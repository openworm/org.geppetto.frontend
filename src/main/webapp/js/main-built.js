function loadCss(e){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define("JSXTransformer",e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.JSXTransformer=e()}}(function(){var define,module,exports;return function e(t,n,r){function i(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return i(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){function s(e,t,n){if(this instanceof s){var r=typeof e;if(t==="base64"&&r==="string"){e=O(e);while(e.length%4!==0)e+="="}var i;if(r==="number")i=P(e);else if(r==="string")i=s.byteLength(e,t);else{if(r!=="object")throw new Error("First argument needs to be a number, array or string.");i=P(e.length)}var o;s._useTypedArrays?o=_(new Uint8Array(i)):(o=this,o.length=i,o._isBuffer=!0);var u;if(s._useTypedArrays&&typeof Uint8Array=="function"&&e instanceof Uint8Array)o._set(e);else if(B(e))for(u=0;u<i;u++)s.isBuffer(e)?o[u]=e.readUInt8(u):o[u]=e[u];else if(r==="string")o.write(e,0,t);else if(r==="number"&&!s._useTypedArrays&&!n)for(u=0;u<i;u++)o[u]=0;return o}return new s(e,t,n)}function o(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=t.length;$(o%2===0,"Invalid hex string"),r>o/2&&(r=o/2);for(var u=0;u<r;u++){var a=parseInt(t.substr(u*2,2),16);$(!isNaN(a),"Invalid hex string"),e[n+u]=a}return s._charsWritten=u*2,u}function u(e,t,n,r){var i=s._charsWritten=U(F(t),e,n,r);return i}function a(e,t,n,r){var i=s._charsWritten=U(I(t),e,n,r);return i}function f(e,t,n,r){return a(e,t,n,r)}function l(e,t,n,r){var i=s._charsWritten=U(R(t),e,n,r);return i}function c(e,t,n,r){var i=s._charsWritten=U(q(t),e,n,r);return i}function h(e,t,n){return t===0&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function p(e,t,n){var r="",i="";n=Math.min(e.length,n);for(var s=t;s<n;s++)e[s]<=127?(r+=z(i)+String.fromCharCode(e[s]),i=""):i+="%"+e[s].toString(16);return r+z(i)}function d(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;i++)r+=String.fromCharCode(e[i]);return r}function v(e,t,n){return d(e,t,n)}function m(e,t,n){var r=e.length;if(!t||t<0)t=0;if(!n||n<0||n>r)n=r;var i="";for(var s=t;s<n;s++)i+=j(e[s]);return i}function g(e,t,n){var r=e.slice(t,n),i="";for(var s=0;s<r.length;s+=2)i+=String.fromCharCode(r[s]+r[s+1]*256);return i}function y(e,t,n,r){r||($(typeof n=="boolean","missing or invalid endian"),$(t!==undefined&&t!==null,"missing offset"),$(t+1<e.length,"Trying to read beyond buffer length"));var i=e.length;if(t>=i)return;var s;return n?(s=e[t],t+1<i&&(s|=e[t+1]<<8)):(s=e[t]<<8,t+1<i&&(s|=e[t+1])),s}function b(e,t,n,r){r||($(typeof n=="boolean","missing or invalid endian"),$(t!==undefined&&t!==null,"missing offset"),$(t+3<e.length,"Trying to read beyond buffer length"));var i=e.length;if(t>=i)return;var s;return n?(t+2<i&&(s=e[t+2]<<16),t+1<i&&(s|=e[t+1]<<8),s|=e[t],t+3<i&&(s+=e[t+3]<<24>>>0)):(t+1<i&&(s=e[t+1]<<16),t+2<i&&(s|=e[t+2]<<8),t+3<i&&(s|=e[t+3]),s+=e[t]<<24>>>0),s}function w(e,t,n,r){r||($(typeof n=="boolean","missing or invalid endian"),$(t!==undefined&&t!==null,"missing offset"),$(t+1<e.length,"Trying to read beyond buffer length"));var i=e.length;if(t>=i)return;var s=y(e,t,n,!0),o=s&32768;return o?(65535-s+1)*-1:s}function E(e,t,n,r){r||($(typeof n=="boolean","missing or invalid endian"),$(t!==undefined&&t!==null,"missing offset"),$(t+3<e.length,"Trying to read beyond buffer length"));var i=e.length;if(t>=i)return;var s=b(e,t,n,!0),o=s&2147483648;return o?(4294967295-s+1)*-1:s}function S(e,t,n,r){return r||($(typeof n=="boolean","missing or invalid endian"),$(t+3<e.length,"Trying to read beyond buffer length")),i.read(e,t,n,23,4)}function x(e,t,n,r){return r||($(typeof n=="boolean","missing or invalid endian"),$(t+7<e.length,"Trying to read beyond buffer length")),i.read(e,t,n,52,8)}function T(e,t,n,r,i){i||($(t!==undefined&&t!==null,"missing value"),$(typeof r=="boolean","missing or invalid endian"),$(n!==undefined&&n!==null,"missing offset"),$(n+1<e.length,"trying to write beyond buffer length"),W(t,65535));var s=e.length;if(n>=s)return;for(var o=0,u=Math.min(s-n,2);o<u;o++)e[n+o]=(t&255<<8*(r?o:1-o))>>>(r?o:1-o)*8}function N(e,t,n,r,i){i||($(t!==undefined&&t!==null,"missing value"),$(typeof r=="boolean","missing or invalid endian"),$(n!==undefined&&n!==null,"missing offset"),$(n+3<e.length,"trying to write beyond buffer length"),W(t,4294967295));var s=e.length;if(n>=s)return;for(var o=0,u=Math.min(s-n,4);o<u;o++)e[n+o]=t>>>(r?o:3-o)*8&255}function C(e,t,n,r,i){i||($(t!==undefined&&t!==null,"missing value"),$(typeof r=="boolean","missing or invalid endian"),$(n!==undefined&&n!==null,"missing offset"),$(n+1<e.length,"Trying to write beyond buffer length"),X(t,32767,-32768));var s=e.length;if(n>=s)return;t>=0?T(e,t,n,r,i):T(e,65535+t+1,n,r,i)}function k(e,t,n,r,i){i||($(t!==undefined&&t!==null,"missing value"),$(typeof r=="boolean","missing or invalid endian"),$(n!==undefined&&n!==null,"missing offset"),$(n+3<e.length,"Trying to write beyond buffer length"),X(t,2147483647,-2147483648));var s=e.length;if(n>=s)return;t>=0?N(e,t,n,r,i):N(e,4294967295+t+1,n,r,i)}function L(e,t,n,r,s){s||($(t!==undefined&&t!==null,"missing value"),$(typeof r=="boolean","missing or invalid endian"),$(n!==undefined&&n!==null,"missing offset"),$(n+3<e.length,"Trying to write beyond buffer length"),V(t,3.4028234663852886e38,-3.4028234663852886e38));var o=e.length;if(n>=o)return;i.write(e,t,n,r,23,4)}function A(e,t,n,r,s){s||($(t!==undefined&&t!==null,"missing value"),$(typeof r=="boolean","missing or invalid endian"),$(n!==undefined&&n!==null,"missing offset"),$(n+7<e.length,"Trying to write beyond buffer length"),V(t,1.7976931348623157e308,-1.7976931348623157e308));var o=e.length;if(n>=o)return;i.write(e,t,n,r,52,8)}function O(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function _(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=M.get,e.set=M.set,e.write=M.write,e.toString=M.toString,e.toLocaleString=M.toString,e.toJSON=M.toJSON,e.copy=M.copy,e.slice=M.slice,e.readUInt8=M.readUInt8,e.readUInt16LE=M.readUInt16LE,e.readUInt16BE=M.readUInt16BE,e.readUInt32LE=M.readUInt32LE,e.readUInt32BE=M.readUInt32BE,e.readInt8=M.readInt8,e.readInt16LE=M.readInt16LE,e.readInt16BE=M.readInt16BE,e.readInt32LE=M.readInt32LE,e.readInt32BE=M.readInt32BE,e.readFloatLE=M.readFloatLE,e.readFloatBE=M.readFloatBE,e.readDoubleLE=M.readDoubleLE,e.readDoubleBE=M.readDoubleBE,e.writeUInt8=M.writeUInt8,e.writeUInt16LE=M.writeUInt16LE,e.writeUInt16BE=M.writeUInt16BE,e.writeUInt32LE=M.writeUInt32LE,e.writeUInt32BE=M.writeUInt32BE,e.writeInt8=M.writeInt8,e.writeInt16LE=M.writeInt16LE,e.writeInt16BE=M.writeInt16BE,e.writeInt32LE=M.writeInt32LE,e.writeInt32BE=M.writeInt32BE,e.writeFloatLE=M.writeFloatLE,e.writeFloatBE=M.writeFloatBE,e.writeDoubleLE=M.writeDoubleLE,e.writeDoubleBE=M.writeDoubleBE,e.fill=M.fill,e.inspect=M.inspect,e.toArrayBuffer=M.toArrayBuffer,e}function D(e,t,n){return typeof e!="number"?n:(e=~~e,e>=t?t:e>=0?e:(e+=t,e>=0?e:0))}function P(e){return e=~~Math.ceil(+e),e<0?0:e}function H(e){return(Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"})(e)}function B(e){return H(e)||s.isBuffer(e)||e&&typeof e=="object"&&typeof e.length=="number"}function j(e){return e<16?"0"+e.toString(16):e.toString(16)}function F(e){var t=[];for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(e.charCodeAt(n));else{var i=n;r>=55296&&r<=57343&&n++;var s=encodeURIComponent(e.slice(i,n+1)).substr(1).split("%");for(var o=0;o<s.length;o++)t.push(parseInt(s[o],16))}}return t}function I(e){var t=[];for(var n=0;n<e.length;n++)t.push(e.charCodeAt(n)&255);return t}function q(e){var t,n,r,i=[];for(var s=0;s<e.length;s++)t=e.charCodeAt(s),n=t>>8,r=t%256,i.push(r),i.push(n);return i}function R(e){return r.toByteArray(e)}function U(e,t,n,r){var i;for(var s=0;s<r;s++){if(s+n>=t.length||s>=e.length)break;t[s+n]=e[s]}return s}function z(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}function W(e,t){$(typeof e=="number","cannot write a non-number as a number"),$(e>=0,"specified a negative value for writing an unsigned value"),$(e<=t,"value is larger than maximum value for type"),$(Math.floor(e)===e,"value has a fractional component")}function X(e,t,n){$(typeof e=="number","cannot write a non-number as a number"),$(e<=t,"value larger than maximum allowed value"),$(e>=n,"value smaller than minimum allowed value"),$(Math.floor(e)===e,"value has a fractional component")}function V(e,t,n){$(typeof e=="number","cannot write a non-number as a number"),$(e<=t,"value larger than maximum allowed value"),$(e>=n,"value smaller than minimum allowed value")}function $(e,t){if(!e)throw new Error(t||"Failed assertion")}var r=e("base64-js"),i=e("ieee754");n.Buffer=s,n.SlowBuffer=s,n.INSPECT_MAX_BYTES=50,s.poolSize=8192,s._useTypedArrays=function(){if(typeof Uint8Array!="function"||typeof ArrayBuffer!="function")return!1;try{var e=new Uint8Array(0);return e.foo=function(){return 42},42===e.foo()&&typeof e.subarray=="function"}catch(t){return!1}}(),s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.isBuffer=function(e){return e!==null&&e!==undefined&&!!e._isBuffer},s.byteLength=function(e,t){var n;e+="";switch(t||"utf8"){case"hex":n=e.length/2;break;case"utf8":case"utf-8":n=F(e).length;break;case"ascii":case"binary":case"raw":n=e.length;break;case"base64":n=R(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=e.length*2;break;default:throw new Error("Unknown encoding")}return n},s.concat=function(e,t){$(H(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array.");if(e.length===0)return new s(0);if(e.length===1)return e[0];var n;if(typeof t!="number"){t=0;for(n=0;n<e.length;n++)t+=e[n].length}var r=new s(t),i=0;for(n=0;n<e.length;n++){var o=e[n];o.copy(r,i),i+=o.length}return r},s.prototype.write=function(e,t,n,r){if(isFinite(t))isFinite(n)||(r=n,n=undefined);else{var i=r;r=t,t=n,n=i}t=Number(t)||0;var s=this.length-t;n?(n=Number(n),n>s&&(n=s)):n=s,r=String(r||"utf8").toLowerCase();var h;switch(r){case"hex":h=o(this,e,t,n);break;case"utf8":case"utf-8":h=u(this,e,t,n);break;case"ascii":h=a(this,e,t,n);break;case"binary":h=f(this,e,t,n);break;case"base64":h=l(this,e,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":h=c(this,e,t,n);break;default:throw new Error("Unknown encoding")}return h},s.prototype.toString=function(e,t,n){var r=this;e=String(e||"utf8").toLowerCase(),t=Number(t)||0,n=n!==undefined?Number(n):n=r.length;if(n===t)return"";var i;switch(e){case"hex":i=m(r,t,n);break;case"utf8":case"utf-8":i=p(r,t,n);break;case"ascii":i=d(r,t,n);break;case"binary":i=v(r,t,n);break;case"base64":i=h(r,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=g(r,t,n);break;default:throw new Error("Unknown encoding")}return i},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.copy=function(e,t,n,r){var i=this;n||(n=0),!r&&r!==0&&(r=this.length),t||(t=0);if(r===n)return;if(e.length===0||i.length===0)return;$(r>=n,"sourceEnd < sourceStart"),$(t>=0&&t<e.length,"targetStart out of bounds"),$(n>=0&&n<i.length,"sourceStart out of bounds"),$(r>=0&&r<=i.length,"sourceEnd out of bounds"),r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);for(var s=0;s<r-n;s++)e[s+t]=this[s+n]},s.prototype.slice=function(e,t){var n=this.length;e=D(e,n,0),t=D(t,n,n);if(s._useTypedArrays)return _(this.subarray(e,t));var r=t-e,i=new s(r,undefined,!0);for(var o=0;o<r;o++)i[o]=this[o+e];return i},s.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},s.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},s.prototype.readUInt8=function(e,t){t||($(e!==undefined&&e!==null,"missing offset"),$(e<this.length,"Trying to read beyond buffer length"));if(e>=this.length)return;return this[e]},s.prototype.readUInt16LE=function(e,t){return y(this,e,!0,t)},s.prototype.readUInt16BE=function(e,t){return y(this,e,!1,t)},s.prototype.readUInt32LE=function(e,t){return b(this,e,!0,t)},s.prototype.readUInt32BE=function(e,t){return b(this,e,!1,t)},s.prototype.readInt8=function(e,t){t||($(e!==undefined&&e!==null,"missing offset"),$(e<this.length,"Trying to read beyond buffer length"));if(e>=this.length)return;var n=this[e]&128;return n?(255-this[e]+1)*-1:this[e]},s.prototype.readInt16LE=function(e,t){return w(this,e,!0,t)},s.prototype.readInt16BE=function(e,t){return w(this,e,!1,t)},s.prototype.readInt32LE=function(e,t){return E(this,e,!0,t)},s.prototype.readInt32BE=function(e,t){return E(this,e,!1,t)},s.prototype.readFloatLE=function(e,t){return S(this,e,!0,t)},s.prototype.readFloatBE=function(e,t){return S(this,e,!1,t)},s.prototype.readDoubleLE=function(e,t){return x(this,e,!0,t)},s.prototype.readDoubleBE=function(e,t){return x(this,e,!1,t)},s.prototype.writeUInt8=function(e,t,n){n||($(e!==undefined&&e!==null,"missing value"),$(t!==undefined&&t!==null,"missing offset"),$(t<this.length,"trying to write beyond buffer length"),W(e,255));if(t>=this.length)return;this[t]=e},s.prototype.writeUInt16LE=function(e,t,n){T(this,e,t,!0,n)},s.prototype.writeUInt16BE=function(e,t,n){T(this,e,t,!1,n)},s.prototype.writeUInt32LE=function(e,t,n){N(this,e,t,!0,n)},s.prototype.writeUInt32BE=function(e,t,n){N(this,e,t,!1,n)},s.prototype.writeInt8=function(e,t,n){n||($(e!==undefined&&e!==null,"missing value"),$(t!==undefined&&t!==null,"missing offset"),$(t<this.length,"Trying to write beyond buffer length"),X(e,127,-128));if(t>=this.length)return;e>=0?this.writeUInt8(e,t,n):this.writeUInt8(255+e+1,t,n)},s.prototype.writeInt16LE=function(e,t,n){C(this,e,t,!0,n)},s.prototype.writeInt16BE=function(e,t,n){C(this,e,t,!1,n)},s.prototype.writeInt32LE=function(e,t,n){k(this,e,t,!0,n)},s.prototype.writeInt32BE=function(e,t,n){k(this,e,t,!1,n)},s.prototype.writeFloatLE=function(e,t,n){L(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){L(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){A(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){A(this,e,t,!1,n)},s.prototype.fill=function(e,t,n){e||(e=0),t||(t=0),n||(n=this.length),typeof e=="string"&&(e=e.charCodeAt(0)),$(typeof e=="number"&&!isNaN(e),"value is not a number"),$(n>=t,"end < start");if(n===t)return;if(this.length===0)return;$(t>=0&&t<this.length,"start out of bounds"),$(n>=0&&n<=this.length,"end out of bounds");for(var r=t;r<n;r++)this[r]=e},s.prototype.inspect=function(){var e=[],t=this.length;for(var r=0;r<t;r++){e[r]=j(this[r]);if(r===n.INSPECT_MAX_BYTES){e[r+1]="...";break}}return"<Buffer "+e.join(" ")+">"},s.prototype.toArrayBuffer=function(){if(typeof Uint8Array=="function"){if(s._useTypedArrays)return(new s(this)).buffer;var e=new Uint8Array(this.length);for(var t=0,n=e.length;t<n;t+=1)e[t]=this[t];return e.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var M=s.prototype},{"base64-js":2,ieee754:3}],2:[function(e,t,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(e){function l(e){var t=e.charCodeAt(0);if(t===s)return 62;if(t===o)return 63;if(t<u)return-1;if(t<u+10)return t-u+26+26;if(t<f+26)return t-f;if(t<a+26)return t-a+26}function c(e){function c(e){u[f++]=e}var t,r,i,s,o,u;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=e.length;o="="===e.charAt(a-2)?2:"="===e.charAt(a-1)?1:0,u=new n(e.length*3/4-o),i=o>0?e.length-4:e.length;var f=0;for(t=0,r=0;t<i;t+=4,r+=3)s=l(e.charAt(t))<<18|l(e.charAt(t+1))<<12|l(e.charAt(t+2))<<6|l(e.charAt(t+3)),c((s&16711680)>>16),c((s&65280)>>8),c(s&255);return o===2?(s=l(e.charAt(t))<<2|l(e.charAt(t+1))>>4,c(s&255)):o===1&&(s=l(e.charAt(t))<<10|l(e.charAt(t+1))<<4|l(e.charAt(t+2))>>2,c(s>>8&255),c(s&255)),u}function h(e){function u(e){return r.charAt(e)}function a(e){return u(e>>18&63)+u(e>>12&63)+u(e>>6&63)+u(e&63)}var t,n=e.length%3,i="",s,o;for(t=0,o=e.length-n;t<o;t+=3)s=(e[t]<<16)+(e[t+1]<<8)+e[t+2],i+=a(s);switch(n){case 1:s=e[e.length-1],i+=u(s>>2),i+=u(s<<4&63),i+="==";break;case 2:s=(e[e.length-2]<<8)+e[e.length-1],i+=u(s>>10),i+=u(s>>4&63),i+=u(s<<2&63),i+="="}return i}var n=typeof Uint8Array!="undefined"?Uint8Array:Array,i="0".charCodeAt(0),s="+".charCodeAt(0),o="/".charCodeAt(0),u="0".charCodeAt(0),a="a".charCodeAt(0),f="A".charCodeAt(0);t.exports.toByteArray=c,t.exports.fromByteArray=h})()},{}],3:[function(e,t,n){n.read=function(e,t,n,r,i){var s,o,u=i*8-r-1,a=(1<<u)-1,f=a>>1,l=-7,c=n?i-1:0,h=n?-1:1,p=e[t+c];c+=h,s=p&(1<<-l)-1,p>>=-l,l+=u;for(;l>0;s=s*256+e[t+c],c+=h,l-=8);o=s&(1<<-l)-1,s>>=-l,l+=r;for(;l>0;o=o*256+e[t+c],c+=h,l-=8);if(s===0)s=1-f;else{if(s===a)return o?NaN:(p?-1:1)*Infinity;o+=Math.pow(2,r),s-=f}return(p?-1:1)*o*Math.pow(2,s-r)},n.write=function(e,t,n,r,i,s){var o,u,a,f=s*8-i-1,l=(1<<f)-1,c=l>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:s-1,d=r?1:-1,v=t<0||t===0&&1/t<0?1:0;t=Math.abs(t),isNaN(t)||t===Infinity?(u=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(a=Math.pow(2,-o))<1&&(o--,a*=2),o+c>=1?t+=h/a:t+=h*Math.pow(2,1-c),t*a>=2&&(o++,a/=2),o+c>=l?(u=0,o=l):o+c>=1?(u=(t*a-1)*Math.pow(2,i),o+=c):(u=t*Math.pow(2,c-1)*Math.pow(2,i),o=0));for(;i>=8;e[n+p]=u&255,p+=d,u/=256,i-=8);o=o<<i|u,f+=i;for(;f>0;e[n+p]=o&255,p+=d,o/=256,f-=8);e[n+p-d]|=v*128}},{}],4:[function(e,t,n){var r=t.exports={};r.nextTick=function(){var e=typeof window!="undefined"&&window.setImmediate,t=typeof window!="undefined"&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||t===null)&&e.data==="process-tick"){e.stopPropagation();if(n.length>0){var r=n.shift();r()}}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],5:[function(e,t,n){(function(e){function t(e,t){var n=0;for(var r=e.length-1;r>=0;r--){var i=e[r];i==="."?e.splice(r,1):i===".."?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function s(e,t){if(e.filter)return e.filter(t);var n=[];for(var r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return r.exec(e).slice(1)};n.resolve=function(){var n="",r=!1;for(var i=arguments.length-1;i>=-1&&!r;i--){var o=i>=0?arguments[i]:e.cwd();if(typeof o!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!o)continue;n=o+"/"+n,r=o.charAt(0)==="/"}return n=t(s(n.split("/"),function(e){return!!e}),!r).join("/"),(r?"/":"")+n||"."},n.normalize=function(e){var r=n.isAbsolute(e),i=o(e,-1)==="/";return e=t(s(e.split("/"),function(e){return!!e}),!r).join("/"),!e&&!r&&(e="."),e&&i&&(e+="/"),(r?"/":"")+e},n.isAbsolute=function(e){return e.charAt(0)==="/"},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(s(e,function(e,t){if(typeof e!="string")throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},n.relative=function(e,t){function r(e){var t=0;for(;t<e.length;t++)if(e[t]!=="")break;var n=e.length-1;for(;n>=0;n--)if(e[n]!=="")break;return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);var i=r(e.split("/")),s=r(t.split("/")),o=Math.min(i.length,s.length),u=o;for(var a=0;a<o;a++)if(i[a]!==s[a]){u=a;break}var f=[];for(var a=u;a<i.length;a++)f.push("..");return f=f.concat(s.slice(u)),f.join("/")},n.sep="/",n.delimiter=":",n.dirname=function(e){var t=i(e),n=t[0],r=t[1];return!n&&!r?".":(r&&(r=r.substr(0,r.length-1)),n+r)},n.basename=function(e,t){var n=i(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){return i(e)[3]};var o="ab".substr(-1)==="b"?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,e("/Users/poshannessy/FB/code/react/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"/Users/poshannessy/FB/code/react/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4}],6:[function(e,t,n){(function(e,t){typeof define=="function"&&define.amd?define(["exports"],t):typeof n!="undefined"?t(n):t(e.esprima={})})(this,function(e){function E(e,t){if(!e)throw new Error("ASSERT: "+t)}function S(e){return e>=48&&e<=57}function x(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function T(e){return"01234567".indexOf(e)>=0}function N(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&" ᠎             　﻿".indexOf(String.fromCharCode(e))>0}function C(e){return e===10||e===13||e===8232||e===8233}function k(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&u.NonAsciiIdentifierStart.test(String.fromCharCode(e))}function L(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&u.NonAsciiIdentifierPart.test(String.fromCharCode(e))}function A(e){switch(e){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}function O(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function M(e){return e==="eval"||e==="arguments"}function _(e){if(h&&O(e))return!0;switch(e.length){case 2:return e==="if"||e==="in"||e==="do";case 3:return e==="var"||e==="for"||e==="new"||e==="try"||e==="let";case 4:return e==="this"||e==="else"||e==="case"||e==="void"||e==="with"||e==="enum";case 5:return e==="while"||e==="break"||e==="catch"||e==="throw"||e==="const"||e==="yield"||e==="class"||e==="super";case 6:return e==="return"||e==="typeof"||e==="delete"||e==="switch"||e==="export"||e==="import";case 7:return e==="default"||e==="finally"||e==="extends";case 8:return e==="function"||e==="continue"||e==="debugger";case 10:return e==="instanceof";default:return!1}}function D(){var e,t,n;t=!1,n=!1;while(p<m){e=c.charCodeAt(p);if(n)++p,C(e)&&(n=!1,e===13&&c.charCodeAt(p)===10&&++p,++d,v=p);else if(t)C(e)?(e===13&&c.charCodeAt(p+1)===10&&++p,++d,++p,v=p,p>=m&&et({},o.UnexpectedToken,"ILLEGAL")):(e=c.charCodeAt(p++),p>=m&&et({},o.UnexpectedToken,"ILLEGAL"),e===42&&(e=c.charCodeAt(p),e===47&&(++p,t=!1)));else if(e===47){e=c.charCodeAt(p+1);if(e===47)p+=2,n=!0;else{if(e!==42)break;p+=2,t=!0,p>=m&&et({},o.UnexpectedToken,"ILLEGAL")}}else if(N(e))++p;else{if(!C(e))break;++p,e===13&&c.charCodeAt(p)===10&&++p,++d,v=p}}}function P(e){var t,n,r,i=0;n=e==="u"?4:2;for(t=0;t<n;++t){if(!(p<m&&x(c[p])))return"";r=c[p++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())}return String.fromCharCode(i)}function H(){var e,t,n,r;e=c[p],t=0,e==="}"&&et({},o.UnexpectedToken,"ILLEGAL");while(p<m){e=c[p++];if(!x(e))break;t=t*16+"0123456789abcdef".indexOf(e.toLowerCase())}return(t>1114111||e!=="}")&&et({},o.UnexpectedToken,"ILLEGAL"),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,r=(t-65536&1023)+56320,String.fromCharCode(n,r))}function B(){var e,t;e=c.charCodeAt(p++),t=String.fromCharCode(e),e===92&&(c.charCodeAt(p)!==117&&et({},o.UnexpectedToken,"ILLEGAL"),++p,e=P("u"),(!e||e==="\\"||!k(e.charCodeAt(0)))&&et({},o.UnexpectedToken,"ILLEGAL"),t=e);while(p<m){e=c.charCodeAt(p);if(!L(e))break;++p,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),c.charCodeAt(p)!==117&&et({},o.UnexpectedToken,"ILLEGAL"),++p,e=P("u"),(!e||e==="\\"||!L(e.charCodeAt(0)))&&et({},o.UnexpectedToken,"ILLEGAL"),t+=e)}return t}function j(){var e,t;e=p++;while(p<m){t=c.charCodeAt(p);if(t===92)return p=e,B();if(!L(t))break;++p}return c.slice(e,p)}function F(){var e,n,r;return e=p,n=c.charCodeAt(p)===92?B():j(),n.length===1?r=t.Identifier:_(n)?r=t.Keyword:n==="null"?r=t.NullLiteral:n==="true"||n==="false"?r=t.BooleanLiteral:r=t.Identifier,{type:r,value:n,lineNumber:d,lineStart:v,range:[e,p]}}function I(){var e=p,n=c.charCodeAt(p),r,i=c[p],s,u,a;switch(n){case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++p,w.tokenize&&(n===40?w.openParenToken=w.tokens.length:n===123&&(w.openCurlyToken=w.tokens.length)),{type:t.Punctuator,value:String.fromCharCode(n),lineNumber:d,lineStart:v,range:[e,p]};default:r=c.charCodeAt(p+1);if(r===61)switch(n){case 37:case 38:case 42:case 43:case 45:case 47:case 60:case 62:case 94:case 124:return p+=2,{type:t.Punctuator,value:String.fromCharCode(n)+String.fromCharCode(r),lineNumber:d,lineStart:v,range:[e,p]};case 33:case 61:return p+=2,c.charCodeAt(p)===61&&++p,{type:t.Punctuator,value:c.slice(e,p),lineNumber:d,lineStart:v,range:[e,p]};default:}}s=c[p+1],u=c[p+2],a=c[p+3];if(i===">"&&s===">"&&u===">"&&a==="=")return p+=4,{type:t.Punctuator,value:">>>=",lineNumber:d,lineStart:v,range:[e,p]};if(i===">"&&s===">"&&u===">")return p+=3,{type:t.Punctuator,value:">>>",lineNumber:d,lineStart:v,range:[e,p]};if(i==="<"&&s==="<"&&u==="=")return p+=3,{type:t.Punctuator,value:"<<=",lineNumber:d,lineStart:v,range:[e,p]};if(i===">"&&s===">"&&u==="=")return p+=3,{type:t.Punctuator,value:">>=",lineNumber:d,lineStart:v,range:[e,p]};if(i==="."&&s==="."&&u===".")return p+=3,{type:t.Punctuator,value:"...",lineNumber:d,lineStart:v,range:[e,p]};if(i===s&&"+-<>&|".indexOf(i)>=0)return p+=2,{type:t.Punctuator,value:i+s,lineNumber:d,lineStart:v,range:[e,p]};if(i==="="&&s===">")return p+=2,{type:t.Punctuator,value:"=>",lineNumber:d,lineStart:v,range:[e,p]};if("<>=!+-*%&|^/".indexOf(i)>=0)return++p,{type:t.Punctuator,value:i,lineNumber:d,lineStart:v,range:[e,p]};if(i===".")return++p,{type:t.Punctuator,value:i,lineNumber:d,lineStart:v,range:[e,p]};et({},o.UnexpectedToken,"ILLEGAL")}function q(e){var n="";while(p<m){if(!x(c[p]))break;n+=c[p++]}return n.length===0&&et({},o.UnexpectedToken,"ILLEGAL"),k(c.charCodeAt(p))&&et({},o.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt("0x"+n,16),lineNumber:d,lineStart:v,range:[e,p]}}function R(e,n){var r,i;T(e)?(i=!0,r="0"+c[p++]):(i=!1,++p,r="");while(p<m){if(!T(c[p]))break;r+=c[p++]}return!i&&r.length===0&&et({},o.UnexpectedToken,"ILLEGAL"),(k(c.charCodeAt(p))||S(c.charCodeAt(p)))&&et({},o.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt(r,8),octal:i,lineNumber:d,lineStart:v,range:[n,p]}}function U(){var e,n,r,i;r=c[p],E(S(r.charCodeAt(0))||r===".","Numeric literal must start with a decimal digit or a decimal point"),n=p,e="";if(r!=="."){e=c[p++],r=c[p];if(e==="0"){if(r==="x"||r==="X")return++p,q(n);if(r==="b"||r==="B"){++p,e="";while(p<m){r=c[p];if(r!=="0"&&r!=="1")break;e+=c[p++]}return e.length===0&&et({},o.UnexpectedToken,"ILLEGAL"),p<m&&(r=c.charCodeAt(p),(k(r)||S(r))&&et({},o.UnexpectedToken,"ILLEGAL")),{type:t.NumericLiteral,value:parseInt(e,2),lineNumber:d,lineStart:v,range:[n,p]}}if(r==="o"||r==="O"||T(r))return R(r,n);r&&S(r.charCodeAt(0))&&et({},o.UnexpectedToken,"ILLEGAL")}while(S(c.charCodeAt(p)))e+=c[p++];r=c[p]}if(r==="."){e+=c[p++];while(S(c.charCodeAt(p)))e+=c[p++];r=c[p]}if(r==="e"||r==="E"){e+=c[p++],r=c[p];if(r==="+"||r==="-")e+=c[p++];if(S(c.charCodeAt(p)))while(S(c.charCodeAt(p)))e+=c[p++];else et({},o.UnexpectedToken,"ILLEGAL")}return k(c.charCodeAt(p))&&et({},o.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseFloat(e),lineNumber:d,lineStart:v,range:[n,p]}}function z(){var e="",n,r,i,s,u,a,f=!1;n=c[p],E(n==="'"||n==='"',"String literal must starts with a quote"),r=p,++p;while(p<m){i=c[p++];if(i===n){n="";break}if(i==="\\"){i=c[p++];if(!i||!C(i.charCodeAt(0)))switch(i){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="	";break;case"u":case"x":c[p]==="{"?(++p,e+=H()):(a=p,u=P(i),u?e+=u:(p=a,e+=i));break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="";break;default:T(i)?(s="01234567".indexOf(i),s!==0&&(f=!0),p<m&&T(c[p])&&(f=!0,s=s*8+"01234567".indexOf(c[p++]),"0123".indexOf(i)>=0&&p<m&&T(c[p])&&(s=s*8+"01234567".indexOf(c[p++]))),e+=String.fromCharCode(s)):e+=i}else++d,i==="\r"&&c[p]==="\n"&&++p}else{if(C(i.charCodeAt(0)))break;e+=i}}return n!==""&&et({},o.UnexpectedToken,"ILLEGAL"),{type:t.StringLiteral,value:e,octal:f,lineNumber:d,lineStart:v,range:[r,p]}}function W(){var e="",n,r,i,s,u,a,f,l;i=!1,s=!1,r=p,++p;while(p<m){n=c[p++];if(n==="`"){s=!0,i=!0;break}if(n==="$"){if(c[p]==="{"){++p,i=!0;break}e+=n}else if(n==="\\"){n=c[p++];if(!C(n.charCodeAt(0)))switch(n){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="	";break;case"u":case"x":c[p]==="{"?(++p,e+=H()):(u=p,a=P(n),a?e+=a:(p=u,e+=n));break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="";break;default:T(n)?(f="01234567".indexOf(n),f!==0&&(l=!0),p<m&&T(c[p])&&(l=!0,f=f*8+"01234567".indexOf(c[p++]),"0123".indexOf(n)>=0&&p<m&&T(c[p])&&(f=f*8+"01234567".indexOf(c[p++]))),e+=String.fromCharCode(f)):e+=n}else++d,n==="\r"&&c[p]==="\n"&&++p}else C(n.charCodeAt(0))?(++d,n==="\r"&&c[p]==="\n"&&++p,e+="\n"):e+=n}return i||et({},o.UnexpectedToken,"ILLEGAL"),{type:t.Template,value:{cooked:e,raw:c.slice(r+1,p-(s?1:2))},tail:s,octal:l,lineNumber:d,lineStart:v,range:[r,p]}}function X(e){var t,n;return y=null,D(),t=e.head?"`":"}",c[p]!==t&&et({},o.UnexpectedToken,"ILLEGAL"),n=W(),G(),n}function V(){var e,n,r,i,s,u,a=!1,f,l=!1;y=null,D(),r=p,n=c[p],E(n==="/","Regular expression literal must start with a slash"),e=c[p++];while(p<m){n=c[p++],e+=n;if(a)n==="]"&&(a=!1);else if(n==="\\")n=c[p++],C(n.charCodeAt(0))&&et({},o.UnterminatedRegExp),e+=n;else{if(n==="/"){l=!0;break}n==="["?a=!0:C(n.charCodeAt(0))&&et({},o.UnterminatedRegExp)}}l||et({},o.UnterminatedRegExp),i=e.substr(1,e.length-2),s="";while(p<m){n=c[p];if(!L(n.charCodeAt(0)))break;++p;if(n==="\\"&&p<m){n=c[p];if(n==="u"){++p,f=p,n=P("u");if(n){s+=n;for(e+="\\u";f<p;++f)e+=c[f]}else p=f,s+="u",e+="\\u"}else e+="\\"}else s+=n,e+=n}try{u=new RegExp(i,s)}catch(h){et({},o.InvalidRegExp)}return G(),w.tokenize?{type:t.RegularExpression,value:u,lineNumber:d,lineStart:v,range:[r,p]}:{literal:e,value:u,range:[r,p]}}function $(e){return e.type===t.Identifier||e.type===t.Keyword||e.type===t.BooleanLiteral||e.type===t.NullLiteral}function J(){var e,t;e=w.tokens[w.tokens.length-1];if(!e)return V();if(e.type==="Punctuator"){if(e.value===")")return t=w.tokens[w.openParenToken-1],!t||t.type!=="Keyword"||t.value!=="if"&&t.value!=="while"&&t.value!=="for"&&t.value!=="with"?I():V();if(e.value==="}"){if(w.tokens[w.openCurlyToken-3]&&w.tokens[w.openCurlyToken-3].type==="Keyword"){t=w.tokens[w.openCurlyToken-4];if(!t)return I()}else{if(!w.tokens[w.openCurlyToken-4]||w.tokens[w.openCurlyToken-4].type!=="Keyword")return I();t=w.tokens[w.openCurlyToken-5];if(!t)return V()}return r.indexOf(t.value)>=0?I():V()}return V()}return e.type==="Keyword"?V():I()}function K(){var e;return b.inXJSChild||D(),p>=m?{type:t.EOF,lineNumber:d,lineStart:v,range:[p,p]}:b.inXJSChild?Gn():(e=c.charCodeAt(p),e===40||e===41||e===58?I():e===39||e===34?b.inXJSTag?Qn():z():b.inXJSTag&&Xn(e)?$n():e===96?W():k(e)?F():e===46?S(c.charCodeAt(p+1))?U():I():S(e)?U():w.tokenize&&e===47?J():I())}function Q(){var e;return e=y,p=e.range[1],d=e.lineNumber,v=e.lineStart,y=K(),p=e.range[1],d=e.lineNumber,v=e.lineStart,e}function G(){var e,t,n;e=p,t=d,n=v,y=K(),p=e,d=t,v=n}function Y(){var e,t,n,r,i;return e=typeof w.advance=="function"?w.advance:K,t=p,n=d,r=v,y===null&&(y=e()),p=y.range[1],d=y.lineNumber,v=y.lineStart,i=e(),p=t,d=n,v=r,i}function Z(){var e,t,n,r;return e=p,t=d,n=v,D(),r=d!==t,p=e,d=t,v=n,r}function et(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(e,t){return E(t<r.length,"Message reference must be in range"),r[t]});throw typeof e.lineNumber=="number"?(n=new Error("Line "+e.lineNumber+": "+i),n.index=e.range[0],n.lineNumber=e.lineNumber,n.column=e.range[0]-v+1):(n=new Error("Line "+d+": "+i),n.index=p,n.lineNumber=d,n.column=p-v+1),n.description=i,n}function tt(){try{et.apply(null,arguments)}catch(e){if(!w.errors)throw e;w.errors.push(e)}}function nt(e){e.type===t.EOF&&et(e,o.UnexpectedEOS),e.type===t.NumericLiteral&&et(e,o.UnexpectedNumber),(e.type===t.StringLiteral||e.type===t.XJSText)&&et(e,o.UnexpectedString),e.type===t.Identifier&&et(e,o.UnexpectedIdentifier);if(e.type===t.Keyword){if(A(e.value))et(e,o.UnexpectedReserved);else if(h&&O(e.value)){tt(e,o.StrictReservedWord);return}et(e,o.UnexpectedToken,e.value)}e.type===t.Template&&et(e,o.UnexpectedTemplate,e.value.raw),et(e,o.UnexpectedToken,e.value)}function rt(e){var n=Q();(n.type!==t.Punctuator||n.value!==e)&&nt(n)}function it(e){var n=Q();(n.type!==t.Keyword||n.value!==e)&&nt(n)}function st(e){return y.type===t.Punctuator&&y.value===e}function ot(e){return y.type===t.Keyword&&y.value===e}function ut(e){return y.type===t.Identifier&&y.value===e}function at(){var e;return y.type!==t.Punctuator?!1:(e=y.value,e==="="||e==="*="||e==="/="||e==="%="||e==="+="||e==="-="||e==="<<="||e===">>="||e===">>>="||e==="&="||e==="^="||e==="|=")}function ft(){var e;if(c.charCodeAt(p)===59){Q();return}e=d,D();if(d!==e)return;if(st(";")){Q();return}y.type!==t.EOF&&!st("}")&&nt(y)}function lt(e){return e.type===i.Identifier||e.type===i.MemberExpression}function ct(e){return lt(e)||e.type===i.ObjectPattern||e.type===i.ArrayPattern}function ht(){var e=[],n=[],r=null,s,u=!0,a;rt("[");while(!st("]"))y.value==="for"&&y.type===t.Keyword?(u||et({},o.ComprehensionError),ot("for"),s=fn({ignoreBody:!0}),s.of=s.type===i.ForOfStatement,s.type=i.ComprehensionBlock,s.left.kind&&et({},o.ComprehensionError),n.push(s)):y.value==="if"&&y.type===t.Keyword?(u||et({},o.ComprehensionError),it("if"),rt("("),r=qt(),rt(")")):y.value===","&&y.type===t.Punctuator?(u=!1,Q(),e.push(null)):(s=xt(),e.push(s),s&&s.type===i.SpreadElement?st("]")||et({},o.ElementAfterSpreadElement):st("]")||ot("for")||ot("if")||(rt(","),u=!1));return rt("]"),r&&!n.length&&et({},o.ComprehensionRequiresBlock),n.length?(e.length!==1&&et({},o.ComprehensionError),{type:i.ComprehensionExpression,filter:r,blocks:n,body:e[0]}):g.createArrayExpression(e)}function pt(e){var t,n,r,s,u;return t=h,n=b.yieldAllowed,b.yieldAllowed=e.generator,r=e.params||[],s=e.defaults||[],u=En(),e.name&&h&&M(r[0].name)&&tt(e.name,o.StrictParamName),b.yieldAllowed&&!b.yieldFound&&tt({},o.NoYieldInGenerator),h=t,b.yieldAllowed=n,g.createFunctionExpression(null,r,s,u,e.rest||null,e.generator,u.type!==i.BlockStatement,e.returnTypeAnnotation)}function dt(e){var t,n,r;return t=h,h=!0,n=Nn(),n.stricted&&tt(n.stricted,n.message),r=pt({params:n.params,defaults:n.defaults,rest:n.rest,generator:e.generator,returnTypeAnnotation:n.returnTypeAnnotation}),h=t,r}function vt(){var e=Q();return e.type===t.StringLiteral||e.type===t.NumericLiteral?(h&&e.octal&&tt(e,o.StrictOctalLiteral),g.createLiteral(e)):g.createIdentifier(e.value)}function mt(){var e,n,r,i,s;e=y;if(e.type===t.Identifier)return r=vt(),e.value==="get"&&!st(":")&&!st("(")?(n=vt(),rt("("),rt(")"),g.createProperty("get",n,pt({generator:!1}),!1,!1)):e.value==="set"&&!st(":")&&!st("(")?(n=vt(),rt("("),e=y,s=[Xt()],rt(")"),g.createProperty("set",n,pt({params:s,generator:!1,name:e}),!1,!1)):st(":")?(Q(),g.createProperty("init",r,It(),!1,!1)):st("(")?g.createProperty("init",r,dt({generator:!1}),!0,!1):g.createProperty("init",r,r,!1,!0);if(e.type===t.EOF||e.type===t.Punctuator)return st("*")||nt(e),Q(),r=vt(),st("(")||nt(Q()),g.createProperty("init",r,dt({generator:!0}),!0,!1);n=vt();if(st(":"))return Q(),g.createProperty("init",n,It(),!1,!1);if(st("("))return g.createProperty("init",n,dt({generator:!1}),!0,!1);nt(Q())}function gt(){var e=[],t,n,r,u,a={},f=String;rt("{");while(!st("}"))t=mt(),t.key.type===i.Identifier?n=t.key.name:n=f(t.key.value),u=t.kind==="init"?s.Data:t.kind==="get"?s.Get:s.Set,r="$"+n,Object.prototype.hasOwnProperty.call(a,r)?(a[r]===s.Data?h&&u===s.Data?tt({},o.StrictDuplicateProperty):u!==s.Data&&tt({},o.AccessorDataProperty):u===s.Data?tt({},o.AccessorDataProperty):a[r]&u&&tt({},o.AccessorGetSet),a[r]|=u):a[r]=u,e.push(t),st("}")||rt(",");return rt("}"),g.createObjectExpression(e)}function yt(e){var t=X(e);return h&&t.octal&&et(t,o.StrictOctalLiteral),g.createTemplateElement({raw:t.value.raw,cooked:t.value.cooked},t.tail)}function bt(){var e,t,n;e=yt({head:!0}),t=[e],n=[];while(!e.tail)n.push(qt()),e=yt({head:!1}),t.push(e);return g.createTemplateLiteral(t,n)}function wt(){var e;return rt("("),++b.parenthesizedCount,e=qt(),rt(")"),e}function Et(){var e,n;n=y,e=y.type;if(e===t.Identifier)return Q(),g.createIdentifier(n.value);if(e===t.StringLiteral||e===t.NumericLiteral)return h&&y.octal&&tt(y,o.StrictOctalLiteral),g.createLiteral(Q());if(e===t.Keyword){if(ot("this"))return Q(),g.createThisExpression();if(ot("function"))return kn();if(ot("class"))return _n();if(ot("super"))return Q(),g.createIdentifier("super")}return e===t.BooleanLiteral?(n=Q(),n.value=n.value==="true",g.createLiteral(n)):e===t.NullLiteral?(n=Q(),n.value=null,g.createLiteral(n)):st("[")?ht():st("{")?gt():st("(")?wt():st("/")||st("/=")?g.createLiteral(V()):e===t.Template?bt():st("<")?or():nt(Q())}function St(){var e=[],t;rt("(");if(!st(")"))while(p<m){t=xt(),e.push(t);if(st(")"))break;t.type===i.SpreadElement&&et({},o.ElementAfterSpreadElement),rt(",")}return rt(")"),e}function xt(){return st("...")?(Q(),g.createSpreadElement(It())):It()}function Tt(){var e=Q();return $(e)||nt(e),g.createIdentifier(e.value)}function Nt(){return rt("."),Tt()}function Ct(){var e;return rt("["),e=qt(),rt("]"),e}function kt(){var e,t;return it("new"),e=At(),t=st("(")?St():[],g.createNewExpression(e,t)}function Lt(){var e,n,r;e=ot("new")?kt():Et();while(st(".")||st("[")||st("(")||y.type===t.Template)st("(")?(n=St(),e=g.createCallExpression(e,n)):st("[")?e=g.createMemberExpression("[",e,Ct()):st(".")?e=g.createMemberExpression(".",e,Nt()):e=g.createTaggedTemplateExpression(e,bt());return e}function At(){var e,n;e=ot("new")?kt():Et();while(st(".")||st("[")||y.type===t.Template)st("[")?e=g.createMemberExpression("[",e,Ct()):st(".")?e=g.createMemberExpression(".",e,Nt()):e=g.createTaggedTemplateExpression(e,bt());return e}function Ot(){var e=Lt(),n=y;return y.type!==t.Punctuator?e:((st("++")||st("--"))&&!Z()&&(h&&e.type===i.Identifier&&M(e.name)&&tt({},o.StrictLHSPostfix),lt(e)||et({},o.InvalidLHSInAssignment),n=Q(),e=g.createPostfixExpression(n.value,e)),e)}function Mt(){var e,n;return y.type!==t.Punctuator&&y.type!==t.Keyword?Ot():st("++")||st("--")?(e=Q(),n=Mt(),h&&n.type===i.Identifier&&M(n.name)&&tt({},o.StrictLHSPrefix),lt(n)||et({},o.InvalidLHSInAssignment),g.createUnaryExpression(e.value,n)):st("+")||st("-")||st("~")||st("!")?(e=Q(),n=Mt(),g.createUnaryExpression(e.value,n)):ot("delete")||ot("void")||ot("typeof")?(e=Q(),n=Mt(),n=g.createUnaryExpression(e.value,n),h&&n.operator==="delete"&&n.argument.type===i.Identifier&&tt({},o.StrictDelete),n):Ot()}function _t(e,n){var r=0;if(e.type!==t.Punctuator&&e.type!==t.Keyword)return 0;switch(e.value){case"||":r=1;break;case"&&":r=2;break;case"|":r=3;break;case"^":r=4;break;case"&":r=5;break;case"==":case"!=":case"===":case"!==":r=6;break;case"<":case">":case"<=":case">=":case"instanceof":r=7;break;case"in":r=n?7:0;break;case"<<":case">>":case">>>":r=8;break;case"+":case"-":r=9;break;case"*":case"/":case"%":r=11;break;default:}return r}function Dt(){var e,t,n,r,i,s,o,u,a;r=b.allowIn,b.allowIn=!0,e=Mt(),t=y,n=_t(t,r);if(n===0)return e;t.prec=n,Q(),i=[e,t,Mt()];while((n=_t(y,r))>0){while(i.length>2&&n<=i[i.length-2].prec)s=i.pop(),o=i.pop().value,u=i.pop(),i.push(g.createBinaryExpression(o,u,s));t=Q(),t.prec=n,i.push(t),i.push(Mt())}b.allowIn=r,a=i.length-1,e=i[a];while(a>1)e=g.createBinaryExpression(i[a-1].value,i[a-2],e),a-=2;return e}function Pt(){var e,t,n,r;return e=Dt(),st("?")&&(Q(),t=b.allowIn,b.allowIn=!0,n=It(),b.allowIn=t,rt(":"),r=It(),e=g.createConditionalExpression(e,n,r)),e}function Ht(e){var t,n,r,s;if(e.type===i.ObjectExpression){e.type=i.ObjectPattern;for(t=0,n=e.properties.length;t<n;t+=1)r=e.properties[t],r.kind!=="init"&&et({},o.InvalidLHSInAssignment),Ht(r.value)}else if(e.type===i.ArrayExpression){e.type=i.ArrayPattern;for(t=0,n=e.elements.length;t<n;t+=1)s=e.elements[t],s&&Ht(s)}else e.type===i.Identifier?M(e.name)&&et({},o.InvalidLHSInAssignment):e.type===i.SpreadElement?(Ht(e.argument),e.argument.type===i.ObjectPattern&&et({},o.ObjectPatternAsSpread)):e.type!==i.MemberExpression&&e.type!==i.CallExpression&&e.type!==i.NewExpression&&et({},o.InvalidLHSInAssignment)}function Bt(e,t){var n,r,s,u;if(t.type===i.ObjectExpression){t.type=i.ObjectPattern;for(n=0,r=t.properties.length;n<r;n+=1)s=t.properties[n],s.kind!=="init"&&et({},o.InvalidLHSInFormalsList),Bt(e,s.value)}else if(t.type===i.ArrayExpression){t.type=i.ArrayPattern;for(n=0,r=t.elements.length;n<r;n+=1)u=t.elements[n],u&&Bt(e,u)}else t.type===i.Identifier?xn(e,t,t.name):t.type!==i.MemberExpression&&et({},o.InvalidLHSInFormalsList)}function jt(e){var t,n,r,s,u,a,f,l;s=[],u=[],a=0,l=null,f={paramSet:{}};for(t=0,n=e.length;t<n;t+=1){r=e[t];if(r.type===i.Identifier)s.push(r),u.push(null),xn(f,r,r.name);else if(r.type===i.ObjectExpression||r.type===i.ArrayExpression)Bt(f,r),s.push(r),u.push(null);else if(r.type===i.SpreadElement)E(t===n-1,"It is guaranteed that SpreadElement is last element by parseExpression"),Bt(f,r.argument),l=r.argument;else{if(r.type!==i.AssignmentExpression)return null;s.push(r.left),u.push(r.right),++a,xn(f,r.left,r.left.name)}}return f.message===o.StrictParamDupe&&et(h?f.stricted:f.firstRestricted,f.message),a===0&&(u=[]),{params:s,defaults:u,rest:l,stricted:f.stricted,firstRestricted:f.firstRestricted,message:f.message}}function Ft(e){var t,n,r;return rt("=>"),t=h,n=b.yieldAllowed,b.yieldAllowed=!1,r=En(),h&&e.firstRestricted&&et(e.firstRestricted,e.message),h&&e.stricted&&tt(e.stricted,e.message),h=t,b.yieldAllowed=n,g.createArrowFunctionExpression(e.params,e.defaults,r,e.rest,r.type!==i.BlockStatement)}function It(){var e,n,r,s;if(ot("yield"))return Ln();s=b.parenthesizedCount;if(st("(")){n=Y();if(n.type===t.Punctuator&&n.value===")"||n.value==="...")return r=Nn(),st("=>")||nt(Q()),Ft(r)}n=y,e=Pt();if(st("=>")&&(b.parenthesizedCount===s||b.parenthesizedCount===s+1)){e.type===i.Identifier?r=jt([e]):e.type===i.SequenceExpression&&(r=jt(e.expressions));if(r)return Ft(r)}return at()&&(h&&e.type===i.Identifier&&M(e.name)&&tt(n,o.StrictLHSAssignment),!st("=")||e.type!==i.ObjectExpression&&e.type!==i.ArrayExpression?lt(e)||et({},o.InvalidLHSInAssignment):Ht(e),e=g.createAssignmentExpression(Q().value,e,It())),e}function qt(){var e,t,n,r,s,u;u=b.parenthesizedCount,e=It(),t=[e];if(st(",")){while(p<m){if(!st(","))break;Q(),e=xt(),t.push(e);if(e.type===i.SpreadElement){s=!0,st(")")||et({},o.ElementAfterSpreadElement);break}}n=g.createSequenceExpression(t)}if(st("=>")){if(b.parenthesizedCount===u||b.parenthesizedCount===u+1){e=e.type===i.SequenceExpression?e.expressions:t,r=jt(e);if(r)return Ft(r)}nt(Q())}return s&&Y().value!=="=>"&&et({},o.IllegalSpread),n||e}function Rt(){var e=[],t;while(p<m){if(st("}"))break;t=Hn();if(typeof t=="undefined")break;e.push(t)}return e}function Ut(){var e;return rt("{"),e=Rt(),rt("}"),g.createBlockStatement(e)}function zt(e){var n=null,r=null,i=null,s=!1;e||rt(":"),st("?")&&(Q(),s=!0),y.type===t.Identifier&&(n=Wt());if(st("(")){Q(),r=[];while(y.type===t.Identifier||st("?"))r.push(zt(!0)),st(")")||rt(",");rt(")"),rt("=>"),ot("void")?Q():i=zt(!0)}return g.createTypeAnnotation(n,r,i,s)}function Wt(){var e=Q();return e.type!==t.Identifier&&nt(e),g.createIdentifier(e.value)}function Xt(){var e=Wt();return st(":")?g.createTypeAnnotatedIdentifier(e,zt()):e}function Vt(e){var t,n=null;return st("{")?(t=gt(),Ht(t)):st("[")?(t=ht(),Ht(t)):(t=b.allowKeyword?Tt():Xt(),h&&M(t.name)&&tt({},o.StrictVarName)),e==="const"?(st("=")||et({},o.NoUnintializedConst),rt("="),n=It()):st("=")&&(Q(),n=It()),g.createVariableDeclarator(t,n)}function $t(e){var t=[];do{t.push(Vt(e));if(!st(","))break;Q()}while(p<m);return t}function Jt(){var e;return it("var"),e=$t(),ft(),g.createVariableDeclaration(e,"var")}function Kt(e){var t;return it(e),t=$t(e),ft(),g.createVariableDeclaration(t,e)}function Qt(){var e,n,r;Q(),Z()&&et({},o.NewlineAfterModule);switch(y.type){case t.StringLiteral:e=Et(),r=qn(),n=null;break;case t.Identifier:e=Wt(),r=null,ut("from")||nt(Q()),Q(),n=Et(),n.type!==i.Literal&&et({},o.InvalidModuleSpecifier)}return ft(),g.createModuleDeclaration(e,n,r)}function Gt(){return rt("*"),g.createExportBatchSpecifier()}function Yt(){var e,t=null;return e=Wt(),ut("as")&&(Q(),t=Tt()),g.createExportSpecifier(e,t)}function Zt(){var e,n,r,s,u;it("export");if(y.type===t.Keyword)switch(y.value){case"let":case"const":case"var":case"class":case"function":return g.createExportDeclaration(Hn(),null,null)}if($(y))return e=b.allowKeyword,b.allowKeyword=!0,n=$t("let"),b.allowKeyword=e,g.createExportDeclaration(n,null,null);u=[],s=null;if(st("*"))u.push(Gt());else{rt("{");do u.push(Yt());while(st(",")&&Q());rt("}")}return ut("from")&&(Q(),s=Et(),s.type!==i.Literal&&et({},o.InvalidModuleSpecifier)),ft(),g.createExportDeclaration(null,u,s)}function en(){var e,t,n;it("import"),e=[];if($(y))t="default",e.push(tn()),ut("from")||et({},o.NoFromAfterImport),Q();else if(st("{")){t="named",Q();do e.push(tn());while(st(",")&&Q());rt("}"),ut("from")||et({},o.NoFromAfterImport),Q()}return n=Et(),n.type!==i.Literal&&et({},o.InvalidModuleSpecifier),ft(),g.createImportDeclaration(e,t,n)}function tn(){var e,t=null;return e=Tt(),ut("as")&&(Q(),t=Wt()),g.createImportSpecifier(e,t)}function nn(){return rt(";"),g.createEmptyStatement()}function rn(){var e=qt();return ft(),g.createExpressionStatement(e)}function sn(){var e,t,n;return it("if"),rt("("),e=qt(),rt(")"),t=wn(),ot("else")?(Q(),n=wn()):n=null,g.createIfStatement(e,t,n)}function on(){var e,t,n;return it("do"),n=b.inIteration,b.inIteration=!0,e=wn(),b.inIteration=n,it("while"),rt("("),t=qt(),rt(")"),st(";")&&Q(),g.createDoWhileStatement(e,t)}function un(){var e,t,n;return it("while"),rt("("),e=qt(),rt(")"),n=b.inIteration,b.inIteration=!0,t=wn(),b.inIteration=n,g.createWhileStatement(e,t)}function an(){var e=Q(),t=$t();return g.createVariableDeclaration(t,e.value)}function fn(e){var t,n,r,i,s,u,a,f;t=n=r=null,it("for"),ut("each")&&et({},o.EachNotAllowed),rt("(");if(st(";"))Q();else{if(ot("var")||ot("let")||ot("const")){b.allowIn=!1,t=an(),b.allowIn=!0;if(t.declarations.length===1)if(ot("in")||ut("of")){a=y;if(a.value!=="in"&&t.kind==="var"||!t.declarations[0].init)Q(),i=t,s=qt(),t=null}}else b.allowIn=!1,t=qt(),b.allowIn=!0,ut("of")?(a=Q(),i=t,s=qt(),t=null):ot("in")&&(ct(t)||et({},o.InvalidLHSInForIn),a=Q(),i=t,s=qt(),t=null);typeof i=="undefined"&&rt(";")}typeof i=="undefined"&&(st(";")||(n=qt()),rt(";"),st(")")||(r=qt())),rt(")"),f=b.inIteration,b.inIteration=!0;if(e===undefined||!e.ignoreBody)u=wn();return b.inIteration=f,typeof i=="undefined"?g.createForStatement(t,n,r,u):a.value==="in"?g.createForInStatement(i,s,u):g.createForOfStatement(i,s,u)}function ln(){var e=null,n;return it("continue"),c.charCodeAt(p)===59?(Q(),b.inIteration||et({},o.IllegalContinue),g.createContinueStatement(null)):Z()?(b.inIteration||et({},o.IllegalContinue),g.createContinueStatement(null)):(y.type===t.Identifier&&(e=Wt(),n="$"+e.name,Object.prototype.hasOwnProperty.call(b.labelSet,n)||et({},o.UnknownLabel,e.name)),ft(),e===null&&!b.inIteration&&et({},o.IllegalContinue),g.createContinueStatement(e))}function cn(){var e=null,n;return it("break"),c.charCodeAt(p)===59?(Q(),!b.inIteration&&!b.inSwitch&&et({},o.IllegalBreak),g.createBreakStatement(null)):Z()?(!b.inIteration&&!b.inSwitch&&et({},o.IllegalBreak),g.createBreakStatement(null)):(y.type===t.Identifier&&(e=Wt(),n="$"+e.name,Object.prototype.hasOwnProperty.call(b.labelSet,n)||et({},o.UnknownLabel,e.name)),ft(),e===null&&!b.inIteration&&!b.inSwitch&&et({},o.IllegalBreak),g.createBreakStatement(e))}function hn(){var e=null;return it("return"),b.inFunctionBody||tt({},o.IllegalReturn),c.charCodeAt(p)===32&&k(c.charCodeAt(p+1))?(e=qt(),ft(),g.createReturnStatement(e)):Z()?g.createReturnStatement(null):(st(";")||!st("}")&&y.type!==t.EOF&&(e=qt()),ft(),g.createReturnStatement(e))}function pn(){var e,t;return h&&tt({},o.StrictModeWith),it("with"),rt("("),e=qt(),rt(")"),t=wn(),g.createWithStatement(e,t)}function dn(){var e,t=[],n;ot("default")?(Q(),e=null):(it("case"),e=qt()),rt(":");while(p<m){if(st("}")||ot("default")||ot("case"))break;n=Hn();if(typeof n=="undefined")break;t.push(n)}return g.createSwitchCase(e,t)}function vn(){var e,t,n,r,i;it("switch"),rt("("),e=qt(),rt(")"),rt("{"),t=[];if(st("}"))return Q(),g.createSwitchStatement(e,t);r=b.inSwitch,b.inSwitch=!0,i=!1;while(p<m){if(st("}"))break;n=dn(),n.test===null&&(i&&et({},o.MultipleDefaultsInSwitch),i=!0),t.push(n)}return b.inSwitch=r,rt("}"),g.createSwitchStatement(e,t)}function mn(){var e;return it("throw"),Z()&&et({},o.NewlineAfterThrow),e=qt(),ft(),g.createThrowStatement(e)}function gn(){var e,t;return it("catch"),rt("("),st(")")&&nt(y),e=qt(),h&&e.type===i.Identifier&&M(e.name)&&tt({},o.StrictCatchVariable),rt(")"),t=Ut(),g.createCatchClause(e,t)}function yn(){var e,t=[],n=null;return it("try"),e=Ut(),ot("catch")&&t.push(gn()),ot("finally")&&(Q(),n=Ut()),t.length===0&&!n&&et({},o.NoCatchOrFinally),g.createTryStatement(e,[],t,n)}function bn(){return it("debugger"),ft(),g.createDebuggerStatement()}function wn(){var e=y.type,n,r,s;e===t.EOF&&nt(y);if(e===t.Punctuator)switch(y.value){case";":return nn();case"{":return Ut();case"(":return rn();default:}if(e===t.Keyword)switch(y.value){case"break":return cn();case"continue":return ln();case"debugger":return bn();case"do":return on();case"for":return fn();case"function":return Cn();case"class":return Dn();case"if":return sn();case"return":return hn();case"switch":return vn();case"throw":return mn();case"try":return yn();case"var":return Jt();case"while":return un();case"with":return pn();default:}return n=qt(),n.type===i.Identifier&&st(":")?(Q(),s="$"+n.name,Object.prototype.hasOwnProperty.call(b.labelSet,s)&&et({},o.Redeclaration,"Label",n.name),b.labelSet[s]=!0,r=wn(),delete b.labelSet[s],g.createLabeledStatement(n,r)):(ft(),g.createExpressionStatement(n))}function En(){return st("{")?Sn():It()}function Sn(){var e,n=[],r,s,u,a,f,l,d,v;rt("{");while(p<m){if(y.type!==t.StringLiteral)break;r=y,e=Hn(),n.push(e);if(e.expression.type!==i.Literal)break;s=c.slice(r.range[0]+1,r.range[1]-1),s==="use strict"?(h=!0,u&&tt(u,o.StrictOctalLiteral)):!u&&r.octal&&(u=r)}a=b.labelSet,f=b.inIteration,l=b.inSwitch,d=b.inFunctionBody,v=b.parenthesizedCount,b.labelSet={},b.inIteration=!1,b.inSwitch=!1,b.inFunctionBody=!0,b.parenthesizedCount=0;while(p<m){if(st("}"))break;e=Hn();if(typeof e=="undefined")break;n.push(e)}return rt("}"),b.labelSet=a,b.inIteration=f,b.inSwitch=l,b.inFunctionBody=d,b.parenthesizedCount=v,g.createBlockStatement(n)}function xn(e,t,n){var r="$"+n;h?(M(n)&&(e.stricted=t,e.message=o.StrictParamName),Object.prototype.hasOwnProperty.call(e.paramSet,r)&&(e.stricted=t,e.message=o.StrictParamDupe)):e.firstRestricted||(M(n)?(e.firstRestricted=t,e.message=o.StrictParamName):O(n)?(e.firstRestricted=t,e.message=o.StrictReservedWord):Object.prototype.hasOwnProperty.call(e.paramSet,r)&&(e.firstRestricted=t,e.message=o.StrictParamDupe)),e.paramSet[r]=!0}function Tn(e){var t,n,r,i;return t=y,t.value==="..."&&(t=Q(),n=!0),st("[")?(r=ht(),Bt(e,r)):st("{")?(n&&et({},o.ObjectPatternAsRestParameter),r=gt(),Bt(e,r)):(r=n?Wt():Xt(),xn(e,t,t.value),st("=")&&(n&&tt(y,o.DefaultRestParameter),Q(),i=It(),++e.defaultCount)),n?(st(")")||et({},o.ParameterAfterRestParameter),e.rest=r,!1):(e.params.push(r),e.defaults.push(i),!st(")"))}function Nn(e){var t;t={params:[],defaultCount:0,defaults:[],rest:null,firstRestricted:e},rt("(");if(!st(")")){t.paramSet={};while(p<m){if(!Tn(t))break;rt(",")}}return rt(")"),t.defaultCount===0&&(t.defaults=[]),st(":")&&(t.returnTypeAnnotation=zt()),t}function Cn(){var e,t,n,r,i,s,u,a,f;return it("function"),f=!1,st("*")&&(Q(),f=!0),n=y,e=Wt(),h?M(n.value)&&tt(n,o.StrictFunctionName):M(n.value)?(i=n,s=o.StrictFunctionName):O(n.value)&&(i=n,s=o.StrictReservedWord),r=Nn(i),i=r.firstRestricted,r.message&&(s=r.message),u=h,a=b.yieldAllowed,b.yieldAllowed=f,t=Sn(),h&&i&&et(i,s),h&&r.stricted&&tt(r.stricted,s),b.yieldAllowed&&!b.yieldFound&&tt({},o.NoYieldInGenerator),h=u,b.yieldAllowed=a,g.createFunctionDeclaration(e,r.params,r.defaults,t,r.rest,f,!1,r.returnTypeAnnotation)}function kn(){var e,t=null,n,r,i,s,u,a,f;return it("function"),f=!1,st("*")&&(Q(),f=!0),st("(")||(e=y,t=Wt(),h?M(e.value)&&tt(e,o.StrictFunctionName):M(e.value)?(n=e,r=o.StrictFunctionName):O(e.value)&&(n=e,r=o.StrictReservedWord)),i=Nn(n),n=i.firstRestricted,i.message&&(r=i.message),u=h,a=b.yieldAllowed,b.yieldAllowed=f,s=Sn(),h&&n&&et(n,r),h&&i.stricted&&tt(i.stricted,r),b.yieldAllowed&&!b.yieldFound&&tt({},o.NoYieldInGenerator),h=u,b.yieldAllowed=a,g.createFunctionExpression(t,i.params,i.defaults,s,i.rest,f,!1,i.returnTypeAnnotation)}function Ln(){var e,t;return it("yield"),b.yieldAllowed||tt({},o.IllegalYield),e=!1,st("*")&&(Q(),e=!0),t=It(),b.yieldFound=!0,g.createYieldExpression(t,e)}function An(e){var t,n,r,i,s=!1;return y.value==="static"?(i=l["static"],Q()):i=l.prototype,st("*")?(Q(),g.createMethodDefinition(i,"",vt(),dt({generator:!0}))):(t=y,n=vt(),t.value==="get"&&!st("(")?(n=vt(),e[i].hasOwnProperty(n.name)?(s=e[i][n.name].get===undefined&&e[i][n.name].data===undefined&&e[i][n.name].set!==undefined,s||et(n,o.IllegalDuplicateClassProperty)):e[i][n.name]={},e[i][n.name].get=!0,rt("("),rt(")"),g.createMethodDefinition(i,"get",n,pt({generator:!1}))):t.value==="set"&&!st("(")?(n=vt(),e[i].hasOwnProperty(n.name)?(s=e[i][n.name].set===undefined&&e[i][n.name].data===undefined&&e[i][n.name].get!==undefined,s||et(n,o.IllegalDuplicateClassProperty)):e[i][n.name]={},e[i][n.name].set=!0,rt("("),t=y,r=[Xt()],rt(")"),g.createMethodDefinition(i,"set",n,pt({params:r,generator:!1,name:t}))):(e[i].hasOwnProperty(n.name)?et(n,o.IllegalDuplicateClassProperty):e[i][n.name]={},e[i][n.name].data=!0,g.createMethodDefinition(i,"",n,dt({generator:!1}))))}function On(e){if(st(";")){Q();return}return An(e)}function Mn(){var e,t=[],n={};n[l["static"]]={},n[l.prototype]={},rt("{");while(p<m){if(st("}"))break;e=On(n),typeof e!="undefined"&&t.push(e)}return rt("}"),g.createClassBody(t)}function _n(){var e,t,n=null;return it("class"),!ot("extends")&&!st("{")&&(e=Wt()),ot("extends")&&(it("extends"),t=b.yieldAllowed,b.yieldAllowed=!1,n=It(),b.yieldAllowed=t),g.createClassExpression(e,n,Mn())}function Dn(){var e,t,n=null;return it("class"),e=Wt(),ot("extends")&&(it("extends"),t=b.yieldAllowed,b.yieldAllowed=!1,n=It(),b.yieldAllowed=t),g.createClassDeclaration(e,n,Mn())}function Pn(){var e;return ut("module")?(e=Y(),e.type===t.StringLiteral||e.type===t.Identifier):!1}function Hn(){if(y.type===t.Keyword)switch(y.value){case"const":case"let":return Kt(y.value);case"function":return Cn();case"export":return Zt();case"import":return en();default:return wn()}Pn()&&et({},o.NestedModule);if(y.type!==t.EOF)return wn()}function Bn(){if(y.type===t.Keyword)switch(y.value){case"export":return Zt();case"import":return en()}return Pn()?Qt():Hn()}function jn(){var e,n=[],r,s,u;while(p<m){r=y;if(r.type!==t.StringLiteral)break;e=Bn(),n.push(e);if(e.expression.type!==i.Literal)break;s=c.slice(r.range[0]+1,r.range[1]-1),s==="use strict"?(h=!0,u&&tt(u,o.StrictOctalLiteral)):!u&&r.octal&&(u=r)}while(p<m){e=Bn();if(typeof e=="undefined")break;n.push(e)}return n}function Fn(){return Hn()}function In(){var e=[],t;while(p<m){if(st("}"))break;t=Fn();if(typeof t=="undefined")break;e.push(t)}return e}function qn(){var e;return rt("{"),e=In(),rt("}"),g.createBlockStatement(e)}function Rn(){var e;return h=!1,G(),e=jn(),g.createProgram(e)}function Un(e,t,n,r,i){E(typeof n=="number","Comment must have valid position");if(w.comments.length>0&&w.comments[w.comments.length-1].range[1]>n)return;w.comments.push({type:e,value:t,range:[n,r],loc:i})}function zn(){var e,t,n,r,i,s;e="",i=!1,s=!1;while(p<m){t=c[p];if(s)t=c[p++],C(t.charCodeAt(0))?(n.end={line:d,column:p-v-1},s=!1,Un("Line",e,r,p-1,n),t==="\r"&&c[p]==="\n"&&++p,++d,v=p,e=""):p>=m?(s=!1,e+=t,n.end={line:d,column:m-v},Un("Line",e,r,m,n)):e+=t;else if(i)C(t.charCodeAt(0))?(t==="\r"&&c[p+1]==="\n"?(++p,e+="\r\n"):e+=t,++d,++p,v=p,p>=m&&et({},o.UnexpectedToken,"ILLEGAL")):(t=c[p++],p>=m&&et({},o.UnexpectedToken,"ILLEGAL"),e+=t,t==="*"&&(t=c[p],t==="/"&&(e=e.substr(0,e.length-1),i=!1,++p,n.end={line:d,column:p-v},Un("Block",e,r,p,n),e="")));else if(t==="/"){t=c[p+1];if(t==="/")n={start:{line:d,column:p-v}},r=p,p+=2,s=!0,p>=m&&(n.end={line:d,column:p-v},s=!1,Un("Line",e,r,p,n));else{if(t!=="*")break;r=p,p+=2,i=!0,n={start:{line:d,column:p-v-2}},p>=m&&et({},o.UnexpectedToken,"ILLEGAL")}}else if(N(t.charCodeAt(0)))++p;else{if(!C(t.charCodeAt(0)))break;++p,t==="\r"&&c[p]==="\n"&&++p,++d,v=p}}}function Wn(){var e,t,n,r=[];for(e=0;e<w.comments.length;++e)t=w.comments[e],n={type:t.type,value:t.value},w.range&&(n.range=t.range),w.loc&&(n.loc=t.loc),r.push(n);w.comments=r}function Xn(e){return e!==92&&k(e)}function Vn(e){return e!==92&&(e===45||L(e))}function $n(){var e,n,r="",i;n=p;while(p<m){e=c.charCodeAt(p);if(!Vn(e))break;r+=c[p++]}if(e===58){++p,i=r,r="";while(p<m){e=c.charCodeAt(p);if(!Vn(e))break;r+=c[p++]}}return r||et({},o.InvalidXJSTagName),{type:t.XJSIdentifier,value:r,namespace:i,lineNumber:d,lineStart:v,range:[n,p]}}function Jn(){var e,t="",n=0,r;e=c[p],E(e==="&","Entity must start with an ampersand"),p++;while(p<m&&n++<10){e=c[p++];if(e===";")break;t+=e}return t[0]==="#"&&t[1]==="x"?r=String.fromCharCode(parseInt(t.substr(2),16)):t[0]==="#"?r=String.fromCharCode(parseInt(t.substr(1),10)):r=f[t],r}function Kn(e){var n,r="",i;i=p;while(p<m){n=c[p];if(e.indexOf(n)!==-1)break;n==="&"?r+=Jn():(n=c[p++],C(n.charCodeAt(0))&&(++d,v=p),r+=n)}return{type:t.XJSText,value:r,lineNumber:d,lineStart:v,range:[i,p]}}function Qn(){var e,t,n;return t=c[p],E(t==="'"||t==='"',"String literal must starts with a quote"),n=p,++p,e=Kn([t]),t!==c[p]&&et({},o.UnexpectedToken,"ILLEGAL"),++p,e.range=[n,p],e}function Gn(){var e=c.charCodeAt(p);return e!==123&&e!==60?Kn(["<","{"]):I()}function Yn(){var e;return y.type!==t.XJSIdentifier&&nt(y),e=Q(),g.createXJSIdentifier(e.value,e.namespace)}function Zn(){var e;return st("{")?(e=tr(),e.expression.type===i.XJSEmptyExpression&&et(e,"XJS attributes must only be assigned a non-empty expression")):st("<")?e=or():y.type===t.XJSText?e=g.createLiteral(Q()):et({},o.InvalidXJSAttributeValue),e}function er(){while(c.charAt(p)!=="}")p++;return g.createXJSEmptyExpression()}function tr(){var e,t,n;return t=b.inXJSChild,n=b.inXJSTag,b.inXJSChild=!1,b.inXJSTag=!1,rt("{"),st("}")?e=er():e=qt(),b.inXJSChild=t,b.inXJSTag=n,rt("}"),g.createXJSExpressionContainer(e)}function nr(){var e,t,n;return t=Yn(),st("=")?(Q(),g.createXJSAttribute(t,Zn())):g.createXJSAttribute(t)}function rr(){var e;return st("{")?e=tr():y.type===t.XJSText?e=g.createLiteral(Q()):e=or(),e}function ir(){var e,t,n;return t=b.inXJSChild,n=b.inXJSTag,b.inXJSChild=!1,b.inXJSTag=!0,rt("<"),rt("/"),e=Yn(),b.inXJSChild=t,b.inXJSTag=n,rt(">"),g.createXJSClosingElement(e)}function sr(){var e,t,n=[],r=!1,i,s;i=b.inXJSChild,s=b.inXJSTag,b.inXJSChild=!1,b.inXJSTag=!0,rt("<"),e=Yn();while(p<m&&y.value!=="/"&&y.value!==">")n.push(nr());return b.inXJSTag=s,y.value==="/"?(rt("/"),b.inXJSChild=i,rt(">"),r=!0):(b.inXJSChild=!0,rt(">")),g.createXJSOpeningElement(e,n,r)}function or(){var e,t,n=[],r,i;r=b.inXJSChild,i=b.inXJSTag,e=sr();if(!e.selfClosing){while(p<m){b.inXJSChild=!1;if(y.value==="<"&&Y().value==="/")break;b.inXJSChild=!0,G(),n.push(rr())}b.inXJSChild=r,b.inXJSTag=i,t=ir(),(t.name.namespace!==e.name.namespace||t.name.name!==e.name.name)&&et({},o.ExpectedXJSClosingTag,e.name.namespace?e.name.namespace+":"+e.name.name:e.name.name)}return g.createXJSElement(e,t,n)}function ur(){var e,r,i,s,o;return D(),e=p,r={start:{line:d,column:p-v}},i=w.advance(),r.end={line:d,column:p-v},i.type!==t.EOF&&(s=[i.range[0],i.range[1]],o=c.slice(i.range[0],i.range[1]),w.tokens.push({type:n[i.type],value:o,range:s,loc:r})),i}function ar(){var e,t,n,r;return D(),e=p,t={start:{line:d,column:p-v}},n=w.scanRegExp(),t.end={line:d,column:p-v},w.tokenize||(w.tokens.length>0&&(r=w.tokens[w.tokens.length-1],r.range[0]===e&&r.type==="Punctuator"&&(r.value==="/"||r.value==="/=")&&w.tokens.pop()),w.tokens.push({type:"RegularExpression",value:n.literal,range:[e,p],loc:t})),n}function fr(){var e,t,n,r=[];for(e=0;e<w.tokens.length;++e)t=w.tokens[e],n={type:t.type,value:t.value},w.range&&(n.range=t.range),w.loc&&(n.loc=t.loc),r.push(n);w.tokens=r}function lr(){this.range=[p,p],this.loc={start:{line:d,column:p-v},end:{line:d,column:p-v}}}function cr(){return new lr}function hr(){var e,t;return D(),e=cr(),rt("("),++b.parenthesizedCount,t=qt(),rt(")"),e.end(),e.applyGroup(t),t}function pr(){var e,n;D(),e=cr(),n=ot("new")?kt():Et();while(st(".")||st("[")||y.type===t.Template)st("[")?(n=g.createMemberExpression("[",n,Ct()),e.end(),e.apply(n)):st(".")?(n=g.createMemberExpression(".",n,Nt()),e.end(),e.apply(n)):(n=g.createTaggedTemplateExpression(n,bt()),e.end(),e.apply(n));return n}function dr(){var e,n,r;D(),e=cr(),n=ot("new")?kt():Et();while(st(".")||st("[")||st("(")||y.type===t.Template)st("(")?(r=St(),n=g.createCallExpression(n,r),e.end(),e.apply(n)):st("[")?(n=g.createMemberExpression("[",n,Ct()),e.end(),e.apply(n)):st(".")?(n=g.createMemberExpression(".",n,Nt()),e.end(),e.apply(n)):(n=g.createTaggedTemplateExpression(n,bt()),e.end(),e.apply(n));return n}function vr(e){var t,n,r;t=Object.prototype.toString.apply(e)==="[object Array]"?[]:{};for(n in e)e.hasOwnProperty(n)&&n!=="groupRange"&&n!=="groupLoc"&&(r=e[n],r===null||typeof r!="object"||r instanceof RegExp?t[n]=r:t[n]=vr(r));return t}function mr(e,t,n){return function(r){function s(e){return e.type===i.LogicalExpression||e.type===i.BinaryExpression}function o(n){var r,i;s(n.left)&&o(n.left),s(n.right)&&o(n.right),e&&(n.left.groupRange||n.right.groupRange?(r=n.left.groupRange?n.left.groupRange[0]:n.left.range[0],i=n.right.groupRange?n.right.groupRange[1]:n.right.range[1],n.range=[r,i]):typeof n.range=="undefined"&&(r=n.left.range[0],i=n.right.range[1],n.range=[r,i])),t&&(n.left.groupLoc||n.right.groupLoc?(r=n.left.groupLoc?n.left.groupLoc.start:n.left.loc.start,i=n.right.groupLoc?n.right.groupLoc.end:n.right.loc.end,n.loc={start:r,end:i},n=g.postProcess(n)):typeof n.loc=="undefined"&&(n.loc={start:n.left.loc.start,end:n.right.loc.end},n=g.postProcess(n)))}return function(){var i,u;return n||D(),i=cr(),u=r.apply(null,arguments),i.end(),e&&typeof u.range=="undefined"&&i.apply(u),t&&typeof u.loc=="undefined"&&i.apply(u),s(u)&&o(u),u}}}function gr(){var e,t;w.comments&&(w.skipComment=D,D=zn);if(w.range||w.loc)w.parseGroupExpression=wt,w.parseLeftHandSideExpression=At,w.parseLeftHandSideExpressionAllowCall=Lt,wt=hr,At=pr,Lt=dr,e=mr(w.range,w.loc),t=mr(w.range,w.loc,!0),w.parseArrayInitialiser=ht,w.parseAssignmentExpression=It,w.parseBinaryExpression=Dt,w.parseBlock=Ut,w.parseFunctionSourceElements=Sn,w.parseCatchClause=gn,w.parseComputedMember=Ct,w.parseConditionalExpression=Pt,w.parseConstLetDeclaration=Kt,w.parseExportBatchSpecifier=Gt,w.parseExportDeclaration=Zt,w.parseExportSpecifier=Yt,w.parseExpression=qt,w.parseForVariableDeclaration=an,w.parseFunctionDeclaration=Cn,w.parseFunctionExpression=kn,w.parseParams=Nn,w.parseImportDeclaration=en,w.parseImportSpecifier=tn,w.parseModuleDeclaration=Qt,w.parseModuleBlock=qn,w.parseNewExpression=kt,w.parseNonComputedProperty=Tt,w.parseObjectInitialiser=gt,w.parseObjectProperty=mt,w.parseObjectPropertyKey=vt,w.parsePostfixExpression=Ot,w.parsePrimaryExpression=Et,w.parseProgram=Rn,w.parsePropertyFunction=pt,w.parseSpreadOrAssignmentExpression=xt,w.parseTemplateElement=yt,w.parseTemplateLiteral=bt,w.parseTypeAnnotatableIdentifier=Xt,w.parseTypeAnnotation=zt,w.parseStatement=wn,w.parseSwitchCase=dn,w.parseUnaryExpression=Mt,w.parseVariableDeclaration=Vt,w.parseVariableIdentifier=Wt,w.parseMethodDefinition=An,w.parseClassDeclaration=Dn,w.parseClassExpression=_n,w.parseClassBody=Mn,w.parseXJSIdentifier=Yn,w.parseXJSChild=rr,w.parseXJSAttribute=nr,w.parseXJSAttributeValue=Zn,w.parseXJSExpressionContainer=tr,w.parseXJSEmptyExpression=er,w.parseXJSElement=or,w.parseXJSClosingElement=ir,w.parseXJSOpeningElement=sr,ht=e(w.parseArrayInitialiser),It=e(w.parseAssignmentExpression),Dt=e(w.parseBinaryExpression),Ut=e(w.parseBlock),Sn=e(w.parseFunctionSourceElements),gn=e(w.parseCatchClause),Ct=e(w.parseComputedMember),Pt=e(w.parseConditionalExpression),Kt=e(w.parseConstLetDeclaration),Gt=e(Gt),Zt=e(Zt),Yt=e(Yt),qt=e(w.parseExpression),an=e(w.parseForVariableDeclaration),Cn=e(w.parseFunctionDeclaration),kn=e(w.parseFunctionExpression),Nn=e(w.parseParams),en=e(w.parseImportDeclaration),tn=e(w.parseImportSpecifier),Qt=e(w.parseModuleDeclaration),qn=e(w.parseModuleBlock),At=e(At),kt=e(w.parseNewExpression),Tt=e(w.parseNonComputedProperty),gt=e(w.parseObjectInitialiser),mt=e(w.parseObjectProperty),vt=e(w.parseObjectPropertyKey),Ot=e(w.parsePostfixExpression),Et=e(w.parsePrimaryExpression),Rn=e(w.parseProgram),pt=e(w.parsePropertyFunction),yt=e(w.parseTemplateElement),bt=e(w.parseTemplateLiteral),Xt=e(w.parseTypeAnnotatableIdentifier),zt=e(w.parseTypeAnnotation),xt=e(w.parseSpreadOrAssignmentExpression),wn=e(w.parseStatement),dn=e(w.parseSwitchCase),Mt=e(w.parseUnaryExpression),Vt=e(w.parseVariableDeclaration),Wt=e(w.parseVariableIdentifier),An=e(w.parseMethodDefinition),Dn=e(w.parseClassDeclaration),_n=e(w.parseClassExpression),Mn=e(w.parseClassBody),Yn=e(w.parseXJSIdentifier),rr=t(w.parseXJSChild),nr=e(w.parseXJSAttribute),Zn=e(w.parseXJSAttributeValue),tr=e(w.parseXJSExpressionContainer),er=t(w.parseXJSEmptyExpression),or=e(w.parseXJSElement),ir=e(w.parseXJSClosingElement),sr=e(w.parseXJSOpeningElement);typeof w.tokens!="undefined"&&(w.advance=K,w.scanRegExp=V,K=ur,V=ar)}function yr(){typeof w.skipComment=="function"&&(D=w.skipComment);if(w.range||w.loc)ht=w.parseArrayInitialiser,It=w.parseAssignmentExpression,Dt=w.parseBinaryExpression,Ut=w.parseBlock,Sn=w.parseFunctionSourceElements,gn=w.parseCatchClause,Ct=w.parseComputedMember,Pt=w.parseConditionalExpression,Kt=w.parseConstLetDeclaration,Gt=w.parseExportBatchSpecifier,Zt=w.parseExportDeclaration,Yt=w.parseExportSpecifier,qt=w.parseExpression,an=w.parseForVariableDeclaration,Cn=w.parseFunctionDeclaration,kn=w.parseFunctionExpression,en=w.parseImportDeclaration,tn=w.parseImportSpecifier,wt=w.parseGroupExpression,At=w.parseLeftHandSideExpression,Lt=w.parseLeftHandSideExpressionAllowCall,Qt=w.parseModuleDeclaration,qn=w.parseModuleBlock,kt=w.parseNewExpression,Tt=w.parseNonComputedProperty,gt=w.parseObjectInitialiser,mt=w.parseObjectProperty,vt=w.parseObjectPropertyKey,Ot=w.parsePostfixExpression,Et=w.parsePrimaryExpression,Rn=w.parseProgram,pt=w.parsePropertyFunction,yt=w.parseTemplateElement,bt=w.parseTemplateLiteral,Xt=w.parseTypeAnnotatableIdentifier,zt=w.parseTypeAnnotation,xt=w.parseSpreadOrAssignmentExpression,wn=w.parseStatement,dn=w.parseSwitchCase,Mt=w.parseUnaryExpression,Vt=w.parseVariableDeclaration,Wt=w.parseVariableIdentifier,An=w.parseMethodDefinition,Dn=w.parseClassDeclaration,_n=w.parseClassExpression,Mn=w.parseClassBody,Yn=w.parseXJSIdentifier,rr=w.parseXJSChild,nr=w.parseXJSAttribute,Zn=w.parseXJSAttributeValue,tr=w.parseXJSExpressionContainer,er=w.parseXJSEmptyExpression,or=w.parseXJSElement,ir=w.parseXJSClosingElement,sr=w.parseXJSOpeningElement;typeof w.scanRegExp=="function"&&(K=w.advance,V=w.scanRegExp)}function br(e,t){var n,r={};for(n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);for(n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r}function wr(e,n){var r,i,s;r=String,typeof e!="string"&&!(e instanceof String)&&(e=r(e)),g=a,c=e,p=0,d=c.length>0?1:0,v=0,m=c.length,y=null,b={allowKeyword:!0,allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1},w={},n=n||{},n.tokens=!0,w.tokens=[],w.tokenize=!0,w.openParenToken=-1,w.openCurlyToken=-1,w.range=typeof n.range=="boolean"&&n.range,w.loc=typeof n.loc=="boolean"&&n.loc,typeof n.comment=="boolean"&&n.comment&&(w.comments=[]),typeof n.tolerant=="boolean"&&n.tolerant&&(w.errors=[]),m>0&&typeof c[0]=="undefined"&&e instanceof String&&(c=e.valueOf()),gr();try{G();if(y.type===t.EOF)return w.tokens;i=Q();while(y.type!==t.EOF)try{i=Q()}catch(o){i=y;if(w.errors){w.errors.push(o);break}throw o}fr(),s=w.tokens,typeof w.comments!="undefined"&&(Wn(),s.comments=w.comments),typeof w.errors!="undefined"&&(s.errors=w.errors)}catch(u){throw u}finally{yr(),w={}}return s}function Er(e,t){var n,r;r=String,typeof e!="string"&&!(e instanceof String)&&(e=r(e)),g=a,c=e,p=0,d=c.length>0?1:0,v=0,m=c.length,y=null,b={allowKeyword:!1,allowIn:!0,labelSet:{},parenthesizedCount:0,inFunctionBody:!1,inIteration:!1,inSwitch:!1,inXJSChild:!1,inXJSTag:!1,yieldAllowed:!1,yieldFound:!1},w={},typeof t!="undefined"&&(w.range=typeof t.range=="boolean"&&t.range,w.loc=typeof t.loc=="boolean"&&t.loc,w.loc&&t.source!==null&&t.source!==undefined&&(g=br(g,{postProcess:function(e){return e.loc.source=r(t.source),e}})),typeof t.tokens=="boolean"&&t.tokens&&(w.tokens=[]),typeof t.comment=="boolean"&&t.comment&&(w.comments=[]),typeof t.tolerant=="boolean"&&t.tolerant&&(w.errors=[])),m>0&&typeof c[0]=="undefined"&&e instanceof String&&(c=e.valueOf()),gr();try{n=Rn(),typeof w.comments!="undefined"&&(Wn(),n.comments=w.comments),typeof w.tokens!="undefined"&&(fr(),n.tokens=w.tokens),typeof w.errors!="undefined"&&(n.errors=w.errors);if(w.range||w.loc)n.body=vr(n.body)}catch(i){throw i}finally{yr(),w={}}return n}var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;t={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9,Template:10,XJSIdentifier:11,XJSText:12},n={},n[t.BooleanLiteral]="Boolean",n[t.EOF]="<end>",n[t.Identifier]="Identifier",n[t.Keyword]="Keyword",n[t.NullLiteral]="Null",n[t.NumericLiteral]="Numeric",n[t.Punctuator]="Punctuator",n[t.StringLiteral]="String",n[t.XJSIdentifier]="XJSIdentifier",n[t.XJSText]="XJSText",n[t.RegularExpression]="RegularExpression",r=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],i={ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AssignmentExpression:"AssignmentExpression",BinaryExpression:"BinaryExpression",BlockStatement:"BlockStatement",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ClassHeritage:"ClassHeritage",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportDeclaration:"ExportDeclaration",ExportBatchSpecifier:"ExportBatchSpecifier",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",ForStatement:"ForStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportSpecifier:"ImportSpecifier",LabeledStatement:"LabeledStatement",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MethodDefinition:"MethodDefinition",ModuleDeclaration:"ModuleDeclaration",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",TypeAnnotatedIdentifier:"TypeAnnotatedIdentifier",TypeAnnotation:"TypeAnnotation",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",XJSIdentifier:"XJSIdentifier",XJSEmptyExpression:"XJSEmptyExpression",XJSExpressionContainer:"XJSExpressionContainer",XJSElement:"XJSElement",XJSClosingElement:"XJSClosingElement",XJSOpeningElement:"XJSOpeningElement",XJSAttribute:"XJSAttribute",XJSText:"XJSText",YieldExpression:"YieldExpression"},s={Data:1,Get:2,Set:4},l={"static":"static",prototype:"prototype"},o={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInFormalsList:"Invalid left-hand side in formals list",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalDuplicateClassProperty:"Illegal duplicate property in class definition",IllegalReturn:"Illegal return statement",IllegalYield:"Illegal yield expression",IllegalSpread:"Illegal spread element",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",ParameterAfterRestParameter:"Rest parameter must be final parameter of an argument list",DefaultRestParameter:"Rest parameter can not have a default value",ElementAfterSpreadElement:"Spread must be the final element of an element list",ObjectPatternAsRestParameter:"Invalid rest parameter",ObjectPatternAsSpread:"Invalid spread argument",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",NewlineAfterModule:"Illegal newline after module",NoFromAfterImport:"Missing from after import",InvalidModuleSpecifier:"Invalid module specifier",NestedModule:"Module declaration can not be nested",NoYieldInGenerator:"Missing yield in generator",NoUnintializedConst:"Const must be initialized",ComprehensionRequiresBlock:"Comprehension must have at least one block",ComprehensionError:"Comprehension Error",EachNotAllowed:"Each is not supported",InvalidXJSTagName:"XJS tag name can not be empty",InvalidXJSAttributeValue:"XJS value should be either an expression or a quoted XJS text",ExpectedXJSClosingTag:"Expected corresponding XJS closing tag for %0"},u={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԧԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠࢢ-ࢬࣤ-ࣾऀ-ॣ०-९ॱ-ॷॹ-ॿঁ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఁ-ఃఅ-ఌఎ-ఐఒ-నప-ళవ-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಂಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲംഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤜᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶᴀ-ᷦ᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚗꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺꩻꪀ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︦︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]")},a={name:"SyntaxTree",postProcess:function(e){return e},createArrayExpression:function(e){return{type:i.ArrayExpression,elements:e}},createAssignmentExpression:function(e,t,n){return{type:i.AssignmentExpression,operator:e,left:t,right:n}},createBinaryExpression:function(e,t,n){var r=e==="||"||e==="&&"?i.LogicalExpression:i.BinaryExpression;return{type:r,operator:e,left:t,right:n}},createBlockStatement:function(e){return{type:i.BlockStatement,body:e}},createBreakStatement:function(e){return{type:i.BreakStatement,label:e}},createCallExpression:function(e,t){return{type:i.CallExpression,callee:e,arguments:t}},createCatchClause:function(e,t){return{type:i.CatchClause,param:e,body:t}},createConditionalExpression:function(e,t,n){return{type:i.ConditionalExpression,test:e,consequent:t,alternate:n}},createContinueStatement:function(e){return{type:i.ContinueStatement,label:e}},createDebuggerStatement:function(){return{type:i.DebuggerStatement}},createDoWhileStatement:function(e,t){return{type:i.DoWhileStatement,body:e,test:t}},createEmptyStatement:function(){return{type:i.EmptyStatement}},createExpressionStatement:function(e){return{type:i.ExpressionStatement,expression:e}},createForStatement:function(e,t,n,r){return{type:i.ForStatement,init:e,test:t,update:n,body:r}},createForInStatement:function(e,t,n){return{type:i.ForInStatement,left:e,right:t,body:n,each:!1}},createForOfStatement:function(e,t,n){return{type:i.ForOfStatement,left:e,right:t,body:n}},createFunctionDeclaration:function(e,t,n,r,s,o,u,a){return{type:i.FunctionDeclaration,id:e,params:t,defaults:n,body:r,rest:s,generator:o,expression:u,returnType:a}},createFunctionExpression:function(e,t,n,r,s,o,u,a){return{type:i.FunctionExpression,id:e,params:t,defaults:n,body:r,rest:s,generator:o,expression:u,returnType:a}},createIdentifier:function(e){return{type:i.Identifier,name:e,typeAnnotation:undefined}},createTypeAnnotation:function(e,t,n,r){return{type:i.TypeAnnotation,id:e,paramTypes:t,returnType:n,nullable:r}},createTypeAnnotatedIdentifier:function(e,t){return{type:i.TypeAnnotatedIdentifier,id:e,annotation:t}},createXJSAttribute:function(e,t){return{type:i.XJSAttribute,name:e,value:t}},createXJSIdentifier:function(e,t){return{type:i.XJSIdentifier,name:e,namespace:t}},createXJSElement:function(e,t,n){return{type:i.XJSElement,openingElement:e,closingElement:t,children:n}},createXJSEmptyExpression:function(){return{type:i.XJSEmptyExpression}},createXJSExpressionContainer:function(e){return{type:i.XJSExpressionContainer,expression:e}},createXJSOpeningElement:function(e,t,n){return{type:i.XJSOpeningElement,name:e,selfClosing:n,attributes:t}},createXJSClosingElement:function(e){return{type:i.XJSClosingElement,name:e}},createIfStatement:function(e,t,n){return{type:i.IfStatement,test:e,consequent:t,alternate:n}},createLabeledStatement:function(e,t){return{type:i.LabeledStatement,label:e,body:t}},createLiteral:function(e){return{type:i.Literal,value:e.value,raw:c.slice(e.range[0],e.range[1])}},createMemberExpression:function(e,t,n){return{type:i.MemberExpression,computed:e==="[",object:t,property:n}},createNewExpression:function(e,t){return{type:i.NewExpression,callee:e,arguments:t}},createObjectExpression:function(e){return{type:i.ObjectExpression,properties:e}},createPostfixExpression:function(e,t){return{type:i.UpdateExpression,operator:e,argument:t,prefix:!1}},createProgram:function(e){return{type:i.Program,body:e}},createProperty:function(e,t,n,r,s){return{type:i.Property,key:t,value:n,kind:e,method:r,shorthand:s}},createReturnStatement:function(e){return{type:i.ReturnStatement,argument:e}},createSequenceExpression:function(e){return{type:i.SequenceExpression,expressions:e}},createSwitchCase:function(e,t){return{type:i.SwitchCase,test:e,consequent:t}},createSwitchStatement:function(e,t){return{type:i.SwitchStatement,discriminant:e,cases:t}},createThisExpression:function(){return{type:i.ThisExpression}},createThrowStatement:function(e){return{type:i.ThrowStatement,argument:e}},createTryStatement:function(e,t,n,r){return{type:i.TryStatement,block:e,guardedHandlers:t,handlers:n,finalizer:r}},createUnaryExpression:function(e,t){return e==="++"||e==="--"?{type:i.UpdateExpression,operator:e,argument:t,prefix:!0}:{type:i.UnaryExpression,operator:e,argument:t}},createVariableDeclaration:function(e,t){return{type:i.VariableDeclaration,declarations:e,kind:t}},createVariableDeclarator:function(e,t){return{type:i.VariableDeclarator,id:e,init:t}},createWhileStatement:function(e,t){return{type:i.WhileStatement,test:e,body:t}},createWithStatement:function(e,t){return{type:i.WithStatement,object:e,body:t}},createTemplateElement:function(e,t){return{type:i.TemplateElement,value:e,tail:t}},createTemplateLiteral:function(e,t){return{type:i.TemplateLiteral,quasis:e,expressions:t}},createSpreadElement:function(e){return{type:i.SpreadElement,argument:e}},createTaggedTemplateExpression:function(e,t){return{type:i.TaggedTemplateExpression,tag:e,quasi:t}},createArrowFunctionExpression:function(e,t,n,r,s){return{type:i.ArrowFunctionExpression,id:null,params:e,defaults:t,body:n,rest:r,generator:!1,expression:s}},createMethodDefinition:function(e,t,n,r){return{type:i.MethodDefinition,key:n,value:r,kind:t,"static":e===l["static"]}},createClassBody:function(e){return{type:i.ClassBody,body:e}},createClassExpression:function(e,t,n){return{type:i.ClassExpression,id:e,superClass:t,body:n}},createClassDeclaration:function(e,t,n){return{type:i.ClassDeclaration,id:e,superClass:t,body:n}},createExportSpecifier:function(e,t){return{type:i.ExportSpecifier,id:e,name:t}},createExportBatchSpecifier:function(){return{type:i.ExportBatchSpecifier}},createExportDeclaration:function(e,t,n){return{type:i.ExportDeclaration,declaration:e,specifiers:t,source:n}},createImportSpecifier:function(e,t){return{type:i.ImportSpecifier,id:e,name:t}},createImportDeclaration:function(e,t,n){return{type:i.ImportDeclaration,specifiers:e,kind:t,source:n}},createYieldExpression:function(e,t){return{type:i.YieldExpression,argument:e,delegate:t}},createModuleDeclaration:function(e,t,n){return{type:i.ModuleDeclaration,id:e,source:t,body:n}}},f={quot:'"',amp:"&",apos:"'",lt:"<",gt:">",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",frasl:"⁄",euro:"€",image:"ℑ",weierp:"℘",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪","int":"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",lang:"〈",rang:"〉",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"},lr.prototype={constructor:lr,end:function(){this.range[1]=p,this.loc.end.line=d,this.loc.end.column=p-v},applyGroup:function(e){w.range&&(e.groupRange=[this.range[0],this.range[1]]),w.loc&&(e.groupLoc={start:{line:this.loc.start.line,column:this.loc.start.column},end:{line:this.loc.end.line,column:this.loc.end.column}},e=g.postProcess(e))},apply:function(e){var t=typeof e;E(t==="object","Applying location marker to an unexpected node type: "+t),w.range&&(e.range=[this.range[0],this.range[1]]),w.loc&&(e.loc={start:{line:this.loc.start.line,column:this.loc.start.column},end:{line:this.loc.end.line,column:this.loc.end.column}},e=g.postProcess(e))}},e.version="1.1.0-dev-harmony",e.tokenize=wr,e.parse=Er,e.Syntax=function(){var e,t={};typeof Object.create=="function"&&(t=Object.create(null));for(e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return typeof Object.freeze=="function"&&Object.freeze(t),t}()})},{}],7:[function(e,t,n){var r=function(e){return e.chars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],e.encode=function(e){if(e===0)return"0";var t="";while(e>0)t=this.chars[e%62]+t,e=Math.floor(e/62);return t},e.decode=function(e,t,n,r){for(t=n=(e===(/\W|_|^$/.test(e+="")||e))-1;r=e.charCodeAt(n++);)t=t*62+r-[,48,29,87][r>>5];return t},e}({});t.exports=r},{}],8:[function(e,t,n){n.SourceMapGenerator=e("./source-map/source-map-generator").SourceMapGenerator,n.SourceMapConsumer=e("./source-map/source-map-consumer").SourceMapConsumer,n.SourceNode=e("./source-map/source-node").SourceNode},{"./source-map/source-map-consumer":13,"./source-map/source-map-generator":14,"./source-map/source-node":15}],9:[function(e,t,n){define(function(e,t,n){function i(){this._array=[],this._set={}}var r=e("./util");i.fromArray=function(t,n){var r=new i;for(var s=0,o=t.length;s<o;s++)r.add(t[s],n);return r},i.prototype.add=function(t,n){var i=this.has(t),s=this._array.length;(!i||n)&&this._array.push(t),i||(this._set[r.toSetString(t)]=s)},i.prototype.has=function(t){return Object.prototype.hasOwnProperty.call(this._set,r.toSetString(t))},i.prototype.indexOf=function(t){if(this.has(t))return this._set[r.toSetString(t)];throw new Error('"'+t+'" is not in the set.')},i.prototype.at=function(t){if(t>=0&&t<this._array.length)return this._array[t];throw new Error("No element indexed by "+t)},i.prototype.toArray=function(){return this._array.slice()},t.ArraySet=i})},{"./util":16,amdefine:17}],10:[function(e,t,n){define(function(e,t,n){function a(e){return e<0?(-e<<1)+1:(e<<1)+0}function f(e){var t=(e&1)===1,n=e>>1;return t?-n:n}var r=e("./base64"),i=5,s=1<<i,o=s-1,u=s;t.encode=function(t){var n="",s,f=a(t);do s=f&o,f>>>=i,f>0&&(s|=u),n+=r.encode(s);while(f>0);return n},t.decode=function(t){var n=0,s=t.length,a=0,l=0,c,h;do{if(n>=s)throw new Error("Expected more digits in base 64 VLQ value.");h=r.decode(t.charAt(n++)),c=!!(h&u),h&=o,a+=h<<l,l+=i}while(c);return{value:f(a),rest:t.slice(n)}}})},{"./base64":11,amdefine:17}],11:[function(e,t,n){define(function(e,t,n){var r={},i={};"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("").forEach(function(e,t){r[e]=t,i[t]=e}),t.encode=function(t){if(t in i)return i[t];throw new TypeError("Must be between 0 and 63: "+t)},t.decode=function(t){if(t in r)return r[t];throw new TypeError("Not a valid base 64 digit: "+t)}})},{amdefine:17}],12:[function(e,t,n){define(function(e,t,n){function r(e,t,n,i,s){var o=Math.floor((t-e)/2)+e,u=s(n,i[o],!0);return u===0?i[o]:u>0?t-o>1?r(o,t,n,i,s):i[o]:o-e>1?r(e,o,n,i,s):e<0?null:i[e]}t.search=function(t,n,i){return n.length>0?r(-1,n.length,t,n,i):null}})},{amdefine:17}],13:[function(e,t,n){define(function(e,t,n){function u(e){var t=e;typeof e=="string"&&(t=JSON.parse(e.replace(/^\)\]\}'/,"")));var n=r.getArg(t,"version"),i=r.getArg(t,"sources"),o=r.getArg(t,"names",[]),u=r.getArg(t,"sourceRoot",null),a=r.getArg(t,"sourcesContent",null),f=r.getArg(t,"mappings"),l=r.getArg(t,"file",null);if(n!=this._version)throw new Error("Unsupported version: "+n);this._names=s.fromArray(o,!0),this._sources=s.fromArray(i,!0),this.sourceRoot=u,this.sourcesContent=a,this._mappings=f,this.file=l}var r=e("./util"),i=e("./binary-search"),s=e("./array-set").ArraySet,o=e("./base64-vlq");u.fromSourceMap=function(t){var n=Object.create(u.prototype);return n._names=s.fromArray(t._names.toArray(),!0),n._sources=s.fromArray(t._sources.toArray(),!0),n.sourceRoot=t._sourceRoot,n.sourcesContent=t._generateSourcesContent(n._sources.toArray(),n.sourceRoot),n.file=t._file,n.__generatedMappings=t._mappings.slice().sort(r.compareByGeneratedPositions),n.__originalMappings=t._mappings.slice().sort(r.compareByOriginalPositions),n},u.prototype._version=3,Object.defineProperty(u.prototype,"sources",{get:function(){return this._sources.toArray().map(function(e){return this.sourceRoot?r.join(this.sourceRoot,e):e},this)}}),u.prototype.__generatedMappings=null,Object.defineProperty(u.prototype,"_generatedMappings",{get:function(){return this.__generatedMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__generatedMappings}}),u.prototype.__originalMappings=null,Object.defineProperty(u.prototype,"_originalMappings",{get:function(){return this.__originalMappings||(this.__generatedMappings=[],this.__originalMappings=[],this._parseMappings(this._mappings,this.sourceRoot)),this.__originalMappings}}),u.prototype._parseMappings=function(t,n){var i=1,s=0,u=0,a=0,f=0,l=0,c=/^[,;]/,h=t,p,d;while(h.length>0)if(h.charAt(0)===";")i++,h=h.slice(1),s=0;else if(h.charAt(0)===",")h=h.slice(1);else{p={},p.generatedLine=i,d=o.decode(h),p.generatedColumn=s+d.value,s=p.generatedColumn,h=d.rest;if(h.length>0&&!c.test(h.charAt(0))){d=o.decode(h),p.source=this._sources.at(f+d.value),f+=d.value,h=d.rest;if(h.length===0||c.test(h.charAt(0)))throw new Error("Found a source, but no line and column");d=o.decode(h),p.originalLine=u+d.value,u=p.originalLine,p.originalLine+=1,h=d.rest;if(h.length===0||c.test(h.charAt(0)))throw new Error("Found a source and line, but no column");d=o.decode(h),p.originalColumn=a+d.value,a=p.originalColumn,h=d.rest,h.length>0&&!c.test(h.charAt(0))&&(d=o.decode(h),p.name=this._names.at(l+d.value),l+=d.value,h=d.rest)}this.__generatedMappings.push(p),typeof p.originalLine=="number"&&this.__originalMappings.push(p)}this.__originalMappings.sort(r.compareByOriginalPositions)},u.prototype._findMapping=function(t,n,r,s,o){if(t[r]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+t[r]);if(t[s]<0)throw new TypeError("Column must be greater than or equal to 0, got "+t[s]);return i.search(t,n,o)},u.prototype.originalPositionFor=function(t){var n={generatedLine:r.getArg(t,"line"),generatedColumn:r.getArg(t,"column")},i=this._findMapping(n,this._generatedMappings,"generatedLine","generatedColumn",r.compareByGeneratedPositions);if(i){var s=r.getArg(i,"source",null);return s&&this.sourceRoot&&(s=r.join(this.sourceRoot,s)),{source:s,line:r.getArg(i,"originalLine",null),column:r.getArg(i,"originalColumn",null),name:r.getArg(i,"name",null)}}return{source:null,line:null,column:null,name:null}},u.prototype.sourceContentFor=function(t){if(!this.sourcesContent)return null;this.sourceRoot&&(t=r.relative(this.sourceRoot,t));if(this._sources.has(t))return this.sourcesContent[this._sources.indexOf(t)];var n;if(this.sourceRoot&&(n=r.urlParse(this.sourceRoot))){var i=t.replace(/^file:\/\//,"");if(n.scheme=="file"&&this._sources.has(i))return this.sourcesContent[this._sources.indexOf(i)];if((!n.path||n.path=="/")&&this._sources.has("/"+t))return this.sourcesContent[this._sources.indexOf("/"+t)]}throw new Error('"'+t+'" is not in the SourceMap.')},u.prototype.generatedPositionFor=function(t){var n={source:r.getArg(t,"source"),originalLine:r.getArg(t,"line"),originalColumn:r.getArg(t,"column")};this.sourceRoot&&(n.source=r.relative(this.sourceRoot,n.source));var i=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",r.compareByOriginalPositions);return i?{line:r.getArg(i,"generatedLine",null),column:r.getArg(i,"generatedColumn",null)}:{line:null,column:null}},u.GENERATED_ORDER=1,u.ORIGINAL_ORDER=2,u.prototype.eachMapping=function(t,n,i){var s=n||null,o=i||u.GENERATED_ORDER,a;switch(o){case u.GENERATED_ORDER:a=this._generatedMappings;break;case u.ORIGINAL_ORDER:a=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var f=this.sourceRoot;a.map(function(e){var t=e.source;return t&&f&&(t=r.join(f,t)),{source:t,generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:e.name}}).forEach(t,s)},t.SourceMapConsumer=u})},{"./array-set":9,"./base64-vlq":10,"./binary-search":12,"./util":16,amdefine:17}],14:[function(e,t,n){define(function(e,t,n){function o(e){this._file=i.getArg(e,"file"),this._sourceRoot=i.getArg(e,"sourceRoot",null),this._sources=new s,this._names=new s,this._mappings=[],this._sourcesContents=null}var r=e("./base64-vlq"),i=e("./util"),s=e("./array-set").ArraySet;o.prototype._version=3,o.fromSourceMap=function(t){var n=t.sourceRoot,r=new o({file:t.file,sourceRoot:n});return t.eachMapping(function(e){var t={generated:{line:e.generatedLine,column:e.generatedColumn}};e.source&&(t.source=e.source,n&&(t.source=i.relative(n,t.source)),t.original={line:e.originalLine,column:e.originalColumn},e.name&&(t.name=e.name)),r.addMapping(t)}),t.sources.forEach(function(e){var n=t.sourceContentFor(e);n&&r.setSourceContent(e,n)}),r},o.prototype.addMapping=function(t){var n=i.getArg(t,"generated"),r=i.getArg(t,"original",null),s=i.getArg(t,"source",null),o=i.getArg(t,"name",null);this._validateMapping(n,r,s,o),s&&!this._sources.has(s)&&this._sources.add(s),o&&!this._names.has(o)&&this._names.add(o),this._mappings.push({generatedLine:n.line,generatedColumn:n.column,originalLine:r!=null&&r.line,originalColumn:r!=null&&r.column,source:s,name:o})},o.prototype.setSourceContent=function(t,n){var r=t;this._sourceRoot&&(r=i.relative(this._sourceRoot,r)),n!==null?(this._sourcesContents||(this._sourcesContents={}),this._sourcesContents[i.toSetString(r)]=n):(delete this._sourcesContents[i.toSetString(r)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},o.prototype.applySourceMap=function(t,n){n||(n=t.file);var r=this._sourceRoot;r&&(n=i.relative(r,n));var o=new s,u=new s;this._mappings.forEach(function(e){if(e.source===n&&e.originalLine){var s=t.originalPositionFor({line:e.originalLine,column:e.originalColumn});s.source!==null&&(r?e.source=i.relative(r,s.source):e.source=s.source,e.originalLine=s.line,e.originalColumn=s.column,s.name!==null&&e.name!==null&&(e.name=s.name))}var a=e.source;a&&!o.has(a)&&o.add(a);var f=e.name;f&&!u.has(f)&&u.add(f)},this),this._sources=o,this._names=u,t.sources.forEach(function(e){var n=t.sourceContentFor(e);n&&(r&&(e=i.relative(r,e)),this.setSourceContent(e,n))},this)},o.prototype._validateMapping=function(t,n,r,i){if(t&&"line"in t&&"column"in t&&t.line>0&&t.column>=0&&!n&&!r&&!i)return;if(t&&"line"in t&&"column"in t&&n&&"line"in n&&"column"in n&&t.line>0&&t.column>=0&&n.line>0&&n.column>=0&&r)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:t,source:r,orginal:n,name:i}))},o.prototype._serializeMappings=function(){var t=0,n=1,s=0,o=0,u=0,a=0,f="",l;this._mappings.sort(i.compareByGeneratedPositions);for(var c=0,h=this._mappings.length;c<h;c++){l=this._mappings[c];if(l.generatedLine!==n){t=0;while(l.generatedLine!==n)f+=";",n++}else if(c>0){if(!i.compareByGeneratedPositions(l,this._mappings[c-1]))continue;f+=","}f+=r.encode(l.generatedColumn-t),t=l.generatedColumn,l.source&&(f+=r.encode(this._sources.indexOf(l.source)-a),a=this._sources.indexOf(l.source),f+=r.encode(l.originalLine-1-o),o=l.originalLine-1,f+=r.encode(l.originalColumn-s),s=l.originalColumn,l.name&&(f+=r.encode(this._names.indexOf(l.name)-u),u=this._names.indexOf(l.name)))}return f},o.prototype._generateSourcesContent=function(t,n){return t.map(function(e){if(!this._sourcesContents)return null;n&&(e=i.relative(n,e));var t=i.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,t)?this._sourcesContents[t]:null},this)},o.prototype.toJSON=function(){var t={version:this._version,file:this._file,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._sourceRoot&&(t.sourceRoot=this._sourceRoot),this._sourcesContents&&(t.sourcesContent=this._generateSourcesContent(t.sources,t.sourceRoot)),t},o.prototype.toString=function(){return JSON.stringify(this)},t.SourceMapGenerator=o})},{"./array-set":9,"./base64-vlq":10,"./util":16,amdefine:17}],15:[function(e,t,n){define(function(e,t,n){function s(e,t,n,r,i){this.children=[],this.sourceContents={},this.line=e===undefined?null:e,this.column=t===undefined?null:t,this.source=n===undefined?null:n,this.name=i===undefined?null:i,r!=null&&this.add(r)}var r=e("./source-map-generator").SourceMapGenerator,i=e("./util");s.fromStringWithSourceMap=function(t,n){function f(e,t){e===null||e.source===undefined?r.add(t):r.add(new s(e.originalLine,e.originalColumn,e.source,t,e.name))}var r=new s,i=t.split("\n"),o=1,u=0,a=null;return n.eachMapping(function(e){if(a===null){while(o<e.generatedLine)r.add(i.shift()+"\n"),o++;if(u<e.generatedColumn){var t=i[0];r.add(t.substr(0,e.generatedColumn)),i[0]=t.substr(e.generatedColumn),u=e.generatedColumn}}else if(o<e.generatedLine){var n="";do n+=i.shift()+"\n",o++,u=0;while(o<e.generatedLine);if(u<e.generatedColumn){var t=i[0];n+=t.substr(0,e.generatedColumn),i[0]=t.substr(e.generatedColumn),u=e.generatedColumn}f(a,n)}else{var t=i[0],n=t.substr(0,e.generatedColumn-u);i[0]=t.substr(e.generatedColumn-u),u=e.generatedColumn,f(a,n)}a=e},this),f(a,i.join("\n")),n.sources.forEach(function(e){var t=n.sourceContentFor(e);t&&r.setSourceContent(e,t)}),r},s.prototype.add=function(t){if(Array.isArray(t))t.forEach(function(e){this.add(e)},this);else{if(!(t instanceof s||typeof t=="string"))throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);t&&this.children.push(t)}return this},s.prototype.prepend=function(t){if(Array.isArray(t))for(var n=t.length-1;n>=0;n--)this.prepend(t[n]);else{if(!(t instanceof s||typeof t=="string"))throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);this.children.unshift(t)}return this},s.prototype.walk=function(t){var n;for(var r=0,i=this.children.length;r<i;r++)n=this.children[r],n instanceof s?n.walk(t):n!==""&&t(n,{source:this.source,line:this.line,column:this.column,name:this.name})},s.prototype.join=function(t){var n,r,i=this.children.length;if(i>0){n=[];for(r=0;r<i-1;r++)n.push(this.children[r]),n.push(t);n.push(this.children[r]),this.children=n}return this},s.prototype.replaceRight=function(t,n){var r=this.children[this.children.length-1];return r instanceof s?r.replaceRight(t,n):typeof r=="string"?this.children[this.children.length-1]=r.replace(t,n):this.children.push("".replace(t,n)),this},s.prototype.setSourceContent=function(t,n){this.sourceContents[i.toSetString(t)]=n},s.prototype.walkSourceContents=function(t){for(var n=0,r=this.children.length;n<r;n++)this.children[n]instanceof s&&this.children[n].walkSourceContents(t);var o=Object.keys(this.sourceContents);for(var n=0,r=o.length;n<r;n++)t(i.fromSetString(o[n]),this.sourceContents[o[n]])},s.prototype.toString=function(){var t="";return this.walk(function(e){t+=e}),t},s.prototype.toStringWithSourceMap=function(t){var n={code:"",line:1,column:0},i=new r(t),s=!1,o=null,u=null,a=null,f=null;return this.walk(function(e,t){n.code+=e,t.source!==null&&t.line!==null&&t.column!==null?((o!==t.source||u!==t.line||a!==t.column||f!==t.name)&&i.addMapping({source:t.source,original:{line:t.line,column:t.column},generated:{line:n.line,column:n.column},name:t.name}),o=t.source,u=t.line,a=t.column,f=t.name,s=!0):s&&(i.addMapping({generated:{line:n.line,column:n.column}}),o=null,s=!1),e.split("").forEach(function(e){e==="\n"?(n.line++,n.column=0):n.column++})}),this.walkSourceContents(function(e,t){i.setSourceContent(e,t)}),{code:n.code,map:i}},t.SourceNode=s})},{"./source-map-generator":14,"./util":16,amdefine:17}],16:[function(e,t,n){define(function(e,t,n){function r(e,t,n){if(t in e)return e[t];if(arguments.length===3)return n;throw new Error('"'+t+'" is a required argument.')}function o(e){var t=e.match(i);return t?{scheme:t[1],auth:t[3],host:t[4],port:t[6],path:t[7]}:null}function u(e){var t=e.scheme+"://";return e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function a(e,t){var n;return t.match(i)||t.match(s)?t:t.charAt(0)==="/"&&(n=o(e))?(n.path=t,u(n)):e.replace(/\/$/,"")+"/"+t}function f(e){return"$"+e}function l(e){return e.substr(1)}function c(e,t){e=e.replace(/\/$/,"");var n=o(e);return t.charAt(0)=="/"&&n&&n.path=="/"?t.slice(1):t.indexOf(e+"/")===0?t.substr(e.length+1):t}function h(e,t){var n=e||"",r=t||"";return(n>r)-(n<r)}function p(e,t,n){var r;return r=h(e.source,t.source),r?r:(r=e.originalLine-t.originalLine,r?r:(r=e.originalColumn-t.originalColumn,r||n?r:(r=h(e.name,t.name),r?r:(r=e.generatedLine-t.generatedLine,r?r:e.generatedColumn-t.generatedColumn))))}function d(e,t,n){var r;return r=e.generatedLine-t.generatedLine,r?r:(r=e.generatedColumn-t.generatedColumn,r||n?r:(r=h(e.source,t.source),r?r:(r=e.originalLine-t.originalLine,r?r:(r=e.originalColumn-t.originalColumn,r?r:h(e.name,t.name)))))}t.getArg=r;var i=/([\w+\-.]+):\/\/((\w+:\w+)@)?([\w.]+)?(:(\d+))?(\S+)?/,s=/^data:.+\,.+/;t.urlParse=o,t.urlGenerate=u,t.join=a,t.toSetString=f,t.fromSetString=l,t.relative=c,t.compareByOriginalPositions=p,t.compareByGeneratedPositions=d})},{amdefine:17}],17:[function(e,t,n){(function(n,r){function i(t,i){function c(e){var t,n;for(t=0;e[t];t+=1){n=e[t];if(n===".")e.splice(t,1),t-=1;else if(n===".."){if(t===1&&(e[2]===".."||e[0]===".."))break;t>0&&(e.splice(t-1,2),t-=2)}}}function h(e,t){var n;return e&&e.charAt(0)==="."&&t&&(n=t.split("/"),n=n.slice(0,n.length-1),n=n.concat(e.split("/")),c(n),e=n.join("/")),e}function p(e){return function(t){return h(t,e)}}function d(e){function t(t){o[e]=t}return t.fromText=function(e,t){throw new Error("amdefine does not implement load.fromText")},t}function v(e,n,s){var a,l,c,h;if(e)l=o[e]={},c={id:e,uri:r,exports:l},a=f(i,l,c,e);else{if(u)throw new Error("amdefine with no module ID cannot be called more than once per file.");u=!0,l=t.exports,c=t,a=f(i,l,c,t.id)}n&&(n=n.map(function(e){return a(e)})),typeof s=="function"?h=s.apply(c.exports,n):h=s,h!==undefined&&(c.exports=h,e&&(o[e]=c.exports))}function m(e,t,n){Array.isArray(e)?(n=t,t=e,e=undefined):typeof e!="string"&&(n=e,e=t=undefined),t&&!Array.isArray(t)&&(n=t,t=undefined),t||(t=["require","exports","module"]),e?s[e]=[e,t,n]:v(e,t,n)}var s={},o={},u=!1,a=e("path"),f,l;return f=function(e,t,r,i){function s(s,o){if(typeof s=="string")return l(e,t,r,s,i);s=s.map(function(n){return l(e,t,r,n,i)}),n.nextTick(function(){o.apply(null,s)})}return s.toUrl=function(e){return e.indexOf(".")===0?h(e,a.dirname(r.filename)):e},s},i=i||function(){return t.require.apply(t,arguments)},l=function(e,t,n,r,i){var u=r.indexOf("!"),a=r,c,m;if(u===-1){r=h(r,i);if(r==="require")return f(e,t,n,i);if(r==="exports")return t;if(r==="module")return n;if(o.hasOwnProperty(r))return o[r];if(s[r])return v.apply(null,s[r]),o[r];if(e)return e(a);throw new Error("No module with ID: "+r)}return c=r.substring(0,u),r=r.substring(u+1,r.length),m=l(e,t,n,c,i),m.normalize?r=m.normalize(r,p(i)):r=h(r,i),o[r]?o[r]:(m.load(r,f(e,t,n,i),d(r),{}),o[r])},m.require=function(e){if(o[e])return o[e];if(s[e])return v.apply(null,s[e]),o[e]},m.amd={},m}t.exports=i}).call(this,e("/Users/poshannessy/FB/code/react/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),"/../node_modules/jstransform/node_modules/source-map/node_modules/amdefine/amdefine.js")},{"/Users/poshannessy/FB/code/react/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,path:5}],18:[function(e,t,n){function s(e){var t=e.match(r);return t?t[0].replace(i,"")||"":""}function h(e){e=e.replace(o,"").replace(u,"").replace(a," ").replace(f,"$1");var t="";while(t!=e)t=e,e=e.replace(l,"\n$1 $2\n");e=e.trim();var n=[],r;while(r=c.exec(e))n.push([r[1],r[2]]);return n}function p(e){var t=h(e),n={};for(var r=0;r<t.length;r++)n[t[r][0]]=t[r][1];return n}var r=/^\s*(\/\*\*(.|\r?\n)*?\*\/)/,i=/^\s*/,o=/^\/\*\*?/,u=/\*+\/$/,a=/[\t ]+/g,f=/(\r?\n|^) *\*/g,l=/(?:^|\r?\n) *(@[^\r\n]*?) *\r?\n *([^@\r\n\s][^@\r\n]+?) *\r?\n/g,c=/(?:^|\r?\n) *@(\S+) *([^\r\n]*)/g;n.extract=s,n.parse=h,n.parseAsObject=p},{}],19:[function(e,t,n){function o(e,t){if(e.type===s.Program)return!0;var n=t.type===s.FunctionDeclaration||t.type===s.FunctionExpression;return e.type===s.BlockStatement&&n}function u(e,t){return e.type===s.Program?!1:e.type===s.BlockStatement&&t.type===s.CatchClause}function a(e,t,n){function v(e,t,n){e.range&&i.catchup(e.range[0],n),a(e,t,n),e.range&&i.catchup(e.range[1],n)}var r=t[0];if(!Array.isArray(e)&&n.localScope.parentNode!==r){if(o(e,r)){var c=n.scopeIsStrict||e.body.length>0&&e.body[0].type===s.ExpressionStatement&&e.body[0].expression.type===s.Literal&&e.body[0].expression.value==="use strict";if(e.type===s.Program)n=i.updateState(n,{scopeIsStrict:c});else{n=i.updateState(n,{localScope:{parentNode:r,parentScope:n.localScope,identifiers:{}},scopeIsStrict:c}),n.localScope.identifiers.arguments=!0;if(r.params.length>0){var h;for(var d=0;d<r.params.length;d++)h=r.params[d],h.type===s.Identifier&&(n.localScope.identifiers[h.name]=!0)}r.type===s.FunctionExpression&&r.id&&(n.localScope.identifiers[r.id.name]=!0)}f(e,t,n)}u(e,r)&&(n=i.updateState(n,{localScope:{parentNode:r,parentScope:n.localScope,identifiers:{}}}),r.type===s.CatchClause&&(n.localScope.identifiers[r.param.name]=!0),l(e,t,n))}i.analyzeAndTraverse(p,v,e,t,n)}function f(e,t,n){i.analyzeAndTraverse(c,f,e,t,n)}function l(e,t,n){i.analyzeAndTraverse(h,l,e,t,n)}function c(e,t,n){var r=n.localScope.identifiers;switch(e.type){case s.FunctionExpression:return!1;case s.ClassDeclaration:case s.ClassExpression:case s.FunctionDeclaration:return e.id&&(r[e.id.name]=!0),!1;case s.VariableDeclarator:t[0].kind==="var"&&(r[e.id.name]=!0)}}function h(e,t,n){if(e.type===s.CatchClause)return!1}function p(e,t,n){var r=n.g.visitors;for(var i=0;i<r.length;i++)if(r[i].test(e,t,n))return r[i](a,e,t,n)}function d(t,n,s){s=s||{};var o;try{o=r.parse(n,{comment:!0,loc:!0,range:!0})}catch(u){throw u.message="Parse Error: "+u.message,u}var f=i.createState(n,o,s);f.g.visitors=t;if(s.sourceMap){var l=e("source-map").SourceMapGenerator;f.g.sourceMap=new l({file:"transformed.js"})}a(o,[],f),i.catchup(n.length,f);var c={code:f.g.buffer};return s.sourceMap&&(c.sourceMap=f.g.sourceMap,c.sourceMapFilename=s.filename||"source.js"),c}var r=e("esprima-fb"),i=e("./utils"),s=r.Syntax;n.transform=d},{"./utils":20,"esprima-fb":6,"source-map":8}],20:[function(e,t,n){function r(e,t,n){return{localScope:{parentNode:t,parentScope:null,identifiers:{}},superClass:null,mungeNamespace:"",methodFuncNode:null,className:null,scopeIsStrict:null,g:{opts:n,position:0,buffer:"",indentBy:0,source:e,docblock:null,tagNamespaceUsed:!1,isBolt:undefined,sourceMap:null,sourceMapFilename:"source.js",sourceLine:1,bufferLine:1,originalProgramAST:null,sourceColumn:0,bufferColumn:0}}}function i(e,t){var n=Object.create(e);return Object.keys(t).forEach(function(e){n[e]=t[e]}),n}function s(e,t,n){if(e<t.g.position)return;var r=t.g.source.substring(t.g.position,e),i=d(r,t);if(t.g.sourceMap&&i){t.g.sourceMap.addMapping({generated:{line:t.g.bufferLine,column:t.g.bufferColumn},original:{line:t.g.sourceLine,column:t.g.sourceColumn},source:t.g.sourceMapFilename});var s=r.split("\n"),o=i.split("\n");for(var u=1;u<s.length-1;u++)t.g.sourceMap.addMapping({generated:{line:t.g.bufferLine,column:0},original:{line:t.g.sourceLine,column:0},source:t.g.sourceMapFilename}),t.g.sourceLine++,t.g.bufferLine++;s.length>1&&(t.g.sourceLine++,t.g.bufferLine++,t.g.sourceColumn=0,t.g.bufferColumn=0),t.g.sourceColumn+=s[s.length-1].length,t.g.bufferColumn+=o[o.length-1].length}t.g.buffer+=n?n(i):i,t.g.position=e}function u(e){return e.replace(o,function(){return""})}function a(e,t){s(e,t,u)}function l(e){return e.replace(f,function(){return""})}function c(e,t){s(e,t,l)}function h(e,t){if(t.g.sourceMap){e<t.g.position&&(t.g.position=0,t.g.sourceLine=1,t.g.sourceColumn=0);var n=t.g.source.substring(t.g.position,e),r=n.split("\n");r.length>1&&(t.g.sourceLine+=r.length-1,t.g.sourceColumn=0),t.g.sourceColumn+=r[r.length-1].length}t.g.position=e}function p(e,t){if(t.g.sourceMap&&e){t.g.sourceMap.addMapping({generated:{line:t.g.bufferLine,column:t.g.bufferColumn},original:{line:t.g.sourceLine,column:t.g.sourceColumn},source:t.g.sourceMapFilename});var n=e.split("\n");n.length>1&&(t.g.bufferLine+=n.length-1,t.g.bufferColumn=0),t.g.bufferColumn+=n[n.length-1].length}t.g.buffer+=e}function d(e,t){for(var n=0;n<-t.g.indentBy;n++)e=e.replace(/(^|\n)( {2}|\t)/g,"$1");return e}function v(e,t){var n=e;e-=1;while(e>0&&t.g.source[e]!="\n")t.g.source[e].match(/[ \t]/)||(n=e),e--;return t.g.source.substring(e+1,n)}function m(t){if(!t.g.docblock){var n=e("./docblock");t.g.docblock=n.parseAsObject(n.extract(t.g.source))}return t.g.docblock}function g(e,t,n){var r=t.localScope;while(r){if(r.identifiers[e]!==undefined)return!0;if(n&&r.parentNode===n)break;r=r.parentScope}return!1}function y(e,t){return t.localScope.identifiers[e]!==undefined}function b(e,t){t.localScope.identifiers[e]=!0}function w(e,t,n,r,i){var s,o;if(n.type){if(e(n,r,i)===!1)return;r.unshift(n)}for(s in n){if(s==="range"||s==="loc")continue;n.hasOwnProperty(s)&&(o=n[s],typeof o=="object"&&o!==null&&t(o,r,i))}n.type&&r.shift()}function E(e,t){function r(e){if(e.type===t)return n=!0,!1}function i(e,r,i){n||(n=E(e,t))}var n=!1;return w(r,i,e,[]),n}var o=/(\S)/g,f=/[^\n]/g;n.append=p,n.catchup=s,n.catchupWhiteSpace=a,n.catchupNewlines=c,n.containsChildOfType=E,n.createState=r,n.declareIdentInLocalScope=b,n.getDocblock=m,n.identWithinLexicalScope=g,n.identInLocalScope=y,n.indentBefore=v,n.move=h,n.updateIndent=d,n.updateState=i,n.analyzeAndTraverse=w},{"./docblock":18}],21:[function(e,t,n){function o(e,t,n,r){s.append("function",r),u(t,r),s.catchupWhiteSpace(t.body.range[0],r);var o=t.body.type==i.BlockStatement?l:f;return n.unshift(t),o(e,t,n,r),n.shift(),s.containsChildOfType(t.body,i.ThisExpression)&&s.append(".bind(this)",r),!1}function u(e,t){(a(e,t)||!e.params.length)&&s.append("(",t),e.params.length!==0&&s.catchup(e.params[e.params.length-1].range[1],t),s.append(")",t)}function a(e,t){return e.params.length===1&&t.g.source[t.g.position]!=="("}function f(e,t,n,i){s.append("{",i),t.rest&&s.append(r.renderRestParamSetup(t),i),s.append("return ",i),l(e,t,n,i),s.append(";}",i)}function l(e,t,n,r){e(t.body,n,r),s.catchup(t.body.range[1],r)}var r=e("./es6-rest-param-visitors"),i=e("esprima-fb").Syntax,s=e("../src/utils");o.test=function(e,t,n){return e.type===i.ArrowFunctionExpression},n.visitorList=[o]},{"../src/utils":20,"./es6-rest-param-visitors":24,"esprima-fb":6}],22:[function(e,t,n){function f(e){var t=e.mungeNamespace||"";return"____Class"+t+r.encode(u++)}function l(e,t){var n=t.mungeNamespace,i=t.g.opts.minify;if(i){a[n]||(a[n]={symbolMap:{},identUUIDCounter:0});var s=a[n].symbolMap;s[e]||(s[e]=r.encode(a[n].identUUIDCounter++)),e=s[e]}return"$"+n+e}function c(e,t){var n={name:null,expression:null};return e.superClass&&(e.superClass.type===i.Identifier?n.name=e.superClass.name:(n.name=f(t),n.expression=t.g.source.substring(e.superClass.range[0],e.superClass.range[1]))),n}function h(e){return e.type===i.MethodDefinition&&e.key.type===i.Identifier&&e.key.name==="constructor"}function p(e,t){return!!t.methodFuncNode&&!s.getDocblock(t).hasOwnProperty("preventMunge")&&/^_(?!_)/.test(e.name)}function d(e,t,n,r){return s.catchup(t.range[0],r),n.unshift(t),e(t.value,n,r),n.shift(),!1}function v(e,t,n,r){var i=n[0];r=s.updateState(r,{methodFuncNode:t});if(i.key.name==="constructor")s.append("function "+r.className,r);else{var o=i.key.name;p(i.key,r)&&(o=l(o,r));var u=i["static"]?"":"prototype.";s.append(r.className+"."+u+o+"=function",r)}s.move(i.key.range[1],r);var a=t.params,f;if(a.length>0)for(var c=0;c<a.length;c++)s.catchup(t.params[c].range[0],r),f=a[c].name,p(a[c],r)&&(f=l(a[c].name,r)),s.append(f,r),s.move(a[c].range[1],r);else s.append("(",r);return s.append(")",r),s.catchupWhiteSpace(t.body.range[0],r),s.append("{",r),r.scopeIsStrict||s.append('"use strict";',r),s.move(t.body.range[0]+"{".length,r),n.unshift(t),e(t.body,n,r),n.shift(),s.catchup(t.body.range[1],r),i.key.name!=="constructor"&&s.append(";",r),!1}function m(e,t,n,r){var i=r.className,u=r.superClass;if(u.name){u.expression!==null&&s.append("var "+u.name+"="+u.expression+";",r);var a=u.name+"____Key",f="";s.identWithinLexicalScope(a,r)||(f="var ",s.declareIdentInLocalScope(a,r)),s.append("for("+f+a+" in "+u.name+"){"+"if("+u.name+".hasOwnProperty("+a+")){"+i+"["+a+"]="+u.name+"["+a+"];"+"}"+"}",r);var l=o+u.name;s.identWithinLexicalScope(l,r)||(s.append("var "+l+"="+u.name+"===null?"+"null:"+u.name+".prototype;",r),s.declareIdentInLocalScope(l,r)),s.append(i+".prototype=Object.create("+l+");",r),s.append(i+".prototype.constructor="+i+";",r),s.append(i+".__superConstructor__="+u.name+";",r)}t.body.body.filter(h).pop()||(s.append("function "+i+"(){",r),r.scopeIsStrict||s.append('"use strict";',r),u.name&&s.append("if("+u.name+"!==null){"+u.name+".apply(this,arguments);}",r),s.append("}",r)),s.move(t.body.range[0]+"{".length,r),e(t.body,n,r),s.catchupWhiteSpace(t.range[1],r)}function g(e,t,n,r){var i=t.id.name,o=c(t,r);return r=s.updateState(r,{mungeNamespace:i,className:i,superClass:o}),m(e,t,n,r),!1}function y(e,t,n,r){var i=t.id&&t.id.name||f(r),o=c(t,r);return s.append("(function(){",r),r=s.updateState(r,{mungeNamespace:i,className:i,superClass:o}),m(e,t,n,r),s.append("return "+i+";})()",r),!1}function b(e,t,n,r){s.append(l(t.name,r),r),s.move(t.range[1],r)}function w(e,t,n,r){var u=r.superClass.name;return t.callee.type===i.Identifier?(s.append(u+".call(",r),s.move(t.callee.range[1],r)):t.callee.type===i.MemberExpression&&(s.append(o+u,r),s.move(t.callee.object.range[1],r),t.callee.computed?s.catchup(t.callee.property.range[1]+"]".length,r):s.append("."+t.callee.property.name,r),s.append(".call(",r),s.move(t.callee.range[1],r)),s.append("this",r),t.arguments.length>0&&(s.append(",",r),s.catchupWhiteSpace(t.arguments[0].range[0],r),e(t.arguments,n,r)),s.catchupWhiteSpace(t.range[1],r),s.append(")",r),!1}function E(e,t,n,r){var i=r.superClass.name;s.append(o+i,r),s.move(t.object.range[1],r)}var r=e("base62"),i=e("esprima-fb").Syntax,s=e("../src/utils"),o="____SuperProtoOf",u=0,a={};d.test=function(e,t,n){return e.type===i.MethodDefinition},v.test=function(e,t,n){return e.type===i.FunctionExpression&&t[0].type===i.MethodDefinition},g.test=function(e,t,n){return e.type===i.ClassDeclaration},y.test=function(e,t,n){return e.type===i.ClassExpression},b.test=function(e,t,n){if(e.type===i.Identifier&&p(e,n)){if(t[0].type===i.MemberExpression&&t[0].object!==e&&t[0].computed===!1)return!0;if(s.identWithinLexicalScope(e.name,n,n.methodFuncNode))return!0;if(t[0].type===i.Property&&t[1].type===i.ObjectExpression)return!0;if(t[0].type===i.FunctionExpression||t[0].type===i.FunctionDeclaration)for(var r=0;r<t[0].params.length;r++)if(t[0].params[r]===e)return!0}return!1},w.test=function(e,t,n){if(n.superClass&&e.type===i.CallExpression){var r=e.callee;if(r.type===i.Identifier&&r.name==="super"||r.type==i.MemberExpression&&r.object.name==="super")return!0}return!1},E.test=function(e,t,n){return n.superClass&&e.type===i.MemberExpression&&e.object.type===i.Identifier&&e.object.name==="super"},n.visitorList=[g,y,v,d,b,w,E]},{"../src/utils":20,base62:7,"esprima-fb":6}],23:[function(e,t,n){function s(e,t,n,r){return i.catchup(t.key.range[1],r),i.append(":"+t.key.name,r),!1}var r=e("esprima-fb").Syntax,i=e("../src/utils");s.test=function(e,t,n){return e.type===r.Property&&e.kind==="init"&&e.shorthand===!0},n.visitorList=[s]},{"../src/utils":20,"esprima-fb":6}],24:[function(e,t,n){function s(e){return(e.type===r.FunctionDeclaration||e.type===r.FunctionExpression||e.type===r.ArrowFunctionExpression)&&e.rest}function o(e,t,n,r){t.params.length?i.catchup(t.params[t.params.length-1].range[1],r):i.catchup(t.rest.range[0]-3,r),i.catchupWhiteSpace(t.rest.range[1],r)}function u(e){return"var "+e.rest.name+"=Array.prototype.slice.call("+"arguments,"+e.params.length+");"}function a(e,t,n,r){i.catchup(t.range[0]+1,r);var s=n[0];return i.append(u(s),r),e(t.body,n,r),!1}var r=e("esprima-fb").Syntax,i=e("../src/utils");o.test=function(e,t,n){return s(e)},a.test=function(e,t,n){return e.type===r.BlockStatement&&s(t[0])},n.renderRestParamSetup=u,n.visitorList=[o,a]},{"../src/utils":20,"esprima-fb":6}],25:[function(e,t,n){function s(e,t,n,s){var o=t.quasis;i.append("(",s);for(var a=0;a<o.length;a++){var f=o[a];f.value.raw!==""&&(i.append(u(f),s),f.tail||i.append(" + ",s),i.move(f.range[0],s),i.catchupNewlines(f.range[1],s)),i.move(f.range[1],s);if(!f.tail){var l=t.expressions[a];l.type===r.Identifier||l.type===r.MemberExpression||l.type===r.CallExpression?i.catchup(l.range[1],s):(i.append("(",s),e(l,n,s),i.catchup(l.range[1],s),i.append(")",s)),o[a+1].value.cooked!==""&&i.append(" + ",s)}}return i.move(t.range[1],s),i.append(")",s),!1}function o(e,t,n,r){var s=t.quasi,o=s.quasis.length;i.move(t.tag.range[0],r),e(t.tag,n,r),i.catchup(t.tag.range[1],r),i.append("(function() { var siteObj = [",r);for(var f=0;f<o;f++)i.append(u(s.quasis[f]),r),f!==o-1&&i.append(", ",r);i.append("]; siteObj.raw = [",r);for(f=0;f<o;f++)i.append(a(s.quasis[f]),r),f!==o-1&&i.append(", ",r);i.append("]; Object.freeze(siteObj.raw); Object.freeze(siteObj); return siteObj; }()",r);if(o>1)for(f=0;f<s.expressions.length;f++){var l=s.expressions[f];i.append(", ",r),i.move(s.quasis[f].range[0],r),i.catchupNewlines(s.quasis[f].range[1],r),i.move(l.range[0],r),e(l,n,r),i.catchup(l.range[1],r)}return i.catchupNewlines(t.range[1],r),i.append(")",r),!1}function u(e){return JSON.stringify(e.value.cooked)}function a(e){return JSON.stringify(e.value.raw)}var r=e("esprima-fb").Syntax,i=e("../src/utils");s.test=function(e,t,n){return e.type===r.TemplateLiteral},o.test=function(e,t,n){return e.type===r.TaggedTemplateExpression},n.visitorList=[s,o]},{"../src/utils":20,"esprima-fb":6}],26:[function(_dereq_,module,exports){function transformReact(e){return transform(visitors.react,e,{sourceMap:!1})}var runScripts,headEl,buffer=_dereq_("buffer"),transform=_dereq_("jstransform").transform,visitors=_dereq_("./fbtransform/visitors").transformVisitors,docblock=_dereq_("jstransform/src/docblock"),supportsAccessors=Object.prototype.hasOwnProperty("__defineGetter__");exports.transform=transformReact,exports.exec=function(code){return eval(transformReact(code).code)};var inlineScriptCount=0,createSourceCodeErrorMessage=function(e,t){var n=e.split("\n"),r=n[t.lineNumber-1],i=0;r=r.replace(/^\s+/,function(e){return i=e.length,""});var s=30,o=t.column-i;o>s&&(r="... "+r.slice(o-s),o=4+s),r.length-o>s&&(r=r.slice(0,o+s)+" ...");var u="\n\n"+r+"\n";return u+=(new Array(o-1)).join(" ")+"^",u},transformCode=function(e,t){var n=docblock.parseAsObject(docblock.extract(e)).jsx;if(n){try{var r=transformReact(e)}catch(i){throw i.message+="\n    at ",t?("fileName"in i&&(i.fileName=t),i.message+=t+":"+i.lineNumber+":"+i.column):i.message+=location.href,i.message+=createSourceCodeErrorMessage(e,i),i}if(!r.sourceMap)return r.code;var s=r.sourceMap.toJSON();return t==null&&(t="Inline JSX script",inlineScriptCount++,inlineScriptCount>1&&(t+=" ("+inlineScriptCount+")")),s.sources=[t],s.sourcesContent=[e],r.code+"//## sourceMappingURL=data:application/json;base64,"+buffer.Buffer(JSON.stringify(s)).toString("base64")}return e},run=exports.run=function(e,t){var n=document.createElement("script");n.text=transformCode(e,t),headEl.appendChild(n)},load=exports.load=function(e,t){var n;return n=window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest,n.open("GET",e,!1),"overrideMimeType"in n&&n.overrideMimeType("text/plain"),n.onreadystatechange=function(){if(n.readyState===4){if(n.status!==0&&n.status!==200)throw new Error("Could not load "+e);run(n.responseText,e);if(t)return t()}},n.send(null)};runScripts=function(){var e=document.getElementsByTagName("script"),t=[];for(var n=0;n<e.length;n++)e.item(n).type==="text/jsx"&&t.push(e.item(n));console.warn("You are using the in-browser JSX transformer. Be sure to precompile your JSX for production - http://facebook.github.io/react/docs/tooling-integration.html#jsx"),t.forEach(function(e){e.src?load(e.src):run(e.innerHTML,null)})},typeof window!="undefined"&&window!==null&&(headEl=document.getElementsByTagName("head")[0],window.addEventListener?window.addEventListener("DOMContentLoaded",runScripts,!1):window.attachEvent("onload",runScripts))},{"./fbtransform/visitors":30,buffer:1,jstransform:19,"jstransform/src/docblock":18}],27:[function(e,t,n){function l(e,t,n,l){var c=i.getDocblock(l).jsx,h=t.openingElement,p=h.name,d=h.attributes;i.catchup(h.range[0],l);if(p.namespace)throw new Error("Namespace tags are not supported. ReactJSX is not XML.");var v=s.hasOwnProperty(p.name);i.append((v?c+".":"")+p.name+"(",l),i.move(p.range[1],l),d.length===0&&i.append("null",l),d.forEach(function(t,s){i.catchup(t.range[0],l);if(t.name.namespace)throw new Error("Namespace attributes are not supported. ReactJSX is not XML.");var c=t.name.name,h=s===0,p=s===d.length-1;h&&i.append("{",l),i.append(a(c),l),i.append(":",l),t.value?(i.move(t.name.range[1],l),i.catchupWhiteSpace(t.value.range[0],l),f.hasOwnProperty(t.name.name)?(i.append(f[t.name.name](t),l),i.move(t.value.range[1],l),p||i.append(",",l)):t.value.type===r.Literal?u(t.value,p,l):o(e,t.value,p,n,l)):(l.g.buffer+="true",l.g.position=t.name.range[1],p||i.append(",",l)),p&&i.append("}",l),i.catchup(t.range[1],l)}),h.selfClosing||(i.catchup(h.range[1]-1,l),i.move(h.range[1],l));var m=t.children.filter(function(e){return e.type!==r.Literal||typeof e.value!="string"||!e.value.match(/^[ \t]*[\r\n][ \t\r\n]*$/)});if(m.length>0){var g;m.forEach(function(e,t){if(e.type!==r.XJSExpressionContainer||e.expression.type!==r.XJSEmptyExpression)g=t}),g!==undefined&&i.append(", ",l),m.forEach(function(t,s){i.catchup(t.range[0],l);var a=s>=g;t.type===r.Literal?u(t,a,l):t.type===r.XJSExpressionContainer?o(e,t,a,n,l):(e(t,n,l),a||(i.append(",",l),l.g.buffer=l.g.buffer.replace(/(\s*),$/,",$1"))),i.catchup(t.range[1],l)})}return h.selfClosing?(i.catchup(h.range[1]-2,l),i.move(h.range[1],l)):(i.catchup(t.closingElement.range[0],l),i.move(t.closingElement.range[1],l)),i.append(")",l),!1}var r=e("esprima-fb").Syntax,i=e("jstransform/src/utils"),s=e("./xjs").knownTags,o=e("./xjs").renderXJSExpressionContainer,u=e("./xjs").renderXJSLiteral,a=e("./xjs").quoteAttrName,f={cxName:function(e){throw new Error("cxName is no longer supported, use className={cx(...)} instead")}};l.test=function(e,t,n){var s=i.getDocblock(n).jsx;return e.type===r.XJSElement&&s&&s.length},n.visitorList=[l]},{"./xjs":29,"esprima-fb":6,"jstransform/src/utils":20}],28:[function(e,t,n){function s(e,t,n){if(t&&t.type===r.CallExpression&&t.callee.type===r.MemberExpression&&t.callee.object.type===r.Identifier&&t.callee.object.name==="React"&&t.callee.property.type===r.Identifier&&t.callee.property.name==="createClass"&&t.arguments.length===1&&t.arguments[0].type===r.ObjectExpression){var s=t.arguments[0].properties,o=s.every(function(e){var t=e.key.type===r.Identifier?e.key.name:e.key.value;return t!=="displayName"});o&&(i.catchup(t.arguments[0].range[0]+1,n),i.append("displayName: '"+e+"',",n))}}function o(e,t,n,i){var o,u;t.type===r.AssignmentExpression?(o=t.left,u=t.right):t.type===r.Property?(o=t.key,u=t.value):t.type===r.VariableDeclarator&&(o=t.id,u=t.init),o&&o.type===r.MemberExpression&&(o=o.property),o&&o.type===r.Identifier&&s(o.name,u,i)}var r=e("esprima-fb").Syntax,i=e("jstransform/src/utils");o.test=function(e,t,n){return i.getDocblock(n).jsx?e.type===r.AssignmentExpression||e.type===r.Property||e.type===r.VariableDeclarator:!1},n.visitorList=[o]},{"esprima-fb":6,"jstransform/src/utils":20}],29:[function(e,t,n){function o(e,t,n,r,s){var o=e.value.split(/\r\n|\n|\r/);r&&i.append(r,n);var u=0;o.forEach(function(e,t){e.match(/[^ \t]/)&&(u=t)}),o.forEach(function(e,r){var a=r===0,f=r===o.length-1,l=r===u,c=e.replace(/\t/g," ");a||(c=c.replace(/^[ ]+/,"")),f||(c=c.replace(/[ ]+$/,"")),i.append(e.match(/^[ \t]*/)[0],n);if(c||l)i.append(JSON.stringify(c)+(l?"":"+' '+"),n),l&&(s&&i.append(s,n),t||i.append(",",n)),c&&i.append(e.match(/[ \t]*$/)[0],n);f||i.append("\n",n)}),i.move(e.range[1],n)}function u(e,t,n,s,o){return i.move(t.range[0]+1,o),e(t.expression,s,o),!n&&t.expression.type!==r.XJSEmptyExpression&&(i.catchup(t.expression.range[1],o),i.append(",",o)),i.catchup(t.range[1]-1,o),i.move(t.range[1],o),!1}function a(e){return/^[a-z_$][a-z\d_$]*$/i.test(e)?e:"'"+e+"'"}var r=e("esprima-fb").Syntax,i=e("jstransform/src/utils"),s={a:!0,abbr:!0,address:!0,applet:!0,area:!0,article:!0,aside:!0,audio:!0,b:!0,base:!0,bdi:!0,bdo:!0,big:!0,blockquote:!0,body:!0,br:!0,button:!0,canvas:!0,caption:!0,circle:!0,cite:!0,code:!0,col:!0,colgroup:!0,command:!0,data:!0,datalist:!0,dd:!0,defs:!0,del:!0,details:!0,dfn:!0,dialog:!0,div:!0,dl:!0,dt:!0,ellipse:!0,em:!0,embed:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,g:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,head:!0,header:!0,hgroup:!0,hr:!0,html:!0,i:!0,iframe:!0,img:!0,input:!0,ins:!0,kbd:!0,keygen:!0,label:!0,legend:!0,li:!0,line:!0,linearGradient:!0,link:!0,main:!0,map:!0,mark:!0,marquee:!0,menu:!0,menuitem:!0,meta:!0,meter:!0,nav:!0,noscript:!0,object:!0,ol:!0,optgroup:!0,option:!0,output:!0,p:!0,param:!0,path:!0,polygon:!0,polyline:!0,pre:!0,progress:!0,q:!0,radialGradient:!0,rect:!0,rp:!0,rt:!0,ruby:!0,s:!0,samp:!0,script:!0,section:!0,select:!0,small:!0,source:!0,span:!0,stop:!0,strong:!0,style:!0,sub:!0,summary:!0,sup:!0,svg:!0,table:!0,tbody:!0,td:!0,text:!0,textarea:!0,tfoot:!0,th:!0,thead:!0,time:!0,title:!0,tr:!0,track:!0,u:!0,ul:!0,"var":!0,video:!0,wbr:!0};n.knownTags=s,n.renderXJSExpressionContainer=u,n.renderXJSLiteral=o,n.quoteAttrName=a},{"esprima-fb":6,"jstransform/src/utils":20}],30:[function(e,t,n){function h(e){var t=[];for(var n=0,r=c.length;n<r;n++)if(!e||e.indexOf(c[n])===-1)t=t.concat(l[c[n]]);return t}var r=e("jstransform/visitors/es6-arrow-function-visitors"),i=e("jstransform/visitors/es6-class-visitors"),s=e("jstransform/visitors/es6-object-short-notation-visitors"),o=e("jstransform/visitors/es6-rest-param-visitors"),u=e("jstransform/visitors/es6-template-visitors"),a=e("./transforms/react"),f=e("./transforms/reactDisplayName"),l={"es6-arrow-functions":r.visitorList,"es6-classes":i.visitorList,"es6-object-short-notation":s.visitorList,"es6-rest-params":o.visitorList,"es6-templates":u.visitorList,react:a.visitorList.concat(f.visitorList)},c=["es6-arrow-functions","es6-object-short-notation","es6-classes","es6-rest-params","es6-templates","react"];n.getAllVisitors=h,n.transformVisitors=l},{"./transforms/react":27,"./transforms/reactDisplayName":28,"jstransform/visitors/es6-arrow-function-visitors":21,"jstransform/visitors/es6-class-visitors":22,"jstransform/visitors/es6-object-short-notation-visitors":23,"jstransform/visitors/es6-rest-param-visitors":24,"jstransform/visitors/es6-template-visitors":25}]},{},[26])(26)}),function(e,t){function P(e){var t=e.length,n=b.type(e);return b.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function B(e){var t=H[e]={};return b.each(e.match(E)||[],function(e,n){t[n]=!0}),t}function I(e,n,r,i){if(b.acceptData(e)){var s,o,u=b.expando,a="string"==typeof n,f=e.nodeType,c=f?b.cache:e,h=f?e[u]:e[u]&&u;if(h&&c[h]&&(i||c[h].data)||!a||r!==t)return h||(f?e[u]=h=l.pop()||b.guid++:h=u),c[h]||(c[h]={},f||(c[h].toJSON=b.noop)),("object"==typeof n||"function"==typeof n)&&(i?c[h]=b.extend(c[h],n):c[h].data=b.extend(c[h].data,n)),s=c[h],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[b.camelCase(n)]=r),a?(o=s[n],null==o&&(o=s[b.camelCase(n)])):o=s,o}}function q(e,t,n){if(b.acceptData(e)){var r,i,s,o=e.nodeType,u=o?b.cache:e,a=o?e[b.expando]:b.expando;if(u[a]){if(t&&(s=n?u[a]:u[a].data)){b.isArray(t)?t=t.concat(b.map(t,b.camelCase)):t in s?t=[t]:(t=b.camelCase(t),t=t in s?[t]:t.split(" "));for(r=0,i=t.length;i>r;r++)delete s[t[r]];if(!(n?U:b.isEmptyObject)(s))return}(n||(delete u[a].data,U(u[a])))&&(o?b.cleanData([e],!0):b.support.deleteExpando||u!=u.window?delete u[a]:u[a]=null)}}}function R(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(F,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:j.test(r)?b.parseJSON(r):r}catch(s){}b.data(e,n,r)}else r=t}return r}function U(e){var t;for(t in e)if(("data"!==t||!b.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function it(){return!0}function st(){return!1}function ct(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function ht(e,t,n){if(t=t||0,b.isFunction(t))return b.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return b.grep(e,function(e){return e===t===n});if("string"==typeof t){var r=b.grep(e,function(e){return 1===e.nodeType});if(at.test(t))return b.filter(t,r,!n);t=b.filter(t,r)}return b.grep(e,function(e){return b.inArray(e,t)>=0===n})}function pt(e){var t=dt.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Mt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function _t(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function Dt(e){var t=Ct.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Pt(e,t){var n,r=0;for(;null!=(n=e[r]);r++)b._data(n,"globalEval",!t||b._data(t[r],"globalEval"))}function Ht(e,t){if(1===t.nodeType&&b.hasData(e)){var n,r,i,s=b._data(e),o=b._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;i>r;r++)b.event.add(t,n,u[n][r])}o.data&&(o.data=b.extend({},o.data))}}function Bt(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!b.support.noCloneEvent&&t[b.expando]){i=b._data(t);for(r in i.events)b.removeEvent(t,r,i.handle);t.removeAttribute(b.expando)}"script"===n&&t.text!==e.text?(_t(t).text=e.text,Dt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),b.support.html5Clone&&e.innerHTML&&!b.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&xt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function jt(e,n){var r,s,o=0,u=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!u)for(u=[],r=e.childNodes||e;null!=(s=r[o]);o++)!n||b.nodeName(s,n)?u.push(s):b.merge(u,jt(s,n));return n===t||n&&b.nodeName(e,n)?b.merge([e],u):u}function Ft(e){xt.test(e.type)&&(e.defaultChecked=e.checked)}function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,"none"===b.css(e,"display")||!b.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,s=[],o=0,u=e.length;for(;u>o;o++)r=e[o],r.style&&(s[o]=b._data(r,"olddisplay"),n=r.style.display,t?(s[o]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(s[o]=b._data(r,"olddisplay",an(r.nodeName)))):s[o]||(i=nn(r),(n&&"none"!==n||!i)&&b._data(r,"olddisplay",i?n:b.css(r,"display"))));for(o=0;u>o;o++)r=e[o],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?s[o]||"":"none"));return e}function sn(e,t,n){var r=$t.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function on(e,t,n,r,i){var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;for(;4>s;s+=2)"margin"===n&&(o+=b.css(e,n+Zt[s],!0,i)),r?("content"===n&&(o-=b.css(e,"padding"+Zt[s],!0,i)),"margin"!==n&&(o-=b.css(e,"border"+Zt[s]+"Width",!0,i))):(o+=b.css(e,"padding"+Zt[s],!0,i),"padding"!==n&&(o+=b.css(e,"border"+Zt[s]+"Width",!0,i)));return o}function un(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=qt(e),o=b.support.boxSizing&&"border-box"===b.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=Rt(e,t,s),(0>i||null==i)&&(i=e.style[t]),Jt.test(i))return i;r=o&&(b.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+on(e,t,n||(o?"border":"content"),r,s)+"px"}function an(e){var t=s,n=Qt[e];return n||(n=fn(e,t),"none"!==n&&n||(It=(It||b("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(It[0].contentWindow||It[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=fn(e,t),It.detach()),Qt[e]=n),n}function fn(e,t){var n=b(t.createElement(e)).appendTo(t.body),r=b.css(n[0],"display");return n.remove(),r}function vn(e,t,n,r){var i;if(b.isArray(t))b.each(t,function(t,i){n||cn.test(e)?r(e,i):vn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==b.type(t))r(e,t);else for(i in t)vn(e+"["+i+"]",t[i],n,r)}function _n(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(E)||[];if(b.isFunction(n))while(r=s[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Dn(e,n,r,i){function u(a){var f;return s[a]=!0,b.each(e[a]||[],function(e,a){var l=a(n,r,i);return"string"!=typeof l||o||s[l]?o?!(f=l):t:(n.dataTypes.unshift(l),u(l),!1)}),f}var s={},o=e===An;return u(n.dataTypes[0])||!s["*"]&&u("*")}function Pn(e,n){var r,i,s=b.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((s[i]?e:r||(r={}))[i]=n[i]);return r&&b.extend(!0,e,r),e}function Hn(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(u in l)u in r&&(n[l[u]]=r[u]);while("*"===f[0])f.shift(),s===t&&(s=e.mimeType||n.getResponseHeader("Content-Type"));if(s)for(u in a)if(a[u]&&a[u].test(s)){f.unshift(u);break}if(f[0]in r)o=f[0];else{for(u in r){if(!f[0]||e.converters[u+" "+f[0]]){o=u;break}i||(i=u)}o=o||i}return o?(o!==f[0]&&f.unshift(o),r[o]):t}function Bn(e,t){var n,r,i,s,o={},u=0,a=e.dataTypes.slice(),f=a[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a[1])for(i in e.converters)o[i.toLowerCase()]=e.converters[i];for(;r=a[++u];)if("*"!==r){if("*"!==f&&f!==r){if(i=o[f+" "+r]||o["* "+r],!i)for(n in o)if(s=n.split(" "),s[1]===r&&(i=o[f+" "+s[0]]||o["* "+s[0]])){i===!0?i=o[n]:o[n]!==!0&&(r=s[0],a.splice(u--,0,r));break}if(i!==!0)if(i&&e["throws"])t=i(t);else try{t=i(t)}catch(l){return{state:"parsererror",error:i?l:"No conversion from "+f+" to "+r}}}f=r}return{state:"success",data:t}}function zn(){try{return new e.XMLHttpRequest}catch(t){}}function Wn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function Yn(){return setTimeout(function(){Xn=t}),Xn=b.now()}function Zn(e,t){b.each(t,function(t,n){var r=(Gn[t]||[]).concat(Gn["*"]),i=0,s=r.length;for(;s>i;i++)if(r[i].call(e,t,n))return})}function er(e,t,n){var r,i,s=0,o=Qn.length,u=b.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=Xn||Yn(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:b.extend({},t),opts:b.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Yn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=b.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(tr(l,f.opts.specialEasing);o>s;s++)if(r=Qn[s].call(f,e,l,f.opts))return r;return Zn(f,l),b.isFunction(f.opts.start)&&f.opts.start.call(e,f),b.fx.timer(b.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function tr(e,t){var n,r,i,s,o;for(i in e)if(r=b.camelCase(i),s=t[r],n=e[i],b.isArray(n)&&(s=n[1],n=e[i]=n[0]),i!==r&&(e[r]=n,delete e[i]),o=b.cssHooks[r],o&&"expand"in o){n=o.expand(n),delete e[r];for(i in n)i in e||(e[i]=n[i],t[i]=s)}else t[r]=s}function nr(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},v=[],m=e.nodeType&&nn(e);n.queue||(l=b._queueHooks(e,"fx"),null==l.unqueued&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,b.queue(e,"fx").length||l.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===b.css(e,"display")&&"none"===b.css(e,"float")&&(b.support.inlineBlockNeedsLayout&&"inline"!==an(e.nodeName)?p.zoom=1:p.display="inline-block")),n.overflow&&(p.overflow="hidden",b.support.shrinkWrapBlocks||h.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(i in t)if(o=t[i],$n.exec(o)){if(delete t[i],a=a||"toggle"===o,o===(m?"hide":"show"))continue;v.push(i)}if(s=v.length){u=b._data(e,"fxshow")||b._data(e,"fxshow",{}),"hidden"in u&&(m=u.hidden),a&&(u.hidden=!m),m?b(e).show():h.done(function(){b(e).hide()}),h.done(function(){var t;b._removeData(e,"fxshow");for(t in d)b.style(e,t,d[t])});for(i=0;s>i;i++)r=v[i],f=h.createTween(r,m?u[r]:0),d[r]=u[r]||b.style(e,r),r in u||(u[r]=f.start,m&&(f.end=f.start,f.start="width"===r||"height"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function sr(e){return b.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var n,r,i=typeof t,s=e.document,o=e.location,u=e.jQuery,a=e.$,f={},l=[],c="1.9.1",h=l.concat,p=l.push,d=l.slice,v=l.indexOf,m=f.toString,g=f.hasOwnProperty,y=c.trim,b=function(e,t){return new b.fn.init(e,t,r)},w=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,E=/\S+/g,S=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,x=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,T=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,N=/^[\],:{}\s]*$/,C=/(?:^|:|,)(?:\s*\[)+/g,k=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,L=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,A=/^-ms-/,O=/-([\da-z])/gi,M=function(e,t){return t.toUpperCase()},_=function(e){(s.addEventListener||"load"===e.type||"complete"===s.readyState)&&(D(),b.ready())},D=function(){s.addEventListener?(s.removeEventListener("DOMContentLoaded",_,!1),e.removeEventListener("load",_,!1)):(s.detachEvent("onreadystatechange",_),e.detachEvent("onload",_))};b.fn=b.prototype={jquery:c,constructor:b,init:function(e,n,r){var i,o;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:x.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof b?n[0]:n,b.merge(this,b.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:s,!0)),T.test(i[1])&&b.isPlainObject(n))for(i in n)b.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(o=s.getElementById(i[2]),o&&o.parentNode){if(o.id!==i[2])return r.find(e);this.length=1,this[0]=o}return this.context=s,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):b.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),b.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return d.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return b.each(this,e,t)},ready:function(e){return b.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(b.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:p,sort:[].sort,splice:[].splice},b.fn.init.prototype=b.fn,b.extend=b.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;for("boolean"==typeof u&&(l=u,u=arguments[1]||{},a=2),"object"==typeof u||b.isFunction(u)||(u={}),f===a&&(u=this,--a);f>a;a++)if(null!=(s=arguments[a]))for(i in s)e=u[i],r=s[i],u!==r&&(l&&r&&(b.isPlainObject(r)||(n=b.isArray(r)))?(n?(n=!1,o=e&&b.isArray(e)?e:[]):o=e&&b.isPlainObject(e)?e:{},u[i]=b.extend(l,o,r)):r!==t&&(u[i]=r));return u},b.extend({noConflict:function(t){return e.$===b&&(e.$=a),t&&e.jQuery===b&&(e.jQuery=u),b},isReady:!1,readyWait:1,holdReady:function(e){e?b.readyWait++:b.ready(!0)},ready:function(e){if(e===!0?!--b.readyWait:!b.isReady){if(!s.body)return setTimeout(b.ready);b.isReady=!0,e!==!0&&--b.readyWait>0||(n.resolveWith(s,[b]),b.fn.trigger&&b(s).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===b.type(e)},isArray:Array.isArray||function(e){return"array"===b.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?f[m.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==b.type(e)||e.nodeType||b.isWindow(e))return!1;try{if(e.constructor&&!g.call(e,"constructor")&&!g.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||g.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||s;var r=T.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=b.buildFragment([e],t,i),i&&b(i).remove(),b.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=b.trim(n),n&&N.test(n.replace(k,"@").replace(L,"]").replace(C,"")))?Function("return "+n)():(b.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||b.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&b.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(A,"ms-").replace(O,M)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=P(e);if(n){if(o){for(;s>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(o){for(;s>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:y&&!y.call("﻿ ")?function(e){return null==e?"":y.call(e)}:function(e){return null==e?"":(e+"").replace(S,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(P(Object(e))?b.merge(n,"string"==typeof e?[e]:e):p.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(v)return v.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if("number"==typeof r)for(;r>s;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;o>s;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=P(e),u=[];if(o)for(;s>i;i++)r=t(e[i],i,n),null!=r&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(u[u.length]=r);return h.apply([],u)},guid:1,proxy:function(e,n){var r,i,s;return"string"==typeof n&&(s=e[n],n=e,e=s),b.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(n||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||b.guid++,i):t},access:function(e,n,r,i,s,o,u){var a=0,f=e.length,l=null==r;if("object"===b.type(r)){s=!0;for(a in r)b.access(e,n,a,r[a],!0,o,u)}else if(i!==t&&(s=!0,b.isFunction(i)||(u=!0),l&&(u?(n.call(e,i),n=null):(l=n,n=function(e,t,n){return l.call(b(e),n)})),n))for(;f>a;a++)n(e[a],r,u?i:i.call(e[a],a,n(e[a],r)));return s?e:l?n.call(e):f?n(e[0],r):o},now:function(){return(new Date).getTime()}}),b.ready.promise=function(t){if(!n)if(n=b.Deferred(),"complete"===s.readyState)setTimeout(b.ready);else if(s.addEventListener)s.addEventListener("DOMContentLoaded",_,!1),e.addEventListener("load",_,!1);else{s.attachEvent("onreadystatechange",_),e.attachEvent("onload",_);var r=!1;try{r=null==e.frameElement&&s.documentElement}catch(i){}r&&r.doScroll&&function o(){if(!b.isReady){try{r.doScroll("left")}catch(e){return setTimeout(o,50)}D(),b.ready()}}()}return n.promise(t)},b.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){f["[object "+t+"]"]=t.toLowerCase()}),r=b(s);var H={};b.Callbacks=function(e){e="string"==typeof e?H[e]||B(e):b.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){for(r=e.memory&&t,i=!0,o=u||0,u=0,s=a.length,n=!0;a&&s>o;o++)if(a[o].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,a&&(f?f.length&&l(f.shift()):r?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function i(t){b.each(t,function(t,n){var r=b.type(n);"function"===r?e.unique&&c.has(n)||a.push(n):n&&n.length&&"string"!==r&&i(n)})})(arguments),n?s=a.length:r&&(u=t,l(r))}return this},remove:function(){return a&&b.each(arguments,function(e,t){var r;while((r=b.inArray(t,a,r))>-1)a.splice(r,1),n&&(s>=r&&s--,o>=r&&o--)}),this},has:function(e){return e?b.inArray(e,a)>-1:!!a&&!!a.length},empty:function(){return a=[],this},disable:function(){return a=f=r=t,this},disabled:function(){return!a},lock:function(){return f=t,r||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!a||i&&!f||(n?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},b.extend({Deferred:function(e){var t=[["resolve","done",b.Callbacks("once memory"),"resolved"],["reject","fail",b.Callbacks("once memory"),"rejected"],["notify","progress",b.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return b.Deferred(function(n){b.each(t,function(t,s){var o=s[0],u=b.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&b.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?b.extend(e,r):r}},i={};return r.pipe=r.then,b.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=1!==r||e&&b.isFunction(e.promise)?r:0,s=1===i?e:b.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1)for(u=Array(r),a=Array(r),f=Array(r);r>t;t++)n[t]&&b.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i;return i||s.resolveWith(f,n),s.promise()}}),b.support=function(){var t,n,r,o,u,a,f,l,c,h,p=s.createElement("div");if(p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0],!n||!r||!n.length)return{};u=s.createElement("select"),f=u.appendChild(s.createElement("option")),o=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:"t"!==p.className,leadingWhitespace:3===p.firstChild.nodeType,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:"/a"===r.getAttribute("href"),opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:!!o.value,optSelected:f.selected,enctype:!!s.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==s.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===s.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},o.checked=!0,t.noCloneChecked=o.cloneNode(!0).checked,u.disabled=!0,t.optDisabled=!f.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}o=s.createElement("input"),o.setAttribute("value",""),t.input=""===o.getAttribute("value"),o.value="t",o.setAttribute("type","radio"),t.radioValue="t"===o.value,o.setAttribute("checked","t"),o.setAttribute("name","t"),a=s.createDocumentFragment(),a.appendChild(o),t.appendChecked=o.checked,t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,p.attachEvent&&(p.attachEvent("onclick",function(){t.noCloneEvent=!1}),p.cloneNode(!0).click());for(h in{submit:!0,change:!0,focusin:!0})p.setAttribute(l="on"+h,"t"),t[h+"Bubbles"]=l in e||p.attributes[l].expando===!1;return p.style.backgroundClip="content-box",p.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===p.style.backgroundClip,b(function(){var n,r,o,u="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",a=s.getElementsByTagName("body")[0];a&&(n=s.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(p),p.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=p.getElementsByTagName("td"),o[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===o[0].offsetHeight,o[0].style.display="",o[1].style.display="none",t.reliableHiddenOffsets=c&&0===o[0].offsetHeight,p.innerHTML="",p.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===p.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==a.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(p,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(p,null)||{width:"4px"}).width,r=p.appendChild(s.createElement("div")),r.style.cssText=p.style.cssText=u,r.style.marginRight=r.style.width="0",p.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof p.style.zoom!==i&&(p.innerHTML="",p.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===p.offsetWidth,p.style.display="block",p.innerHTML="<div></div>",p.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==p.offsetWidth,t.inlineBlockNeedsLayout&&(a.style.zoom=1)),a.removeChild(n),n=p=o=r=null)}),n=u=a=f=r=o=null,t}();var j=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,F=/([A-Z])/g;b.extend({cache:{},expando:"jQuery"+(c+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?b.cache[e[b.expando]]:e[b.expando],!!e&&!U(e)},data:function(e,t,n){return I(e,t,n)},removeData:function(e,t){return q(e,t)},_data:function(e,t,n){return I(e,t,n,!0)},_removeData:function(e,t){return q(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&b.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),b.fn.extend({data:function(e,n){var r,i,s=this[0],o=0,u=null;if(e===t){if(this.length&&(u=b.data(s),1===s.nodeType&&!b._data(s,"parsedAttrs"))){for(r=s.attributes;r.length>o;o++)i=r[o].name,i.indexOf("data-")||(i=b.camelCase(i.slice(5)),R(s,i,u[i]));b._data(s,"parsedAttrs",!0)}return u}return"object"==typeof e?this.each(function(){b.data(this,e)}):b.access(this,function(n){return n===t?s?R(s,e,b.data(s,e)):null:(this.each(function(){b.data(this,e,n)}),t)},null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){b.removeData(this,e)})}}),b.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=b._data(e,n),r&&(!i||b.isArray(r)?i=b._data(e,n,b.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=b.queue(e,t),r=n.length,i=n.shift(),s=b._queueHooks(e,t),o=function(){b.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),s.cur=i,i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return b._data(e,n)||b._data(e,n,{empty:b.Callbacks("once memory").add(function(){b._removeData(e,t+"queue"),b._removeData(e,n)})})}}),b.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?b.queue(this[0],e):n===t?this:this.each(function(){var t=b.queue(this,e,n);b._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&b.dequeue(this,e)})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(e,t){return e=b.fx?b.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=b.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};"string"!=typeof e&&(n=e,e=t),e=e||"fx";while(u--)r=b._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var z,W,X=/[\t\r\n]/g,V=/\r/g,$=/^(?:input|select|textarea|button|object)$/i,J=/^(?:a|area)$/i,K=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,Q=/^(?:checked|selected)$/i,G=b.support.getSetAttribute,Y=b.support.input;b.fn.extend({attr:function(e,t){return b.access(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,t){return b.access(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){return e=b.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a="string"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(E)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(X," "):" ")){s=0;while(i=t[s++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=b.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=0===arguments.length||"string"==typeof e&&e;if(b.isFunction(e))return this.each(function(t){b(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(E)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(X," "):"")){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?b.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e,r="boolean"==typeof t;return b.isFunction(e)?this.each(function(n){b(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var s,o=0,u=b(this),a=t,f=e.match(E)||[];while(s=f[o++])a=r?a:!u.hasClass(s),u[a?"addClass":"removeClass"](s)}else(n===i||"boolean"===n)&&(this.className&&b._data(this,"__className__",this.className),this.className=this.className||e===!1?"":b._data(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(X," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(arguments.length)return i=b.isFunction(e),this.each(function(n){var s,o=b(this);1===this.nodeType&&(s=i?e.call(this,n,o.val()):e,null==s?s="":"number"==typeof s?s+="":b.isArray(s)&&(s=b.map(s,function(e){return null==e?"":e+""})),r=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,s,"value")!==t||(this.value=s))});if(s)return r=b.valHooks[s.type]||b.valHooks[s.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(s,"value"))!==t?n:(n=s.value,"string"==typeof n?n.replace(V,""):null==n?"":n)}}),b.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;for(;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(b.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&b.nodeName(n.parentNode,"optgroup"))){if(t=b(n).val(),s)return t;o.push(t)}return o},set:function(e,t){var n=b.makeArray(t);return b(e).find("option").each(function(){this.selected=b.inArray(b(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attr:function(e,n,r){var s,o,u,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return typeof e.getAttribute===i?b.prop(e,n,r):(o=1!==a||!b.isXMLDoc(e),o&&(n=n.toLowerCase(),s=b.attrHooks[n]||(K.test(n)?W:z)),r===t?s&&o&&"get"in s&&null!==(u=s.get(e,n))?u:(typeof e.getAttribute!==i&&(u=e.getAttribute(n)),null==u?t:u):null!==r?s&&o&&"set"in s&&(u=s.set(e,r,n))!==t?u:(e.setAttribute(n,r+""),r):(b.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(E);if(s&&1===e.nodeType)while(n=s[i++])r=b.propFix[n]||n,K.test(n)?!G&&Q.test(n)?e[b.camelCase("default-"+n)]=e[r]=!1:e[r]=!1:b.attr(e,n,""),e.removeAttribute(G?n:r)},attrHooks:{type:{set:function(e,t){if(!b.support.radioValue&&"radio"===t&&b.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return o=1!==u||!b.isXMLDoc(e),o&&(n=b.propFix[n]||n,s=b.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&null!==(i=s.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):$.test(e.nodeName)||J.test(e.nodeName)&&e.href?0:t}}}}),W={get:function(e,n){var r=b.prop(e,n),i="boolean"==typeof r&&e.getAttribute(n),s="boolean"==typeof r?Y&&G?null!=i:Q.test(n)?e[b.camelCase("default-"+n)]:!!i:e.getAttributeNode(n);return s&&s.value!==!1?n.toLowerCase():t},set:function(e,t,n){return t===!1?b.removeAttr(e,n):Y&&G||!Q.test(n)?e.setAttribute(!G&&b.propFix[n]||n,n):e[b.camelCase("default-"+n)]=e[n]=!0,n}},Y&&G||(b.attrHooks.value={get:function(e,n){var r=e.getAttributeNode(n);return b.nodeName(e,"input")?e.defaultValue:r&&r.specified?r.value:t},set:function(e,n,r){return b.nodeName(e,"input")?(e.defaultValue=n,t):z&&z.set(e,n,r)}}),G||(z=b.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&("id"===n||"name"===n||"coords"===n?""!==r.value:r.specified)?r.value:t},set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},b.attrHooks.contenteditable={get:z.get,set:function(e,t,n){z.set(e,""===t?!1:t,n)}},b.each(["width","height"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}})})),b.support.hrefNormalized||(b.each(["href","src","width","height"],function(e,n){b.attrHooks[n]=b.extend(b.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return null==r?t:r}})}),b.each(["href","src"],function(e,t){b.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),b.support.style||(b.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),b.support.optSelected||(b.propHooks.selected=b.extend(b.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),b.support.enctype||(b.propFix.enctype="encoding"),b.support.checkOn||b.each(["radio","checkbox"],function(){b.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),b.each(["radio","checkbox"],function(){b.valHooks[this]=b.extend(b.valHooks[this],{set:function(e,n){return b.isArray(n)?e.checked=b.inArray(b(e).val(),n)>=0:t}})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;b.event={global:{},add:function(e,n,r,s,o){var u,a,f,l,c,h,p,d,v,m,g,y=b._data(e);if(y){r.handler&&(l=r,r=l.handler,o=l.selector),r.guid||(r.guid=b.guid++),(a=y.events)||(a=y.events={}),(h=y.handle)||(h=y.handle=function(e){return typeof b===i||e&&b.event.triggered===e.type?t:b.event.dispatch.apply(h.elem,arguments)},h.elem=e),n=(n||"").match(E)||[""],f=n.length;while(f--)u=rt.exec(n[f])||[],v=g=u[1],m=(u[2]||"").split(".").sort(),c=b.event.special[v]||{},v=(o?c.delegateType:c.bindType)||v,c=b.event.special[v]||{},p=b.extend({type:v,origType:g,data:s,handler:r,guid:r.guid,selector:o,needsContext:o&&b.expr.match.needsContext.test(o),namespace:m.join(".")},l),(d=a[v])||(d=a[v]=[],d.delegateCount=0,c.setup&&c.setup.call(e,s,m,h)!==!1||(e.addEventListener?e.addEventListener(v,h,!1):e.attachEvent&&e.attachEvent("on"+v,h))),c.add&&(c.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),o?d.splice(d.delegateCount++,0,p):d.push(p),b.event.global[v]=!0;e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=b.hasData(e)&&b._data(e);if(m&&(l=m.events)){t=(t||"").match(E)||[""],f=t.length;while(f--)if(u=rt.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){c=b.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=l[p]||[],u=u[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=h.length;while(s--)o=h[s],!i&&v!==o.origType||n&&n.guid!==o.guid||u&&!u.test(o.namespace)||r&&r!==o.selector&&("**"!==r||!o.selector)||(h.splice(s,1),o.selector&&h.delegateCount--,c.remove&&c.remove.call(e,o));a&&!h.length&&(c.teardown&&c.teardown.call(e,d,m.handle)!==!1||b.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)b.event.remove(e,p+t[f],n,r,!0);b.isEmptyObject(l)&&(delete m.handle,b._removeData(e,"events"))}},trigger:function(n,r,i,o){var u,a,f,l,c,h,p,d=[i||s],v=g.call(n,"type")?n.type:n,m=g.call(n,"namespace")?n.namespace.split("."):[];if(f=h=i=i||s,3!==i.nodeType&&8!==i.nodeType&&!nt.test(v+b.event.triggered)&&(v.indexOf(".")>=0&&(m=v.split("."),v=m.shift(),m.sort()),a=0>v.indexOf(":")&&"on"+v,n=n[b.expando]?n:new b.Event(v,"object"==typeof n&&n),n.isTrigger=!0,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:b.makeArray(r,[n]),c=b.event.special[v]||{},o||!c.trigger||c.trigger.apply(i,r)!==!1)){if(!o&&!c.noBubble&&!b.isWindow(i)){for(l=c.delegateType||v,nt.test(l+v)||(f=f.parentNode);f;f=f.parentNode)d.push(f),h=f;h===(i.ownerDocument||s)&&d.push(h.defaultView||h.parentWindow||e)}p=0;while((f=d[p++])&&!n.isPropagationStopped())n.type=p>1?l:c.bindType||v,u=(b._data(f,"events")||{})[n.type]&&b._data(f,"handle"),u&&u.apply(f,r),u=a&&f[a],u&&b.acceptData(f)&&u.apply&&u.apply(f,r)===!1&&n.preventDefault();if(n.type=v,!(o||n.isDefaultPrevented()||c._default&&c._default.apply(i.ownerDocument,r)!==!1||"click"===v&&b.nodeName(i,"a")||!b.acceptData(i)||!a||!i[v]||b.isWindow(i))){h=i[a],h&&(i[a]=null),b.event.triggered=v;try{i[v]()}catch(y){}b.event.triggered=t,h&&(i[a]=h)}return n.result}},dispatch:function(e){e=b.event.fix(e);var n,r,i,s,o,u=[],a=d.call(arguments),f=(b._data(this,"events")||{})[e.type]||[],l=b.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){u=b.event.handlers.call(this,e,f),n=0;while((s=u[n++])&&!e.isPropagationStopped()){e.currentTarget=s.elem,o=0;while((i=s.handlers[o++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((b.event.special[i.origType]||{}).handle||i.handler).apply(s.elem,a),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,s,o,u=[],a=n.delegateCount,f=e.target;if(a&&f.nodeType&&(!e.button||"click"!==e.type))for(;f!=this;f=f.parentNode||this)if(1===f.nodeType&&(f.disabled!==!0||"click"!==e.type)){for(s=[],o=0;a>o;o++)i=n[o],r=i.selector+" ",s[r]===t&&(s[r]=i.needsContext?b(r,this).index(f)>=0:b.find(r,this,null,[f]).length),s[r]&&s.push(i);s.length&&u.push({elem:f,handlers:s})}return n.length>a&&u.push({elem:this,handlers:n.slice(a)}),u},fix:function(e){if(e[b.expando])return e;var t,n,r,i=e.type,o=e,u=this.fixHooks[i];u||(this.fixHooks[i]=u=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=u.props?this.props.concat(u.props):this.props,e=new b.Event(o),t=r.length;while(t--)n=r[t],e[n]=o[n];return e.target||(e.target=o.srcElement||s),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,u.filter?u.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,o,u=n.button,a=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||s,o=i.documentElement,r=i.body,e.pageX=n.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),e.which||u===t||(e.which=1&u?1:2&u?3:4&u?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return b.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t}},focus:{trigger:function(){if(this!==s.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===s.activeElement&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=b.extend(new b.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?b.event.trigger(i,null,t):b.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},b.removeEvent=s.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},b.Event=function(e,n){return this instanceof b.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:st):this.type=e,n&&b.extend(this,n),this.timeStamp=e&&e.timeStamp||b.now(),this[b.expando]=!0,t):new b.Event(e,n)},b.Event.prototype={isDefaultPrevented:st,isPropagationStopped:st,isImmediatePropagationStopped:st,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},b.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!b.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),b.support.submitBubbles||(b.event.special.submit={setup:function(){return b.nodeName(this,"form")?!1:(b.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=b.nodeName(n,"input")||b.nodeName(n,"button")?n.form:t;r&&!b._data(r,"submitBubbles")&&(b.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),b._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&b.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return b.nodeName(this,"form")?!1:(b.event.remove(this,"._submit"),t)}}),b.support.changeBubbles||(b.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(b.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),b.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),b.event.simulate("change",this,e,!0)})),!1):(b.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!b._data(t,"changeBubbles")&&(b.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||b.event.simulate("change",this.parentNode,e,!0)}),b._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return b.event.remove(this,"._change"),!Z.test(this.nodeName)}}),b.support.focusinBubbles||b.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){b.event.simulate(t,e.target,b.event.fix(e),!0)};b.event.special[t]={setup:function(){0===n++&&s.addEventListener(e,r,!0)},teardown:function(){0===--n&&s.removeEventListener(e,r,!0)}}}),b.fn.extend({on:function(e,n,r,i,s){var o,u;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(o in e)this.on(o,n,r,e[o],s);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=st;else if(!i)return this;return 1===s&&(u=i,i=function(e){return b().off(e),u.apply(this,arguments)},i.guid=u.guid||(u.guid=b.guid++)),this.each(function(){b.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,b(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(s in e)this.off(s,n,e[s]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=st),this.each(function(){b.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?b.event.trigger(e,n,r,!0):t}}),function(e,t){function rt(e){return J.test(e+"")}function it(){var e,t=[];return e=function(n,r){return t.push(n+=" ")>i.cacheLength&&delete e[t.shift()],e[n]=r}}function st(e){return e[w]=!0,e}function ot(e){var t=c.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}}function ut(e,t,n,r){var i,s,o,u,a,f,h,v,m,y;if((t?t.ownerDocument||t:E)!==c&&l(t),t=t||c,n=n||[],!e||"string"!=typeof e)return n;if(1!==(u=t.nodeType)&&9!==u)return[];if(!p&&!r){if(i=K.exec(e))if(o=i[1]){if(9===u){if(s=t.getElementById(o),!s||!s.parentNode)return n;if(s.id===o)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&g(t,s)&&s.id===o)return n.push(s),n}else{if(i[2])return _.apply(n,D.call(t.getElementsByTagName(e),0)),n;if((o=i[3])&&S.getByClassName&&t.getElementsByClassName)return _.apply(n,D.call(t.getElementsByClassName(o),0)),n}if(S.qsa&&!d.test(e)){if(h=!0,v=w,m=t,y=9===u&&e,1===u&&"object"!==t.nodeName.toLowerCase()){f=ht(e),(h=t.getAttribute("id"))?v=h.replace(Y,"\\$&"):t.setAttribute("id",v),v="[id='"+v+"'] ",a=f.length;while(a--)f[a]=v+pt(f[a]);m=$.test(e)&&t.parentNode||t,y=f.join(",")}if(y)try{return _.apply(n,D.call(m.querySelectorAll(y),0)),n}catch(b){}finally{h||t.removeAttribute("id")}}}return Et(e.replace(R,"$1"),t,n,r)}function at(e,t){var n=t&&e,r=n&&(~t.sourceIndex||A)-(~e.sourceIndex||A);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ft(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function lt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ct(e){return st(function(t){return t=+t,st(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function ht(e,t){var n,r,s,o,u,a,f,l=C[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){(!n||(r=U.exec(u)))&&(r&&(u=u.slice(r[0].length)||u),a.push(s=[])),n=!1,(r=z.exec(u))&&(n=r.shift(),s.push({value:n,type:r[0].replace(R," ")}),u=u.slice(n.length));for(o in i.filter)!(r=V[o].exec(u))||f[o]&&!(r=f[o](r))||(n=r.shift(),s.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ut.error(e):C(e,a).slice(0)}function pt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function dt(e,t,n){var i=t.dir,s=n&&"parentNode"===i,o=T++;return t.first?function(t,n,r){while(t=t[i])if(1===t.nodeType||s)return e(t,n,r)}:function(t,n,u){var a,f,l,c=x+" "+o;if(u){while(t=t[i])if((1===t.nodeType||s)&&e(t,n,u))return!0}else while(t=t[i])if(1===t.nodeType||s)if(l=t[w]||(t[w]={}),(f=l[i])&&f[0]===c){if((a=f[1])===!0||a===r)return a===!0}else if(f=l[i]=[c],f[1]=e(t,n,u)||r,f[1]===!0)return!0}}function vt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function mt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=null!=t;for(;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function gt(e,t,n,r,i,s){return r&&!r[w]&&(r=gt(r)),i&&!i[w]&&(i=gt(i,s)),st(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||wt(t||"*",u.nodeType?[u]:u,[]),m=!e||!s&&t?v:mt(v,h,e,u,a),g=n?i||(s?e:d||r)?[]:o:m;if(n&&n(m,g,u,a),r){f=mt(g,p),r(f,[],u,a),l=f.length;while(l--)(c=f[l])&&(g[p[l]]=!(m[p[l]]=c))}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?P.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=mt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):_.apply(o,g)})}function yt(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],a=o?1:0,l=dt(function(e){return e===t},u,!0),c=dt(function(e){return P.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;s>a;a++)if(n=i.relative[e[a].type])h=[dt(vt(h),n)];else{if(n=i.filter[e[a].type].apply(null,e[a].matches),n[w]){for(r=++a;s>r;r++)if(i.relative[e[r].type])break;return gt(a>1&&vt(h),a>1&&pt(e.slice(0,a-1)).replace(R,"$1"),n,r>a&&yt(e.slice(a,r)),s>r&&yt(e=e.slice(r)),s>r&&pt(e))}h.push(n)}return vt(h)}function bt(e,t){var n=0,s=t.length>0,o=e.length>0,u=function(u,a,l,h,p){var d,v,m,g=[],y=0,b="0",w=u&&[],E=null!=p,S=f,T=u||o&&i.find.TAG("*",p&&a.parentNode||a),N=x+=null==S?1:Math.random()||.1;for(E&&(f=a!==c&&a,r=n);null!=(d=T[b]);b++){if(o&&d){v=0;while(m=e[v++])if(m(d,a,l)){h.push(d);break}E&&(x=N,r=++n)}s&&((d=!m&&d)&&y--,u&&w.push(d))}if(y+=b,s&&b!==y){v=0;while(m=t[v++])m(w,g,a,l);if(u){if(y>0)while(b--)w[b]||g[b]||(g[b]=M.call(h));g=mt(g)}_.apply(h,g),E&&!u&&g.length>0&&y+t.length>1&&ut.uniqueSort(h)}return E&&(x=N,f=S),w};return s?st(u):u}function wt(e,t,n){var r=0,i=t.length;for(;i>r;r++)ut(e,t[r],n);return n}function Et(e,t,n,r){var s,o,a,f,l,c=ht(e);if(!r&&1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&9===t.nodeType&&!p&&i.relative[o[1].type]){if(t=i.find.ID(a.matches[0].replace(et,tt),t)[0],!t)return n;e=e.slice(o.shift().value.length)}s=V.needsContext.test(e)?0:o.length;while(s--){if(a=o[s],i.relative[f=a.type])break;if((l=i.find[f])&&(r=l(a.matches[0].replace(et,tt),$.test(o[0].type)&&t.parentNode||t))){if(o.splice(s,1),e=r.length&&pt(o),!e)return _.apply(n,D.call(r,0)),n;break}}}return u(e,c)(r,t,p,n,$.test(e)),n}function St(){}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,w="sizzle"+ -(new Date),E=e.document,S={},x=0,T=0,N=it(),C=it(),k=it(),L=typeof t,A=1<<31,O=[],M=O.pop,_=O.push,D=O.slice,P=O.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},H="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",j=B.replace("w","w#"),F="([*^$|!~]?=)",I="\\["+H+"*("+B+")"+H+"*(?:"+F+H+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+j+")|)|)"+H+"*\\]",q=":("+B+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+I.replace(3,8)+")*)|.*)\\)|)",R=RegExp("^"+H+"+|((?:^|[^\\\\])(?:\\\\.)*)"+H+"+$","g"),U=RegExp("^"+H+"*,"+H+"*"),z=RegExp("^"+H+"*([\\x20\\t\\r\\n\\f>+~])"+H+"*"),W=RegExp(q),X=RegExp("^"+j+"$"),V={ID:RegExp("^#("+B+")"),CLASS:RegExp("^\\.("+B+")"),NAME:RegExp("^\\[name=['\"]?("+B+")['\"]?\\]"),TAG:RegExp("^("+B.replace("w","w*")+")"),ATTR:RegExp("^"+I),PSEUDO:RegExp("^"+q),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+H+"*(even|odd|(([+-]|)(\\d*)n|)"+H+"*(?:([+-]|)"+H+"*(\\d+)|))"+H+"*\\)|)","i"),needsContext:RegExp("^"+H+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+H+"*((?:-\\d)?\\d*)"+H+"*\\)|)(?=[^-]|$)","i")},$=/[\x20\t\r\n\f]*[+~]/,J=/^[^{]+\{\s*\[native code/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Q=/^(?:input|select|textarea|button)$/i,G=/^h\d$/i,Y=/'|\\/g,Z=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,et=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,tt=function(e,t){var n="0x"+t-65536;return n!==n?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{D.call(E.documentElement.childNodes,0)[0].nodeType}catch(nt){D=function(e){var t,n=[];while(t=this[e++])n.push(t);return n}}o=ut.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},l=ut.setDocument=function(e){var n=e?e.ownerDocument||e:E;return n!==c&&9===n.nodeType&&n.documentElement?(c=n,h=n.documentElement,p=o(n),S.tagNameNoComments=ot(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),S.attributes=ot(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),S.getByClassName=ot(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),S.getByName=ot(function(e){e.id=w+0,e.innerHTML="<a name='"+w+"'></a><div name='"+w+"'></div>",h.insertBefore(e,h.firstChild);var t=n.getElementsByName&&n.getElementsByName(w).length===2+n.getElementsByName(w+0).length;return S.getIdNotName=!n.getElementById(w),h.removeChild(e),t}),i.attrHandle=ot(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==L&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},S.getIdNotName?(i.find.ID=function(e,t){if(typeof t.getElementById!==L&&!p){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){return e.getAttribute("id")===t}}):(i.find.ID=function(e,n){if(typeof n.getElementById!==L&&!p){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==L&&r.getAttributeNode("id").value===e?[r]:t:[]}},i.filter.ID=function(e){var t=e.replace(et,tt);return function(e){var n=typeof e.getAttributeNode!==L&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=S.tagNameNoComments?function(e,n){return typeof n.getElementsByTagName!==L?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){while(n=s[i++])1===n.nodeType&&r.push(n);return r}return s},i.find.NAME=S.getByName&&function(e,n){return typeof n.getElementsByName!==L?n.getElementsByName(name):t},i.find.CLASS=S.getByClassName&&function(e,n){return typeof n.getElementsByClassName===L||p?t:n.getElementsByClassName(e)},v=[],d=[":focus"],(S.qsa=rt(n.querySelectorAll))&&(ot(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+H+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||d.push(":checked")}),ot(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&d.push("[*^$]="+H+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),d.push(",.*:")})),(S.matchesSelector=rt(m=h.matchesSelector||h.mozMatchesSelector||h.webkitMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&ot(function(e){S.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),v.push("!=",q)}),d=RegExp(d.join("|")),v=RegExp(v.join("|")),g=rt(h.contains)||h.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},y=h.compareDocumentPosition?function(e,t){var r;return e===t?(a=!0,0):(r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&r||e.parentNode&&11===e.parentNode.nodeType?e===n||g(E,e)?-1:t===n||g(E,t)?1:0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,s=e.parentNode,o=t.parentNode,u=[e],f=[t];if(e===t)return a=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:0;if(s===o)return at(e,t);r=e;while(r=r.parentNode)u.unshift(r);r=t;while(r=r.parentNode)f.unshift(r);while(u[i]===f[i])i++;return i?at(u[i],f[i]):u[i]===E?-1:f[i]===E?1:0},a=!1,[0,0].sort(y),S.detectDuplicates=a,c):c},ut.matches=function(e,t){return ut(e,null,null,t)},ut.matchesSelector=function(e,t){if((e.ownerDocument||e)!==c&&l(e),t=t.replace(Z,"='$1']"),!(!S.matchesSelector||p||v&&v.test(t)||d.test(t)))try{var n=m.call(e,t);if(n||S.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return ut(t,c,null,[e]).length>0},ut.contains=function(e,t){return(e.ownerDocument||e)!==c&&l(e),g(e,t)},ut.attr=function(e,t){var n;return(e.ownerDocument||e)!==c&&l(e),p||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):p||S.attributes?e.getAttribute(t):((n=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:n&&n.specified?n.value:null},ut.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ut.uniqueSort=function(e){var t,n=[],r=1,i=0;if(a=!S.detectDuplicates,e.sort(y),a){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e},s=ut.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=s(t);return n},i=ut.selectors={cacheLength:50,createPseudo:st,match:V,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(et,tt),e[3]=(e[4]||e[5]||"").replace(et,tt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ut.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ut.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return V.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&W.test(n)&&(t=ht(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(et,tt).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=N[e+" "];return t||(t=RegExp("(^|"+H+")"+e+"("+H+"|$)"))&&N(e,function(e){return t.test(e.className||typeof e.getAttribute!==L&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ut.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){l=m[w]||(m[w]={}),f=l[e]||[],p=f[0]===x&&f[1],h=f[0]===x&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(1===c.nodeType&&++h&&c===t){l[e]=[x,p,h];break}}else if(y&&(f=(t[w]||(t[w]={}))[e])&&f[0]===x)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:1===c.nodeType)&&++h&&(y&&((c[w]||(c[w]={}))[e]=[x,h]),c===t))break;return h-=i,h===r||0===h%r&&h/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||ut.error("unsupported pseudo: "+e);return r[w]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?st(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=P.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:st(function(e){var t=[],n=[],r=u(e.replace(R,"$1"));return r[w]?st(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:st(function(e){return function(t){return ut(e,t).length>0}}),contains:st(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),lang:st(function(e){return X.test(e||"")||ut.error("unsupported lang: "+e),e=e.replace(et,tt).toLowerCase(),function(t){var n;do if(n=p?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang)return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===c.activeElement&&(!c.hasFocus||c.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return G.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:ct(function(){return[0]}),last:ct(function(e,t){return[t-1]}),eq:ct(function(e,t,n){return[0>n?n+t:n]}),even:ct(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:ct(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:ct(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:ct(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[n]=ft(n);for(n in{submit:!0,reset:!0})i.pseudos[n]=lt(n);u=ut.compile=function(e,t){var n,r=[],i=[],s=k[e+" "];if(!s){t||(t=ht(e)),n=t.length;while(n--)s=yt(t[n]),s[w]?r.push(s):i.push(s);s=k(e,bt(i,r))}return s},i.pseudos.nth=i.pseudos.eq,i.filters=St.prototype=i.pseudos,i.setFilters=new St,l(),ut.attr=b.attr,b.find=ut,b.expr=ut.selectors,b.expr[":"]=b.expr.pseudos,b.unique=ut.uniqueSort,b.text=ut.getText,b.isXMLDoc=ut.isXML,b.contains=ut.contains}(e);var ot=/Until$/,ut=/^(?:parents|prev(?:Until|All))/,at=/^.[^:#\[\.,]*$/,ft=b.expr.match.needsContext,lt={children:!0,contents:!0,next:!0,prev:!0};b.fn.extend({find:function(e){var t,n,r,i=this.length;if("string"!=typeof e)return r=this,this.pushStack(b(e).filter(function(){for(t=0;i>t;t++)if(b.contains(r[t],this))return!0}));for(n=[],t=0;i>t;t++)b.find(e,this[t],n);return n=this.pushStack(i>1?b.unique(n):n),n.selector=(this.selector?this.selector+" ":"")+e,n},has:function(e){var t,n=b(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(b.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ht(this,e,!1))},filter:function(e){return this.pushStack(ht(this,e,!0))},is:function(e){return!!e&&("string"==typeof e?ft.test(e)?b(e,this.context).index(this[0])>=0:b.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=ft.test(e)||"string"!=typeof e?b(e,t||this.context):0;for(;i>r;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&11!==n.nodeType){if(o?o.index(n)>-1:b.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return this.pushStack(s.length>1?b.unique(s):s)},index:function(e){return e?"string"==typeof e?b.inArray(this[0],b(e)):b.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?b(e,t):b.makeArray(e&&e.nodeType?[e]:e),r=b.merge(this.get(),n);return this.pushStack(b.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),b.fn.andSelf=b.fn.addBack,b.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return b.dir(e,"parentNode")},parentsUntil:function(e,t,n){return b.dir(e,"parentNode",n)},next:function(e){return ct(e,"nextSibling")},prev:function(e){return ct(e,"previousSibling")},nextAll:function(e){return b.dir(e,"nextSibling")},prevAll:function(e){return b.dir(e,"previousSibling")},nextUntil:function(e,t,n){return b.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return b.dir(e,"previousSibling",n)},siblings:function(e){return b.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:b.merge([],e.childNodes)}},function(e,t){b.fn[e]=function(n,r){var i=b.map(this,t,n);return ot.test(e)||(r=n),r&&"string"==typeof r&&(i=b.filter(r,i)),i=this.length>1&&!lt[e]?b.unique(i):i,this.length>1&&ut.test(e)&&(i=i.reverse()),this.pushStack(i)}}),b.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?b.find.matchesSelector(t[0],e)?[t[0]]:[]:b.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&9!==s.nodeType&&(r===t||1!==s.nodeType||!b(s).is(r)))1===s.nodeType&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var dt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",vt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+dt+")[\\s/>]","i"),gt=/^\s+/,yt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,wt=/<tbody/i,Et=/<|&#?\w+;/,St=/<(?:script|style|link)/i,xt=/^(?:checkbox|radio)$/i,Tt=/checked\s*(?:[^=]|=\s*.checked.)/i,Nt=/^$|\/(?:java|ecma)script/i,Ct=/^true\/(.*)/,kt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Lt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:b.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},At=pt(s),Ot=At.appendChild(s.createElement("div"));Lt.optgroup=Lt.option,Lt.tbody=Lt.tfoot=Lt.colgroup=Lt.caption=Lt.thead,Lt.th=Lt.td,b.fn.extend({text:function(e){return b.access(this,function(e){return e===t?b.text(this):this.empty().append((this[0]&&this[0].ownerDocument||s).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(b.isFunction(e))return this.each(function(t){b(this).wrapAll(e.call(this,t))});if(this[0]){var t=b(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return b.isFunction(e)?this.each(function(t){b(this).wrapInner(e.call(this,t))}):this.each(function(){var t=b(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=b.isFunction(e);return this.each(function(n){b(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){b.nodeName(this,"body")||b(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=0;for(;null!=(n=this[r]);r++)(!e||b.filter(e,[n]).length>0)&&(t||1!==n.nodeType||b.cleanData(jt(n)),n.parentNode&&(t&&b.contains(n.ownerDocument,n)&&Pt(jt(n,"script")),n.parentNode.removeChild(n)));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&b.cleanData(jt(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&b.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return b.clone(this,e,t)})},html:function(e){return b.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(vt,""):t;if(!("string"!=typeof e||St.test(e)||!b.support.htmlSerialize&&mt.test(e)||!b.support.leadingWhitespace&&gt.test(e)||Lt[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(yt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(b.cleanData(jt(n,!1)),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=b.isFunction(e);return t||"string"==typeof e||(e=b(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,n=this.parentNode;n&&(b(this).remove(),n.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=h.apply([],e);var i,s,o,u,a,f,l=0,c=this.length,p=this,d=c-1,v=e[0],m=b.isFunction(v);if(m||!(1>=c||"string"!=typeof v||b.support.checkClone)&&Tt.test(v))return this.each(function(i){var s=p.eq(i);m&&(e[0]=v.call(this,i,n?s.html():t)),s.domManip(e,n,r)});if(c&&(f=b.buildFragment(e,this[0].ownerDocument,!1,this),i=f.firstChild,1===f.childNodes.length&&(f=i),i)){for(n=n&&b.nodeName(i,"tr"),u=b.map(jt(f,"script"),_t),o=u.length;c>l;l++)s=f,l!==d&&(s=b.clone(s,!0,!0),o&&b.merge(u,jt(s,"script"))),r.call(n&&b.nodeName(this[l],"table")?Mt(this[l],"tbody"):this[l],s,l);if(o)for(a=u[u.length-1].ownerDocument,b.map(u,Dt),l=0;o>l;l++)s=u[l],Nt.test(s.type||"")&&!b._data(s,"globalEval")&&b.contains(a,s)&&(s.src?b.ajax({url:s.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):b.globalEval((s.text||s.textContent||s.innerHTML||"").replace(kt,"")));f=i=null}return this}}),b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){b.fn[e]=function(e){var n,r=0,i=[],s=b(e),o=s.length-1;for(;o>=r;r++)n=r===o?this:this.clone(!0),b(s[r])[t](n),p.apply(i,n.get());return this.pushStack(i)}}),b.extend({clone:function(e,t,n){var r,i,s,o,u,a=b.contains(e.ownerDocument,e);if(b.support.html5Clone||b.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(Ot.innerHTML=e.outerHTML,Ot.removeChild(s=Ot.firstChild)),!(b.support.noCloneEvent&&b.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||b.isXMLDoc(e)))for(r=jt(s),u=jt(e),o=0;null!=(i=u[o]);++o)r[o]&&Bt(i,r[o]);if(t)if(n)for(u=u||jt(e),r=r||jt(s),o=0;null!=(i=u[o]);o++)Ht(i,r[o]);else Ht(e,s);return r=jt(s,"script"),r.length>0&&Pt(r,!a&&jt(e,"script")),r=u=i=null,s},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l,c=e.length,h=pt(t),p=[],d=0;for(;c>d;d++)if(s=e[d],s||0===s)if("object"===b.type(s))b.merge(p,s.nodeType?[s]:s);else if(Et.test(s)){u=u||h.appendChild(t.createElement("div")),a=(bt.exec(s)||["",""])[1].toLowerCase(),l=Lt[a]||Lt._default,u.innerHTML=l[1]+s.replace(yt,"<$1></$2>")+l[2],i=l[0];while(i--)u=u.lastChild;if(!b.support.leadingWhitespace&&gt.test(s)&&p.push(t.createTextNode(gt.exec(s)[0])),!b.support.tbody){s="table"!==a||wt.test(s)?"<table>"!==l[1]||wt.test(s)?0:u:u.firstChild,i=s&&s.childNodes.length;while(i--)b.nodeName(f=s.childNodes[i],"tbody")&&!f.childNodes.length&&s.removeChild(f)}b.merge(p,u.childNodes),u.textContent="";while(u.firstChild)u.removeChild(u.firstChild);u=h.lastChild}else p.push(t.createTextNode(s));u&&h.removeChild(u),b.support.appendChecked||b.grep(jt(p,"input"),Ft),d=0;while(s=p[d++])if((!r||-1===b.inArray(s,r))&&(o=b.contains(s.ownerDocument,s),u=jt(h.appendChild(s),"script"),o&&Pt(u),n)){i=0;while(s=u[i++])Nt.test(s.type||"")&&n.push(s)}return u=null,h},cleanData:function(e,t){var n,r,s,o,u=0,a=b.expando,f=b.cache,c=b.support.deleteExpando,h=b.event.special;for(;null!=(n=e[u]);u++)if((t||b.acceptData(n))&&(s=n[a],o=s&&f[s])){if(o.events)for(r in o.events)h[r]?b.event.remove(n,r):b.removeEvent(n,r,o.handle);f[s]&&(delete f[s],c?delete n[a]:typeof n.removeAttribute!==i?n.removeAttribute(a):n[a]=null,l.push(s))}}});var It,qt,Rt,Ut=/alpha\([^)]*\)/i,zt=/opacity\s*=\s*([^)]*)/,Wt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Vt=/^margin/,$t=RegExp("^("+w+")(.*)$","i"),Jt=RegExp("^("+w+")(?!px)[a-z%]+$","i"),Kt=RegExp("^([+-])=("+w+")","i"),Qt={BODY:"block"},Gt={position:"absolute",visibility:"hidden",display:"block"},Yt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];b.fn.extend({css:function(e,n){return b.access(this,function(e,n,r){var i,s,o={},u=0;if(b.isArray(n)){for(s=qt(e),i=n.length;i>u;u++)o[n[u]]=b.css(e,n[u],!1,s);return o}return r!==t?b.style(e,n,r):b.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:nn(this))?b(this).show():b(this).hide()})}}),b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Rt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":b.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,u,a=b.camelCase(n),f=e.style;if(n=b.cssProps[a]||(b.cssProps[a]=tn(f,a)),u=b.cssHooks[n]||b.cssHooks[a],r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];if(o=typeof r,"string"===o&&(s=Kt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(b.css(e,n)),o="number"),!(null==r||"number"===o&&isNaN(r)||("number"!==o||b.cssNumber[a]||(r+="px"),b.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(f[n]="inherit"),u&&"set"in u&&(r=u.set(e,r,i))===t)))try{f[n]=r}catch(l){}}},css:function(e,n,r,i){var s,o,u,a=b.camelCase(n);return n=b.cssProps[a]||(b.cssProps[a]=tn(e.style,a)),u=b.cssHooks[n]||b.cssHooks[a],u&&"get"in u&&(o=u.get(e,!0,r)),o===t&&(o=Rt(e,n,i)),"normal"===o&&n in Yt&&(o=Yt[n]),""===r||r?(s=parseFloat(o),r===!0||b.isNumeric(s)?s||0:o):o},swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),e.getComputedStyle?(qt=function(t){return e.getComputedStyle(t,null)},Rt=function(e,n,r){var i,s,o,u=r||qt(e),a=u?u.getPropertyValue(n)||u[n]:t,f=e.style;return u&&(""!==a||b.contains(e.ownerDocument,e)||(a=b.style(e,n)),Jt.test(a)&&Vt.test(n)&&(i=f.width,s=f.minWidth,o=f.maxWidth,f.minWidth=f.maxWidth=f.width=a,a=u.width,f.width=i,f.minWidth=s,f.maxWidth=o)),a}):s.documentElement.currentStyle&&(qt=function(e){return e.currentStyle},Rt=function(e,n,r){var i,s,o,u=r||qt(e),a=u?u[n]:t,f=e.style;return null==a&&f&&f[n]&&(a=f[n]),Jt.test(a)&&!Wt.test(n)&&(i=f.left,s=e.runtimeStyle,o=s&&s.left,o&&(s.left=e.currentStyle.left),f.left="fontSize"===n?"1em":a,a=f.pixelLeft+"px",f.left=i,o&&(s.left=o)),""===a?"auto":a}),b.each(["height","width"],function(e,n){b.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(b.css(e,"display"))?b.swap(e,Gt,function(){return un(e,n,i)}):un(e,n,i):t},set:function(e,t,r){var i=r&&qt(e);return sn(e,t,r?on(e,n,r,b.support.boxSizing&&"border-box"===b.css(e,"boxSizing",!1,i),i):0)}}}),b.support.opacity||(b.cssHooks.opacity={get:function(e,t){return zt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=b.isNumeric(t)?"alpha(opacity="+100*t+")":"",s=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===b.trim(s.replace(Ut,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=Ut.test(s)?s.replace(Ut,i):s+" "+i)}}),b(function(){b.support.reliableMarginRight||(b.cssHooks.marginRight={get:function(e,n){return n?b.swap(e,{display:"inline-block"},Rt,[e,"marginRight"]):t}}),!b.support.pixelPosition&&b.fn.position&&b.each(["top","left"],function(e,n){b.cssHooks[n]={get:function(e,r){return r?(r=Rt(e,n),Jt.test(r)?b(e).position()[n]+"px":r):t}}})}),b.expr&&b.expr.filters&&(b.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!b.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||b.css(e,"display"))},b.expr.filters.visible=function(e){return!b.expr.filters.hidden(e)}),b.each({margin:"",padding:"",border:"Width"},function(e,t){b.cssHooks[e+t]={expand:function(n){var r=0,i={},s="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+Zt[r]+t]=s[r]||s[r-2]||s[0];return i}},Vt.test(e)||(b.cssHooks[e+t].set=sn)});var ln=/%20/g,cn=/\[\]$/,hn=/\r?\n/g,pn=/^(?:submit|button|image|reset|file)$/i,dn=/^(?:input|select|textarea|keygen)/i;b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,"elements");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(":disabled")&&dn.test(this.nodeName)&&!pn.test(e)&&(this.checked||!xt.test(e))}).map(function(e,t){var n=b(this).val();return null==n?null:b.isArray(n)?b.map(n,function(e){return{name:t.name,value:e.replace(hn,"\r\n")}}):{name:t.name,value:n.replace(hn,"\r\n")}}).get()}}),b.param=function(e,n){var r,i=[],s=function(e,t){t=b.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=b.ajaxSettings&&b.ajaxSettings.traditional),b.isArray(e)||e.jquery&&!b.isPlainObject(e))b.each(e,function(){s(this.name,this.value)});else for(r in e)vn(r,e[r],n,s);return i.join("&").replace(ln,"+")},b.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){b.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),b.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var mn,gn,yn=b.now(),bn=/\?/,wn=/#.*$/,En=/([?&])_=[^&]*/,Sn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,xn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Tn=/^(?:GET|HEAD)$/,Nn=/^\/\//,Cn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,kn=b.fn.load,Ln={},An={},On="*/".concat("*");try{gn=o.href}catch(Mn){gn=s.createElement("a"),gn.href="",gn=gn.href}mn=Cn.exec(gn.toLowerCase())||[],b.fn.load=function(e,n,r){if("string"!=typeof e&&kn)return kn.apply(this,arguments);var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),b.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(o="POST"),u.length>0&&b.ajax({url:e,type:o,dataType:"html",data:n}).done(function(e){s=arguments,u.html(i?b("<div>").append(b.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){u.each(r,s||[e.responseText,t,e])}),this},b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}}),b.each(["get","post"],function(e,n){b[n]=function(e,r,i,s){return b.isFunction(r)&&(s=s||i,i=r,r=t),b.ajax({url:e,type:n,dataType:s,data:r,success:i})}}),b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:gn,type:"GET",isLocal:xn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":On,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":b.parseJSON,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Pn(Pn(e,b.ajaxSettings),t):Pn(b.ajaxSettings,e)},ajaxPrefilter:_n(Ln),ajaxTransport:_n(An),ajax:function(e,n){function N(e,n,r,i){var l,g,y,E,S,T=n;2!==w&&(w=2,u&&clearTimeout(u),f=t,o=i||"",x.readyState=e>0?4:0,r&&(E=Hn(c,x,r)),e>=200&&300>e||304===e?(c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(b.lastModified[s]=S),S=x.getResponseHeader("etag"),S&&(b.etag[s]=S)),204===e?(l=!0,T="nocontent"):304===e?(l=!0,T="notmodified"):(l=Bn(c,E),T=l.state,g=l.data,y=l.error,l=!y)):(y=T,(e||!T)&&(T="error",0>e&&(e=0))),x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[g,T,x]):d.rejectWith(h,[x,T,y]),x.statusCode(m),m=t,a&&p.trigger(l?"ajaxSuccess":"ajaxError",[x,c,l?g:y]),v.fireWith(h,[x,T]),a&&(p.trigger("ajaxComplete",[x,c]),--b.active||b.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=b.ajaxSetup({},n),h=c.context||c,p=c.context&&(h.nodeType||h.jquery)?b(h):b.event,d=b.Deferred(),v=b.Callbacks("once memory"),m=c.statusCode||{},g={},y={},w=0,S="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!l){l={};while(t=Sn.exec(o))l[t[1].toLowerCase()]=t[2]}t=l[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return w||(e=y[n]=y[n]||e,g[e]=t),this},overrideMimeType:function(e){return w||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>w)for(t in e)m[t]=[m[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||S;return f&&f.abort(t),N(0,t),this}};if(d.promise(x).complete=v.add,x.success=x.done,x.error=x.fail,c.url=((e||c.url||gn)+"").replace(wn,"").replace(Nn,mn[1]+"//"),c.type=n.method||n.type||c.method||c.type,c.dataTypes=b.trim(c.dataType||"*").toLowerCase().match(E)||[""],null==c.crossDomain&&(r=Cn.exec(c.url.toLowerCase()),c.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?80:443))==(mn[3]||("http:"===mn[1]?80:443)))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=b.param(c.data,c.traditional)),Dn(Ln,c,n,x),2===w)return x;a=c.global,a&&0===b.active++&&b.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!Tn.test(c.type),s=c.url,c.hasContent||(c.data&&(s=c.url+=(bn.test(s)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=En.test(s)?s.replace(En,"$1_="+yn++):s+(bn.test(s)?"&":"?")+"_="+yn++)),c.ifModified&&(b.lastModified[s]&&x.setRequestHeader("If-Modified-Since",b.lastModified[s]),b.etag[s]&&x.setRequestHeader("If-None-Match",b.etag[s])),(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+On+"; q=0.01":""):c.accepts["*"]);for(i in c.headers)x.setRequestHeader(i,c.headers[i]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&2!==w){S="abort";for(i in{success:1,error:1,complete:1})x[i](c[i]);if(f=Dn(An,c,n,x)){x.readyState=1,a&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{w=1,f.send(g,N)}catch(T){if(!(2>w))throw T;N(-1,T)}}else N(-1,"No Transport");return x}return x.abort()},getScript:function(e,n){return b.get(e,t,n,"script")},getJSON:function(e,t,n){return b.get(e,t,n,"json")}}),b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return b.globalEval(e),e}}}),b.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),b.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=s.head||b("head")[0]||s.documentElement;return{send:function(t,i){n=s.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var jn=[],Fn=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=jn.pop()||b.expando+"_"+yn++;return this[e]=!0,e}}),b.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.jsonp!==!1&&(Fn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Fn.test(n.data)&&"data");return a||"jsonp"===n.dataTypes[0]?(s=n.jsonpCallback=b.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,a?n[a]=n[a].replace(Fn,"$1"+s):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||b.error(s+" was not called"),u[0]},n.dataTypes[0]="json",o=e[s],e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,jn.push(s)),u&&b.isFunction(o)&&o(u[0]),u=o=t}),"script"):t});var In,qn,Rn=0,Un=e.ActiveXObject&&function(){var e;for(e in In)In[e](t,!0)};b.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&zn()||Wn()}:zn,qn=b.ajaxSettings.xhr(),b.support.cors=!!qn&&"withCredentials"in qn,qn=b.support.ajax=!!qn,qn&&b.ajaxTransport(function(n){if(!n.crossDomain||b.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();if(n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async),n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c;try{if(r&&(i||4===a.readyState))if(r=t,o&&(a.onreadystatechange=b.noop,Un&&delete In[o]),i)4!==a.readyState&&a.abort();else{c={},u=a.status,f=a.getAllResponseHeaders(),"string"==typeof a.responseText&&(c.text=a.responseText);try{l=a.statusText}catch(h){l=""}u||!n.isLocal||n.crossDomain?1223===u&&(u=204):u=c.text?200:404}}catch(p){i||s(-1,p)}c&&s(u,l,c,f)},n.async?4===a.readyState?setTimeout(r):(o=++Rn,Un&&(In||(In={},b(e).unload(Un)),In[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Vn,$n=/^(?:toggle|show|hide)$/,Jn=RegExp("^(?:([+-])=|)("+w+")([a-z%]*)$","i"),Kn=/queueHooks$/,Qn=[nr],Gn={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=Jn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){if(n=+s[2],r=s[3]||(b.cssNumber[e]?"":"px"),"px"!==r&&u){u=b.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,b.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&1!==a&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};b.Animation=b.extend(er,{tweener:function(e,t){b.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Gn[n]=Gn[n]||[],Gn[n].unshift(t)},prefilter:function(e,t){t?Qn.unshift(e):Qn.push(e)}}),b.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(b.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=b.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){b.fx.step[e.prop]?b.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[b.cssProps[e.prop]]||b.cssHooks[e.prop])?b.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},b.each(["toggle","show","hide"],function(e,t){var n=b.fn[t];b.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),b.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=b.isEmptyObject(e),s=b.speed(t,n,r),o=function(){var t=er(this,b.extend({},e),s);o.finish=function(){t.stop(!0)},(i||b._data(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",s=b.timers,o=b._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Kn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem!==this||null!=e&&s[n].queue!==e||(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&b.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=b._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=b.timers,o=r?r.length:0;for(n.finish=!0,b.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),b.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){b.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),b.speed=function(e,t,n){var r=e&&"object"==typeof e?b.extend({},e):{complete:n||!n&&t||b.isFunction(e)&&e,duration:e,easing:n&&t||t&&!b.isFunction(t)&&t};return r.duration=b.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in b.fx.speeds?b.fx.speeds[r.duration]:b.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){b.isFunction(r.old)&&r.old.call(this),r.queue&&b.dequeue(this,r.queue)},r},b.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},b.timers=[],b.fx=rr.prototype.init,b.fx.tick=function(){var e,n=b.timers,r=0;for(Xn=b.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||b.fx.stop(),Xn=t},b.fx.timer=function(e){e()&&b.timers.push(e)&&b.fx.start()},b.fx.interval=13,b.fx.start=function(){Vn||(Vn=setInterval(b.fx.tick,b.fx.interval))},b.fx.stop=function(){clearInterval(Vn),Vn=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fx.step={},b.expr&&b.expr.filters&&(b.expr.filters.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length}),b.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){b.offset.setOffset(this,e,t)});var n,r,s={top:0,left:0},o=this[0],u=o&&o.ownerDocument;if(u)return n=u.documentElement,b.contains(n,o)?(typeof o.getBoundingClientRect!==i&&(s=o.getBoundingClientRect()),r=sr(u),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):s},b.offset={setOffset:function(e,t,n){var r=b.css(e,"position");"static"===r&&(e.style.position="relative");var i=b(e),s=i.offset(),o=b.css(e,"top"),u=b.css(e,"left"),a=("absolute"===r||"fixed"===r)&&b.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),b.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(f.top=t.top-s.top+c),null!=t.left&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},b.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===b.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),b.nodeName(e[0],"html")||(n=e.offset()),n.top+=b.css(e[0],"borderTopWidth",!0),n.left+=b.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-b.css(r,"marginTop",!0),left:t.left-n.left-b.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s.documentElement;while(e&&!b.nodeName(e,"html")&&"static"===b.css(e,"position"))e=e.offsetParent;return e||s.documentElement})}}),b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);b.fn[e]=function(i){return b.access(this,function(e,i,s){var o=sr(e);return s===t?o?n in o?o[n]:o.document.documentElement[i]:e[i]:(o?o.scrollTo(r?b(o).scrollLeft():s,r?s:b(o).scrollTop()):e[i]=s,t)},e,i,arguments.length,null)}}),b.each({Height:"height",Width:"width"},function(e,n){b.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){b.fn[i]=function(i,s){var o=arguments.length&&(r||"boolean"!=typeof i),u=r||(i===!0||s===!0?"margin":"border");return b.access(this,function(n,r,i){var s;return b.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?b.css(n,r,u):b.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=b,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return b})}(window),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){return e instanceof x?e:this instanceof x?void (this._wrapped=e):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.6.0";var T=x.each=x.forEach=function(e,t,r){if(null==e)return e;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;s>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o=x.keys(e),i=0,s=o.length;s>i;i++)if(t.call(r,e[o[i]],o[i],e)===n)return;return e};x.map=x.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}if(T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){return t.call(n,e,i,s)?(r=e,!0):void 0}),r},x.filter=x.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return null==e?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){return(i=i&&t.call(r,e,s,o))?void 0:n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return null==e?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){return i||(i=t.call(r,e,s,o))?n:void 0}),!!i)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,x.property(t))},x.where=function(e,t){return x.filter(e,x.matches(t))},x.findWhere=function(e,t){return x.find(e,x.matches(t))},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var r=-1/0,i=-1/0;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u>i&&(r=e,i=u)}),r},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var r=1/0,i=1/0;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;i>u&&(r=e,i=u)}),r},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r},x.sample=function(e,t,n){return null==t||n?(e.length!==+e.length&&(e=x.values(e)),e[x.random(e.length-1)]):x.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return null==e?x.identity:x.isFunction(e)?e:x.property(e)};x.sortBy=function(e,t,n){return t=k(t),x.pluck(x.map(e,function(e,r,i){return{value:e,index:r,criteria:t.call(n,e,r,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(r>n||r===void 0)return-1}return e.index-t.index}),"value")};var L=function(e){return function(t,n,r){var i={};return n=k(n),T(t,function(s,o){var u=n.call(r,s,o,t);e(i,u,s)}),i}};x.groupBy=L(function(e,t,n){x.has(e,t)?e[t].push(n):e[t]=[n]}),x.indexBy=L(function(e,t,n){e[t]=n}),x.countBy=L(function(e,t){x.has(e,t)?e[t]++:e[t]=1}),x.sortedIndex=function(e,t,n,r){n=k(n);for(var i=n.call(r,t),s=0,o=e.length;o>s;){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:0>t?[]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.partition=function(e,t){var n=[],r=[];return T(e,function(e){(t(e)?n:r).push(e)}),[n,r]},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){(t?r&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(e[r]))}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.contains(t,e)})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;e>n;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);r>i;)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){for(var n=0,r=t.slice(),i=0,s=r.length;s>i;i++)r[i]===x&&(r[i]=arguments[n++]);for(;n<arguments.length;)r.push(arguments[n++]);return e.apply(this,r)}},x.bindAll=function(e){var t=u.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:x.now(),o=null,s=e.apply(r,i),r=i=null};return function(){var f=x.now();u||n.leading!==!1||(u=f);var l=t-(f-u);return r=this,i=arguments,0>=l?(clearTimeout(o),o=null,u=f,s=e.apply(r,i),r=i=null):o||n.trailing===!1||(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i,s,o,u,a=function(){var f=x.now()-o;t>f?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i),s=i=null))};return function(){s=this,i=arguments,o=x.now();var f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i),s=i=null),u}},x.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return x.partial(t,e)},x.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},x.keys=function(e){if(!x.isObject(e))return[];if(E)return E(e);var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){for(var t=x.keys(e),n=t.length,r=new Array(n),i=0;n>i;i++)r[i]=e[t[i]];return r},x.pairs=function(e){for(var t=x.keys(e),n=t.length,r=new Array(n),i=0;n>i;i++)r[i]=[t[i],e[t[i]]];return r},x.invert=function(e){for(var t={},n=x.keys(e),r=0,i=n.length;i>r;r++)t[e[n[r]]]=n[r];return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1;n.push(e),r.push(t);var a=0,l=!0;if("[object Array]"==i){if(a=e.length,l=a==t.length)for(;a--&&(l=M(e[a],t[a],n,r)););}else{for(var c in e)if(x.has(e,c)&&(a++,!(l=x.has(t,c)&&M(e[c],t[c],n,r))))break;if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&1===e.nodeType},x.isArray=w||function(e){return"[object Array]"==f.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),"function"!=typeof /./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.constant=function(e){return function(){return e}},x.property=function(e){return function(t){return t[e]}},x.matches=function(e){return function(t){if(t===e)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0}},x.times=function(e,t,n){for(var r=Array(Math.max(0,e)),i=0;e>i;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},x.now=Date.now||function(){return(new Date).getTime()};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(null==e)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}.call(this),function(e,t){if(typeof define=="function"&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,r,i){e.Backbone=t(e,i,n,r)});else if(typeof exports!="undefined"){var n=require("underscore");t(e,exports,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,r){var i=e.Backbone,s=[],o=s.push,u=s.slice,a=s.splice;t.VERSION="1.1.2",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var f=t.Events={on:function(e,t,n){if(!c(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,r){if(!c(this,"once",e,[t,r])||!t)return this;var i=this,s=n.once(function(){i.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,r)},off:function(e,t,r){var i,s,o,u,a,f,l,h;if(!this._events||!c(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;u=e?[e]:n.keys(this._events);for(a=0,f=u.length;a<f;a++){e=u[a];if(o=this._events[e]){this._events[e]=i=[];if(t||r)for(l=0,h=o.length;l<h;l++)s=o[l],(t&&t!==s.callback&&t!==s.callback._callback||r&&r!==s.context)&&i.push(s);i.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=u.call(arguments,1);if(!c(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&h(n,t),r&&h(r,arguments),this},stopListening:function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=!t&&!r;!r&&typeof t=="object"&&(r=this),e&&((i={})[e._listenId]=e);for(var o in i)e=i[o],e.off(t,r,this),(s||n.isEmpty(e._events))&&delete this._listeningTo[o];return this}},l=/\s+/,c=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(l.test(n)){var s=n.split(l);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},h=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t);return}},p={listenTo:"on",listenToOnce:"once"};n.each(p,function(e,t){f[t]=function(t,r,i){var s=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=n.uniqueId("l"));return s[o]=t,!i&&typeof r=="object"&&(i=this),t[e](r,i,this),this}}),f.bind=f.on,f.unbind=f.off,n.extend(t,f);var d=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(d.prototype,f,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,r){var i,s,o,u,a,f,l,c;if(e==null)return this;typeof e=="object"?(s=e,r=t):(s={})[e]=t,r||(r={});if(!this._validate(s,r))return!1;o=r.unset,a=r.silent,u=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=n.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(i in s)t=s[i],n.isEqual(c[i],t)||u.push(i),n.isEqual(l[i],t)?delete this.changed[i]:this.changed[i]=t,o?delete c[i]:c[i]=t;if(!a){u.length&&(this._pending=r);for(var h=0,p=u.length;h<p;h++)this.trigger("change:"+u[h],this,c[u[h]],r)}if(f)return this;if(!a)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,r=!1,i=this._changing?this._previousAttributes:this.attributes;for(var s in e){if(n.isEqual(i[s],t=e[s]))continue;(r||(r={}))[s]=t}return r},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,r=e.success;return e.success=function(n){if(!t.set(t.parse(n,e),e))return!1;r&&r(t,n,e),t.trigger("sync",t,n,e)},I(this,e),this.sync("read",this,e)},save:function(e,t,r){var i,s,o,u=this.attributes;e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0},r);if(i&&!r.wait){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;i&&r.wait&&(this.attributes=n.extend({},u,i)),r.parse===void 0&&(r.parse=!0);var a=this,f=r.success;return r.success=function(e){a.attributes=u;var t=a.parse(e,r);r.wait&&(t=n.extend(i||{},t));if(n.isObject(t)&&!a.set(t,r))return!1;f&&f(a,e,r),a.trigger("sync",a,e,r)},I(this,r),s=this.isNew()?"create":r.patch?"patch":"update",s==="patch"&&(r.attrs=i),o=this.sync(s,this,r),i&&r.wait&&(this.attributes=u),o},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(n){(e.wait||t.isNew())&&i(),r&&r(t,n,e),t.isNew()||t.trigger("sync",t,n,e)};if(this.isNew())return e.success(),!1;I(this,e);var s=this.sync("delete",this,e);return e.wait||i(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||F();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];n.each(v,function(e){d.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var m=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,remove:!1};n.extend(m.prototype,f,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,y))},remove:function(e,t){var r=!n.isArray(e);e=r?[e]:n.clone(e),t||(t={});var i,s,o,u;for(i=0,s=e.length;i<s;i++){u=e[i]=this.get(e[i]);if(!u)continue;delete this._byId[u.id],delete this._byId[u.cid],o=this.indexOf(u),this.models.splice(o,1),this.length--,t.silent||(t.index=o,u.trigger("remove",u,this,t)),this._removeReference(u,t)}return r?e[0]:e},set:function(e,t){t=n.defaults({},t,g),t.parse&&(e=this.parse(e,t));var r=!n.isArray(e);e=r?e?[e]:[]:n.clone(e);var i,s,o,u,a,f,l,c=t.at,h=this.model,p=this.comparator&&c==null&&t.sort!==!1,v=n.isString(this.comparator)?this.comparator:null,m=[],y=[],b={},w=t.add,E=t.merge,S=t.remove,x=!p&&w&&S?[]:!1;for(i=0,s=e.length;i<s;i++){a=e[i]||{},a instanceof d?o=u=a:o=a[h.prototype.idAttribute||"id"];if(f=this.get(o))S&&(b[f.cid]=!0),E&&(a=a===u?u.attributes:a,t.parse&&(a=f.parse(a,t)),f.set(a,t),p&&!l&&f.hasChanged(v)&&(l=!0)),e[i]=f;else if(w){u=e[i]=this._prepareModel(a,t);if(!u)continue;m.push(u),this._addReference(u,t)}u=f||u,x&&(u.isNew()||!b[u.id])&&x.push(u),b[u.id]=!0}if(S){for(i=0,s=this.length;i<s;++i)b[(u=this.models[i]).cid]||y.push(u);y.length&&this.remove(y,t)}if(m.length||x&&x.length){p&&(l=!0),this.length+=m.length;if(c!=null)for(i=0,s=m.length;i<s;i++)this.models.splice(c+i,0,m[i]);else{x&&(this.models.length=0);var T=x||m;for(i=0,s=T.length;i<s;i++)this.models.push(T[i])}}l&&this.sort({silent:!0});if(!t.silent){for(i=0,s=m.length;i<s;i++)(u=m[i]).trigger("add",u,this,t);(l||x&&x.length)&&this.trigger("sort",this,t)}return r?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,i=this.models.length;r<i;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return u.apply(this.models,arguments)},get:function(e){return e==null?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t(r,n,e),r.trigger("sync",r,n,e)},I(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var r=this,i=t.success;return t.success=function(e,n){t.wait&&r.add(e,t),i&&i(e,n,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_addReference:function(e,t){this._byId[e.cid]=e,e.id!=null&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(b,function(e){m.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var w=["groupBy","countBy","sortBy","indexBy"];n.each(w,function(e){m.prototype[e]=function(t,r){var i=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,i,r)}});var E=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,x)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];n.extend(E.prototype,f,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r)||(r=this[e[t]]);if(!r)continue;var i=t.match(S),s=i[1],o=i[2];r=n.bind(r,this),s+=".delegateEvents"+this.cid,o===""?this.$el.on(s,r):this.$el.on(s,o,r)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(!this.el){var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var r=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(r,!1)}else this.setElement(n.result(this,"el"),!1)}}),t.sync=function(e,r,i){var s=N[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||F()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1),o.type==="PATCH"&&T&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,a,i),a};var T=typeof window!="undefined"&&!!window.ActiveXObject&&(!window.XMLHttpRequest||!(new XMLHttpRequest).dispatchEvent),N={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var C=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},k=/\((.*?)\)/g,L=/(\(\?)?:\w+/g,A=/\*\w+/g,O=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(C.prototype,f,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o),s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(!this.routes)return;this.routes=n.result(this,"routes");var e,t=n.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(O,"\\$&").replace(k,"(?:$1)?").replace(L,function(e,t){return t?e:"([^/?]+)"}).replace(A,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var M=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},_=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,P=/msie [\w.]+/,H=/\/$/,B=/#.*$/;M.started=!1,n.extend(M.prototype,f,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(H,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(_,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");M.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var r=this.getFragment(),i=document.documentMode,s=P.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(D,"/");if(s&&this._wantsHashChange){var o=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(r)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=r;var u=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&u.hash&&(this.fragment=this.getHash().replace(_,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),M.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!M.started)return!1;if(!t||t===!0)t={trigger:!!t};var n=this.root+(e=this.getFragment(e||""));e=e.replace(B,"");if(this.fragment===e)return;this.fragment=e,e===""&&n!=="/"&&(n=n.slice(0,-1));if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new M;var j=function(e,t){var r=this,i;e&&n.has(e,"constructor")?i=e.constructor:i=function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};d.extend=m.extend=C.extend=E.extend=M.extend=j;var F=function(){throw new Error('A "url" property or function must be specified')},I=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}};return t});var Detector={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(e){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <ul><a href="http://get.webgl.org/" style="color:#000">WebGL</a></ul>.<br />','Find out how to get it <ul><a  target="_blank" href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">here</a></ul>.'].join("\n"):['Your browser does not seem to support <ul><a href="http://get.webgl.org/" style="color:#000">WebGL</a></ul>.<br/>','Find out how to get it <ul><a  target="_blank" href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">here</a></ul>.'].join("\n")),e},addGetWebGLMessage:function(e){var t,n,r;e=e||{},t=e.parent!==undefined?e.parent:document.body,n=e.id!==undefined?e.id:"oldie",r=Detector.getWebGLErrorMessage(),r.id=n,t.appendChild(r)}};define("vendor/Detector",function(){});var THREE={REVISION:"65"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}},String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},THREE.extend=function(e,t){if(Object.keys)for(var n=Object.keys(t),r=0,i=n.length;r<i;r++){var s=n[r];Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}else for(s in n={}.hasOwnProperty,t)n.call(t,s)&&(e[s]=t[s]);return e},function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!self.requestAnimationFrame;++n)self.requestAnimationFrame=self[t[n]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[t[n]+"CancelAnimationFrame"]||self[t[n]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(t){var n=Date.now(),r=Math.max(0,16-(n-e)),i=self.setTimeout(function(){t(n+r)},r);return e=n+r,i}),void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(e){self.clearTimeout(e)})}(),THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.NoShading=0,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.UVMapping=function(){},THREE.CubeReflectionMapping=function(){},THREE.CubeRefractionMapping=function(){},THREE.SphericalReflectionMapping=function(){},THREE.SphericalRefractionMapping=function(){},THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.Color=function(e){return void 0!==e&&this.set(e),this},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(e){return e instanceof THREE.Color?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){if(0===t)this.r=this.g=this.b=n;else{var r=function(e,t,n){return 0>n&&(n+=1),1<n&&(n-=1),n<1/6?e+6*(t-e)*n:.5>n?t:n<2/3?e+6*(t-e)*(2/3-n):e},t=.5>=n?n*(1+t):n+t-n*t,n=2*n-t;this.r=r(n,t,e+1/3),this.g=r(n,t,e),this.b=r(n,t,e-1/3)}return this},setStyle:function(e){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(e))return e=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(e),this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,this;if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(e))return e=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(e),this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,this;if(/^\#([0-9a-f]{6})$/i.test(e))return e=/^\#([0-9a-f]{6})$/i.exec(e),this.setHex(parseInt(e[1],16)),this;if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e))return e=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e),this.setHex(parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3],16)),this;if(/^(\w+)$/i.test(e))return this.setHex(THREE.ColorKeywords[e]),this},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e){return this.r=e.r*e.r,this.g=e.g*e.g,this.b=e.b*e.b,this},copyLinearToGamma:function(e){return this.r=Math.sqrt(e.r),this.g=Math.sqrt(e.g),this.b=Math.sqrt(e.b),this},convertGammaToLinear:function(){var e=this.r,t=this.g,n=this.b;return this.r=e*e,this.g=t*t,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var e=e||{h:0,s:0,l:0},t=this.r,n=this.g,r=this.b,i=Math.max(t,n,r),s=Math.min(t,n,r),o,u=(s+i)/2;if(s===i)s=o=0;else{var a=i-s,s=.5>=u?a/(i+s):a/(2-i-s);switch(i){case t:o=(n-r)/a+(n<r?6:0);break;case n:o=(r-t)/a+2;break;case r:o=(t-n)/a+4}o/=6}return e.h=o,e.s=s,e.l=u,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){var r=this.getHSL();return r.h+=e,r.s+=t,r.l+=n,this.setHSL(r.h,r.s,r.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e){return this.r=e[0],this.g=e[1],this.b=e[2],this},toArray:function(){return[this.r,this.g,this.b]},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}},THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},THREE.Quaternion=function(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==r?r:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,_euler:void 0,_updateEuler:function(){void 0!==this._euler&&this._euler.setFromQuaternion(this,void 0,!1)},get x(){return this._x},set x(e){this._x=e,this._updateEuler()},get y(){return this._y},set y(e){this._y=e,this._updateEuler()},get z(){return this._z},set z(e){this._z=e,this._updateEuler()},get w(){return this._w},set w(e){this._w=e,this._updateEuler()},set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._updateEuler(),this},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._w=e._w,this._updateEuler(),this},setFromEuler:function(e,t){if(0==e instanceof THREE.Euler)throw Error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var n=Math.cos(e._x/2),r=Math.cos(e._y/2),i=Math.cos(e._z/2),s=Math.sin(e._x/2),o=Math.sin(e._y/2),u=Math.sin(e._z/2);return"XYZ"===e.order?(this._x=s*r*i+n*o*u,this._y=n*o*i-s*r*u,this._z=n*r*u+s*o*i,this._w=n*r*i-s*o*u):"YXZ"===e.order?(this._x=s*r*i+n*o*u,this._y=n*o*i-s*r*u,this._z=n*r*u-s*o*i,this._w=n*r*i+s*o*u):"ZXY"===e.order?(this._x=s*r*i-n*o*u,this._y=n*o*i+s*r*u,this._z=n*r*u+s*o*i,this._w=n*r*i-s*o*u):"ZYX"===e.order?(this._x=s*r*i-n*o*u,this._y=n*o*i+s*r*u,this._z=n*r*u-s*o*i,this._w=n*r*i+s*o*u):"YZX"===e.order?(this._x=s*r*i+n*o*u,this._y=n*o*i+s*r*u,this._z=n*r*u-s*o*i,this._w=n*r*i-s*o*u):"XZY"===e.order&&(this._x=s*r*i-n*o*u,this._y=n*o*i-s*r*u,this._z=n*r*u+s*o*i,this._w=n*r*i+s*o*u),!1!==t&&this._updateEuler(),this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._updateEuler(),this},setFromRotationMatrix:function(e){var t=e.elements,n=t[0],e=t[4],r=t[8],i=t[1],s=t[5],o=t[9],u=t[2],a=t[6],t=t[10],f=n+s+t;return 0<f?(n=.5/Math.sqrt(f+1),this._w=.25/n,this._x=(a-o)*n,this._y=(r-u)*n,this._z=(i-e)*n):n>s&&n>t?(n=2*Math.sqrt(1+n-s-t),this._w=(a-o)/n,this._x=.25*n,this._y=(e+i)/n,this._z=(r+u)/n):s>t?(n=2*Math.sqrt(1+s-n-t),this._w=(r-u)/n,this._x=(e+i)/n,this._y=.25*n,this._z=(o+a)/n):(n=2*Math.sqrt(1+t-n-s),this._w=(i-e)/n,this._x=(r+u)/n,this._y=(o+a)/n,this._z=.25*n),this._updateEuler(),this},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._updateEuler(),this},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._z=this._y=this._x=0,this._w=1):(e=1/e,this._x*=e,this._y*=e,this._z*=e,this._w*=e),this},multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,s=e._w,o=t._x,u=t._y,a=t._z,f=t._w;return this._x=n*f+s*o+r*a-i*u,this._y=r*f+s*u+i*o-n*a,this._z=i*f+s*a+n*u-r*o,this._w=s*f-n*o-r*u-i*a,this._updateEuler(),this},multiplyVector3:function(e){return console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},slerp:function(e,t){var n=this._x,r=this._y,i=this._z,s=this._w,o=s*e._w+n*e._x+r*e._y+i*e._z;0>o?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e);if(1<=o)return this._w=s,this._x=n,this._y=r,this._z=i,this;var u=Math.acos(o),a=Math.sqrt(1-o*o);return.001>Math.abs(a)?(this._w=.5*(s+this._w),this._x=.5*(n+this._x),this._y=.5*(r+this._y),this._z=.5*(i+this._z),this):(o=Math.sin((1-t)*u)/a,u=Math.sin(t*u)/a,this._w=s*o+this._w*u,this._x=n*o+this._x*u,this._y=r*o+this._y*u,this._z=i*o+this._z*u,this._updateEuler(),this)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],this._w=e[3],this._updateEuler(),this},toArray:function(){return[this._x,this._y,this._z,this._w]},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}},THREE.Quaternion.slerp=function(e,t,n,r){return n.copy(e).slerp(t,r)},THREE.Vector2=function(e,t){this.x=e||0,this.y=t||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScalar:function(e){return this.x+=e,this.y+=e,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divideScalar:function(e){return 0!==e?(e=1/e,this.x*=e,this.y*=e):this.y=this.x=0,this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,e=this.y-e.y;return t*t+e*e},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e){return this.x=e[0],this.y=e[1],this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z,e=e.elements;return this.x=e[0]*t+e[3]*n+e[6]*r,this.y=e[1]*t+e[4]*n+e[7]*r,this.z=e[2]*t+e[5]*n+e[8]*r,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,e=e.elements;return this.x=e[0]*t+e[4]*n+e[8]*r+e[12],this.y=e[1]*t+e[5]*n+e[9]*r+e[13],this.z=e[2]*t+e[6]*n+e[10]*r+e[14],this},applyProjection:function(e){var t=this.x,n=this.y,r=this.z,e=e.elements,i=1/(e[3]*t+e[7]*n+e[11]*r+e[15]);return this.x=(e[0]*t+e[4]*n+e[8]*r+e[12])*i,this.y=(e[1]*t+e[5]*n+e[9]*r+e[13])*i,this.z=(e[2]*t+e[6]*n+e[10]*r+e[14])*i,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,s=e.y,o=e.z,e=e.w,u=e*t+s*r-o*n,a=e*n+o*t-i*r,f=e*r+i*n-s*t,t=-i*t-s*n-o*r;return this.x=u*e+t*-i+a*-o-f*-s,this.y=a*e+t*-s+f*-i-u*-o,this.z=f*e+t*-o+u*-s-a*-i,this},transformDirection:function(e){var t=this.x,n=this.y,r=this.z,e=e.elements;return this.x=e[0]*t+e[4]*n+e[8]*r,this.y=e[1]*t+e[5]*n+e[9]*r,this.z=e[2]*t+e[6]*n+e[10]*r,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return 0!==e?(e=1/e,this.x*=e,this.y*=e,this.z*=e):this.z=this.y=this.x=0,this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},cross:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,r=this.y,i=this.z;return this.x=r*e.z-i*e.y,this.y=i*e.x-n*e.z,this.z=n*e.y-r*e.x,this},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,s=t.x,o=t.y,u=t.z;return this.x=r*u-i*o,this.y=i*s-n*u,this.z=n*o-r*s,this},angleTo:function(e){return e=this.dot(e)/(this.length()*e.length()),Math.acos(THREE.Math.clamp(e,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,e=this.z-e.z;return t*t+n*n+e*e},setEulerFromRotationMatrix:function(){console.error("REMOVED: Vector3's setEulerFromRotationMatrix has been removed in favor of Euler.setFromRotationMatrix(), please update your code.")},setEulerFromQuaternion:function(){console.error("REMOVED: Vector3's setEulerFromQuaternion: has been removed in favor of Euler.setFromQuaternion(), please update your code.")},getPositionFromMatrix:function(e){return console.warn("DEPRECATED: Vector3's .getPositionFromMatrix() has been renamed to .setFromMatrixPosition(). Please update your code."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("DEPRECATED: Vector3's .getScaleFromMatrix() has been renamed to .setFromMatrixScale(). Please update your code."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("DEPRECATED: Vector3's .getColumnFromMatrix() has been renamed to .setFromMatrixColumn(). Please update your code."),this.setFromMatrixColumn(e,t)},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),e=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=n,this.z=e,this},setFromMatrixColumn:function(e,t){var n=4*e,r=t.elements;return this.x=r[n],this.y=r[n+1],this.z=r[n+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}},THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var e=new THREE.Quaternion;return function(t){return 0==t instanceof THREE.Euler&&console.error("ERROR: Vector3's .applyEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code."),this.applyQuaternion(e.setFromEuler(t)),this}}(),applyAxisAngle:function(){var e=new THREE.Quaternion;return function(t,n){return this.applyQuaternion(e.setFromAxisAngle(t,n)),this}}(),projectOnVector:function(){var e=new THREE.Vector3;return function(t){return e.copy(t).normalize(),t=this.dot(e),this.copy(e).multiplyScalar(t)}}(),projectOnPlane:function(){var e=new THREE.Vector3;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new THREE.Vector3;return function(t){return e.copy(this).projectOnVector(t).multiplyScalar(2),this.subVectors(e,this)}}()}),THREE.Vector4=function(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,e=e.elements;return this.x=e[0]*t+e[4]*n+e[8]*r+e[12]*i,this.y=e[1]*t+e[5]*n+e[9]*r+e[13]*i,this.z=e[2]*t+e[6]*n+e[10]*r+e[14]*i,this.w=e[3]*t+e[7]*n+e[11]*r+e[15]*i,this},divideScalar:function(e){return 0!==e?(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e):(this.z=this.y=this.x=0,this.w=1),this},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return 1e-4>t?(this.x=1,this.z=this.y=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,r,e=e.elements,i=e[0];r=e[4];var s=e[8],o=e[1],u=e[5],a=e[9];n=e[2],t=e[6];var f=e[10];return.01>Math.abs(r-o)&&.01>Math.abs(s-n)&&.01>Math.abs(a-t)?.1>Math.abs(r+o)&&.1>Math.abs(s+n)&&.1>Math.abs(a+t)&&.1>Math.abs(i+u+f-3)?(this.set(1,0,0,0),this):(e=Math.PI,i=(i+1)/2,u=(u+1)/2,f=(f+1)/2,r=(r+o)/4,s=(s+n)/4,a=(a+t)/4,i>u&&i>f?.01>i?(t=0,r=n=.707106781):(t=Math.sqrt(i),n=r/t,r=s/t):u>f?.01>u?(t=.707106781,n=0,r=.707106781):(n=Math.sqrt(u),t=r/n,r=a/n):.01>f?(n=t=.707106781,r=0):(r=Math.sqrt(f),t=s/r,n=a/r),this.set(t,n,r,e),this):(e=Math.sqrt((t-a)*(t-a)+(s-n)*(s-n)+(o-r)*(o-r)),.001>Math.abs(e)&&(e=1),this.x=(t-a)/e,this.y=(s-n)/e,this.z=(o-r)/e,this.w=Math.acos((i+u+f-1)/2),this)},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this.w>e.w&&(this.w=e.w),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this.w<e.w&&(this.w=e.w),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this.w<e.w?this.w=e.w:this.w>t.w&&(this.w=t.w),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this.w=e[3],this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Euler=function(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._order=r||THREE.Euler.DefaultOrder},THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),THREE.Euler.DefaultOrder="XYZ",THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,_quaternion:void 0,_updateQuaternion:function(){void 0!==this._quaternion&&this._quaternion.setFromEuler(this,!1)},get x(){return this._x},set x(e){this._x=e,this._updateQuaternion()},get y(){return this._y},set y(e){this._y=e,this._updateQuaternion()},get z(){return this._z},set z(e){this._z=e,this._updateQuaternion()},get order(){return this._order},set order(e){this._order=e,this._updateQuaternion()},set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._updateQuaternion(),this},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._updateQuaternion(),this},setFromRotationMatrix:function(e,t){function n(e){return Math.min(Math.max(e,-1),1)}var r=e.elements,i=r[0],s=r[4],o=r[8],u=r[1],a=r[5],f=r[9],l=r[2],c=r[6],r=r[10],t=t||this._order;return"XYZ"===t?(this._y=Math.asin(n(o)),.99999>Math.abs(o)?(this._x=Math.atan2(-f,r),this._z=Math.atan2(-s,i)):(this._x=Math.atan2(c,a),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(f)),.99999>Math.abs(f)?(this._y=Math.atan2(o,r),this._z=Math.atan2(u,a)):(this._y=Math.atan2(-l,i),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(c)),.99999>Math.abs(c)?(this._y=Math.atan2(-l,r),this._z=Math.atan2(-s,a)):(this._y=0,this._z=Math.atan2(u,i))):"ZYX"===t?(this._y=Math.asin(-n(l)),.99999>Math.abs(l)?(this._x=Math.atan2(c,r),this._z=Math.atan2(u,i)):(this._x=0,this._z=Math.atan2(-s,a))):"YZX"===t?(this._z=Math.asin(n(u)),.99999>Math.abs(u)?(this._x=Math.atan2(-f,a),this._y=Math.atan2(-l,i)):(this._x=0,this._y=Math.atan2(o,r))):"XZY"===t?(this._z=Math.asin(-n(s)),.99999>Math.abs(s)?(this._x=Math.atan2(c,a),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-f,r),this._y=0)):console.warn("WARNING: Euler.setFromRotationMatrix() given unsupported order: "+t),this._order=t,this._updateQuaternion(),this},setFromQuaternion:function(e,t,n){function r(e){return Math.min(Math.max(e,-1),1)}var i=e.x*e.x,s=e.y*e.y,o=e.z*e.z,u=e.w*e.w,t=t||this._order;return"XYZ"===t?(this._x=Math.atan2(2*(e.x*e.w-e.y*e.z),u-i-s+o),this._y=Math.asin(r(2*(e.x*e.z+e.y*e.w))),this._z=Math.atan2(2*(e.z*e.w-e.x*e.y),u+i-s-o)):"YXZ"===t?(this._x=Math.asin(r(2*(e.x*e.w-e.y*e.z))),this._y=Math.atan2(2*(e.x*e.z+e.y*e.w),u-i-s+o),this._z=Math.atan2(2*(e.x*e.y+e.z*e.w),u-i+s-o)):"ZXY"===t?(this._x=Math.asin(r(2*(e.x*e.w+e.y*e.z))),this._y=Math.atan2(2*(e.y*e.w-e.z*e.x),u-i-s+o),this._z=Math.atan2(2*(e.z*e.w-e.x*e.y),u-i+s-o)):"ZYX"===t?(this._x=Math.atan2(2*(e.x*e.w+e.z*e.y),u-i-s+o),this._y=Math.asin(r(2*(e.y*e.w-e.x*e.z))),this._z=Math.atan2(2*(e.x*e.y+e.z*e.w),u+i-s-o)):"YZX"===t?(this._x=Math.atan2(2*(e.x*e.w-e.z*e.y),u-i+s-o),this._y=Math.atan2(2*(e.y*e.w-e.x*e.z),u+i-s-o),this._z=Math.asin(r(2*(e.x*e.y+e.z*e.w)))):"XZY"===t?(this._x=Math.atan2(2*(e.x*e.w+e.y*e.z),u-i+s-o),this._y=Math.atan2(2*(e.x*e.z+e.y*e.w),u+i-s-o),this._z=Math.asin(r(2*(e.z*e.w-e.x*e.y)))):console.warn("WARNING: Euler.setFromQuaternion() given unsupported order: "+t),this._order=t,!1!==n&&this._updateQuaternion(),this},reorder:function(){var e=new THREE.Quaternion;return function(t){e.setFromEuler(this),this.setFromQuaternion(e,t)}}(),fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._updateQuaternion(),this},toArray:function(){return[this._x,this._y,this._z,this._order]},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}},THREE.Line3=function(e,t){this.start=void 0!==e?e:new THREE.Vector3,this.end=void 0!==t?t:new THREE.Vector3},THREE.Line3.prototype={constructor:THREE.Line3,set:function(e,t){return this.start.copy(e),this.end.copy(t),this},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},center:function(e){return(e||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return(e||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var n=t||new THREE.Vector3;return this.delta(n).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(n,r){e.subVectors(n,this.start),t.subVectors(this.end,this.start);var i=t.dot(t),i=t.dot(e)/i;return r&&(i=THREE.Math.clamp(i,0,1)),i}}(),closestPointToPoint:function(e,t,n){return e=this.closestPointToPointParameter(e,t),n=n||new THREE.Vector3,this.delta(n).multiplyScalar(e).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}},THREE.Box2=function(e,t){this.min=void 0!==e?e:new THREE.Vector2(Infinity,Infinity),this.max=void 0!==t?t:new THREE.Vector2(-Infinity,-Infinity)},THREE.Box2.prototype={constructor:THREE.Box2,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){if(0<e.length){var t=e[0];this.min.copy(t),this.max.copy(t);for(var n=1,r=e.length;n<r;n++)t=e[n],t.x<this.min.x?this.min.x=t.x:t.x>this.max.x&&(this.max.x=t.x),t.y<this.min.y?this.min.y=t.y:t.y>this.max.y&&(this.max.y=t.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var e=new THREE.Vector2;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=Infinity,this.max.x=this.max.y=-Infinity,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){return(e||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y?!0:!1},getParameter:function(e,t){return(t||new THREE.Vector2).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y?!1:!0},clampPoint:function(e,t){return(t||new THREE.Vector2).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector2;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}},THREE.Box3=function(e,t){this.min=void 0!==e?e:new THREE.Vector3(Infinity,Infinity,Infinity),this.max=void 0!==t?t:new THREE.Vector3(-Infinity,-Infinity,-Infinity)},THREE.Box3.prototype={constructor:THREE.Box3,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},addPoint:function(e){e.x<this.min.x?this.min.x=e.x:e.x>this.max.x&&(this.max.x=e.x),e.y<this.min.y?this.min.y=e.y:e.y>this.max.y&&(this.max.y=e.y),e.z<this.min.z?this.min.z=e.z:e.z>this.max.z&&(this.max.z=e.z)},setFromPoints:function(e){if(0<e.length){var t=e[0];this.min.copy(t),this.max.copy(t);for(var t=1,n=e.length;t<n;t++)this.addPoint(e[t])}else this.makeEmpty();return this},setFromCenterAndSize:function(){var e=new THREE.Vector3;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),setFromObject:function(){var e=new THREE.Vector3;return function(t){var n=this;return t.updateMatrixWorld(!0),this.makeEmpty(),t.traverse(function(t){if(void 0!==t.geometry&&void 0!==t.geometry.vertices)for(var r=t.geometry.vertices,i=0,s=r.length;i<s;i++)e.copy(r[i]),e.applyMatrix4(t.matrixWorld),n.expandByPoint(e)}),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-Infinity,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){return(e||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z?!0:!1},getParameter:function(e,t){return(t||new THREE.Vector3).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?!1:!0},clampPoint:function(e,t){return(t||new THREE.Vector3).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector3;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new THREE.Vector3;return function(t){return t=t||new THREE.Sphere,t.center=this.center(),t.radius=.5*this.size(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(t){return e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.makeEmpty(),this.setFromPoints(e),this}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}},THREE.Matrix3=function(e,t,n,r,i,s,o,u,a){this.elements=new Float32Array(9),this.set(void 0!==e?e:1,t||0,n||0,r||0,void 0!==i?i:1,s||0,o||0,u||0,void 0!==a?a:1)},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(e,t,n,r,i,s,o,u,a){var f=this.elements;return f[0]=e,f[3]=t,f[6]=n,f[1]=r,f[4]=i,f[7]=s,f[2]=o,f[5]=u,f[8]=a,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(e){return e=e.elements,this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},multiplyVector3:function(e){return console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){var e=new THREE.Vector3;return function(t){for(var n=0,r=t.length;n<r;n+=3)e.x=t[n],e.y=t[n+1],e.z=t[n+2],e.applyMatrix3(this),t[n]=e.x,t[n+1]=e.y,t[n+2]=e.z;return t}}(),multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],e=e[8];return t*s*e-t*o*a-n*i*e+n*o*u+r*i*a-r*s*u},getInverse:function(e,t){var n=e.elements,r=this.elements;r[0]=n[10]*n[5]-n[6]*n[9],r[1]=-n[10]*n[1]+n[2]*n[9],r[2]=n[6]*n[1]-n[2]*n[5],r[3]=-n[10]*n[4]+n[6]*n[8],r[4]=n[10]*n[0]-n[2]*n[8],r[5]=-n[6]*n[0]+n[2]*n[4],r[6]=n[9]*n[4]-n[5]*n[8],r[7]=-n[9]*n[0]+n[1]*n[8],r[8]=n[5]*n[0]-n[1]*n[4],n=n[0]*r[0]+n[1]*r[3]+n[2]*r[6];if(0===n){if(t)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");return console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0"),this.identity(),this}return this.multiplyScalar(1/n),this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.getInverse(e).transpose(),this},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},clone:function(){var e=this.elements;return new THREE.Matrix3(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])}},THREE.Matrix4=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=this.elements=new Float32Array(16);m[0]=void 0!==e?e:1,m[4]=t||0,m[8]=n||0,m[12]=r||0,m[1]=i||0,m[5]=void 0!==s?s:1,m[9]=o||0,m[13]=u||0,m[2]=a||0,m[6]=f||0,m[10]=void 0!==l?l:1,m[14]=c||0,m[3]=h||0,m[7]=p||0,m[11]=d||0,m[15]=void 0!==v?v:1},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=i,m[5]=s,m[9]=o,m[13]=u,m[2]=a,m[6]=f,m[10]=l,m[14]=c,m[3]=h,m[7]=p,m[11]=d,m[15]=v,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return this.elements.set(e.elements),this},extractPosition:function(e){return console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},copyPosition:function(e){var t=this.elements,e=e.elements;return t[12]=e[12],t[13]=e[13],t[14]=e[14],this},extractRotation:function(){var e=new THREE.Vector3;return function(t){var n=this.elements,t=t.elements,r=1/e.set(t[0],t[1],t[2]).length(),i=1/e.set(t[4],t[5],t[6]).length(),s=1/e.set(t[8],t[9],t[10]).length();return n[0]=t[0]*r,n[1]=t[1]*r,n[2]=t[2]*r,n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*i,n[8]=t[8]*s,n[9]=t[9]*s,n[10]=t[10]*s,this}}(),makeRotationFromEuler:function(e){0==e instanceof THREE.Euler&&console.error("ERROR: Matrix's .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.");var t=this.elements,n=e.x,r=e.y,i=e.z,s=Math.cos(n),n=Math.sin(n),o=Math.cos(r),r=Math.sin(r),u=Math.cos(i),i=Math.sin(i);if("XYZ"===e.order){var e=s*u,a=s*i,f=n*u,l=n*i;t[0]=o*u,t[4]=-o*i,t[8]=r,t[1]=a+f*r,t[5]=e-l*r,t[9]=-n*o,t[2]=l-e*r,t[6]=f+a*r,t[10]=s*o}else"YXZ"===e.order?(e=o*u,a=o*i,f=r*u,l=r*i,t[0]=e+l*n,t[4]=f*n-a,t[8]=s*r,t[1]=s*i,t[5]=s*u,t[9]=-n,t[2]=a*n-f,t[6]=l+e*n,t[10]=s*o):"ZXY"===e.order?(e=o*u,a=o*i,f=r*u,l=r*i,t[0]=e-l*n,t[4]=-s*i,t[8]=f+a*n,t[1]=a+f*n,t[5]=s*u,t[9]=l-e*n,t[2]=-s*r,t[6]=n,t[10]=s*o):"ZYX"===e.order?(e=s*u,a=s*i,f=n*u,l=n*i,t[0]=o*u,t[4]=f*r-a,t[8]=e*r+l,t[1]=o*i,t[5]=l*r+e,t[9]=a*r-f,t[2]=-r,t[6]=n*o,t[10]=s*o):"YZX"===e.order?(e=s*o,a=s*r,f=n*o,l=n*r,t[0]=o*u,t[4]=l-e*i,t[8]=f*i+a,t[1]=i,t[5]=s*u,t[9]=-n*u,t[2]=-r*u,t[6]=a*i+f,t[10]=e-l*i):"XZY"===e.order&&(e=s*o,a=s*r,f=n*o,l=n*r,t[0]=o*u,t[4]=-i,t[8]=r*u,t[1]=e*i+l,t[5]=s*u,t[9]=a*i-f,t[2]=f*i-a,t[6]=n*u,t[10]=l*i+e);return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},setRotationFromQuaternion:function(e){return console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code."),this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z,s=e.w,o=n+n,u=r+r,a=i+i,e=n*o,f=n*u,n=n*a,l=r*u,r=r*a,i=i*a,o=s*o,u=s*u,s=s*a;return t[0]=1-(l+i),t[4]=f-s,t[8]=n+u,t[1]=f+s,t[5]=1-(e+i),t[9]=r-o,t[2]=n-u,t[6]=r+o,t[10]=1-(e+l),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(r,i,s){var o=this.elements;return n.subVectors(r,i).normalize(),0===n.length()&&(n.z=1),e.crossVectors(s,n).normalize(),0===e.length()&&(n.x+=1e-4,e.crossVectors(s,n).normalize()),t.crossVectors(n,e),o[0]=e.x,o[4]=t.x,o[8]=n.x,o[1]=e.y,o[5]=t.y,o[9]=n.y,o[2]=e.z,o[6]=t.z,o[10]=n.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,s=n[0],o=n[4],u=n[8],a=n[12],f=n[1],l=n[5],c=n[9],h=n[13],p=n[2],d=n[6],v=n[10],m=n[14],g=n[3],y=n[7],b=n[11],n=n[15],w=r[0],E=r[4],S=r[8],x=r[12],T=r[1],N=r[5],C=r[9],k=r[13],L=r[2],A=r[6],O=r[10],M=r[14],_=r[3],D=r[7],P=r[11],r=r[15];return i[0]=s*w+o*T+u*L+a*_,i[4]=s*E+o*N+u*A+a*D,i[8]=s*S+o*C+u*O+a*P,i[12]=s*x+o*k+u*M+a*r,i[1]=f*w+l*T+c*L+h*_,i[5]=f*E+l*N+c*A+h*D,i[9]=f*S+l*C+c*O+h*P,i[13]=f*x+l*k+c*M+h*r,i[2]=p*w+d*T+v*L+m*_,i[6]=p*E+d*N+v*A+m*D,i[10]=p*S+d*C+v*O+m*P,i[14]=p*x+d*k+v*M+m*r,i[3]=g*w+y*T+b*L+n*_,i[7]=g*E+y*N+b*A+n*D,i[11]=g*S+y*C+b*O+n*P,i[15]=g*x+y*k+b*M+n*r,this},multiplyToArray:function(e,t,n){var r=this.elements;return this.multiplyMatrices(e,t),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},multiplyVector3:function(e){return console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),e.applyProjection(this)},multiplyVector4:function(e){return console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){var e=new THREE.Vector3;return function(t){for(var n=0,r=t.length;n<r;n+=3)e.x=t[n],e.y=t[n+1],e.z=t[n+2],e.applyProjection(this),t[n]=e.x,t[n+1]=e.y,t[n+2]=e.z;return t}}(),rotateAxis:function(e){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},determinant:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],s=e[1],o=e[5],u=e[9],a=e[13],f=e[2],l=e[6],c=e[10],h=e[14];return e[3]*(+i*u*l-r*a*l-i*o*c+n*a*c+r*o*h-n*u*h)+e[7]*(+t*u*h-t*a*c+i*s*c-r*s*h+r*a*f-i*u*f)+e[11]*(+t*a*l-t*o*h-i*s*l+n*s*h+i*o*f-n*a*f)+e[15]*(-r*o*f-t*u*l+t*o*c+r*s*l-n*s*c+n*u*f)},transpose:function(){var e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},flattenToArrayOffset:function(e,t){var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e},getPosition:function(){var e=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,r=e.elements,i=r[0],s=r[4],o=r[8],u=r[12],a=r[1],f=r[5],l=r[9],c=r[13],h=r[2],p=r[6],d=r[10],v=r[14],m=r[3],g=r[7],y=r[11],r=r[15];n[0]=l*v*g-c*d*g+c*p*y-f*v*y-l*p*r+f*d*r,n[4]=u*d*g-o*v*g-u*p*y+s*v*y+o*p*r-s*d*r,n[8]=o*c*g-u*l*g+u*f*y-s*c*y-o*f*r+s*l*r,n[12]=u*l*p-o*c*p-u*f*d+s*c*d+o*f*v-s*l*v,n[1]=c*d*m-l*v*m-c*h*y+a*v*y+l*h*r-a*d*r,n[5]=o*v*m-u*d*m+u*h*y-i*v*y-o*h*r+i*d*r,n[9]=u*l*m-o*c*m-u*a*y+i*c*y+o*a*r-i*l*r,n[13]=o*c*h-u*l*h+u*a*d-i*c*d-o*a*v+i*l*v,n[2]=f*v*m-c*p*m+c*h*g-a*v*g-f*h*r+a*p*r,n[6]=u*p*m-s*v*m-u*h*g+i*v*g+s*h*r-i*p*r,n[10]=s*c*m-u*f*m+u*a*g-i*c*g-s*a*r+i*f*r,n[14]=u*f*h-s*c*h-u*a*p+i*c*p+s*a*v-i*f*v,n[3]=l*p*m-f*d*m-l*h*g+a*d*g+f*h*y-a*p*y,n[7]=s*d*m-o*p*m+o*h*g-i*d*g-s*h*y+i*p*y,n[11]=o*f*m-s*l*m-o*a*g+i*l*g+s*a*y-i*f*y,n[15]=s*l*h-o*f*h+o*a*p-i*l*p-s*a*d+i*f*d,n=i*n[0]+a*n[4]+h*n[8]+m*n[12];if(0==n){if(t)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");return console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0"),this.identity(),this}return this.multiplyScalar(1/n),this},translate:function(){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements,n=e.x,r=e.y,e=e.z;return t[0]*=n,t[4]*=r,t[8]*=e,t[1]*=n,t[5]*=r,t[9]*=e,t[2]*=n,t[6]*=r,t[10]*=e,t[3]*=n,t[7]*=r,t[11]*=e,this},getMaxScaleOnAxis:function(){var e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],Math.max(e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10])))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),e=Math.sin(e);return this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),e=Math.sin(e);return this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),e=Math.sin(e);return this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,s=e.x,o=e.y,u=e.z,a=i*s,f=i*o;return this.set(a*s+n,a*o-r*u,a*u+r*o,0,a*o+r*u,f*o+n,f*u-r*s,0,a*u-r*o,f*u+r*s,i*u*u+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},compose:function(e,t,n){return this.makeRotationFromQuaternion(t),this.scale(n),this.setPosition(e),this},decompose:function(){var e=new THREE.Vector3,t=new THREE.Matrix4;return function(n,r,i){var s=this.elements,o=e.set(s[0],s[1],s[2]).length(),u=e.set(s[4],s[5],s[6]).length(),f=e.set(s[8],s[9],s[10]).length();0>this.determinant()&&(o=-o),n.x=s[12],n.y=s[13],n.z=s[14],t.elements.set(this.elements);var n=1/o,s=1/u,l=1/f;return t.elements[0]*=n,t.elements[1]*=n,t.elements[2]*=n,t.elements[4]*=s,t.elements[5]*=s,t.elements[6]*=s,t.elements[8]*=l,t.elements[9]*=l,t.elements[10]*=l,r.setFromRotationMatrix(t),i.x=o,i.y=u,i.z=f,this}}(),makeFrustum:function(e,t,n,r,i,s){var o=this.elements;return o[0]=2*i/(t-e),o[4]=0,o[8]=(t+e)/(t-e),o[12]=0,o[1]=0,o[5]=2*i/(r-n),o[9]=(r+n)/(r-n),o[13]=0,o[2]=0,o[6]=0,o[10]=-(s+i)/(s-i),o[14]=-2*s*i/(s-i),o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makePerspective:function(e,t,n,r){var e=n*Math.tan(THREE.Math.degToRad(.5*e)),i=-e;return this.makeFrustum(i*t,e*t,i,e,n,r)},makeOrthographic:function(e,t,n,r,i,s){var o=this.elements,u=t-e,a=n-r,f=s-i;return o[0]=2/u,o[4]=0,o[8]=0,o[12]=-((t+e)/u),o[1]=0,o[5]=2/a,o[9]=0,o[13]=-((n+r)/a),o[2]=0,o[6]=0,o[10]=-2/f,o[14]=-((s+i)/f),o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){var e=this.elements;return new THREE.Matrix4(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])}},THREE.Ray=function(e,t){this.origin=void 0!==e?e:new THREE.Vector3,this.direction=void 0!==t?t:new THREE.Vector3},THREE.Ray.prototype={constructor:THREE.Ray,set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return(t||new THREE.Vector3).copy(this.direction).multiplyScalar(e).add(this.origin)},recast:function(){var e=new THREE.Vector3;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var n=t||new THREE.Vector3;n.subVectors(e,this.origin);var r=n.dot(this.direction);return 0>r?n.copy(this.origin):n.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(){var e=new THREE.Vector3;return function(t){var n=e.subVectors(t,this.origin).dot(this.direction);return 0>n?this.origin.distanceTo(t):(e.copy(this.direction).multiplyScalar(n).add(this.origin),e.distanceTo(t))}}(),distanceSqToSegment:function(e,t,n,r){var i=e.clone().add(t).multiplyScalar(.5),s=t.clone().sub(e).normalize(),o=.5*e.distanceTo(t),u=this.origin.clone().sub(i),e=-this.direction.dot(s),t=u.dot(this.direction),a=-u.dot(s),f=u.lengthSq(),l=Math.abs(1-e*e),c,h;return 0<=l?(u=e*a-t,c=e*t-a,h=o*l,0<=u?c>=-h?c<=h?(o=1/l,u*=o,c*=o,e=u*(u+e*c+2*t)+c*(e*u+c+2*a)+f):(c=o,u=Math.max(0,-(e*c+t)),e=-u*u+c*(c+2*a)+f):(c=-o,u=Math.max(0,-(e*c+t)),e=-u*u+c*(c+2*a)+f):c<=-h?(u=Math.max(0,-(-e*o+t)),c=0<u?-o:Math.min(Math.max(-o,-a),o),e=-u*u+c*(c+2*a)+f):c<=h?(u=0,c=Math.min(Math.max(-o,-a),o),e=c*(c+2*a)+f):(u=Math.max(0,-(e*o+t)),c=0<u?o:Math.min(Math.max(-o,-a),o),e=-u*u+c*(c+2*a)+f)):(c=0<e?-o:o,u=Math.max(0,-(e*c+t)),e=-u*u+c*(c+2*a)+f),n&&n.copy(this.direction.clone().multiplyScalar(u).add(this.origin)),r&&r.copy(s.clone().multiplyScalar(c).add(i)),e},isIntersectionSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},isIntersectionPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||0>e.normal.dot(this.direction)*t?!0:!1},distanceToPlane:function(e){var t=e.normal.dot(this.direction);return 0==t?0==e.distanceToPoint(this.origin)?0:null:(e=-(this.origin.dot(e.normal)+e.constant)/t,0<=e?e:null)},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},isIntersectionBox:function(){var e=new THREE.Vector3;return function(t){return null!==this.intersectBox(t,e)}}(),intersectBox:function(e,t){var n,r,i,s,o;r=1/this.direction.x,s=1/this.direction.y,o=1/this.direction.z;var u=this.origin;0<=r?(n=(e.min.x-u.x)*r,r*=e.max.x-u.x):(n=(e.max.x-u.x)*r,r*=e.min.x-u.x),0<=s?(i=(e.min.y-u.y)*s,s*=e.max.y-u.y):(i=(e.max.y-u.y)*s,s*=e.min.y-u.y);if(n>s||i>r)return null;if(i>n||n!==n)n=i;if(s<r||r!==r)r=s;0<=o?(i=(e.min.z-u.z)*o,o*=e.max.z-u.z):(i=(e.max.z-u.z)*o,o*=e.min.z-u.z);if(n>o||i>r)return null;if(i>n||n!==n)n=i;if(o<r||r!==r)r=o;return 0>r?null:this.at(0<=n?n:r,t)},intersectTriangle:function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3,r=new THREE.Vector3;return function(i,s,o,u,f){t.subVectors(s,i),n.subVectors(o,i),r.crossVectors(t,n),s=this.direction.dot(r);if(0<s){if(u)return null;u=1}else{if(!(0>s))return null;u=-1,s=-s}return e.subVectors(this.origin,i),i=u*this.direction.dot(n.crossVectors(e,n)),0>i?null:(o=u*this.direction.dot(t.cross(e)),0>o||i+o>s?null:(i=-u*e.dot(r),0>i?null:this.at(i/s,f)))}}(),applyMatrix4:function(e){return this.direction.add(this.origin).applyMatrix4(e),this.origin.applyMatrix4(e),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}},THREE.Sphere=function(e,t){this.center=void 0!==e?e:new THREE.Vector3,this.radius=void 0!==t?t:0},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(){var e=new THREE.Box3;return function(t,n){var r=this.center;void 0!==n?r.copy(n):e.setFromPoints(t).center(r);for(var i=0,s=0,o=t.length;s<o;s++)i=Math.max(i,r.distanceToSquared(t[s]));return this.radius=Math.sqrt(i),this}}(),copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},clampPoint:function(e,t){var n=this.center.distanceToSquared(e),r=t||new THREE.Vector3;return r.copy(e),n>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r},getBoundingBox:function(e){return e=e||new THREE.Box3,e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius*=e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}},THREE.Frustum=function(e,t,n,r,i,s){this.planes=[void 0!==e?e:new THREE.Plane,void 0!==t?t:new THREE.Plane,void 0!==n?n:new THREE.Plane,void 0!==r?r:new THREE.Plane,void 0!==i?i:new THREE.Plane,void 0!==s?s:new THREE.Plane]},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(e,t,n,r,i,s){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(s),this},copy:function(e){for(var t=this.planes,n=0;6>n;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements,e=n[0],r=n[1],i=n[2],s=n[3],o=n[4],u=n[5],a=n[6],f=n[7],l=n[8],c=n[9],h=n[10],p=n[11],d=n[12],v=n[13],m=n[14],n=n[15];return t[0].setComponents(s-e,f-o,p-l,n-d).normalize(),t[1].setComponents(s+e,f+o,p+l,n+d).normalize(),t[2].setComponents(s+r,f+u,p+c,n+v).normalize(),t[3].setComponents(s-r,f-u,p-c,n-v).normalize(),t[4].setComponents(s-i,f-a,p-h,n-m).normalize(),t[5].setComponents(s+i,f+a,p+h,n+m).normalize(),this},intersectsObject:function(){var e=new THREE.Sphere;return function(t){var n=t.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),e.copy(n.boundingSphere),e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,n=e.center,e=-e.radius,r=0;6>r;r++)if(t[r].distanceToPoint(n)<e)return!1;return!0},intersectsBox:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(n){for(var r=this.planes,i=0;6>i;i++){var s=r[i];e.x=0<s.normal.x?n.min.x:n.max.x,t.x=0<s.normal.x?n.max.x:n.min.x,e.y=0<s.normal.y?n.min.y:n.max.y,t.y=0<s.normal.y?n.max.y:n.min.y,e.z=0<s.normal.z?n.min.z:n.max.z,t.z=0<s.normal.z?n.max.z:n.min.z;var o=s.distanceToPoint(e),s=s.distanceToPoint(t);if(0>o&&0>s)return!1}return!0}}(),containsPoint:function(e){for(var t=this.planes,n=0;6>n;n++)if(0>t[n].distanceToPoint(e))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}},THREE.Plane=function(e,t){this.normal=void 0!==e?e:new THREE.Vector3(1,0,0),this.constant=void 0!==t?t:0},THREE.Plane.prototype={constructor:THREE.Plane,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(n,r,i){return r=e.subVectors(i,r).cross(t.subVectors(n,r)).normalize(),this.setFromNormalAndCoplanarPoint(r,n),this}}(),copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var n=this.distanceToPoint(e);return(t||new THREE.Vector3).copy(this.normal).multiplyScalar(n)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start),e=this.distanceToPoint(e.end);return 0>t&&0<e||0>e&&0<t},intersectLine:function(){var e=new THREE.Vector3;return function(t,n){var r=n||new THREE.Vector3,i=t.delta(e),s=this.normal.dot(i);if(0!=s)return s=-(t.start.dot(this.normal)+this.constant)/s,0>s||1<s?void 0:r.copy(i).multiplyScalar(s).add(t.start);if(0==this.distanceToPoint(t.start))return r.copy(t.start)}}(),coplanarPoint:function(e){return(e||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Matrix3;return function(r,i){var s=i||n.getNormalMatrix(r),s=e.copy(this.normal).applyMatrix3(s),o=this.coplanarPoint(t);return o.applyMatrix4(r),this.setFromNormalAndCoplanarPoint(s,o),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}},THREE.Math={PI2:2*Math.PI,generateUUID:function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),t=Array(36),n=0,r;return function(){for(var i=0;36>i;i++)8==i||13==i||18==i||23==i?t[i]="-":14==i?t[i]="4":(2>=n&&(n=33554432+16777216*Math.random()|0),r=n&15,n>>=4,t[i]=e[19==i?r&3|8:r]);return t.join("")}}(),clamp:function(e,t,n){return e<t?t:e>n?n:e},clampBottom:function(e,t){return e<t?t:e},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*(3-2*e))},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*e*(e*(6*e-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},sign:function(e){return 0>e?-1:0<e?1:0},degToRad:function(){var e=Math.PI/180;return function(t){return t*e}}(),radToDeg:function(){var e=180/Math.PI;return function(t){return t*e}}()},THREE.Spline=function(e){function t(e,t,n,r,i,s,o){return e=.5*(n-e),r=.5*(r-t),(2*(t-n)+e+r)*o+(-3*(t-n)-2*e-r)*s+e*i+t}this.points=e;var n=[],r={x:0,y:0,z:0},i,s,o,u,a,f,l,c,h;this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}},this.getPoint=function(e){return i=(this.points.length-1)*e,s=Math.floor(i),o=i-s,n[0]=0===s?s:s-1,n[1]=s,n[2]=s>this.points.length-2?this.points.length-1:s+1,n[3]=s>this.points.length-3?this.points.length-1:s+2,f=this.points[n[0]],l=this.points[n[1]],c=this.points[n[2]],h=this.points[n[3]],u=o*o,a=o*u,r.x=t(f.x,l.x,c.x,h.x,o,u,a),r.y=t(f.y,l.y,c.y,h.y,o,u,a),r.z=t(f.z,l.z,c.z,h.z,o,u,a),r},this.getControlPointsArray=function(){var e,t,n=this.points.length,r=[];for(e=0;e<n;e++)t=this.points[e],r[e]=[t.x,t.y,t.z];return r},this.getLength=function(e){var t,n,r,i=t=t=0,s=new THREE.Vector3,o=new THREE.Vector3,u=[],a=0;u[0]=0,e||(e=100),n=this.points.length*e,s.copy(this.points[0]);for(e=1;e<n;e++)t=e/n,r=this.getPoint(t),o.copy(r),a+=o.distanceTo(s),s.copy(r),t*=this.points.length-1,t=Math.floor(t),t!=i&&(u[t]=a,i=t);return u[u.length]=a,{chunks:u,total:a}},this.reparametrizeByArcLength=function(e){var t,n,r,i,s,o,u=[],a=new THREE.Vector3,f=this.getLength();u.push(a.copy(this.points[0]).clone());for(t=1;t<this.points.length;t++){n=f.chunks[t]-f.chunks[t-1],o=Math.ceil(e*n/f.total),i=(t-1)/(this.points.length-1),s=t/(this.points.length-1);for(n=1;n<o-1;n++)r=i+n*(1/o)*(s-i),r=this.getPoint(r),u.push(a.copy(r).clone());u.push(a.copy(this.points[t]).clone())}this.points=u}},THREE.Triangle=function(e,t,n){this.a=void 0!==e?e:new THREE.Vector3,this.b=void 0!==t?t:new THREE.Vector3,this.c=void 0!==n?n:new THREE.Vector3},THREE.Triangle.normal=function(){var e=new THREE.Vector3;return function(t,n,r,i){return i=i||new THREE.Vector3,i.subVectors(r,n),e.subVectors(t,n),i.cross(e),t=i.lengthSq(),0<t?i.multiplyScalar(1/Math.sqrt(t)):i.set(0,0,0)}}(),THREE.Triangle.barycoordFromPoint=function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(r,i,s,o,u){e.subVectors(o,i),t.subVectors(s,i),n.subVectors(r,i);var r=e.dot(e),i=e.dot(t),s=e.dot(n),f=t.dot(t),o=t.dot(n),l=r*f-i*i,u=u||new THREE.Vector3;return 0==l?u.set(-2,-1,-1):(l=1/l,f=(f*s-i*o)*l,r=(r*o-i*s)*l,u.set(1-f-r,r,f))}}(),THREE.Triangle.containsPoint=function(){var e=new THREE.Vector3;return function(t,n,r,i){return t=THREE.Triangle.barycoordFromPoint(t,n,r,i,e),0<=t.x&&0<=t.y&&1>=t.x+t.y}}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){return(e||new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return THREE.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){return(e||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return THREE.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return THREE.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}},THREE.Vertex=function(e){return console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead."),e},THREE.UV=function(e,t){return console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead."),new THREE.Vector2(e,t)},THREE.Clock=function(e){this.autoStart=void 0!==e?e:!0,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1},THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;this.autoStart&&!this.running&&this.start();if(this.running){var t=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),e=.001*(t-this.oldTime);this.oldTime=t,this.elapsedTime+=e}return e}},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(e){e.addEventListener=THREE.EventDispatcher.prototype.addEventListener,e.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener,e.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener,e.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)?!0:!1},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(){var e=[];return function(t){if(void 0!==this._listeners){var n=this._listeners[t.type];if(void 0!==n){t.target=this;for(var r=n.length,i=0;i<r;i++)e[i]=n[i];for(i=0;i<r;i++)e[i].call(this,t)}}}}()},function(e){e.Raycaster=function(t,n,r,i){this.ray=new e.Ray(t,n),this.near=r||0,this.far=i||Infinity};var t=new e.Sphere,n=new e.Ray;new e.Plane,new e.Vector3;var r=new e.Vector3,i=new e.Matrix4,s=function(e,t){return e.distance-t.distance},o=new e.Vector3,u=new e.Vector3,a=new e.Vector3,f=function(s,l,p){if(s instanceof e.Sprite){r.setFromMatrixPosition(s.matrixWorld);var v=l.ray.distanceToPoint(r);if(v>s.scale.x)return p;p.push({distance:v,point:s.position,face:null,object:s})}else if(s instanceof e.LOD)r.setFromMatrixPosition(s.matrixWorld),v=l.ray.origin.distanceTo(r),f(s.getObjectForDistance(v),l,p);else if(s instanceof e.Mesh){var m=s.geometry;null===m.boundingSphere&&m.computeBoundingSphere(),t.copy(m.boundingSphere),t.applyMatrix4(s.matrixWorld);if(!1===l.ray.isIntersectionSphere(t))return p;i.getInverse(s.matrixWorld),n.copy(l.ray).applyMatrix4(i);if(null!==m.boundingBox&&!1===n.isIntersectionBox(m.boundingBox))return p;if(m instanceof e.BufferGeometry){var y=s.material;if(void 0===y||!1===m.dynamic)return p;var w,E,S=l.precision;if(void 0!==m.attributes.index)for(var x=m.offsets,T=m.attributes.index.array,N=m.attributes.position.array,C=m.offsets.length,L=m.attributes.index.array.length/3,L=0;L<C;++L)for(var v=x[L].start,A=x[L].index,m=v,O=v+x[L].count;m<O;m+=3)v=A+T[m],w=A+T[m+1],E=A+T[m+2],o.set(N[3*v],N[3*v+1],N[3*v+2]),u.set(N[3*w],N[3*w+1],N[3*w+2]),a.set(N[3*E],N[3*E+1],N[3*E+2]),w=y.side===e.BackSide?n.intersectTriangle(a,u,o,!0):n.intersectTriangle(o,u,a,y.side!==e.DoubleSide),null!==w&&(w.applyMatrix4(s.matrixWorld),v=l.ray.origin.distanceTo(w),v<S||v<l.near||v>l.far||p.push({distance:v,point:w,face:null,faceIndex:null,object:s}));else{N=m.attributes.position.array,L=m.attributes.position.array.length;for(m=0;m<L;m+=3)v=m,w=m+1,E=m+2,o.set(N[3*v],N[3*v+1],N[3*v+2]),u.set(N[3*w],N[3*w+1],N[3*w+2]),a.set(N[3*E],N[3*E+1],N[3*E+2]),w=y.side===e.BackSide?n.intersectTriangle(a,u,o,!0):n.intersectTriangle(o,u,a,y.side!==e.DoubleSide),null!==w&&(w.applyMatrix4(s.matrixWorld),v=l.ray.origin.distanceTo(w),v<S||v<l.near||v>l.far||p.push({distance:v,point:w,face:null,faceIndex:null,object:s}))}}else if(m instanceof e.Geometry){T=s.material instanceof e.MeshFaceMaterial,N=!0===T?s.material.materials:null,S=l.precision,x=m.vertices,C=0;for(L=m.faces.length;C<L;C++)if(A=m.faces[C],y=!0===T?N[A.materialIndex]:s.material,void 0!==y){v=x[A.a],w=x[A.b],E=x[A.c];if(!0===y.morphTargets){var O=m.morphTargets,M=s.morphTargetInfluences;o.set(0,0,0),u.set(0,0,0),a.set(0,0,0);for(var _=0,D=O.length;_<D;_++){var P=M[_];if(0!==P){var H=O[_].vertices;o.x+=(H[A.a].x-v.x)*P,o.y+=(H[A.a].y-v.y)*P,o.z+=(H[A.a].z-v.z)*P,u.x+=(H[A.b].x-w.x)*P,u.y+=(H[A.b].y-w.y)*P,u.z+=(H[A.b].z-w.z)*P,a.x+=(H[A.c].x-E.x)*P,a.y+=(H[A.c].y-E.y)*P,a.z+=(H[A.c].z-E.z)*P}}o.add(v),u.add(w),a.add(E),v=o,w=u,E=a}w=y.side===e.BackSide?n.intersectTriangle(E,w,v,!0):n.intersectTriangle(v,w,E,y.side!==e.DoubleSide),null!==w&&(w.applyMatrix4(s.matrixWorld),v=l.ray.origin.distanceTo(w),v<S||v<l.near||v>l.far||p.push({distance:v,point:w,face:A,faceIndex:C,object:s}))}}}else if(s instanceof e.Line){S=l.linePrecision,y=S*S,m=s.geometry,null===m.boundingSphere&&m.computeBoundingSphere(),t.copy(m.boundingSphere),t.applyMatrix4(s.matrixWorld);if(!1===l.ray.isIntersectionSphere(t))return p;i.getInverse(s.matrixWorld),n.copy(l.ray).applyMatrix4(i);if(m instanceof e.Geometry){x=m.vertices,S=x.length,w=new e.Vector3,E=new e.Vector3,L=s.type===e.LineStrip?1:2;for(m=0;m<S-1;m+=L)n.distanceSqToSegment(x[m],x[m+1],E,w)>y||(v=n.origin.distanceTo(E),v<l.near||v>l.far||p.push({distance:v,point:w.clone().applyMatrix4(s.matrixWorld),face:null,faceIndex:null,object:s}))}}},l=function(e,t,n){for(var e=e.getDescendants(),r=0,i=e.length;r<i;r++)f(e[r],t,n)};e.Raycaster.prototype.precision=1e-4,e.Raycaster.prototype.linePrecision=1,e.Raycaster.prototype.set=function(e,t){this.ray.set(e,t)},e.Raycaster.prototype.intersectObject=function(e,t){var n=[];return!0===t&&l(e,this,n),f(e,this,n),n.sort(s),n},e.Raycaster.prototype.intersectObjects=function(e,t){for(var n=[],r=0,i=e.length;r<i;r++)f(e[r],this,n),!0===t&&l(e[r],this,n);return n.sort(s),n}}(THREE),THREE.Object3D=function(){this.id=THREE.Object3DIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.parent=void 0,this.children=[],this.up=new THREE.Vector3(0,1,0),this.position=new THREE.Vector3,this._rotation=new THREE.Euler,this._quaternion=new THREE.Quaternion,this.scale=new THREE.Vector3(1,1,1),this._rotation._quaternion=this.quaternion,this._quaternion._euler=this.rotation,this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.visible=this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.userData={}},THREE.Object3D.prototype={constructor:THREE.Object3D,get rotation(){return this._rotation},set rotation(e){this._rotation=e,this._rotation._quaternion=this._quaternion,this._quaternion._euler=this._rotation,this._rotation._updateQuaternion()},get quaternion(){return this._quaternion},set quaternion(e){this._quaternion=e,this._quaternion._euler=this._rotation,this._rotation._quaternion=this._quaternion,this._quaternion._updateEuler()},get eulerOrder(){return console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order."),this.rotation.order},set eulerOrder(e){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order."),this.rotation.order=e},get useQuaternion(){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(e){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(){var e=new THREE.Quaternion;return function(t,n){return e.setFromAxisAngle(t,n),this.quaternion.multiply(e),this}}(),rotateX:function(){var e=new THREE.Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new THREE.Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new THREE.Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new THREE.Vector3;return function(t,n){return e.copy(t),e.applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(n)),this}}(),translate:function(e,t){return console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed."),this.translateOnAxis(t,e)},translateX:function(){var e=new THREE.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new THREE.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new THREE.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new THREE.Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new THREE.Matrix4;return function(t){e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(e===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(e instanceof THREE.Object3D){void 0!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e);for(var t=this;void 0!==t.parent;)t=t.parent;void 0!==t&&t instanceof THREE.Scene&&t.__addObject(e)}},remove:function(e){var t=this.children.indexOf(e);if(-1!==t){e.parent=void 0,e.dispatchEvent({type:"removed"}),this.children.splice(t,1);for(t=this;void 0!==t.parent;)t=t.parent;void 0!==t&&t instanceof THREE.Scene&&t.__removeObject(e)}},traverse:function(e){e(this);for(var t=0,n=this.children.length;t<n;t++)this.children[t].traverse(e)},getObjectById:function(e,t){for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n];if(i.id===e||!0===t&&(i=i.getObjectById(e,t),void 0!==i))return i}},getObjectByName:function(e,t){for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n];if(i.name===e||!0===t&&(i=i.getObjectByName(e,t),void 0!==i))return i}},getChildByName:function(e,t){return console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e,t)},getDescendants:function(e){void 0===e&&(e=[]),Array.prototype.push.apply(e,this.children);for(var t=0,n=this.children.length;t<n;t++)this.children[t].getDescendants(e);return e},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===e)void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0;for(var t=0,n=this.children.length;t<n;t++)this.children[t].updateMatrixWorld(e)},clone:function(e,t){void 0===e&&(e=new THREE.Object3D),void 0===t&&(t=!0),e.name=this.name,e.up.copy(this.up),e.position.copy(this.position),e.quaternion.copy(this.quaternion),e.scale.copy(this.scale),e.renderDepth=this.renderDepth,e.rotationAutoUpdate=this.rotationAutoUpdate,e.matrix.copy(this.matrix),e.matrixWorld.copy(this.matrixWorld),e.matrixAutoUpdate=this.matrixAutoUpdate,e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,e.visible=this.visible,e.castShadow=this.castShadow,e.receiveShadow=this.receiveShadow,e.frustumCulled=this.frustumCulled,e.userData=JSON.parse(JSON.stringify(this.userData));if(!0===t)for(var n=0;n<this.children.length;n++)e.add(this.children[n].clone());return e}},THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype),THREE.Object3DIdCount=0,THREE.Projector=function(){function e(){if(a===l){var e=new THREE.RenderableVertex;return f.push(e),l++,a++,e}return f[a++]}function t(e,t){return e.z!==t.z?t.z-e.z:e.id!==t.id?e.id-t.id:0}function n(e,t){var n=0,r=1,i=e.z+e.w,s=t.z+t.w,o=-e.z+e.w,u=-t.z+t.w;return 0<=i&&0<=s&&0<=o&&0<=u?!0:0>i&&0>s||0>o&&0>u?!1:(0>i?n=Math.max(n,i/(i-s)):0>s&&(r=Math.min(r,i/(i-s))),0>o?n=Math.max(n,o/(o-u)):0>u&&(r=Math.min(r,o/(o-u))),r<n?!1:(e.lerp(t,n),t.lerp(e,1-r),!0))}var r,i,s=[],o=0,u,a,f=[],l=0,c,h,p=[],d=0,v,m,g=[],y=0,b,w,E=[],S=0,x={objects:[],sprites:[],lights:[],elements:[]},T=new THREE.Vector3,N=new THREE.Vector3,C=new THREE.Vector3,k=new THREE.Vector3,L=new THREE.Vector4,A=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),O=new THREE.Box3,M=Array(3),_=new THREE.Matrix4,D=new THREE.Matrix4,P,H=new THREE.Matrix4,B=new THREE.Matrix3,j=new THREE.Matrix3,F=new THREE.Vector3,I=new THREE.Frustum,q=new THREE.Vector4,R=new THREE.Vector4;this.projectVector=function(e,t){return t.matrixWorldInverse.getInverse(t.matrixWorld),D.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),e.applyProjection(D)};var U=new THREE.Matrix4;this.unprojectVector=function(e,t){return U.getInverse(t.projectionMatrix),D.multiplyMatrices(t.matrixWorld,U),e.applyProjection(D)},this.pickingRay=function(e,t){e.z=-1;var n=new THREE.Vector3(e.x,e.y,1);return this.unprojectVector(e,t),this.unprojectVector(n,t),n.sub(e).normalize(),new THREE.Raycaster(e,n)};var z=function(e){if(i===o){var t=new THREE.RenderableObject;s.push(t),o++,i++,r=t}else r=s[i++];return r.id=e.id,r.object=e,null!==e.renderDepth?r.z=e.renderDepth:(k.setFromMatrixPosition(e.matrixWorld),k.applyProjection(D),r.z=k.z),r},W=function(e){var t=e.positionWorld,n=e.positionScreen;t.copy(e.position).applyMatrix4(P),n.copy(t).applyMatrix4(D),t=1/n.w,n.x*=t,n.y*=t,n.z*=t,e.visible=-1<=n.x&&1>=n.x&&-1<=n.y&&1>=n.y&&-1<=n.z&&1>=n.z},X=function(e){if(!1!==e.visible){e instanceof THREE.Light?x.lights.push(e):e instanceof THREE.Mesh||e instanceof THREE.Line?(!1===e.frustumCulled||!0===I.intersectsObject(e))&&x.objects.push(z(e)):e instanceof THREE.Sprite&&x.sprites.push(z(e));for(var t=0,n=e.children.length;t<n;t++)X(e.children[t])}};this.projectScene=function(r,s,o,l){var k=!1,U,z,V,$,J,Q,Y,Z,et;w=m=h=0,x.elements.length=0,!0===r.autoUpdate&&r.updateMatrixWorld(),void 0===s.parent&&s.updateMatrixWorld(),_.copy(s.matrixWorldInverse.getInverse(s.matrixWorld)),D.multiplyMatrices(s.projectionMatrix,_),j.getNormalMatrix(_),I.setFromMatrix(D),i=0,x.objects.length=0,x.sprites.length=0,x.lights.length=0,X(r),!0===o&&x.objects.sort(t);for(var o=0,tt=x.objects.length;o<tt;o++)if(r=x.objects[o].object,P=r.matrixWorld,a=0,r instanceof THREE.Mesh){U=r.geometry,z=U.vertices,V=U.faces,J=U.faceVertexUvs,B.getNormalMatrix(P),Z=r.material instanceof THREE.MeshFaceMaterial,et=!0===Z?r.material:null;for(var nt=0,rt=z.length;nt<rt;nt++)u=e(),u.position.copy(z[nt]),W(u);nt=0;for(rt=V.length;nt<rt;nt++){z=V[nt];var it=!0===Z?et.materials[z.materialIndex]:r.material;if(void 0!==it){var st=it.side;$=f[z.a],Q=f[z.b],Y=f[z.c];if(!0===it.morphTargets){var k=U.morphTargets,ot=r.morphTargetInfluences,ut=$.position,at=Q.position,ft=Y.position;T.set(0,0,0),N.set(0,0,0),C.set(0,0,0);for(var lt=0,ct=k.length;lt<ct;lt++){var ht=ot[lt];if(0!==ht){var pt=k[lt].vertices;T.x+=(pt[z.a].x-ut.x)*ht,T.y+=(pt[z.a].y-ut.y)*ht,T.z+=(pt[z.a].z-ut.z)*ht,N.x+=(pt[z.b].x-at.x)*ht,N.y+=(pt[z.b].y-at.y)*ht,N.z+=(pt[z.b].z-at.z)*ht,C.x+=(pt[z.c].x-ft.x)*ht,C.y+=(pt[z.c].y-ft.y)*ht,C.z+=(pt[z.c].z-ft.z)*ht}}$.position.add(T),Q.position.add(N),Y.position.add(C),W($),W(Q),W(Y)}M[0]=$.positionScreen,M[1]=Q.positionScreen,M[2]=Y.positionScreen;if(!0===$.visible||!0===Q.visible||!0===Y.visible||A.isIntersectionBox(O.setFromPoints(M)))if(k=0>(Y.positionScreen.x-$.positionScreen.x)*(Q.positionScreen.y-$.positionScreen.y)-(Y.positionScreen.y-$.positionScreen.y)*(Q.positionScreen.x-$.positionScreen.x),st===THREE.DoubleSide||k===(st===THREE.FrontSide)){h===d?(ot=new THREE.RenderableFace3,p.push(ot),d++,h++,c=ot):c=p[h++],c.id=r.id,c.v1.copy($),c.v2.copy(Q),c.v3.copy(Y),c.normalModel.copy(z.normal),!1===k&&(st===THREE.BackSide||st===THREE.DoubleSide)&&c.normalModel.negate(),c.normalModel.applyMatrix3(B).normalize(),c.normalModelView.copy(c.normalModel).applyMatrix3(j),c.centroidModel.copy(z.centroid).applyMatrix4(P),$=z.vertexNormals,Q=0;for(Y=Math.min($.length,3);Q<Y;Q++)ot=c.vertexNormalsModel[Q],ot.copy($[Q]),!1===k&&(st===THREE.BackSide||st===THREE.DoubleSide)&&ot.negate(),ot.applyMatrix3(B).normalize(),c.vertexNormalsModelView[Q].copy(ot).applyMatrix3(j);c.vertexNormalsLength=$.length,Q=0;for(st=Math.min(J.length,3);Q<st;Q++)if($=J[Q][nt],void 0!==$){Y=0;for(k=$.length;Y<k;Y++)c.uvs[Q][Y]=$[Y]}c.color=z.color,c.material=it,F.copy(c.centroidModel).applyProjection(D),c.z=F.z,x.elements.push(c)}}}}else if(r instanceof THREE.Line){H.multiplyMatrices(D,P),z=r.geometry.vertices,$=e(),$.positionScreen.copy(z[0]).applyMatrix4(H),U=r.type===THREE.LinePieces?2:1,nt=1;for(rt=z.length;nt<rt;nt++)$=e(),$.positionScreen.copy(z[nt]).applyMatrix4(H),0<(nt+1)%U||(Q=f[a-2],q.copy($.positionScreen),R.copy(Q.positionScreen),!0===n(q,R)&&(q.multiplyScalar(1/q.w),R.multiplyScalar(1/R.w),m===y?(V=new THREE.RenderableLine,g.push(V),y++,m++,v=V):v=g[m++],v.id=r.id,v.v1.positionScreen.copy(q),v.v2.positionScreen.copy(R),v.z=Math.max(q.z,R.z),v.material=r.material,r.material.vertexColors===THREE.VertexColors&&(v.vertexColors[0].copy(r.geometry.colors[nt]),v.vertexColors[1].copy(r.geometry.colors[nt-1])),x.elements.push(v)))}o=0;for(tt=x.sprites.length;o<tt;o++)r=x.sprites[o].object,P=r.matrixWorld,L.set(P.elements[12],P.elements[13],P.elements[14],1),L.applyMatrix4(D),U=1/L.w,L.z*=U,-1<=L.z&&1>=L.z&&(w===S?(V=new THREE.RenderableSprite,E.push(V),S++,w++,b=V):b=E[w++],b.id=r.id,b.x=L.x*U,b.y=L.y*U,b.z=L.z,b.object=r,b.rotation=r.rotation,b.scale.x=r.scale.x*Math.abs(b.x-(L.x+s.projectionMatrix.elements[0])/(L.w+s.projectionMatrix.elements[12])),b.scale.y=r.scale.y*Math.abs(b.y-(L.y+s.projectionMatrix.elements[5])/(L.w+s.projectionMatrix.elements[13])),b.material=r.material,x.elements.push(b));return!0===l&&x.elements.sort(t),x}},THREE.Face3=function(e,t,n,r,i,s){this.a=e,this.b=t,this.c=n,this.normal=r instanceof THREE.Vector3?r:new THREE.Vector3,this.vertexNormals=r instanceof Array?r:[],this.color=i instanceof THREE.Color?i:new THREE.Color,this.vertexColors=i instanceof Array?i:[],this.vertexTangents=[],this.materialIndex=void 0!==s?s:0,this.centroid=new THREE.Vector3},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var e=new THREE.Face3(this.a,this.b,this.c);e.normal.copy(this.normal),e.color.copy(this.color),e.centroid.copy(this.centroid),e.materialIndex=this.materialIndex;var t,n;t=0;for(n=this.vertexNormals.length;t<n;t++)e.vertexNormals[t]=this.vertexNormals[t].clone();t=0;for(n=this.vertexColors.length;t<n;t++)e.vertexColors[t]=this.vertexColors[t].clone();t=0;for(n=this.vertexTangents.length;t<n;t++)e.vertexTangents[t]=this.vertexTangents[t].clone();return e}},THREE.Face4=function(e,t,n,r,i,s,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new THREE.Face3(e,t,n,i,s,o)},THREE.Geometry=function(){this.id=THREE.GeometryIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.hasTangents=!1,this.dynamic=!0,this.buffersNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(e){for(var t=(new THREE.Matrix3).getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++)this.vertices[n].applyMatrix4(e);n=0;for(r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(t).normalize();for(var s=0,o=i.vertexNormals.length;s<o;s++)i.vertexNormals[s].applyMatrix3(t).normalize();i.centroid.applyMatrix4(e)}this.boundingBox instanceof THREE.Box3&&this.computeBoundingBox(),this.boundingSphere instanceof THREE.Sphere&&this.computeBoundingSphere()},computeCentroids:function(){var e,t,n;e=0;for(t=this.faces.length;e<t;e++)n=this.faces[e],n.centroid.set(0,0,0),n.centroid.add(this.vertices[n.a]),n.centroid.add(this.vertices[n.b]),n.centroid.add(this.vertices[n.c]),n.centroid.divideScalar(3)},computeFaceNormals:function(){for(var e=new THREE.Vector3,t=new THREE.Vector3,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],s=this.vertices[i.a],o=this.vertices[i.b];e.subVectors(this.vertices[i.c],o),t.subVectors(s,o),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,n,r;r=Array(this.vertices.length),t=0;for(n=this.vertices.length;t<n;t++)r[t]=new THREE.Vector3;if(e){var i,s,o,u=new THREE.Vector3,a=new THREE.Vector3;new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,e=0;for(t=this.faces.length;e<t;e++)n=this.faces[e],i=this.vertices[n.a],s=this.vertices[n.b],o=this.vertices[n.c],u.subVectors(o,s),a.subVectors(i,s),u.cross(a),r[n.a].add(u),r[n.b].add(u),r[n.c].add(u)}else{e=0;for(t=this.faces.length;e<t;e++)n=this.faces[e],r[n.a].add(n.normal),r[n.b].add(n.normal),r[n.c].add(n.normal)}t=0;for(n=this.vertices.length;t<n;t++)r[t].normalize();e=0;for(t=this.faces.length;e<t;e++)n=this.faces[e],n.vertexNormals[0]=r[n.a].clone(),n.vertexNormals[1]=r[n.b].clone(),n.vertexNormals[2]=r[n.c].clone()},computeMorphNormals:function(){var e,t,n,r,i;n=0;for(r=this.faces.length;n<r;n++){i=this.faces[n],i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0;for(t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone()}var s=new THREE.Geometry;s.faces=this.faces,e=0;for(t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[],i=this.morphNormals[e].faceNormals;var o=this.morphNormals[e].vertexNormals,u,a;n=0;for(r=this.faces.length;n<r;n++)u=new THREE.Vector3,a={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},i.push(u),o.push(a)}o=this.morphNormals[e],s.vertices=this.morphTargets[e].vertices,s.computeFaceNormals(),s.computeVertexNormals(),n=0;for(r=this.faces.length;n<r;n++)i=this.faces[n],u=o.faceNormals[n],a=o.vertexNormals[n],u.copy(i.normal),a.a.copy(i.vertexNormals[0]),a.b.copy(i.vertexNormals[1]),a.c.copy(i.vertexNormals[2])}n=0;for(r=this.faces.length;n<r;n++)i=this.faces[n],i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeTangents:function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g=[],y=[];n=new THREE.Vector3;var b=new THREE.Vector3,w=new THREE.Vector3,E=new THREE.Vector3,S=new THREE.Vector3;e=0;for(t=this.vertices.length;e<t;e++)g[e]=new THREE.Vector3,y[e]=new THREE.Vector3;e=0;for(t=this.faces.length;e<t;e++)i=this.faces[e],s=this.faceVertexUvs[0][e],r=i.a,m=i.b,i=i.c,o=this.vertices[r],u=this.vertices[m],a=this.vertices[i],f=s[0],l=s[1],c=s[2],s=u.x-o.x,h=a.x-o.x,p=u.y-o.y,d=a.y-o.y,u=u.z-o.z,o=a.z-o.z,a=l.x-f.x,v=c.x-f.x,l=l.y-f.y,f=c.y-f.y,c=1/(a*f-v*l),n.set((f*s-l*h)*c,(f*p-l*d)*c,(f*u-l*o)*c),b.set((a*h-v*s)*c,(a*d-v*p)*c,(a*o-v*u)*c),g[r].add(n),g[m].add(n),g[i].add(n),y[r].add(b),y[m].add(b),y[i].add(b);b=["a","b","c","d"],e=0;for(t=this.faces.length;e<t;e++){i=this.faces[e];for(n=0;n<Math.min(i.vertexNormals.length,3);n++)S.copy(i.vertexNormals[n]),r=i[b[n]],m=g[r],w.copy(m),w.sub(S.multiplyScalar(S.dot(m))).normalize(),E.crossVectors(i.vertexNormals[n],m),r=E.dot(y[r]),r=0>r?-1:1,i.vertexTangents[n]=new THREE.Vector4(w.x,w.y,w.z,r)}this.hasTangents=!0},computeLineDistances:function(){for(var e=0,t=this.vertices,n=0,r=t.length;n<r;n++)0<n&&(e+=t[n].distanceTo(t[n-1])),this.lineDistances[n]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.boundingSphere.setFromPoints(this.vertices)},mergeVertices:function(){var e={},t=[],n=[],r,i=Math.pow(10,4),s,o;s=0;for(o=this.vertices.length;s<o;s++)r=this.vertices[s],r=Math.round(r.x*i)+"_"+Math.round(r.y*i)+"_"+Math.round(r.z*i),void 0===e[r]?(e[r]=s,t.push(this.vertices[s]),n[s]=t.length-1):n[s]=n[e[r]];e=[],s=0;for(o=this.faces.length;s<o;s++){i=this.faces[s],i.a=n[i.a],i.b=n[i.b],i.c=n[i.c],i=[i.a,i.b,i.c];for(r=0;3>r;r++)if(i[r]==i[(r+1)%3]){e.push(s);break}}for(s=e.length-1;0<=s;s--){i=e[s],this.faces.splice(i,1),n=0;for(o=this.faceVertexUvs.length;n<o;n++)this.faceVertexUvs[n].splice(i,1)}return s=this.vertices.length-t.length,this.vertices=t,s},clone:function(){for(var e=new THREE.Geometry,t=this.vertices,n=0,r=t.length;n<r;n++)e.vertices.push(t[n].clone());t=this.faces,n=0;for(r=t.length;n<r;n++)e.faces.push(t[n].clone());t=this.faceVertexUvs[0],n=0;for(r=t.length;n<r;n++){for(var i=t[n],s=[],o=0,u=i.length;o<u;o++)s.push(new THREE.Vector2(i[o].x,i[o].y));e.faceVertexUvs[0].push(s)}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype),THREE.GeometryIdCount=0,THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.attributes={},this.dynamic=!0,this.offsets=[],this.boundingSphere=this.boundingBox=null,this.hasTangents=!1,this.morphTargets=[]},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addAttribute:function(e,t,n,r){this.attributes[e]={itemSize:r,array:new t(n*r)}},applyMatrix:function(e){var t,n;this.attributes.position&&(t=this.attributes.position.array),this.attributes.normal&&(n=this.attributes.normal.array),void 0!==t&&(e.multiplyVector3Array(t),this.verticesNeedUpdate=!0),void 0!==n&&((new THREE.Matrix3).getNormalMatrix(e).multiplyVector3Array(n),this.normalizeNormals(),this.normalsNeedUpdate=!0)},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var e=this.attributes.position.array;if(e){var t=this.boundingBox,n,r,i;3<=e.length&&(t.min.x=t.max.x=e[0],t.min.y=t.max.y=e[1],t.min.z=t.max.z=e[2]);for(var s=3,o=e.length;s<o;s+=3)n=e[s],r=e[s+1],i=e[s+2],n<t.min.x?t.min.x=n:n>t.max.x&&(t.max.x=n),r<t.min.y?t.min.y=r:r>t.max.y&&(t.max.y=r),i<t.min.z?t.min.z=i:i>t.max.z&&(t.max.z=i)}if(void 0===e||0===e.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)},computeBoundingSphere:function(){var e=new THREE.Box3,t=new THREE.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var n=this.attributes.position.array;if(n){e.makeEmpty();for(var r=this.boundingSphere.center,i=0,s=n.length;i<s;i+=3)t.set(n[i],n[i+1],n[i+2]),e.addPoint(t);e.center(r);for(var o=0,i=0,s=n.length;i<s;i+=3)t.set(n[i],n[i+1],n[i+2]),o=Math.max(o,r.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(o)}}}(),computeVertexNormals:function(){if(this.attributes.position){var e,t,n,r;e=this.attributes.position.array.length;if(void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(e)};else{e=0;for(t=this.attributes.normal.array.length;e<t;e++)this.attributes.normal.array[e]=0}var i=this.attributes.position.array,s=this.attributes.normal.array,o,u,a,f,l,c,h=new THREE.Vector3,p=new THREE.Vector3,d=new THREE.Vector3,v=new THREE.Vector3,m=new THREE.Vector3;if(this.attributes.index){var g=this.attributes.index.array,y=this.offsets;n=0;for(r=y.length;n<r;++n){t=y[n].start,o=y[n].count;var b=y[n].index;e=t;for(t+=o;e<t;e+=3)o=b+g[e],u=b+g[e+1],a=b+g[e+2],f=i[3*o],l=i[3*o+1],c=i[3*o+2],h.set(f,l,c),f=i[3*u],l=i[3*u+1],c=i[3*u+2],p.set(f,l,c),f=i[3*a],l=i[3*a+1],c=i[3*a+2],d.set(f,l,c),v.subVectors(d,p),m.subVectors(h,p),v.cross(m),s[3*o]+=v.x,s[3*o+1]+=v.y,s[3*o+2]+=v.z,s[3*u]+=v.x,s[3*u+1]+=v.y,s[3*u+2]+=v.z,s[3*a]+=v.x,s[3*a+1]+=v.y,s[3*a+2]+=v.z}}else{e=0;for(t=i.length;e<t;e+=9)f=i[e],l=i[e+1],c=i[e+2],h.set(f,l,c),f=i[e+3],l=i[e+4],c=i[e+5],p.set(f,l,c),f=i[e+6],l=i[e+7],c=i[e+8],d.set(f,l,c),v.subVectors(d,p),m.subVectors(h,p),v.cross(m),s[e]=v.x,s[e+1]=v.y,s[e+2]=v.z,s[e+3]=v.x,s[e+4]=v.y,s[e+5]=v.z,s[e+6]=v.x,s[e+7]=v.y,s[e+8]=v.z}this.normalizeNormals(),this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var e=this.attributes.normal.array,t,n,r,i=0,s=e.length;i<s;i+=3)t=e[i],n=e[i+1],r=e[i+2],t=1/Math.sqrt(t*t+n*n+r*r),e[i]*=t,e[i+1]*=t,e[i+2]*=t},computeTangents:function(){function e(e){B.x=r[3*e],B.y=r[3*e+1],B.z=r[3*e+2],j.copy(B),I=u[e],P.copy(I),P.sub(B.multiplyScalar(B.dot(I))).normalize(),H.crossVectors(j,I),q=H.dot(a[e]),F=0>q?-1:1,o[4*e]=P.x,o[4*e+1]=P.y,o[4*e+2]=P.z,o[4*e+3]=F}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var t=this.attributes.index.array,n=this.attributes.position.array,r=this.attributes.normal.array,i=this.attributes.uv.array,s=n.length/3;void 0===this.attributes.tangent&&(this.attributes.tangent={itemSize:4,array:new Float32Array(4*s)});for(var o=this.attributes.tangent.array,u=[],a=[],f=0;f<s;f++)u[f]=new THREE.Vector3,a[f]=new THREE.Vector3;var l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,s=new THREE.Vector3,f=new THREE.Vector3,N,C,k,L,A,O,M,_=this.offsets;k=0;for(L=_.length;k<L;++k){C=_[k].start,A=_[k].count;var D=_[k].index;N=C;for(C+=A;N<C;N+=3)A=D+t[N],O=D+t[N+1],M=D+t[N+2],l=n[3*A],c=n[3*A+1],h=n[3*A+2],p=n[3*O],d=n[3*O+1],v=n[3*O+2],m=n[3*M],g=n[3*M+1],y=n[3*M+2],b=i[2*A],w=i[2*A+1],E=i[2*O],S=i[2*O+1],x=i[2*M],T=i[2*M+1],p-=l,l=m-l,d-=c,c=g-c,v-=h,h=y-h,E-=b,b=x-b,S-=w,w=T-w,T=1/(E*w-b*S),s.set((w*p-S*l)*T,(w*d-S*c)*T,(w*v-S*h)*T),f.set((E*l-b*p)*T,(E*c-b*d)*T,(E*h-b*v)*T),u[A].add(s),u[O].add(s),u[M].add(s),a[A].add(f),a[O].add(f),a[M].add(f)}var P=new THREE.Vector3,H=new THREE.Vector3,B=new THREE.Vector3,j=new THREE.Vector3,F,I,q;k=0;for(L=_.length;k<L;++k){C=_[k].start,A=_[k].count,D=_[k].index,N=C;for(C+=A;N<C;N+=3)A=D+t[N],O=D+t[N+1],M=D+t[N+2],e(A),e(O),e(M)}this.tangentsNeedUpdate=this.hasTangents=!0}},clone:function(){var e=new THREE.BufferGeometry,t=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],n;for(n in this.attributes){for(var r=this.attributes[n],i=r.array,s={itemSize:r.itemSize,numItems:r.numItems,array:null},r=0,o=t.length;r<o;r++){var u=t[r];if(i instanceof u){s.array=new u(i);break}}e.attributes[n]=s}r=0;for(o=this.offsets.length;r<o;r++)t=this.offsets[r],e.offsets.push({start:t.start,index:t.index,count:t.count});return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype),THREE.Camera=function(){THREE.Object3D.call(this),this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.lookAt=function(){var e=new THREE.Matrix4;return function(t){e.lookAt(this.position,t,this.up),this.quaternion.setFromRotationMatrix(e)}}(),THREE.Camera.prototype.clone=function(e){return void 0===e&&(e=new THREE.Camera),THREE.Object3D.prototype.clone.call(this,e),e.matrixWorldInverse.copy(this.matrixWorldInverse),e.projectionMatrix.copy(this.projectionMatrix),e},THREE.OrthographicCamera=function(e,t,n,r,i,s){THREE.Camera.call(this),this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==s?s:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)},THREE.OrthographicCamera.prototype.clone=function(){var e=new THREE.OrthographicCamera;return THREE.Camera.prototype.clone.call(this,e),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e},THREE.PerspectiveCamera=function(e,t,n,r){THREE.Camera.call(this),this.fov=void 0!==e?e:50,this.aspect=void 0!==t?t:1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.setLens=function(e,t){void 0===t&&(t=24),this.fov=2*THREE.Math.radToDeg(Math.atan(t/(2*e))),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(e,t,n,r,i,s){this.fullWidth=e,this.fullHeight=t,this.x=n,this.y=r,this.width=i,this.height=s,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var e=this.fullWidth/this.fullHeight,t=Math.tan(THREE.Math.degToRad(.5*this.fov))*this.near,n=-t,r=e*n,e=Math.abs(e*t-r),n=Math.abs(t-n);this.projectionMatrix.makeFrustum(r+this.x*e/this.fullWidth,r+(this.x+this.width)*e/this.fullWidth,t-(this.y+this.height)*n/this.fullHeight,t-this.y*n/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)},THREE.PerspectiveCamera.prototype.clone=function(){var e=new THREE.PerspectiveCamera;return THREE.Camera.prototype.clone.call(this,e),e.fov=this.fov,e.aspect=this.aspect,e.near=this.near,e.far=this.far,e},THREE.Light=function(e){THREE.Object3D.call(this),this.color=new THREE.Color(e)},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.clone=function(e){return void 0===e&&(e=new THREE.Light),THREE.Object3D.prototype.clone.call(this,e),e.color.copy(this.color),e},THREE.AmbientLight=function(e){THREE.Light.call(this,e)},THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype),THREE.AmbientLight.prototype.clone=function(){var e=new THREE.AmbientLight;return THREE.Light.prototype.clone.call(this,e),e},THREE.AreaLight=function(e,t){THREE.Light.call(this,e),this.normal=new THREE.Vector3(0,-1,0),this.right=new THREE.Vector3(1,0,0),this.intensity=void 0!==t?t:1,this.height=this.width=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},THREE.AreaLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight=function(e,t){THREE.Light.call(this,e),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==t?t:1,this.onlyShadow=this.castShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraTop=this.shadowCameraRight=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapHeight=this.shadowMapWidth=512,this.shadowCascade=!1,this.shadowCascadeOffset=new THREE.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null},THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight.prototype.clone=function(){var e=new THREE.DirectionalLight;return THREE.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e},THREE.HemisphereLight=function(e,t,n){THREE.Light.call(this,e),this.position.set(0,100,0),this.groundColor=new THREE.Color(t),this.intensity=void 0!==n?n:1},THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype),THREE.HemisphereLight.prototype.clone=function(){var e=new THREE.HemisphereLight;return THREE.Light.prototype.clone.call(this,e),e.groundColor.copy(this.groundColor),e.intensity=this.intensity,e},THREE.PointLight=function(e,t,n){THREE.Light.call(this,e),this.intensity=void 0!==t?t:1,this.distance=void 0!==n?n:0},THREE.PointLight.prototype=Object.create(THREE.Light.prototype),THREE.PointLight.prototype.clone=function(){var e=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,e),e.intensity=this.intensity,e.distance=this.distance,e},THREE.SpotLight=function(e,t,n,r,i){THREE.Light.call(this,e),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==t?t:1,this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.exponent=void 0!==i?i:10,this.onlyShadow=this.castShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapHeight=this.shadowMapWidth=512,this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null},THREE.SpotLight.prototype=Object.create(THREE.Light.prototype),THREE.SpotLight.prototype.clone=function(){var e=new THREE.SpotLight;return THREE.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.distance=this.distance,e.angle=this.angle,e.exponent=this.exponent,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e},THREE.Loader=function(e){this.statusDomElement=(this.showStatus=e)?THREE.Loader.prototype.addStatusElement():null,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,addStatusElement:function(){var e=document.createElement("div");return e.style.position="absolute",e.style.right="0px",e.style.top="0px",e.style.fontSize="0.8em",e.style.textAlign="left",e.style.background="rgba(0,0,0,0.25)",e.style.color="#fff",e.style.width="120px",e.style.padding="0.5em 0.5em 0.5em 0.5em",e.style.zIndex=1e3,e.innerHTML="Loading ...",e},updateProgress:function(e){var t="Loaded ",t=e.total?t+((100*e.loaded/e.total).toFixed(0)+"%"):t+((e.loaded/1e3).toFixed(2)+" KB");this.statusDomElement.innerHTML=t},extractUrlBase:function(e){return e=e.split("/"),e.pop(),(1>e.length?".":e.join("/"))+"/"},initMaterials:function(e,t){for(var n=[],r=0;r<e.length;++r)n[r]=THREE.Loader.prototype.createMaterial(e[r],t);return n},needsTangents:function(e){for(var t=0,n=e.length;t<n;t++)if(e[t]instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(e,t){function n(e){return e=Math.log(e)/Math.LN2,Math.floor(e)==e}function r(e){return e=Math.log(e)/Math.LN2,Math.pow(2,Math.round(e))}function i(e,i,s,u,a,f,l){var h=/\.dds$/i.test(s),p=t+"/"+s;if(h){var v=THREE.ImageUtils.loadCompressedTexture(p);e[i]=v}else v=document.createElement("canvas"),e[i]=new THREE.Texture(v);e[i].sourceFile=s,u&&(e[i].repeat.set(u[0],u[1]),1!==u[0]&&(e[i].wrapS=THREE.RepeatWrapping),1!==u[1]&&(e[i].wrapT=THREE.RepeatWrapping)),a&&e[i].offset.set(a[0],a[1]),f&&(s={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==s[f[0]]&&(e[i].wrapS=s[f[0]]),void 0!==s[f[1]]&&(e[i].wrapT=s[f[1]])),l&&(e[i].anisotropy=l);if(!h){var m=e[i],e=new Image;e.onload=function(){if(!n(this.width)||!n(this.height)){var e=r(this.width),t=r(this.height);m.image.width=e,m.image.height=t,m.image.getContext("2d").drawImage(this,0,0,e,t)}else m.image=this;m.needsUpdate=!0},void 0!==o.crossOrigin&&(e.crossOrigin=o.crossOrigin),e.src=p}}function s(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]}var o=this,u="MeshLambertMaterial",a={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(e.shading){var f=e.shading.toLowerCase();"phong"===f?u="MeshPhongMaterial":"basic"===f&&(u="MeshBasicMaterial")}void 0!==e.blending&&void 0!==THREE[e.blending]&&(a.blending=THREE[e.blending]);if(void 0!==e.transparent||1>e.opacity)a.transparent=e.transparent;return void 0!==e.depthTest&&(a.depthTest=e.depthTest),void 0!==e.depthWrite&&(a.depthWrite=e.depthWrite),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.flipSided&&(a.side=THREE.BackSide),void 0!==e.doubleSided&&(a.side=THREE.DoubleSide),void 0!==e.wireframe&&(a.wireframe=e.wireframe),void 0!==e.vertexColors&&("face"===e.vertexColors?a.vertexColors=THREE.FaceColors:e.vertexColors&&(a.vertexColors=THREE.VertexColors)),e.colorDiffuse?a.color=s(e.colorDiffuse):e.DbgColor&&(a.color=e.DbgColor),e.colorSpecular&&(a.specular=s(e.colorSpecular)),e.colorAmbient&&(a.ambient=s(e.colorAmbient)),e.transparency&&(a.opacity=e.transparency),e.specularCoef&&(a.shininess=e.specularCoef),e.mapDiffuse&&t&&i(a,"map",e.mapDiffuse,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy),e.mapLight&&t&&i(a,"lightMap",e.mapLight,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy),e.mapBump&&t&&i(a,"bumpMap",e.mapBump,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy),e.mapNormal&&t&&i(a,"normalMap",e.mapNormal,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy),e.mapSpecular&&t&&i(a,"specularMap",e.mapSpecular,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy),e.mapBumpScale&&(a.bumpScale=e.mapBumpScale),e.mapNormal?(u=THREE.ShaderLib.normalmap,f=THREE.UniformsUtils.clone(u.uniforms),f.tNormal.value=a.normalMap,e.mapNormalFactor&&f.uNormalScale.value.set(e.mapNormalFactor,e.mapNormalFactor),a.map&&(f.tDiffuse.value=a.map,f.enableDiffuse.value=!0),a.specularMap&&(f.tSpecular.value=a.specularMap,f.enableSpecular.value=!0),a.lightMap&&(f.tAO.value=a.lightMap,f.enableAO.value=!0),f.diffuse.value.setHex(a.color),f.specular.value.setHex(a.specular),f.ambient.value.setHex(a.ambient),f.shininess.value=a.shininess,void 0!==a.opacity&&(f.opacity.value=a.opacity),u=new THREE.ShaderMaterial({fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,uniforms:f,lights:!0,fog:!0}),a.transparent&&(u.transparent=!0)):u=new THREE[u](a),void 0!==e.DbgName&&(u.name=e.DbgName),u}},THREE.XHRLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(e,t,n,r){var i=this,s=new XMLHttpRequest;void 0!==t&&s.addEventListener("load",function(n){t(n.target.responseText),i.manager.itemEnd(e)},!1),void 0!==n&&s.addEventListener("progress",function(e){n(e)},!1),void 0!==r&&s.addEventListener("error",function(e){r(e)},!1),void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),s.open("GET",e,!0),s.send(null),i.manager.itemStart(e)},setCrossOrigin:function(e){this.crossOrigin=e}},THREE.ImageLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(e,t,n,r){var i=this,s=document.createElement("img");return void 0!==t&&s.addEventListener("load",function(){i.manager.itemEnd(e),t(this)},!1),void 0!==n&&s.addEventListener("progress",function(e){n(e)},!1),void 0!==r&&s.addEventListener("error",function(e){r(e)},!1),void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),s.src=e,i.manager.itemStart(e),s},setCrossOrigin:function(e){this.crossOrigin=e}},THREE.JSONLoader=function(e){THREE.Loader.call(this,e),this.withCredentials=!1},THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype),THREE.JSONLoader.prototype.load=function(e,t,n){n=n&&"string"==typeof n?n:this.extractUrlBase(e),this.onLoadStart(),this.loadAjaxJSON(this,e,t,n)},THREE.JSONLoader.prototype.loadAjaxJSON=function(e,t,n,r,i){var s=new XMLHttpRequest,o=0;s.onreadystatechange=function(){if(s.readyState===s.DONE)if(200===s.status||0===s.status){if(s.responseText){var u=JSON.parse(s.responseText),u=e.parse(u,r);n(u.geometry,u.materials)}else console.warn("THREE.JSONLoader: ["+t+"] seems to be unreachable or file there is empty");e.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load ["+t+"] ["+s.status+"]");else s.readyState===s.LOADING?i&&(0===o&&(o=s.getResponseHeader("Content-Length")),i({total:o,loaded:s.responseText.length})):s.readyState===s.HEADERS_RECEIVED&&void 0!==i&&(o=s.getResponseHeader("Content-Length"))},s.open("GET",t,!0),s.withCredentials=this.withCredentials,s.send(null)},THREE.JSONLoader.prototype.parse=function(e,t){var n=new THREE.Geometry,r=void 0!==e.scale?1/e.scale:1,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y=e.faces;h=e.vertices;var b=e.normals,w=e.colors,E=0;if(void 0!==e.uvs){for(i=0;i<e.uvs.length;i++)e.uvs[i].length&&E++;for(i=0;i<E;i++)n.faceVertexUvs[i]=[]}u=0;for(a=h.length;u<a;)f=new THREE.Vector3,f.x=h[u++]*r,f.y=h[u++]*r,f.z=h[u++]*r,n.vertices.push(f);u=0;for(a=y.length;u<a;)if(h=y[u++],p=h&1,o=h&2,i=h&8,l=h&16,d=h&32,f=h&64,h&=128,p){p=new THREE.Face3,p.a=y[u],p.b=y[u+1],p.c=y[u+3],v=new THREE.Face3,v.a=y[u+1],v.b=y[u+2],v.c=y[u+3],u+=4,o&&(o=y[u++],p.materialIndex=o,v.materialIndex=o),o=n.faces.length;if(i)for(i=0;i<E;i++){m=e.uvs[i],n.faceVertexUvs[i][o]=[],n.faceVertexUvs[i][o+1]=[];for(s=0;4>s;s++)c=y[u++],g=m[2*c],c=m[2*c+1],g=new THREE.Vector2(g,c),2!==s&&n.faceVertexUvs[i][o].push(g),0!==s&&n.faceVertexUvs[i][o+1].push(g)}l&&(l=3*y[u++],p.normal.set(b[l++],b[l++],b[l]),v.normal.copy(p.normal));if(d)for(i=0;4>i;i++)l=3*y[u++],d=new THREE.Vector3(b[l++],b[l++],b[l]),2!==i&&p.vertexNormals.push(d),0!==i&&v.vertexNormals.push(d);f&&(f=y[u++],f=w[f],p.color.setHex(f),v.color.setHex(f));if(h)for(i=0;4>i;i++)f=y[u++],f=w[f],2!==i&&p.vertexColors.push(new THREE.Color(f)),0!==i&&v.vertexColors.push(new THREE.Color(f));n.faces.push(p),n.faces.push(v)}else{p=new THREE.Face3,p.a=y[u++],p.b=y[u++],p.c=y[u++],o&&(o=y[u++],p.materialIndex=o),o=n.faces.length;if(i)for(i=0;i<E;i++){m=e.uvs[i],n.faceVertexUvs[i][o]=[];for(s=0;3>s;s++)c=y[u++],g=m[2*c],c=m[2*c+1],g=new THREE.Vector2(g,c),n.faceVertexUvs[i][o].push(g)}l&&(l=3*y[u++],p.normal.set(b[l++],b[l++],b[l]));if(d)for(i=0;3>i;i++)l=3*y[u++],d=new THREE.Vector3(b[l++],b[l++],b[l]),p.vertexNormals.push(d);f&&(f=y[u++],p.color.setHex(w[f]));if(h)for(i=0;3>i;i++)f=y[u++],p.vertexColors.push(new THREE.Color(w[f]));n.faces.push(p)}if(e.skinWeights){u=0;for(a=e.skinWeights.length;u<a;u+=2)y=e.skinWeights[u],b=e.skinWeights[u+1],n.skinWeights.push(new THREE.Vector4(y,b,0,0))}if(e.skinIndices){u=0;for(a=e.skinIndices.length;u<a;u+=2)y=e.skinIndices[u],b=e.skinIndices[u+1],n.skinIndices.push(new THREE.Vector4(y,b,0,0))}n.bones=e.bones,n.animation=e.animation,n.animations=e.animations;if(void 0!==e.morphTargets){u=0;for(a=e.morphTargets.length;u<a;u++){n.morphTargets[u]={},n.morphTargets[u].name=e.morphTargets[u].name,n.morphTargets[u].vertices=[],w=n.morphTargets[u].vertices,E=e.morphTargets[u].vertices,y=0;for(b=E.length;y<b;y+=3)h=new THREE.Vector3,h.x=E[y]*r,h.y=E[y+1]*r,h.z=E[y+2]*r,w.push(h)}}if(void 0!==e.morphColors){u=0;for(a=e.morphColors.length;u<a;u++){n.morphColors[u]={},n.morphColors[u].name=e.morphColors[u].name,n.morphColors[u].colors=[],b=n.morphColors[u].colors,w=e.morphColors[u].colors,r=0;for(y=w.length;r<y;r+=3)E=new THREE.Color(16755200),E.setRGB(w[r],w[r+1],w[r+2]),b.push(E)}}return n.computeCentroids(),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===e.materials?{geometry:n}:(r=this.initMaterials(e.materials,t),this.needsTangents(r)&&n.computeTangents(),{geometry:n,materials:r})},THREE.LoadingManager=function(e,t,n){var r=this,i=0,s=0;this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(){s++},this.itemEnd=function(e){i++,void 0!==r.onProgress&&r.onProgress(e,i,s),i===s&&void 0!==r.onLoad&&r.onLoad()}},THREE.DefaultLoadingManager=new THREE.LoadingManager,THREE.BufferGeometryLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(e,t){var n=this,r=new THREE.XHRLoader;r.setCrossOrigin(this.crossOrigin),r.load(e,function(e){t(n.parse(JSON.parse(e)))})},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=new THREE.BufferGeometry,n=e.attributes,r=e.offsets,e=e.boundingSphere,i;for(i in n){var s=n[i];t.attributes[i]={itemSize:s.itemSize,array:new self[s.type](s.array)}}return void 0!==r&&(t.offsets=JSON.parse(JSON.stringify(r))),void 0!==e&&(t.boundingSphere=new THREE.Sphere((new THREE.Vector3).fromArray(void 0!==e.center?e.center:[0,0,0]),e.radius)),t}},THREE.GeometryLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,load:function(e,t){var n=this,r=new THREE.XHRLoader;r.setCrossOrigin(this.crossOrigin),r.load(e,function(e){t(n.parse(JSON.parse(e)))})},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(){}},THREE.MaterialLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(e,t){var n=this,r=new THREE.XHRLoader;r.setCrossOrigin(this.crossOrigin),r.load(e,function(e){t(n.parse(JSON.parse(e)))})},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=new THREE[e.type];void 0!==e.color&&t.color.setHex(e.color),void 0!==e.ambient&&t.ambient.setHex(e.ambient),void 0!==e.emissive&&t.emissive.setHex(e.emissive),void 0!==e.specular&&t.specular.setHex(e.specular),void 0!==e.shininess&&(t.shininess=e.shininess),void 0!==e.vertexColors&&(t.vertexColors=e.vertexColors),void 0!==e.blending&&(t.blending=e.blending),void 0!==e.side&&(t.side=e.side),void 0!==e.opacity&&(t.opacity=e.opacity),void 0!==e.transparent&&(t.transparent=e.transparent),void 0!==e.wireframe&&(t.wireframe=e.wireframe);if(void 0!==e.materials)for(var n=0,r=e.materials.length;n<r;n++)t.materials.push(this.parse(e.materials[n]));return t}},THREE.ObjectLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(e,t){var n=this,r=new THREE.XHRLoader(n.manager);r.setCrossOrigin(this.crossOrigin),r.load(e,function(e){t(n.parse(JSON.parse(e)))})},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=this.parseGeometries(e.geometries),n=this.parseMaterials(e.materials);return this.parseObject(e.object,t,n)},parseGeometries:function(e){var t={};if(void 0!==e)for(var n=new THREE.JSONLoader,r=new THREE.BufferGeometryLoader,i=0,s=e.length;i<s;i++){var o,u=e[i];switch(u.type){case"PlaneGeometry":o=new THREE.PlaneGeometry(u.width,u.height,u.widthSegments,u.heightSegments);break;case"CircleGeometry":o=new THREE.CircleGeometry(u.radius,u.segments);break;case"CubeGeometry":o=new THREE.CubeGeometry(u.width,u.height,u.depth,u.widthSegments,u.heightSegments,u.depthSegments);break;case"CylinderGeometry":o=new THREE.CylinderGeometry(u.radiusTop,u.radiusBottom,u.height,u.radialSegments,u.heightSegments,u.openEnded);break;case"SphereGeometry":o=new THREE.SphereGeometry(u.radius,u.widthSegments,u.heightSegments,u.phiStart,u.phiLength,u.thetaStart,u.thetaLength);break;case"IcosahedronGeometry":o=new THREE.IcosahedronGeometry(u.radius,u.detail);break;case"TorusGeometry":o=new THREE.TorusGeometry(u.radius,u.tube,u.radialSegments,u.tubularSegments,u.arc);break;case"TorusKnotGeometry":o=new THREE.TorusKnotGeometry(u.radius,u.tube,u.radialSegments,u.tubularSegments,u.p,u.q,u.heightScale);break;case"BufferGeometry":o=r.parse(u.data);break;case"Geometry":o=n.parse(u.data).geometry}o.uuid=u.uuid,void 0!==u.name&&(o.name=u.name),t[u.uuid]=o}return t},parseMaterials:function(e){var t={};if(void 0!==e)for(var n=new THREE.MaterialLoader,r=0,i=e.length;r<i;r++){var s=e[r],o=n.parse(s);o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),t[s.uuid]=o}return t},parseObject:function(){var e=new THREE.Matrix4;return function(t,n,r){var i;switch(t.type){case"Scene":i=new THREE.Scene;break;case"PerspectiveCamera":i=new THREE.PerspectiveCamera(t.fov,t.aspect,t.near,t.far);break;case"OrthographicCamera":i=new THREE.OrthographicCamera(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":i=new THREE.AmbientLight(t.color);break;case"DirectionalLight":i=new THREE.DirectionalLight(t.color,t.intensity);break;case"PointLight":i=new THREE.PointLight(t.color,t.intensity,t.distance);break;case"SpotLight":i=new THREE.SpotLight(t.color,t.intensity,t.distance,t.angle,t.exponent);break;case"HemisphereLight":i=new THREE.HemisphereLight(t.color,t.groundColor,t.intensity);break;case"Mesh":i=n[t.geometry];var s=r[t.material];void 0===i&&console.error("THREE.ObjectLoader: Undefined geometry "+t.geometry),void 0===s&&console.error("THREE.ObjectLoader: Undefined material "+t.material),i=new THREE.Mesh(i,s);break;case"Sprite":s=r[t.material],void 0===s&&console.error("THREE.ObjectLoader: Undefined material "+t.material),i=new THREE.Sprite(s);break;default:i=new THREE.Object3D}i.uuid=t.uuid,void 0!==t.name&&(i.name=t.name),void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(i.position,i.quaternion,i.scale)):(void 0!==t.position&&i.position.fromArray(t.position),void 0!==t.rotation&&i.rotation.fromArray(t.rotation),void 0!==t.scale&&i.scale.fromArray(t.scale)),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.userData&&(i.userData=t.userData);if(void 0!==t.children)for(var o in t.children)i.add(this.parseObject(t.children[o],n,r));return i}}()},THREE.SceneLoader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){},this.callbackSync=function(){},this.callbackProgress=function(){},this.geometryHandlers={},this.hierarchyHandlers={},this.addGeometryHandler("ascii",THREE.JSONLoader)},THREE.SceneLoader.prototype={constructor:THREE.SceneLoader,load:function(e,t){var n=this,r=new THREE.XHRLoader(n.manager);r.setCrossOrigin(this.crossOrigin),r.load(e,function(r){n.parse(JSON.parse(r),t,e)})},setCrossOrigin:function(e){this.crossOrigin=e},addGeometryHandler:function(e,t){this.geometryHandlers[e]={loaderClass:t}},addHierarchyHandler:function(e,t){this.hierarchyHandlers[e]={loaderClass:t}},parse:function(e,t,n){function r(e,t){return"relativeToHTML"==t?e:h+"/"+e}function i(){s(x.scene,N.objects)}function s(e,t){var n,i,o,a,f,l;for(l in t){var h=x.objects[l],m=t[l];if(void 0===h){if(m.type&&m.type in c.hierarchyHandlers){if(void 0===m.loading){n={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1};var g={},b;for(b in m)b in n||(g[b]=m[b]);d=x.materials[m.material],m.loading=!0,n=c.hierarchyHandlers[m.type].loaderObject,n.options?n.load(r(m.url,N.urlBaseType),u(l,e,d,m)):n.load(r(m.url,N.urlBaseType),u(l,e,d,m),g)}}else if(void 0!==m.geometry){if(p=x.geometries[m.geometry]){h=!1,d=x.materials[m.material],h=d instanceof THREE.ShaderMaterial,i=m.position,o=m.rotation,a=m.scale,n=m.matrix,f=m.quaternion,m.material||(d=new THREE.MeshFaceMaterial(x.face_materials[m.geometry])),d instanceof THREE.MeshFaceMaterial&&0===d.materials.length&&(d=new THREE.MeshFaceMaterial(x.face_materials[m.geometry]));if(d instanceof THREE.MeshFaceMaterial)for(g=0;g<d.materials.length;g++)h=h||d.materials[g]instanceof THREE.ShaderMaterial;h&&p.computeTangents(),m.skin?h=new THREE.SkinnedMesh(p,d):m.morph?(h=new THREE.MorphAnimMesh(p,d),void 0!==m.duration&&(h.duration=m.duration),void 0!==m.time&&(h.time=m.time),void 0!==m.mirroredLoop&&(h.mirroredLoop=m.mirroredLoop),d.morphNormals&&p.computeMorphNormals()):h=new THREE.Mesh(p,d),h.name=l,n?(h.matrixAutoUpdate=!1,h.matrix.set(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])):(h.position.fromArray(i),f?h.quaternion.fromArray(f):h.rotation.fromArray(o),h.scale.fromArray(a)),h.visible=m.visible,h.castShadow=m.castShadow,h.receiveShadow=m.receiveShadow,e.add(h),x.objects[l]=h}}else if("AmbientLight"===m.type||"PointLight"===m.type||"DirectionalLight"===m.type||"SpotLight"===m.type||"HemisphereLight"===m.type||"AreaLight"===m.type){g=m.color,n=m.intensity,i=m.distance,o=m.position,a=m.rotation;switch(m.type){case"AmbientLight":y=new THREE.AmbientLight(g);break;case"PointLight":y=new THREE.PointLight(g,n,i),y.position.fromArray(o);break;case"DirectionalLight":y=new THREE.DirectionalLight(g,n),y.position.fromArray(m.direction);break;case"SpotLight":y=new THREE.SpotLight(g,n,i,1),y.angle=m.angle,y.position.fromArray(o),y.target.set(o[0],o[1]-i,o[2]),y.target.applyEuler(new THREE.Euler(a[0],a[1],a[2],"XYZ"));break;case"HemisphereLight":y=new THREE.DirectionalLight(g,n,i),y.target.set(o[0],o[1]-i,o[2]),y.target.applyEuler(new THREE.Euler(a[0],a[1],a[2],"XYZ"));break;case"AreaLight":y=new THREE.AreaLight(g,n),y.position.fromArray(o),y.width=m.size,y.height=m.size_y}e.add(y),y.name=l,x.lights[l]=y,x.objects[l]=y}else"PerspectiveCamera"===m.type||"OrthographicCamera"===m.type?(i=m.position,o=m.rotation,f=m.quaternion,"PerspectiveCamera"===m.type?v=new THREE.PerspectiveCamera(m.fov,m.aspect,m.near,m.far):"OrthographicCamera"===m.type&&(v=new THREE.OrthographicCamera(m.left,m.right,m.top,m.bottom,m.near,m.far)),v.name=l,v.position.fromArray(i),void 0!==f?v.quaternion.fromArray(f):void 0!==o&&v.rotation.fromArray(o),e.add(v),x.cameras[l]=v,x.objects[l]=v):(i=m.position,o=m.rotation,a=m.scale,f=m.quaternion,h=new THREE.Object3D,h.name=l,h.position.fromArray(i),f?h.quaternion.fromArray(f):h.rotation.fromArray(o),h.scale.fromArray(a),h.visible=void 0!==m.visible?m.visible:!1,e.add(h),x.objects[l]=h,x.empties[l]=h);if(h){if(void 0!==m.userData)for(var w in m.userData)h.userData[w]=m.userData[w];if(void 0!==m.groups)for(g=0;g<m.groups.length;g++)n=m.groups[g],void 0===x.groups[n]&&(x.groups[n]=[]),x.groups[n].push(l)}}void 0!==h&&void 0!==m.children&&s(h,m.children)}}function o(e){return function(t,n){t.name=e,x.geometries[e]=t,x.face_materials[e]=n,i(),b-=1,c.onLoadComplete(),f()}}function u(e,t,n,r){return function(s){var s=s.content?s.content:s.dae?s.scene:s,o=r.rotation,u=r.quaternion,a=r.scale;s.position.fromArray(r.position),u?s.quaternion.fromArray(u):s.rotation.fromArray(o),s.scale.fromArray(a),n&&s.traverse(function(e){e.material=n});var l=void 0!==r.visible?r.visible:!0;s.traverse(function(e){e.visible=l}),t.add(s),s.name=e,x.objects[e]=s,i(),b-=1,c.onLoadComplete(),f()}}function a(e){return function(t,n){t.name=e,x.geometries[e]=t,x.face_materials[e]=n}}function f(){c.callbackProgress({totalModels:E,totalTextures:S,loadedModels:E-b,loadedTextures:S-w},x),c.onLoadProgress();if(0===b&&0===w){for(var e=0;e<T.length;e++){var n=T[e],r=x.objects[n.targetName];r?n.object.target=r:(n.object.target=new THREE.Object3D,x.scene.add(n.object.target)),n.object.target.userData.targetInverse=n.object}t(x)}}function l(e,t){t(e);if(void 0!==e.children)for(var n in e.children)l(e.children[n],t)}var c=this,h=THREE.Loader.prototype.extractUrlBase(n),p,d,v,m,g,y,b,w,E,S,x,T=[],N=e,C;for(C in this.geometryHandlers)e=this.geometryHandlers[C].loaderClass,this.geometryHandlers[C].loaderObject=new e;for(C in this.hierarchyHandlers)e=this.hierarchyHandlers[C].loaderClass,this.hierarchyHandlers[C].loaderObject=new e;w=b=0,x={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}},N.transform&&(C=N.transform.position,e=N.transform.rotation,n=N.transform.scale,C&&x.scene.position.fromArray(C),e&&x.scene.rotation.fromArray(e),n&&x.scene.scale.fromArray(n),C||e||n)&&(x.scene.updateMatrix(),x.scene.updateMatrixWorld()),C=function(e){return function(){w-=e,f(),c.onLoadComplete()}};for(var k in N.fogs)e=N.fogs[k],"linear"===e.type?m=new THREE.Fog(0,e.near,e.far):"exp2"===e.type&&(m=new THREE.FogExp2(0,e.density)),e=e.color,m.color.setRGB(e[0],e[1],e[2]),x.fogs[k]=m;for(var L in N.geometries)m=N.geometries[L],m.type in this.geometryHandlers&&(b+=1,c.onLoadStart());for(var A in N.objects)l(N.objects[A],function(e){e.type&&e.type in c.hierarchyHandlers&&(b+=1,c.onLoadStart())});E=b;for(L in N.geometries)if(m=N.geometries[L],"cube"===m.type)p=new THREE.CubeGeometry(m.width,m.height,m.depth,m.widthSegments,m.heightSegments,m.depthSegments),p.name=L,x.geometries[L]=p;else if("plane"===m.type)p=new THREE.PlaneGeometry(m.width,m.height,m.widthSegments,m.heightSegments),p.name=L,x.geometries[L]=p;else if("sphere"===m.type)p=new THREE.SphereGeometry(m.radius,m.widthSegments,m.heightSegments),p.name=L,x.geometries[L]=p;else if("cylinder"===m.type)p=new THREE.CylinderGeometry(m.topRad,m.botRad,m.height,m.radSegs,m.heightSegs),p.name=L,x.geometries[L]=p;else if("torus"===m.type)p=new THREE.TorusGeometry(m.radius,m.tube,m.segmentsR,m.segmentsT),p.name=L,x.geometries[L]=p;else if("icosahedron"===m.type)p=new THREE.IcosahedronGeometry(m.radius,m.subdivisions),p.name=L,x.geometries[L]=p;else if(m.type in this.geometryHandlers){A={};for(g in m)"type"!==g&&"url"!==g&&(A[g]=m[g]);this.geometryHandlers[m.type].loaderObject.load(r(m.url,N.urlBaseType),o(L),A)}else"embedded"===m.type&&(A=N.embeds[m.id],A.metadata=N.metadata,A&&(A=this.geometryHandlers.ascii.loaderObject.parse(A,""),a(L)(A.geometry,A.materials)));for(var O in N.textures)if(L=N.textures[O],L.url instanceof Array){w+=L.url.length;for(g=0;g<L.url.length;g++)c.onLoadStart()}else w+=1,c.onLoadStart();S=w;for(O in N.textures){L=N.textures[O],void 0!==L.mapping&&void 0!==THREE[L.mapping]&&(L.mapping=new THREE[L.mapping]);if(L.url instanceof Array){A=L.url.length,m=[];for(g=0;g<A;g++)m[g]=r(L.url[g],N.urlBaseType);g=(g=/\.dds$/i.test(m[0]))?THREE.ImageUtils.loadCompressedTextureCube(m,L.mapping,C(A)):THREE.ImageUtils.loadTextureCube(m,L.mapping,C(A))}else g=/\.dds$/i.test(L.url),A=r(L.url,N.urlBaseType),m=C(1),g=g?THREE.ImageUtils.loadCompressedTexture(A,L.mapping,m):THREE.ImageUtils.loadTexture(A,L.mapping,m),void 0!==THREE[L.minFilter]&&(g.minFilter=THREE[L.minFilter]),void 0!==THREE[L.magFilter]&&(g.magFilter=THREE[L.magFilter]),L.anisotropy&&(g.anisotropy=L.anisotropy),L.repeat&&(g.repeat.set(L.repeat[0],L.repeat[1]),1!==L.repeat[0]&&(g.wrapS=THREE.RepeatWrapping),1!==L.repeat[1]&&(g.wrapT=THREE.RepeatWrapping)),L.offset&&g.offset.set(L.offset[0],L.offset[1]),L.wrap&&(A={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==A[L.wrap[0]]&&(g.wrapS=A[L.wrap[0]]),void 0!==A[L.wrap[1]]&&(g.wrapT=A[L.wrap[1]]));x.textures[O]=g}var M,_;for(M in N.materials){O=N.materials[M];for(_ in O.parameters)"envMap"===_||"map"===_||"lightMap"===_||"bumpMap"===_?O.parameters[_]=x.textures[O.parameters[_]]:"shading"===_?O.parameters[_]="flat"===O.parameters[_]?THREE.FlatShading:THREE.SmoothShading:"side"===_?O.parameters[_]="double"==O.parameters[_]?THREE.DoubleSide:"back"==O.parameters[_]?THREE.BackSide:THREE.FrontSide:"blending"===_?O.parameters[_]=O.parameters[_]in THREE?THREE[O.parameters[_]]:THREE.NormalBlending:"combine"===_?O.parameters[_]=O.parameters[_]in THREE?THREE[O.parameters[_]]:THREE.MultiplyOperation:"vertexColors"===_?"face"==O.parameters[_]?O.parameters[_]=THREE.FaceColors:O.parameters[_]&&(O.parameters[_]=THREE.VertexColors):"wrapRGB"===_&&(C=O.parameters[_],O.parameters[_]=new THREE.Vector3(C[0],C[1],C[2]));void 0!==O.parameters.opacity&&1>O.parameters.opacity&&(O.parameters.transparent=!0),O.parameters.normalMap?(C=THREE.ShaderLib.normalmap,L=THREE.UniformsUtils.clone(C.uniforms),g=O.parameters.color,A=O.parameters.specular,m=O.parameters.ambient,k=O.parameters.shininess,L.tNormal.value=x.textures[O.parameters.normalMap],O.parameters.normalScale&&L.uNormalScale.value.set(O.parameters.normalScale[0],O.parameters.normalScale[1]),O.parameters.map&&(L.tDiffuse.value=O.parameters.map,L.enableDiffuse.value=!0),O.parameters.envMap&&(L.tCube.value=O.parameters.envMap,L.enableReflection.value=!0,L.reflectivity.value=O.parameters.reflectivity),O.parameters.lightMap&&(L.tAO.value=O.parameters.lightMap,L.enableAO.value=!0),O.parameters.specularMap&&(L.tSpecular.value=x.textures[O.parameters.specularMap],L.enableSpecular.value=!0),O.parameters.displacementMap&&(L.tDisplacement.value=x.textures[O.parameters.displacementMap],L.enableDisplacement.value=!0,L.uDisplacementBias.value=O.parameters.displacementBias,L.uDisplacementScale.value=O.parameters.displacementScale),L.diffuse.value.setHex(g),L.specular.value.setHex(A),L.ambient.value.setHex(m),L.shininess.value=k,O.parameters.opacity&&(L.opacity.value=O.parameters.opacity),d=new THREE.ShaderMaterial({fragmentShader:C.fragmentShader,vertexShader:C.vertexShader,uniforms:L,lights:!0,fog:!0})):d=new THREE[O.type](O.parameters),d.name=M,x.materials[M]=d}for(M in N.materials)if(O=N.materials[M],O.parameters.materials){_=[];for(g=0;g<O.parameters.materials.length;g++)_.push(x.materials[O.parameters.materials[g]]);x.materials[M].materials=_}i(),x.cameras&&N.defaults.camera&&(x.currentCamera=x.cameras[N.defaults.camera]),x.fogs&&N.defaults.fog&&(x.scene.fog=x.fogs[N.defaults.fog]),c.callbackSync(x),f()}},THREE.TextureLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(e,t){var n=new THREE.ImageLoader(this.manager);n.setCrossOrigin(this.crossOrigin),n.load(e,function(e){e=new THREE.Texture(e),e.needsUpdate=!0,void 0!==t&&t(e)})},setCrossOrigin:function(e){this.crossOrigin=e}},THREE.Material=function(){this.id=THREE.MaterialIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.side=THREE.FrontSide,this.opacity=1,this.transparent=!1,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.depthWrite=this.depthTest=!0,this.polygonOffset=!1,this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.needsUpdate=this.visible=!0},THREE.Material.prototype={constructor:THREE.Material,setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0===n)console.warn("THREE.Material: '"+t+"' parameter is undefined.");else if(t in this){var r=this[t];r instanceof THREE.Color?r.set(n):r instanceof THREE.Vector3&&n instanceof THREE.Vector3?r.copy(n):this[t]="overdraw"==t?Number(n):n}}},clone:function(e){return void 0===e&&(e=new THREE.Material),e.name=this.name,e.side=this.side,e.opacity=this.opacity,e.transparent=this.transparent,e.blending=this.blending,e.blendSrc=this.blendSrc,e.blendDst=this.blendDst,e.blendEquation=this.blendEquation,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,e.polygonOffset=this.polygonOffset,e.polygonOffsetFactor=this.polygonOffsetFactor,e.polygonOffsetUnits=this.polygonOffsetUnits,e.alphaTest=this.alphaTest,e.overdraw=this.overdraw,e.visible=this.visible,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Material.prototype),THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.vertexColors=!1,this.fog=!0,this.setValues(e)},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.clone=function(){var e=new THREE.LineBasicMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.linecap=this.linecap,e.linejoin=this.linejoin,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.LineDashedMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.scale=this.linewidth=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(e)},THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.clone=function(){var e=new THREE.LineDashedMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.scale=this.scale,e.dashSize=this.dashSize,e.gapSize=this.gapSize,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.MeshBasicMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.envMap=this.specularMap=this.lightMap=this.map=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphTargets=this.skinning=!1,this.setValues(e)},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.clone=function(){var e=new THREE.MeshBasicMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e},THREE.MeshLambertMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.envMap=this.specularMap=this.lightMap=this.map=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.clone=function(){var e=new THREE.MeshLambertMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.ambient.copy(this.ambient),e.emissive.copy(this.emissive),e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.MeshPhongMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.specular=new THREE.Color(1118481),this.shininess=30,this.metal=!1,this.perPixel=!0,this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.bumpMap=this.lightMap=this.map=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.envMap=this.specularMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.clone=function(){var e=new THREE.MeshPhongMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.ambient.copy(this.ambient),e.emissive.copy(this.emissive),e.specular.copy(this.specular),e.shininess=this.shininess,e.metal=this.metal,e.perPixel=this.perPixel,e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.bumpMap=this.bumpMap,e.bumpScale=this.bumpScale,e.normalMap=this.normalMap,e.normalScale.copy(this.normalScale),e.specularMap=this.specularMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.MeshDepthMaterial=function(e){THREE.Material.call(this),this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)},THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.clone=function(){var e=new THREE.MeshDepthMaterial;return THREE.Material.prototype.clone.call(this,e),e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},THREE.MeshNormalMaterial=function(e){THREE.Material.call(this,e),this.shading=THREE.FlatShading,this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(e)},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.clone=function(){var e=new THREE.MeshNormalMaterial;return THREE.Material.prototype.clone.call(this,e),e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},THREE.MeshFaceMaterial=function(e){this.materials=e instanceof Array?e:[]},THREE.MeshFaceMaterial.prototype.clone=function(){for(var e=new THREE.MeshFaceMaterial,t=0;t<this.materials.length;t++)e.materials.push(this.materials[t].clone());return e},THREE.ParticleSystemMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=!1,this.fog=!0,this.setValues(e)},THREE.ParticleSystemMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ParticleSystemMaterial.prototype.clone=function(){var e=new THREE.ParticleSystemMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.ParticleBasicMaterial=THREE.ParticleSystemMaterial,THREE.ShaderMaterial=function(e){THREE.Material.call(this),this.vertexShader=this.fragmentShader="void main() {}",this.uniforms={},this.defines={},this.attributes=null,this.shading=THREE.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName="position",this.setValues(e)},THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.clone=function(){var e=new THREE.ShaderMaterial;return THREE.Material.prototype.clone.call(this,e),e.fragmentShader=this.fragmentShader,e.vertexShader=this.vertexShader,e.uniforms=THREE.UniformsUtils.clone(this.uniforms),e.attributes=this.attributes,e.defines=this.defines,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.fog=this.fog,e.lights=this.lights,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.SpriteMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(e)},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.clone=function(){var e=new THREE.SpriteMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.rotation=this.rotation,e.fog=this.fog,e},THREE.SpriteCanvasMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.program=function(){},this.setValues(e)},THREE.SpriteCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteCanvasMaterial.prototype.clone=function(){var e=new THREE.SpriteCanvasMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.program=this.program,e},THREE.ParticleCanvasMaterial=THREE.SpriteCanvasMaterial,THREE.Texture=function(e,t,n,r,i,s,o,u,a){this.id=THREE.TextureIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.image=e,this.mipmaps=[],this.mapping=void 0!==t?t:new THREE.UVMapping,this.wrapS=void 0!==n?n:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==r?r:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==i?i:THREE.LinearFilter,this.minFilter=void 0!==s?s:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==a?a:1,this.format=void 0!==o?o:THREE.RGBAFormat,this.type=void 0!==u?u:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this._needsUpdate=!1,this.onUpdate=null},THREE.Texture.prototype={constructor:THREE.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){!0===e&&this.update(),this._needsUpdate=e},clone:function(e){return void 0===e&&(e=new THREE.Texture),e.image=this.image,e.mipmaps=this.mipmaps.slice(0),e.mapping=this.mapping,e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.format=this.format,e.type=this.type,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.generateMipmaps=this.generateMipmaps,e.premultiplyAlpha=this.premultiplyAlpha,e.flipY=this.flipY,e.unpackAlignment=this.unpackAlignment,e},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype),THREE.TextureIdCount=0,THREE.CompressedTexture=function(e,t,n,r,i,s,o,u,a,f,l){THREE.Texture.call(this,null,s,o,u,a,f,r,i,l),this.image={width:t,height:n},this.mipmaps=e,this.generateMipmaps=!1},THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.clone=function(){var e=new THREE.CompressedTexture;return THREE.Texture.prototype.clone.call(this,e),e},THREE.DataTexture=function(e,t,n,r,i,s,o,u,a,f,l){THREE.Texture.call(this,null,s,o,u,a,f,r,i,l),this.image={data:e,width:t,height:n}},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.clone=function(){var e=new THREE.DataTexture;return THREE.Texture.prototype.clone.call(this,e),e},THREE.ParticleSystem=function(e,t){THREE.Object3D.call(this),this.geometry=void 0!==e?e:new THREE.Geometry,this.material=void 0!==t?t:new THREE.ParticleSystemMaterial({color:16777215*Math.random()}),this.frustumCulled=this.sortParticles=!1},THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype),THREE.ParticleSystem.prototype.clone=function(e){return void 0===e&&(e=new THREE.ParticleSystem(this.geometry,this.material)),e.sortParticles=this.sortParticles,THREE.Object3D.prototype.clone.call(this,e),e},THREE.Line=function(e,t,n){THREE.Object3D.call(this),this.geometry=void 0!==e?e:new THREE.Geometry,this.material=void 0!==t?t:new THREE.LineBasicMaterial({color:16777215*Math.random()}),this.type=void 0!==n?n:THREE.LineStrip},THREE.LineStrip=0,THREE.LinePieces=1,THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.clone=function(e){return void 0===e&&(e=new THREE.Line(this.geometry,this.material,this.type)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Mesh=function(e,t){THREE.Object3D.call(this),this.geometry=void 0!==e?e:new THREE.Geometry,this.material=void 0!==t?t:new THREE.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.updateMorphTargets=function(){if(0<this.geometry.morphTargets.length){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;e<t;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(e){return void 0!==this.morphTargetDictionary[e]?this.morphTargetDictionary[e]:(console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0."),0)},THREE.Mesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.Mesh(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Bone=function(e){THREE.Object3D.call(this),this.skin=e,this.skinMatrix=new THREE.Matrix4},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.update=function(e,t){this.matrixAutoUpdate&&(t|=this.updateMatrix());if(t||this.matrixWorldNeedsUpdate)e?this.skinMatrix.multiplyMatrices(e,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0;var n,r=this.children.length;for(n=0;n<r;n++)this.children[n].update(this.skinMatrix,t)},THREE.SkinnedMesh=function(e,t,n){THREE.Mesh.call(this,e,t),this.useVertexTexture=void 0!==n?n:!0,this.identityMatrix=new THREE.Matrix4,this.bones=[],this.boneMatrices=[];var r,i,s;if(this.geometry&&void 0!==this.geometry.bones){for(e=0;e<this.geometry.bones.length;e++)n=this.geometry.bones[e],r=n.pos,i=n.rotq,s=n.scl,t=this.addBone(),t.name=n.name,t.position.set(r[0],r[1],r[2]),t.quaternion.set(i[0],i[1],i[2],i[3]),void 0!==s?t.scale.set(s[0],s[1],s[2]):t.scale.set(1,1,1);for(e=0;e<this.bones.length;e++)n=this.geometry.bones[e],t=this.bones[e],-1===n.parent?this.add(t):this.bones[n.parent].add(t);e=this.bones.length,this.useVertexTexture?(this.boneTextureHeight=this.boneTextureWidth=e=256<e?64:64<e?32:16<e?16:8,this.boneMatrices=new Float32Array(4*this.boneTextureWidth*this.boneTextureHeight),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1):this.boneMatrices=new Float32Array(16*e),this.pose()}},THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.SkinnedMesh.prototype.addBone=function(e){return void 0===e&&(e=new THREE.Bone(this)),this.bones.push(e),e},THREE.SkinnedMesh.prototype.updateMatrixWorld=function(){var e=new THREE.Matrix4;return function(t){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||t)this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1;for(var t=0,n=this.children.length;t<n;t++){var r=this.children[t];r instanceof THREE.Bone?r.update(this.identityMatrix,!1):r.updateMatrixWorld(!0)}if(void 0==this.boneInverses){this.boneInverses=[],t=0;for(n=this.bones.length;t<n;t++)r=new THREE.Matrix4,r.getInverse(this.bones[t].skinMatrix),this.boneInverses.push(r)}t=0;for(n=this.bones.length;t<n;t++)e.multiplyMatrices(this.bones[t].skinMatrix,this.boneInverses[t]),e.flattenToArrayOffset(this.boneMatrices,16*t);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}(),THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0),this.normalizeSkinWeights()},THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry)for(var e=0;e<this.geometry.skinIndices.length;e++){var t=this.geometry.skinWeights[e],n=1/t.lengthManhattan();Infinity!==n?t.multiplyScalar(n):t.set(1)}},THREE.SkinnedMesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),THREE.Mesh.prototype.clone.call(this,e),e},THREE.MorphAnimMesh=function(e,t){THREE.Mesh.call(this,e,t),this.duration=1e3,this.mirroredLoop=!1,this.currentKeyframe=this.lastKeyframe=this.time=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphAnimMesh.prototype.setFrameRange=function(e,t){this.startKeyframe=e,this.endKeyframe=t,this.length=this.endKeyframe-this.startKeyframe+1},THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},THREE.MorphAnimMesh.prototype.parseAnimations=function(){var e=this.geometry;e.animations||(e.animations={});for(var t,n=e.animations,r=/([a-z]+)(\d+)/,i=0,s=e.morphTargets.length;i<s;i++){var o=e.morphTargets[i].name.match(r);if(o&&1<o.length){o=o[1],n[o]||(n[o]={start:Infinity,end:-Infinity});var u=n[o];i<u.start&&(u.start=i),i>u.end&&(u.end=i),t||(t=o)}}e.firstAnimation=t},THREE.MorphAnimMesh.prototype.setAnimationLabel=function(e,t,n){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[e]={start:t,end:n}},THREE.MorphAnimMesh.prototype.playAnimation=function(e,t){var n=this.geometry.animations[e];n?(this.setFrameRange(n.start,n.end),this.duration=1e3*((n.end-n.start)/t),this.time=0):console.warn("animation["+e+"] undefined")},THREE.MorphAnimMesh.prototype.updateAnimation=function(e){var t=this.duration/this.length;this.time+=this.direction*e;if(this.mirroredLoop){if(this.time>this.duration||0>this.time)this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),0>this.time&&(this.time=0,this.directionBackwards=!1)}else this.time%=this.duration,0>this.time&&(this.time+=this.duration);e=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/t),0,this.length-1),e!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[e]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=e),t=this.time%t/t,this.directionBackwards&&(t=1-t),this.morphTargetInfluences[this.currentKeyframe]=t,this.morphTargetInfluences[this.lastKeyframe]=1-t},THREE.MorphAnimMesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.MorphAnimMesh(this.geometry,this.material)),e.duration=this.duration,e.mirroredLoop=this.mirroredLoop,e.time=this.time,e.lastKeyframe=this.lastKeyframe,e.currentKeyframe=this.currentKeyframe,e.direction=this.direction,e.directionBackwards=this.directionBackwards,THREE.Mesh.prototype.clone.call(this,e),e},THREE.LOD=function(){THREE.Object3D.call(this),this.objects=[]},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.addLevel=function(e,t){void 0===t&&(t=0);for(var t=Math.abs(t),n=0;n<this.objects.length&&!(t<this.objects[n].distance);n++);this.objects.splice(n,0,{distance:t,object:e}),this.add(e)},THREE.LOD.prototype.getObjectForDistance=function(e){for(var t=1,n=this.objects.length;t<n&&!(e<this.objects[t].distance);t++);return this.objects[t-1].object},THREE.LOD.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(n){if(1<this.objects.length){e.setFromMatrixPosition(n.matrixWorld),t.setFromMatrixPosition(this.matrixWorld),n=e.distanceTo(t),this.objects[0].object.visible=!0;for(var r=1,i=this.objects.length;r<i;r++){if(!(n>=this.objects[r].distance))break;this.objects[r-1].object.visible=!1,this.objects[r].object.visible=!0}for(;r<i;r++)this.objects[r].object.visible=!1}}}(),THREE.LOD.prototype.clone=function(){},THREE.Sprite=function(e){THREE.Object3D.call(this),this.material=void 0!==e?e:new THREE.SpriteMaterial},THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.updateMatrix=function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},THREE.Sprite.prototype.clone=function(e){return void 0===e&&(e=new THREE.Sprite(this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Particle=THREE.Sprite,THREE.Scene=function(){THREE.Object3D.call(this),this.overrideMaterial=this.fog=null,this.autoUpdate=!0,this.matrixAutoUpdate=!1,this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.__addObject=function(e){if(e instanceof THREE.Light)-1===this.__lights.indexOf(e)&&this.__lights.push(e),e.target&&void 0===e.target.parent&&this.add(e.target);else if(!(e instanceof THREE.Camera||e instanceof THREE.Bone)){this.__objectsAdded.push(e);var t=this.__objectsRemoved.indexOf(e);-1!==t&&this.__objectsRemoved.splice(t,1)}this.dispatchEvent({type:"objectAdded",object:e}),e.dispatchEvent({type:"addedToScene",scene:this});for(t=0;t<e.children.length;t++)this.__addObject(e.children[t])},THREE.Scene.prototype.__removeObject=function(e){if(e instanceof THREE.Light){var t=this.__lights.indexOf(e);-1!==t&&this.__lights.splice(t,1);if(e.shadowCascadeArray)for(t=0;t<e.shadowCascadeArray.length;t++)this.__removeObject(e.shadowCascadeArray[t])}else e instanceof THREE.Camera||(this.__objectsRemoved.push(e),t=this.__objectsAdded.indexOf(e),-1!==t&&this.__objectsAdded.splice(t,1));this.dispatchEvent({type:"objectRemoved",object:e}),e.dispatchEvent({type:"removedFromScene",scene:this});for(t=0;t<e.children.length;t++)this.__removeObject(e.children[t])},THREE.Scene.prototype.clone=function(e){return void 0===e&&(e=new THREE.Scene),THREE.Object3D.prototype.clone.call(this,e),null!==this.fog&&(e.fog=this.fog.clone()),null!==this.overrideMaterial&&(e.overrideMaterial=this.overrideMaterial.clone()),e.autoUpdate=this.autoUpdate,e.matrixAutoUpdate=this.matrixAutoUpdate,e},THREE.Fog=function(e,t,n){this.name="",this.color=new THREE.Color(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3},THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)},THREE.FogExp2=function(e,t){this.name="",this.color=new THREE.Color(e),this.density=void 0!==t?t:25e-5},THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)},THREE.CanvasRenderer=function(e){function t(e,t,n){for(var r=0,i=S.length;r<i;r++){var s=S[r];it.copy(s.color);if(s instanceof THREE.DirectionalLight){var o=St.setFromMatrixPosition(s.matrixWorld).normalize(),u=t.dot(o);0>=u||(u*=s.intensity,n.add(it.multiplyScalar(u)))}else s instanceof THREE.PointLight&&(o=St.setFromMatrixPosition(s.matrixWorld),u=t.dot(St.subVectors(o,e).normalize()),0>=u||(u*=0==s.distance?1:1-Math.min(e.distanceTo(o)/s.distance,1),0!=u&&(u*=s.intensity,n.add(it.multiplyScalar(u)))))}}function n(e,t,n,r){h(t),p(n),d(r),v(e.getStyle()),A.stroke(),yt.expandByScalar(2*t)}function r(e){m(e.getStyle()),A.fill()}function i(e){s(e.target)}function s(e){var t=e.wrapS===THREE.RepeatWrapping,n=e.wrapT===THREE.RepeatWrapping,r=e.image,i=document.createElement("canvas");i.width=r.width,i.height=r.height;var s=i.getContext("2d");s.setTransform(1,0,0,-1,0,r.height),s.drawImage(r,0,0),st[e.id]=A.createPattern(i,!0===t&&!0===n?"repeat":!0===t&&!1===n?"repeat-x":!1===t&&!0===n?"repeat-y":"no-repeat")}function o(e,t,n,r,o,u,a,f,l,c,h,p,d){if(!(d instanceof THREE.DataTexture)){!1===d.hasEventListener("update",i)&&(void 0!==d.image&&0<d.image.width&&s(d),d.addEventListener("update",i));var v=st[d.id];if(void 0!==v){m(v);var v=d.offset.x/d.repeat.x,g=d.offset.y/d.repeat.y,y=d.image.width*d.repeat.x,d=d.image.height*d.repeat.y,a=(a+v)*y,f=(f+g)*d,n=n-e,r=r-t,o=o-e,u=u-t,l=(l+v)*y-a,c=(c+g)*d-f,h=(h+v)*y-a,p=(p+g)*d-f,d=l*p-h*c;0!==d&&(v=1/d,d=(p*n-c*o)*v,c=(p*r-c*u)*v,n=(l*o-h*n)*v,r=(l*u-h*r)*v,e=e-d*a-n*f,t=t-c*a-r*f,A.save(),A.transform(d,c,n,r,e,t),A.fill(),A.restore())}else m("rgba(0,0,0,1)"),A.fill()}}function u(e,t,n,r,i,s,o,u,a,f,l,c,h){var p,d;p=h.width-1,d=h.height-1,o*=p,u*=d,n-=e,r-=t,i-=e,s-=t,a=a*p-o,f=f*d-u,l=l*p-o,c=c*d-u,d=1/(a*c-l*f),p=(c*n-f*i)*d,f=(c*r-f*s)*d,n=(a*i-l*n)*d,r=(a*s-l*r)*d,e=e-p*o-n*u,t=t-f*o-r*u,A.save(),A.transform(p,f,n,r,e,t),A.clip(),A.drawImage(h,0,0),A.restore()}function a(e,t,n,r){return Ct[0]=255*e.r|0,Ct[1]=255*e.g|0,Ct[2]=255*e.b|0,Ct[4]=255*t.r|0,Ct[5]=255*t.g|0,Ct[6]=255*t.b|0,Ct[8]=255*n.r|0,Ct[9]=255*n.g|0,Ct[10]=255*n.b|0,Ct[12]=255*r.r|0,Ct[13]=255*r.g|0,Ct[14]=255*r.b|0,Tt.putImageData(Nt,0,0),Lt.drawImage(xt,0,0),kt}function f(e,t,n){var r=t.x-e.x,i=t.y-e.y,s=r*r+i*i;0!==s&&(n/=Math.sqrt(s),r*=n,i*=n,t.x+=r,t.y+=i,e.x-=r,e.y-=i)}function l(e){_!==e&&(_=A.globalAlpha=e)}function c(e){D!==e&&(e===THREE.NormalBlending?A.globalCompositeOperation="source-over":e===THREE.AdditiveBlending?A.globalCompositeOperation="lighter":e===THREE.SubtractiveBlending&&(A.globalCompositeOperation="darker"),D=e)}function h(e){B!==e&&(B=A.lineWidth=e)}function p(e){j!==e&&(j=A.lineCap=e)}function d(e){F!==e&&(F=A.lineJoin=e)}function v(e){P!==e&&(P=A.strokeStyle=e)}function m(e){H!==e&&(H=A.fillStyle=e)}function g(e,t){if(I!==e||q!==t)A.setLineDash([e,t]),I=e,q=t}console.log("THREE.CanvasRenderer",THREE.REVISION);var y=THREE.Math.smoothstep,e=e||{},b=this,w,E,S,x=new THREE.Projector,T=void 0!==e.canvas?e.canvas:document.createElement("canvas"),N=T.width,C=T.height,k=Math.floor(N/2),L=Math.floor(C/2),A=T.getContext("2d"),O=new THREE.Color(0),M=0,_=1,D=0,P=null,H=null,B=null,j=null,F=null,I=null,q=0,R,U,z,W;new THREE.RenderableVertex,new THREE.RenderableVertex;var X,V,$,J,K,Q,G=new THREE.Color,Y=new THREE.Color,Z=new THREE.Color,et=new THREE.Color,tt=new THREE.Color,nt=new THREE.Color,rt=new THREE.Color,it=new THREE.Color,st={},ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt=new THREE.Box2,gt=new THREE.Box2,yt=new THREE.Box2,bt=new THREE.Color,wt=new THREE.Color,Et=new THREE.Color,St=new THREE.Vector3,xt,Tt,Nt,Ct,kt,Lt,At=16;xt=document.createElement("canvas"),xt.width=xt.height=2,Tt=xt.getContext("2d"),Tt.fillStyle="rgba(0,0,0,1)",Tt.fillRect(0,0,2,2),Nt=Tt.getImageData(0,0,2,2),Ct=Nt.data,kt=document.createElement("canvas"),kt.width=kt.height=At,Lt=kt.getContext("2d"),Lt.translate(-At/2,-At/2),Lt.scale(At,At),At--,void 0===A.setLineDash&&(A.setLineDash=void 0!==A.mozDash?function(e){A.mozDash=null!==e[0]?e:null}:function(){}),this.domElement=T,this.devicePixelRatio=void 0!==e.devicePixelRatio?e.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1,this.sortElements=this.sortObjects=this.autoClear=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.setSize=function(e,t,n){N=e*this.devicePixelRatio,C=t*this.devicePixelRatio,k=Math.floor(N/2),L=Math.floor(C/2),T.width=N,T.height=C,1!==this.devicePixelRatio&&!1!==n&&(T.style.width=e+"px",T.style.height=t+"px"),mt.set(new THREE.Vector2(-k,-L),new THREE.Vector2(k,L)),gt.set(new THREE.Vector2(-k,-L),new THREE.Vector2(k,L)),_=1,D=0,F=j=B=H=P=null},this.setClearColor=function(e,t){O.set(e),M=void 0!==t?t:1,gt.set(new THREE.Vector2(-k,-L),new THREE.Vector2(k,L))},this.setClearColorHex=function(e,t){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getMaxAnisotropy=function(){return 0},this.clear=function(){A.setTransform(1,0,0,-1,k,L),!1===gt.empty()&&(gt.intersect(mt),gt.expandByScalar(2),1>M&&A.clearRect(gt.min.x|0,gt.min.y|0,gt.max.x-gt.min.x|0,gt.max.y-gt.min.y|0),0<M&&(c(THREE.NormalBlending),l(1),m("rgba("+Math.floor(255*O.r)+","+Math.floor(255*O.g)+","+Math.floor(255*O.b)+","+M+")"),A.fillRect(gt.min.x|0,gt.min.y|0,gt.max.x-gt.min.x|0,gt.max.y-gt.min.y|0)),gt.makeEmpty())},this.clearColor=function(){},this.clearDepth=function(){},this.clearStencil=function(){},this.render=function(e,T){if(0==T instanceof THREE.Camera)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{!0===this.autoClear&&this.clear(),A.setTransform(1,0,0,-1,k,L),b.info.render.vertices=0,b.info.render.faces=0,w=x.projectScene(e,T,this.sortObjects,this.sortElements),E=w.elements,S=w.lights,R=T,bt.setRGB(0,0,0),wt.setRGB(0,0,0),Et.setRGB(0,0,0);for(var N=0,C=S.length;N<C;N++){var O=S[N],M=O.color;O instanceof THREE.AmbientLight?bt.add(M):O instanceof THREE.DirectionalLight?wt.add(M):O instanceof THREE.PointLight&&Et.add(M)}N=0;for(C=E.length;N<C;N++){var _=E[N],D=_.material;if(void 0!==D&&!1!==D.visible){yt.makeEmpty();if(_ instanceof THREE.RenderableSprite){U=_,U.x*=k,U.y*=L,O=U,M=D,l(M.opacity),c(M.blending);var P=_.scale.x*k,_=_.scale.y*L,D=.5*Math.sqrt(P*P+_*_);yt.min.set(O.x-D,O.y-D),yt.max.set(O.x+D,O.y+D);if(!1===mt.isIntersectionBox(yt))yt.makeEmpty();else if(M instanceof THREE.SpriteMaterial||M instanceof THREE.ParticleSystemMaterial){var H=M.map;if(null!==H){!1===H.hasEventListener("update",i)&&(void 0!==H.image&&0<H.image.width&&s(H),H.addEventListener("update",i)),D=st[H.id],void 0!==D?m(D):m("rgba( 0, 0, 0, 1 )");var B=H.image,D=B.width*H.offset.x,j=B.height*H.offset.y,F=B.width*H.repeat.x,H=B.height*H.repeat.y,B=P/F,I=_/H;A.save(),A.translate(O.x,O.y),0!==M.rotation&&A.rotate(M.rotation),A.translate(-P/2,-_/2),A.scale(B,I),A.translate(-D,-j),A.fillRect(D,j,F,H)}else m(M.color.getStyle()),A.save(),A.translate(O.x,O.y),0!==M.rotation&&A.rotate(M.rotation),A.scale(P,-_),A.fillRect(-0.5,-0.5,1,1);A.restore()}else M instanceof THREE.SpriteCanvasMaterial&&(v(M.color.getStyle()),m(M.color.getStyle()),A.save(),A.translate(O.x,O.y),0!==M.rotation&&A.rotate(M.rotation),A.scale(P,_),M.program(A),A.restore())}else if(_ instanceof THREE.RenderableLine){if(U=_.v1,z=_.v2,U.positionScreen.x*=k,U.positionScreen.y*=L,z.positionScreen.x*=k,z.positionScreen.y*=L,yt.setFromPoints([U.positionScreen,z.positionScreen]),!0===mt.isIntersectionBox(yt))if(O=U,M=z,P=_,_=D,l(_.opacity),c(_.blending),A.beginPath(),A.moveTo(O.positionScreen.x,O.positionScreen.y),A.lineTo(M.positionScreen.x,M.positionScreen.y),_ instanceof THREE.LineBasicMaterial){h(_.linewidth),p(_.linecap),d(_.linejoin);if(_.vertexColors!==THREE.VertexColors)v(_.color.getStyle());else if(D=P.vertexColors[0].getStyle(),P=P.vertexColors[1].getStyle(),D===P)v(D);else{try{var q=A.createLinearGradient(O.positionScreen.x,O.positionScreen.y,M.positionScreen.x,M.positionScreen.y);q.addColorStop(0,D),q.addColorStop(1,P)}catch(it){q=D}v(q)}A.stroke(),yt.expandByScalar(2*_.linewidth)}else _ instanceof THREE.LineDashedMaterial&&(h(_.linewidth),p(_.linecap),d(_.linejoin),v(_.color.getStyle()),g(_.dashSize,_.gapSize),A.stroke(),yt.expandByScalar(2*_.linewidth),g(null,null))}else if(_ instanceof THREE.RenderableFace3){U=_.v1,z=_.v2,W=_.v3;if(-1>U.positionScreen.z||1<U.positionScreen.z)continue;if(-1>z.positionScreen.z||1<z.positionScreen.z)continue;if(-1>W.positionScreen.z||1<W.positionScreen.z)continue;U.positionScreen.x*=k,U.positionScreen.y*=L,z.positionScreen.x*=k,z.positionScreen.y*=L,W.positionScreen.x*=k,W.positionScreen.y*=L,0<D.overdraw&&(f(U.positionScreen,z.positionScreen,D.overdraw),f(z.positionScreen,W.positionScreen,D.overdraw),f(W.positionScreen,U.positionScreen,D.overdraw)),yt.setFromPoints([U.positionScreen,z.positionScreen,W.positionScreen]);if(!0===mt.isIntersectionBox(yt)){O=U,M=z,P=W,b.info.render.vertices+=3,b.info.render.faces++,l(D.opacity),c(D.blending),X=O.positionScreen.x,V=O.positionScreen.y,$=M.positionScreen.x,J=M.positionScreen.y,K=P.positionScreen.x,Q=P.positionScreen.y;var j=X,F=V,H=$,B=J,I=K,xt=Q;A.beginPath(),A.moveTo(j,F),A.lineTo(H,B),A.lineTo(I,xt),A.closePath(),(D instanceof THREE.MeshLambertMaterial||D instanceof THREE.MeshPhongMaterial)&&null===D.map?(nt.copy(D.color),rt.copy(D.emissive),D.vertexColors===THREE.FaceColors&&nt.multiply(_.color),!1===D.wireframe&&D.shading===THREE.SmoothShading&&3===_.vertexNormalsLength?(Y.copy(bt),Z.copy(bt),et.copy(bt),t(_.v1.positionWorld,_.vertexNormalsModel[0],Y),t(_.v2.positionWorld,_.vertexNormalsModel[1],Z),t(_.v3.positionWorld,_.vertexNormalsModel[2],et),Y.multiply(nt).add(rt),Z.multiply(nt).add(rt),et.multiply(nt).add(rt),tt.addColors(Z,et).multiplyScalar(.5),at=a(Y,Z,et,tt),u(X,V,$,J,K,Q,0,0,1,0,0,1,at)):(G.copy(bt),t(_.centroidModel,_.normalModel,G),G.multiply(nt).add(rt),!0===D.wireframe?n(G,D.wireframeLinewidth,D.wireframeLinecap,D.wireframeLinejoin):r(G))):D instanceof THREE.MeshBasicMaterial||D instanceof THREE.MeshLambertMaterial||D instanceof THREE.MeshPhongMaterial?null!==D.map?D.map.mapping instanceof THREE.UVMapping&&(ft=_.uvs[0],o(X,V,$,J,K,Q,ft[0].x,ft[0].y,ft[1].x,ft[1].y,ft[2].x,ft[2].y,D.map)):null!==D.envMap?D.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(St.copy(_.vertexNormalsModelView[0]),lt=.5*St.x+.5,ct=.5*St.y+.5,St.copy(_.vertexNormalsModelView[1]),ht=.5*St.x+.5,pt=.5*St.y+.5,St.copy(_.vertexNormalsModelView[2]),dt=.5*St.x+.5,vt=.5*St.y+.5,o(X,V,$,J,K,Q,lt,ct,ht,pt,dt,vt,D.envMap)):(G.copy(D.color),D.vertexColors===THREE.FaceColors&&G.multiply(_.color),!0===D.wireframe?n(G,D.wireframeLinewidth,D.wireframeLinecap,D.wireframeLinejoin):r(G)):D instanceof THREE.MeshDepthMaterial?(ot=R.near,ut=R.far,Y.r=Y.g=Y.b=1-y(O.positionScreen.z*O.positionScreen.w,ot,ut),Z.r=Z.g=Z.b=1-y(M.positionScreen.z*M.positionScreen.w,ot,ut),et.r=et.g=et.b=1-y(P.positionScreen.z*P.positionScreen.w,ot,ut),tt.addColors(Z,et).multiplyScalar(.5),at=a(Y,Z,et,tt),u(X,V,$,J,K,Q,0,0,1,0,0,1,at)):D instanceof THREE.MeshNormalMaterial&&(O=void 0,D.shading===THREE.FlatShading?(O=_.normalModelView,G.setRGB(O.x,O.y,O.z).multiplyScalar(.5).addScalar(.5),!0===D.wireframe?n(G,D.wireframeLinewidth,D.wireframeLinecap,D.wireframeLinejoin):r(G)):D.shading===THREE.SmoothShading&&(O=_.vertexNormalsModelView[0],Y.setRGB(O.x,O.y,O.z).multiplyScalar(.5).addScalar(.5),O=_.vertexNormalsModelView[1],Z.setRGB(O.x,O.y,O.z).multiplyScalar(.5).addScalar(.5),O=_.vertexNormalsModelView[2],et.setRGB(O.x,O.y,O.z).multiplyScalar(.5).addScalar(.5),tt.addColors(Z,et).multiplyScalar(.5),at=a(Y,Z,et,tt),u(X,V,$,J,K,Q,0,0,1,0,0,1,at)))}}gt.union(yt)}}A.setTransform(1,0,0,1,0,0)}}},THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#else\nvarying vec3 vReflect;\n#endif\n#endif",envmap_fragment:"#ifdef USE_ENVMAP\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nreflectVec = vReflect;\n#endif\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n} else {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n}\n#endif",envmap_pars_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n#ifdef USE_SKINNING\nvec4 worldPosition = modelMatrix * skinned;\n#endif\n#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n#endif\n#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n#endif\n#endif",envmap_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\nworldNormal = normalize( worldNormal );\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, worldNormal );\n}\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n#endif",map_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",map_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",map_fragment:"#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUv );\nvec2 dSTdy = dFdy( vUv );\nfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUv.st );\nvec2 st1 = dFdy( vUv.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif",lights_lambert_pars_vertex:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",lights_lambert_vertex:"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\nvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n#ifdef DOUBLE_SIDED\nvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n#endif\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif",lights_phong_pars_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif",lights_phong_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvWorldPosition = worldPosition.xyz;\n#endif",lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",lights_phong_fragment:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += diffuse * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;\nuniform int boneTextureWidth;\nuniform int boneTextureHeight;\nmat4 getBoneMatrix( const in float i ) {\nfloat j = i * 4.0;\nfloat x = mod( j, float( boneTextureWidth ) );\nfloat y = floor( j / float( boneTextureWidth ) );\nfloat dx = 1.0 / float( boneTextureWidth );\nfloat dy = 1.0 / float( boneTextureHeight );\ny = dy * ( y + 0.5 );\nvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\nvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\nvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\nvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\nmat4 bone = mat4( v1, v2, v3, v4 );\nreturn bone;\n}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\nmat4 getBoneMatrix( const in float i ) {\nmat4 bone = boneGlobalMatrices[ int(i) ];\nreturn bone;\n}\n#endif\n#endif",skinbase_vertex:"#ifdef USE_SKINNING\nmat4 boneMatX = getBoneMatrix( skinIndex.x );\nmat4 boneMatY = getBoneMatrix( skinIndex.y );\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n#ifdef USE_MORPHTARGETS\nvec4 skinVertex = vec4( morphed, 1.0 );\n#else\nvec4 skinVertex = vec4( position, 1.0 );\n#endif\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned 	  += boneMatY * skinVertex * skinWeight.y;\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\n#endif",default_vertex:"vec4 mvPosition;\n#ifdef USE_SKINNING\nmvPosition = modelViewMatrix * skinned;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( position, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\nmat4 skinMatrix = skinWeight.x * boneMatX;\nskinMatrix 	+= skinWeight.y * boneMatY;\n#ifdef USE_MORPHNORMALS\nvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n#else\nvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n#endif\n#endif",defaultnormal_vertex:"vec3 objectNormal;\n#ifdef USE_SKINNING\nobjectNormal = skinnedNormal.xyz;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\nobjectNormal = morphedNormal;\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\nobjectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.0 * xPixelOffset;\nfloat dy0 = -1.0 * yPixelOffset;\nfloat dx1 = 1.0 * xPixelOffset;\nfloat dy1 = 1.0 * yPixelOffset;\nmat3 shadowKernel;\nmat3 depthKernel;\ndepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\ndepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\ndepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\ndepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\ndepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\ndepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\ndepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\ndepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\ndepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nvec3 shadowZ = vec3( shadowCoord.z );\nshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\nshadowKernel[0] *= vec3(0.25);\nshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\nshadowKernel[1] *= vec3(0.25);\nshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\nshadowKernel[2] *= vec3(0.25);\nvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\nshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\nshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\nvec4 shadowValues;\nshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\nshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\nshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\nshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\nshadow = dot( shadowValues, vec4( 1.0 ) );\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",linear_to_gamma_fragment:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"},THREE.UniformsUtils={merge:function(e){var t,n,r,i={};for(t=0;t<e.length;t++)for(n in r=this.clone(e[t]),r)i[n]=r[n];return i},clone:function(e){var t,n,r,i={};for(t in e)for(n in i[t]={},e[t])r=e[t][n],i[t][n]=r instanceof THREE.Color||r instanceof THREE.Vector2||r instanceof THREE.Vector3||r instanceof THREE.Vector4||r instanceof THREE.Matrix4||r instanceof THREE.Texture?r.clone():r instanceof Array?r.slice():r;return i}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\nif ( mod( vLineDistance, totalSize ) > dashSize ) {\ndiscard;\n}\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {\nvNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},diffuse:{type:"c",value:new THREE.Color(16777215)},specular:{type:"c",value:new THREE.Color(1118481)},ambient:{type:"c",value:new THREE.Color(16777215)},shininess:{type:"f",value:30},opacity:{type:"f",value:1},useRefract:{type:"i",value:0},refractionRatio:{type:"f",value:.98},reflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform vec2 uNormalScale;\nuniform bool useRefract;\nuniform float refractionRatio;\nuniform float reflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), opacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\n#ifdef FLIP_SIDED\nfinalNormal = -finalNormal;\n#endif\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 pointVector = lPosition.xyz + vViewPosition.xyz;\nfloat pointDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\npointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );\npointVector = normalize( pointVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * diffuse * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 spotVector = lPosition.xyz + vViewPosition.xyz;\nfloat spotDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nspotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );\nspotVector = normalize( spotVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );\n#endif\nspotDiffuse += spotDistance * spotLightColor[ i ] * diffuse * spotDiffuseWeight * spotEffect;\nvec3 spotHalfVector = normalize( spotVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * diffuse * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, shininess ), 0.0 );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += diffuse * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif\nif ( enableReflection ) {\nvec3 vReflect;\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, normal, refractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, normal );\n}\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * reflectivity );\n}",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\nuniform bool enableDisplacement;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"#ifdef USE_SKINNING\nvNormal = normalize( normalMatrix * skinnedNormal.xyz );\nvec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );\nvTangent = normalize( normalMatrix * skinnedTangent.xyz );\n#else\nvNormal = normalize( normalMatrix * normal );\nvTangent = normalize( normalMatrix * tangent.xyz );\n#endif\nvBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );\nvUv = uv * uRepeat + uOffset;\nvec3 displacedPosition;\n#ifdef VERTEX_TEXTURES\nif ( enableDisplacement ) {\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\ndisplacedPosition = position + normalize( normal ) * df;\n} else {\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned 	  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n}\n#else\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned 	  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n#endif\nvec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );\nvec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\nvWorldPosition = worldPosition.xyz;\nvViewPosition = -mvPosition.xyz;\n#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif\n}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\nvoid main() {\ngl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n}"},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}},THREE.WebGLRenderer=function(e){function t(e,t){var n=e.vertices.length,r=t.material;if(r.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(var i in r.attributes){var s=r.attributes[i];if(!s.__webglInitialized||s.createUniqueBuffers){s.__webglInitialized=!0;var o=1;"v2"===s.type?o=2:"v3"===s.type?o=3:"v4"===s.type?o=4:"c"===s.type&&(o=3),s.size=o,s.array=new Float32Array(n*o),s.buffer=xt.createBuffer(),s.buffer.belongsToAttribute=i,s.needsUpdate=!0}e.__webglCustomAttributesList.push(s)}}}function n(e,t){var n=t.geometry,o=e.faces3,u=3*o.length,a=1*o.length,f=3*o.length,o=r(t,e),l=s(o),c=i(o),h=o.vertexColors?o.vertexColors:!1;e.__vertexArray=new Float32Array(3*u),c&&(e.__normalArray=new Float32Array(3*u)),n.hasTangents&&(e.__tangentArray=new Float32Array(4*u)),h&&(e.__colorArray=new Float32Array(3*u)),l&&(0<n.faceVertexUvs.length&&(e.__uvArray=new Float32Array(2*u)),1<n.faceVertexUvs.length&&(e.__uv2Array=new Float32Array(2*u))),t.geometry.skinWeights.length&&t.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*u),e.__skinWeightArray=new Float32Array(4*u)),e.__faceArray=new Uint16Array(3*a),e.__lineArray=new Uint16Array(2*f);if(e.numMorphTargets){e.__morphTargetsArrays=[],n=0;for(l=e.numMorphTargets;n<l;n++)e.__morphTargetsArrays.push(new Float32Array(3*u))}if(e.numMorphNormals){e.__morphNormalsArrays=[],n=0;for(l=e.numMorphNormals;n<l;n++)e.__morphNormalsArrays.push(new Float32Array(3*u))}e.__webglFaceCount=3*a,e.__webglLineCount=2*f;if(o.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(var p in o.attributes){var a=o.attributes[p],f={},d;for(d in a)f[d]=a[d];if(!f.__webglInitialized||f.createUniqueBuffers)f.__webglInitialized=!0,n=1,"v2"===f.type?n=2:"v3"===f.type?n=3:"v4"===f.type?n=4:"c"===f.type&&(n=3),f.size=n,f.array=new Float32Array(u*n),f.buffer=xt.createBuffer(),f.buffer.belongsToAttribute=p,a.needsUpdate=!0,f.__original=a;e.__webglCustomAttributesList.push(f)}}e.__inittedArrays=!0}function r(e,t){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function i(e){return e instanceof THREE.MeshBasicMaterial&&!e.envMap||e instanceof THREE.MeshDepthMaterial?!1:e&&void 0!==e.shading&&e.shading===THREE.SmoothShading?THREE.SmoothShading:THREE.FlatShading}function s(e){return e.map||e.lightMap||e.bumpMap||e.normalMap||e.specularMap||e instanceof THREE.ShaderMaterial?!0:!1}function o(e){vt[e]||(xt.enableVertexAttribArray(e),vt[e]=!0)}function u(){for(var e in vt)vt[e]&&(xt.disableVertexAttribArray(e),vt[e]=!1)}function a(e,t){return e.z!==t.z?t.z-e.z:e.id-t.id}function f(e,t){return t[0]-e[0]}function l(e,t,n){if(e.length)for(var r=0,i=e.length;r<i;r++)J=W=null,V=$=Y=G=it=rt=Z=-1,Et=!0,e[r].render(t,n,pt,dt),J=W=null,V=$=Y=G=it=rt=Z=-1,Et=!0}function c(e,t,n,r,i,s,o,u){var a,f,l,c;t?(f=e.length-1,c=t=-1):(f=0,t=e.length,c=1);for(var h=f;h!==t;h+=c)if(a=e[h],a.render){f=a.object,l=a.buffer;if(u)a=u;else{a=a[n];if(!a)continue;o&&R.setBlending(a.blending,a.blendEquation,a.blendSrc,a.blendDst),R.setDepthTest(a.depthTest),R.setDepthWrite(a.depthWrite),N(a.polygonOffset,a.polygonOffsetFactor,a.polygonOffsetUnits)}R.setMaterialFaces(a),l instanceof THREE.BufferGeometry?R.renderBufferDirect(r,i,s,a,l,f):R.renderBuffer(r,i,s,a,l,f)}}function h(e,t,n,r,i,s,o){for(var u,a,f=0,l=e.length;f<l;f++)if(u=e[f],a=u.object,a.visible){if(o)u=o;else{u=u[t];if(!u)continue;s&&R.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst),R.setDepthTest(u.depthTest),R.setDepthWrite(u.depthWrite),N(u.polygonOffset,u.polygonOffsetFactor,u.polygonOffsetUnits)}R.renderImmediateObject(n,r,i,u,a)}}function p(e,r){var i,s,o,u;if(void 0===e.__webglInit&&(e.__webglInit=!0,e._modelViewMatrix=new THREE.Matrix4,e._normalMatrix=new THREE.Matrix3,void 0!==e.geometry&&void 0===e.geometry.__webglInit&&(e.geometry.__webglInit=!0,e.geometry.addEventListener("dispose",Ut)),s=e.geometry,void 0!==s))if(s instanceof THREE.BufferGeometry){var a,f;for(a in s.attributes)f="index"===a?xt.ELEMENT_ARRAY_BUFFER:xt.ARRAY_BUFFER,u=s.attributes[a],void 0===u.numItems&&(u.numItems=u.array.length),u.buffer=xt.createBuffer(),xt.bindBuffer(f,u.buffer),xt.bufferData(f,u.array,xt.STATIC_DRAW)}else if(e instanceof THREE.Mesh){o=e.material;if(void 0===s.geometryGroups){a=s;var l,c,h;f={};var p=a.morphTargets.length,v=a.morphNormals.length,m=o instanceof THREE.MeshFaceMaterial;a.geometryGroups={},o=0;for(l=a.faces.length;o<l;o++)c=a.faces[o],c=m?c.materialIndex:0,void 0===f[c]&&(f[c]={hash:c,counter:0}),h=f[c].hash+"_"+f[c].counter,void 0===a.geometryGroups[h]&&(a.geometryGroups[h]={faces3:[],materialIndex:c,vertices:0,numMorphTargets:p,numMorphNormals:v}),65535<a.geometryGroups[h].vertices+3&&(f[c].counter+=1,h=f[c].hash+"_"+f[c].counter,void 0===a.geometryGroups[h]&&(a.geometryGroups[h]={faces3:[],materialIndex:c,vertices:0,numMorphTargets:p,numMorphNormals:v})),a.geometryGroups[h].faces3.push(o),a.geometryGroups[h].vertices+=3;a.geometryGroupsList=[];for(u in a.geometryGroups)a.geometryGroups[u].id=K++,a.geometryGroupsList.push(a.geometryGroups[u])}for(i in s.geometryGroups)if(u=s.geometryGroups[i],!u.__webglVertexBuffer){a=u,a.__webglVertexBuffer=xt.createBuffer(),a.__webglNormalBuffer=xt.createBuffer(),a.__webglTangentBuffer=xt.createBuffer(),a.__webglColorBuffer=xt.createBuffer(),a.__webglUVBuffer=xt.createBuffer(),a.__webglUV2Buffer=xt.createBuffer(),a.__webglSkinIndicesBuffer=xt.createBuffer(),a.__webglSkinWeightsBuffer=xt.createBuffer(),a.__webglFaceBuffer=xt.createBuffer(),a.__webglLineBuffer=xt.createBuffer(),p=f=void 0;if(a.numMorphTargets){a.__webglMorphTargetsBuffers=[],f=0;for(p=a.numMorphTargets;f<p;f++)a.__webglMorphTargetsBuffers.push(xt.createBuffer())}if(a.numMorphNormals){a.__webglMorphNormalsBuffers=[],f=0;for(p=a.numMorphNormals;f<p;f++)a.__webglMorphNormalsBuffers.push(xt.createBuffer())}R.info.memory.geometries++,n(u,e),s.verticesNeedUpdate=!0,s.morphTargetsNeedUpdate=!0,s.elementsNeedUpdate=!0,s.uvsNeedUpdate=!0,s.normalsNeedUpdate=!0,s.tangentsNeedUpdate=!0,s.colorsNeedUpdate=!0}}else e instanceof THREE.Line?s.__webglVertexBuffer||(u=s,u.__webglVertexBuffer=xt.createBuffer(),u.__webglColorBuffer=xt.createBuffer(),u.__webglLineDistanceBuffer=xt.createBuffer(),R.info.memory.geometries++,u=s,a=u.vertices.length,u.__vertexArray=new Float32Array(3*a),u.__colorArray=new Float32Array(3*a),u.__lineDistanceArray=new Float32Array(1*a),u.__webglLineCount=a,t(u,e),s.verticesNeedUpdate=!0,s.colorsNeedUpdate=!0,s.lineDistancesNeedUpdate=!0):e instanceof THREE.ParticleSystem&&!s.__webglVertexBuffer&&(u=s,u.__webglVertexBuffer=xt.createBuffer(),u.__webglColorBuffer=xt.createBuffer(),R.info.memory.geometries++,u=s,a=u.vertices.length,u.__vertexArray=new Float32Array(3*a),u.__colorArray=new Float32Array(3*a),u.__sortArray=[],u.__webglParticleCount=a,t(u,e),s.verticesNeedUpdate=!0,s.colorsNeedUpdate=!0);if(void 0===e.__webglActive){if(e instanceof THREE.Mesh){if(s=e.geometry,s instanceof THREE.BufferGeometry)d(r.__webglObjects,s,e);else if(s instanceof THREE.Geometry)for(i in s.geometryGroups)u=s.geometryGroups[i],d(r.__webglObjects,u,e)}else e instanceof THREE.Line||e instanceof THREE.ParticleSystem?(s=e.geometry,d(r.__webglObjects,s,e)):e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback?r.__webglObjectsImmediate.push({id:null,object:e,opaque:null,transparent:null,z:0}):e instanceof THREE.Sprite?r.__webglSprites.push(e):e instanceof THREE.LensFlare&&r.__webglFlares.push(e);e.__webglActive=!0}}function d(e,t,n){e.push({id:null,buffer:t,object:n,opaque:null,transparent:null,z:0})}function v(e){for(var t in e.attributes)if(e.attributes[t].needsUpdate)return!0;return!1}function m(e){for(var t in e.attributes)e.attributes[t].needsUpdate=!1}function g(e,t){e instanceof THREE.Mesh||e instanceof THREE.ParticleSystem||e instanceof THREE.Line?y(t.__webglObjects,e):e instanceof THREE.Sprite?b(t.__webglSprites,e):e instanceof THREE.LensFlare?b(t.__webglFlares,e):(e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback)&&y(t.__webglObjectsImmediate,e),delete e.__webglActive}function y(e,t){for(var n=e.length-1;0<=n;n--)e[n].object===t&&e.splice(n,1)}function b(e,t){for(var n=e.length-1;0<=n;n--)e[n]===t&&e.splice(n,1)}function w(e,t,n,r,i){Q=0,r.needsUpdate&&(r.program&&$t(r),R.initMaterial(r,t,n,i),r.needsUpdate=!1),r.morphTargets&&!i.__webglMorphTargetInfluences&&(i.__webglMorphTargetInfluences=new Float32Array(R.maxMorphTargets));var s=!1,o=r.program,u=o.uniforms,a=r.uniforms;o!==W&&(xt.useProgram(o),W=o,s=!0),r.id!==V&&(V=r.id,s=!0);if(s||e!==J)xt.uniformMatrix4fv(u.projectionMatrix,!1,e.projectionMatrix.elements),e!==J&&(J=e);if(r.skinning)if(Ht&&i.useVertexTexture){if(null!==u.boneTexture){var f=E();xt.uniform1i(u.boneTexture,f),R.setTexture(i.boneTexture,f)}null!==u.boneTextureWidth&&xt.uniform1i(u.boneTextureWidth,i.boneTextureWidth),null!==u.boneTextureHeight&&xt.uniform1i(u.boneTextureHeight,i.boneTextureHeight)}else null!==u.boneGlobalMatrices&&xt.uniformMatrix4fv(u.boneGlobalMatrices,!1,i.boneMatrices);if(s){n&&r.fog&&(a.fogColor.value=n.color,n instanceof THREE.Fog?(a.fogNear.value=n.near,a.fogFar.value=n.far):n instanceof THREE.FogExp2&&(a.fogDensity.value=n.density));if(r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r.lights){if(Et){for(var l,c=f=0,h=0,p,d,v,m=St,g=m.directional.colors,y=m.directional.positions,b=m.point.colors,w=m.point.positions,T=m.point.distances,N=m.spot.colors,C=m.spot.positions,k=m.spot.distances,A=m.spot.directions,O=m.spot.anglesCos,D=m.spot.exponents,P=m.hemi.skyColors,H=m.hemi.groundColors,B=m.hemi.positions,j=0,F=0,I=0,q=0,U=0,z=0,X=0,$=0,K=l=0,n=v=K=0,s=t.length;n<s;n++)l=t[n],l.onlyShadow||(p=l.color,d=l.intensity,v=l.distance,l instanceof THREE.AmbientLight?l.visible&&(R.gammaInput?(f+=p.r*p.r,c+=p.g*p.g,h+=p.b*p.b):(f+=p.r,c+=p.g,h+=p.b)):l instanceof THREE.DirectionalLight?(U+=1,l.visible&&(wt.setFromMatrixPosition(l.matrixWorld),bt.setFromMatrixPosition(l.target.matrixWorld),wt.sub(bt),wt.normalize(),0===wt.x&&0===wt.y&&0===wt.z||(l=3*j,y[l]=wt.x,y[l+1]=wt.y,y[l+2]=wt.z,R.gammaInput?S(g,l,p,d*d):x(g,l,p,d),j+=1))):l instanceof THREE.PointLight?(z+=1,l.visible&&(K=3*F,R.gammaInput?S(b,K,p,d*d):x(b,K,p,d),bt.setFromMatrixPosition(l.matrixWorld),w[K]=bt.x,w[K+1]=bt.y,w[K+2]=bt.z,T[F]=v,F+=1)):l instanceof THREE.SpotLight?(X+=1,l.visible&&(K=3*I,R.gammaInput?S(N,K,p,d*d):x(N,K,p,d),bt.setFromMatrixPosition(l.matrixWorld),C[K]=bt.x,C[K+1]=bt.y,C[K+2]=bt.z,k[I]=v,wt.copy(bt),bt.setFromMatrixPosition(l.target.matrixWorld),wt.sub(bt),wt.normalize(),A[K]=wt.x,A[K+1]=wt.y,A[K+2]=wt.z,O[I]=Math.cos(l.angle),D[I]=l.exponent,I+=1)):l instanceof THREE.HemisphereLight&&($+=1,l.visible&&(wt.setFromMatrixPosition(l.matrixWorld),wt.normalize(),0===wt.x&&0===wt.y&&0===wt.z||(v=3*q,B[v]=wt.x,B[v+1]=wt.y,B[v+2]=wt.z,p=l.color,l=l.groundColor,R.gammaInput?(d*=d,S(P,v,p,d),S(H,v,l,d)):(x(P,v,p,d),x(H,v,l,d)),q+=1))));n=3*j;for(s=Math.max(g.length,3*U);n<s;n++)g[n]=0;n=3*F;for(s=Math.max(b.length,3*z);n<s;n++)b[n]=0;n=3*I;for(s=Math.max(N.length,3*X);n<s;n++)N[n]=0;n=3*q;for(s=Math.max(P.length,3*$);n<s;n++)P[n]=0;n=3*q;for(s=Math.max(H.length,3*$);n<s;n++)H[n]=0;m.directional.length=j,m.point.length=F,m.spot.length=I,m.hemi.length=q,m.ambient[0]=f,m.ambient[1]=c,m.ambient[2]=h,Et=!1}n=St,a.ambientLightColor.value=n.ambient,a.directionalLightColor.value=n.directional.colors,a.directionalLightDirection.value=n.directional.positions,a.pointLightColor.value=n.point.colors,a.pointLightPosition.value=n.point.positions,a.pointLightDistance.value=n.point.distances,a.spotLightColor.value=n.spot.colors,a.spotLightPosition.value=n.spot.positions,a.spotLightDistance.value=n.spot.distances,a.spotLightDirection.value=n.spot.directions,a.spotLightAngleCos.value=n.spot.anglesCos,a.spotLightExponent.value=n.spot.exponents,a.hemisphereLightSkyColor.value=n.hemi.skyColors,a.hemisphereLightGroundColor.value=n.hemi.groundColors,a.hemisphereLightDirection.value=n.hemi.positions}if(r instanceof THREE.MeshBasicMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.MeshPhongMaterial){a.opacity.value=r.opacity,R.gammaInput?a.diffuse.value.copyGammaToLinear(r.color):a.diffuse.value=r.color,a.map.value=r.map,a.lightMap.value=r.lightMap,a.specularMap.value=r.specularMap,r.bumpMap&&(a.bumpMap.value=r.bumpMap,a.bumpScale.value=r.bumpScale),r.normalMap&&(a.normalMap.value=r.normalMap,a.normalScale.value.copy(r.normalScale));var G;r.map?G=r.map:r.specularMap?G=r.specularMap:r.normalMap?G=r.normalMap:r.bumpMap&&(G=r.bumpMap),void 0!==G&&(n=G.offset,G=G.repeat,a.offsetRepeat.value.set(n.x,n.y,G.x,G.y)),a.envMap.value=r.envMap,a.flipEnvMap.value=r.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,a.reflectivity.value=r.reflectivity,a.refractionRatio.value=r.refractionRatio,a.combine.value=r.combine,a.useRefract.value=r.envMap&&r.envMap.mapping instanceof THREE.CubeRefractionMapping}r instanceof THREE.LineBasicMaterial?(a.diffuse.value=r.color,a.opacity.value=r.opacity):r instanceof THREE.LineDashedMaterial?(a.diffuse.value=r.color,a.opacity.value=r.opacity,a.dashSize.value=r.dashSize,a.totalSize.value=r.dashSize+r.gapSize,a.scale.value=r.scale):r instanceof THREE.ParticleSystemMaterial?(a.psColor.value=r.color,a.opacity.value=r.opacity,a.size.value=r.size,a.scale.value=_.height/2,a.map.value=r.map):r instanceof THREE.MeshPhongMaterial?(a.shininess.value=r.shininess,R.gammaInput?(a.ambient.value.copyGammaToLinear(r.ambient),a.emissive.value.copyGammaToLinear(r.emissive),a.specular.value.copyGammaToLinear(r.specular)):(a.ambient.value=r.ambient,a.emissive.value=r.emissive,a.specular.value=r.specular),r.wrapAround&&a.wrapRGB.value.copy(r.wrapRGB)):r instanceof THREE.MeshLambertMaterial?(R.gammaInput?(a.ambient.value.copyGammaToLinear(r.ambient),a.emissive.value.copyGammaToLinear(r.emissive)):(a.ambient.value=r.ambient,a.emissive.value=r.emissive),r.wrapAround&&a.wrapRGB.value.copy(r.wrapRGB)):r instanceof THREE.MeshDepthMaterial?(a.mNear.value=e.near,a.mFar.value=e.far,a.opacity.value=r.opacity):r instanceof THREE.MeshNormalMaterial&&(a.opacity.value=r.opacity);if(i.receiveShadow&&!r._shadowPass&&a.shadowMatrix){n=G=0;for(s=t.length;n<s;n++)if(f=t[n],f.castShadow&&(f instanceof THREE.SpotLight||f instanceof THREE.DirectionalLight&&!f.shadowCascade))a.shadowMap.value[G]=f.shadowMap,a.shadowMapSize.value[G]=f.shadowMapSize,a.shadowMatrix.value[G]=f.shadowMatrix,a.shadowDarkness.value[G]=f.shadowDarkness,a.shadowBias.value[G]=f.shadowBias,G++}t=r.uniformsList,a=0;for(G=t.length;a<G;a++)if(s=o.uniforms[t[a][1]])if(n=t[a][0],c=n.type,f=n.value,"i"===c)xt.uniform1i(s,f);else if("f"===c)xt.uniform1f(s,f);else if("v2"===c)xt.uniform2f(s,f.x,f.y);else if("v3"===c)xt.uniform3f(s,f.x,f.y,f.z);else if("v4"===c)xt.uniform4f(s,f.x,f.y,f.z,f.w);else if("c"===c)xt.uniform3f(s,f.r,f.g,f.b);else if("iv1"===c)xt.uniform1iv(s,f);else if("iv"===c)xt.uniform3iv(s,f);else if("fv1"===c)xt.uniform1fv(s,f);else if("fv"===c)xt.uniform3fv(s,f);else if("v2v"===c){void 0===n._array&&(n._array=new Float32Array(2*f.length)),c=0;for(h=f.length;c<h;c++)m=2*c,n._array[m]=f[c].x,n._array[m+1]=f[c].y;xt.uniform2fv(s,n._array)}else if("v3v"===c){void 0===n._array&&(n._array=new Float32Array(3*f.length)),c=0;for(h=f.length;c<h;c++)m=3*c,n._array[m]=f[c].x,n._array[m+1]=f[c].y,n._array[m+2]=f[c].z;xt.uniform3fv(s,n._array)}else if("v4v"===c){void 0===n._array&&(n._array=new Float32Array(4*f.length)),c=0;for(h=f.length;c<h;c++)m=4*c,n._array[m]=f[c].x,n._array[m+1]=f[c].y,n._array[m+2]=f[c].z,n._array[m+3]=f[c].w;xt.uniform4fv(s,n._array)}else if("m4"===c)void 0===n._array&&(n._array=new Float32Array(16)),f.flattenToArray(n._array),xt.uniformMatrix4fv(s,!1,n._array);else if("m4v"===c){void 0===n._array&&(n._array=new Float32Array(16*f.length)),c=0;for(h=f.length;c<h;c++)f[c].flattenToArrayOffset(n._array,16*c);xt.uniformMatrix4fv(s,!1,n._array)}else if("t"===c){if(m=f,f=E(),xt.uniform1i(s,f),m)if(m.image instanceof Array&&6===m.image.length){if(n=m,s=f,6===n.image.length)if(n.needsUpdate){n.image.__webglTextureCube||(n.addEventListener("dispose",zt),n.image.__webglTextureCube=xt.createTexture(),R.info.memory.textures++),xt.activeTexture(xt.TEXTURE0+s),xt.bindTexture(xt.TEXTURE_CUBE_MAP,n.image.__webglTextureCube),xt.pixelStorei(xt.UNPACK_FLIP_Y_WEBGL,n.flipY),s=n instanceof THREE.CompressedTexture,f=[];for(c=0;6>c;c++)R.autoScaleCubemaps&&!s?(h=f,m=c,g=n.image[c],b=_t,g.width<=b&&g.height<=b||(w=Math.max(g.width,g.height),y=Math.floor(g.width*b/w),b=Math.floor(g.height*b/w),w=document.createElement("canvas"),w.width=y,w.height=b,w.getContext("2d").drawImage(g,0,0,g.width,g.height,0,0,y,b),g=w),h[m]=g):f[c]=n.image[c];c=f[0],h=0===(c.width&c.width-1)&&0===(c.height&c.height-1),m=M(n.format),g=M(n.type),L(xt.TEXTURE_CUBE_MAP,n,h);for(c=0;6>c;c++)if(s){b=f[c].mipmaps,w=0;for(T=b.length;w<T;w++)y=b[w],n.format!==THREE.RGBAFormat?xt.compressedTexImage2D(xt.TEXTURE_CUBE_MAP_POSITIVE_X+c,w,m,y.width,y.height,0,y.data):xt.texImage2D(xt.TEXTURE_CUBE_MAP_POSITIVE_X+c,w,m,y.width,y.height,0,m,g,y.data)}else xt.texImage2D(xt.TEXTURE_CUBE_MAP_POSITIVE_X+c,0,m,m,g,f[c]);n.generateMipmaps&&h&&xt.generateMipmap(xt.TEXTURE_CUBE_MAP),n.needsUpdate=!1,n.onUpdate&&n.onUpdate()}else xt.activeTexture(xt.TEXTURE0+s),xt.bindTexture(xt.TEXTURE_CUBE_MAP,n.image.__webglTextureCube)}else m instanceof THREE.WebGLRenderTargetCube?(n=m,xt.activeTexture(xt.TEXTURE0+f),xt.bindTexture(xt.TEXTURE_CUBE_MAP,n.__webglTexture)):R.setTexture(m,f)}else if("tv"===c){void 0===n._array&&(n._array=[]),c=0;for(h=n.value.length;c<h;c++)n._array[c]=E();xt.uniform1iv(s,n._array),c=0;for(h=n.value.length;c<h;c++)m=n.value[c],f=n._array[c],m&&R.setTexture(m,f)}else console.warn("THREE.WebGLRenderer: Unknown uniform type: "+c);(r instanceof THREE.ShaderMaterial||r instanceof THREE.MeshPhongMaterial||r.envMap)&&null!==u.cameraPosition&&(bt.setFromMatrixPosition(e.matrixWorld),xt.uniform3f(u.cameraPosition,bt.x,bt.y,bt.z)),(r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.ShaderMaterial||r.skinning)&&null!==u.viewMatrix&&xt.uniformMatrix4fv(u.viewMatrix,!1,e.matrixWorldInverse.elements)}return xt.uniformMatrix4fv(u.modelViewMatrix,!1,i._modelViewMatrix.elements),u.normalMatrix&&xt.uniformMatrix3fv(u.normalMatrix,!1,i._normalMatrix.elements),null!==u.modelMatrix&&xt.uniformMatrix4fv(u.modelMatrix,!1,i.matrixWorld.elements),o}function E(){var e=Q;return e>=Ot&&console.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+Ot),Q+=1,e}function S(e,t,n,r){e[t]=n.r*n.r*r,e[t+1]=n.g*n.g*r,e[t+2]=n.b*n.b*r}function x(e,t,n,r){e[t]=n.r*r,e[t+1]=n.g*r,e[t+2]=n.b*r}function T(e){e!==at&&(xt.lineWidth(e),at=e)}function N(e,t,n){st!==e&&(e?xt.enable(xt.POLYGON_OFFSET_FILL):xt.disable(xt.POLYGON_OFFSET_FILL),st=e),e&&(ot!==t||ut!==n)&&(xt.polygonOffset(t,n),ot=t,ut=n)}function C(e){for(var e=e.split("\n"),t=0,n=e.length;t<n;t++)e[t]=t+1+": "+e[t];return e.join("\n")}function k(e,t){var n;return"fragment"===e?n=xt.createShader(xt.FRAGMENT_SHADER):"vertex"===e&&(n=xt.createShader(xt.VERTEX_SHADER)),xt.shaderSource(n,t),xt.compileShader(n),xt.getShaderParameter(n,xt.COMPILE_STATUS)?n:(console.error(xt.getShaderInfoLog(n)),console.error(C(t)),null)}function L(e,t,n){n?(xt.texParameteri(e,xt.TEXTURE_WRAP_S,M(t.wrapS)),xt.texParameteri(e,xt.TEXTURE_WRAP_T,M(t.wrapT)),xt.texParameteri(e,xt.TEXTURE_MAG_FILTER,M(t.magFilter)),xt.texParameteri(e,xt.TEXTURE_MIN_FILTER,M(t.minFilter))):(xt.texParameteri(e,xt.TEXTURE_WRAP_S,xt.CLAMP_TO_EDGE),xt.texParameteri(e,xt.TEXTURE_WRAP_T,xt.CLAMP_TO_EDGE),xt.texParameteri(e,xt.TEXTURE_MAG_FILTER,O(t.magFilter)),xt.texParameteri(e,xt.TEXTURE_MIN_FILTER,O(t.minFilter))),Ct&&t.type!==THREE.FloatType&&(1<t.anisotropy||t.__oldAnisotropy)&&(xt.texParameterf(e,Ct.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,Dt)),t.__oldAnisotropy=t.anisotropy)}function A(e,t){xt.bindRenderbuffer(xt.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(xt.renderbufferStorage(xt.RENDERBUFFER,xt.DEPTH_COMPONENT16,t.width,t.height),xt.framebufferRenderbuffer(xt.FRAMEBUFFER,xt.DEPTH_ATTACHMENT,xt.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(xt.renderbufferStorage(xt.RENDERBUFFER,xt.DEPTH_STENCIL,t.width,t.height),xt.framebufferRenderbuffer(xt.FRAMEBUFFER,xt.DEPTH_STENCIL_ATTACHMENT,xt.RENDERBUFFER,e)):xt.renderbufferStorage(xt.RENDERBUFFER,xt.RGBA4,t.width,t.height)}function O(e){return e===THREE.NearestFilter||e===THREE.NearestMipMapNearestFilter||e===THREE.NearestMipMapLinearFilter?xt.NEAREST:xt.LINEAR}function M(e){if(e===THREE.RepeatWrapping)return xt.REPEAT;if(e===THREE.ClampToEdgeWrapping)return xt.CLAMP_TO_EDGE;if(e===THREE.MirroredRepeatWrapping)return xt.MIRRORED_REPEAT;if(e===THREE.NearestFilter)return xt.NEAREST;if(e===THREE.NearestMipMapNearestFilter)return xt.NEAREST_MIPMAP_NEAREST;if(e===THREE.NearestMipMapLinearFilter)return xt.NEAREST_MIPMAP_LINEAR;if(e===THREE.LinearFilter)return xt.LINEAR;if(e===THREE.LinearMipMapNearestFilter)return xt.LINEAR_MIPMAP_NEAREST;if(e===THREE.LinearMipMapLinearFilter)return xt.LINEAR_MIPMAP_LINEAR;if(e===THREE.UnsignedByteType)return xt.UNSIGNED_BYTE;if(e===THREE.UnsignedShort4444Type)return xt.UNSIGNED_SHORT_4_4_4_4;if(e===THREE.UnsignedShort5551Type)return xt.UNSIGNED_SHORT_5_5_5_1;if(e===THREE.UnsignedShort565Type)return xt.UNSIGNED_SHORT_5_6_5;if(e===THREE.ByteType)return xt.BYTE;if(e===THREE.ShortType)return xt.SHORT;if(e===THREE.UnsignedShortType)return xt.UNSIGNED_SHORT;if(e===THREE.IntType)return xt.INT;if(e===THREE.UnsignedIntType)return xt.UNSIGNED_INT;if(e===THREE.FloatType)return xt.FLOAT;if(e===THREE.AlphaFormat)return xt.ALPHA;if(e===THREE.RGBFormat)return xt.RGB;if(e===THREE.RGBAFormat)return xt.RGBA;if(e===THREE.LuminanceFormat)return xt.LUMINANCE;if(e===THREE.LuminanceAlphaFormat)return xt.LUMINANCE_ALPHA;if(e===THREE.AddEquation)return xt.FUNC_ADD;if(e===THREE.SubtractEquation)return xt.FUNC_SUBTRACT;if(e===THREE.ReverseSubtractEquation)return xt.FUNC_REVERSE_SUBTRACT;if(e===THREE.ZeroFactor)return xt.ZERO;if(e===THREE.OneFactor)return xt.ONE;if(e===THREE.SrcColorFactor)return xt.SRC_COLOR;if(e===THREE.OneMinusSrcColorFactor)return xt.ONE_MINUS_SRC_COLOR;if(e===THREE.SrcAlphaFactor)return xt.SRC_ALPHA;if(e===THREE.OneMinusSrcAlphaFactor)return xt.ONE_MINUS_SRC_ALPHA;if(e===THREE.DstAlphaFactor)return xt.DST_ALPHA;if(e===THREE.OneMinusDstAlphaFactor)return xt.ONE_MINUS_DST_ALPHA;if(e===THREE.DstColorFactor)return xt.DST_COLOR;if(e===THREE.OneMinusDstColorFactor)return xt.ONE_MINUS_DST_COLOR;if(e===THREE.SrcAlphaSaturateFactor)return xt.SRC_ALPHA_SATURATE;if(void 0!==kt){if(e===THREE.RGB_S3TC_DXT1_Format)return kt.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT1_Format)return kt.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT3_Format)return kt.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===THREE.RGBA_S3TC_DXT5_Format)return kt.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION);var e=e||{},_=void 0!==e.canvas?e.canvas:document.createElement("canvas"),D=void 0!==e.precision?e.precision:"highp",P=void 0!==e.alpha?e.alpha:!1,H=void 0!==e.premultipliedAlpha?e.premultipliedAlpha:!0,B=void 0!==e.antialias?e.antialias:!1,j=void 0!==e.stencil?e.stencil:!0,F=void 0!==e.preserveDrawingBuffer?e.preserveDrawingBuffer:!1,I=new THREE.Color(0),q=0;this.domElement=_,this.context=null,this.devicePixelRatio=void 0!==e.devicePixelRatio?e.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1,this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.shadowMapEnabled=this.gammaOutput=this.gammaInput=!1,this.shadowMapAutoUpdate=!0,this.shadowMapType=THREE.PCFShadowMap,this.shadowMapCullFace=THREE.CullFaceFront,this.shadowMapCascade=this.shadowMapDebug=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.renderPluginsPre=[],this.renderPluginsPost=[],this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var R=this,U=[],z=0,W=null,X=null,V=-1,$=null,J=null,K=0,Q=0,G=-1,Y=-1,Z=-1,et=-1,tt=-1,nt=-1,rt=-1,it=-1,st=null,ot=null,ut=null,at=null,ft=0,lt=0,ct=_.width,ht=_.height,pt=0,dt=0,vt={},mt=new THREE.Frustum,gt=new THREE.Matrix4,yt=new THREE.Matrix4,bt=new THREE.Vector3,wt=new THREE.Vector3,Et=!0,St={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},xt,Tt,Nt,Ct,kt;try{var Lt={alpha:P,premultipliedAlpha:H,antialias:B,stencil:j,preserveDrawingBuffer:F};xt=_.getContext("webgl",Lt)||_.getContext("experimental-webgl",Lt);if(null===xt)throw"Error creating WebGL context."}catch(At){console.error(At)}Tt=xt.getExtension("OES_texture_float"),xt.getExtension("OES_texture_float_linear"),Nt=xt.getExtension("OES_standard_derivatives"),Ct=xt.getExtension("EXT_texture_filter_anisotropic")||xt.getExtension("MOZ_EXT_texture_filter_anisotropic")||xt.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),kt=xt.getExtension("WEBGL_compressed_texture_s3tc")||xt.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||xt.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),Tt||console.log("THREE.WebGLRenderer: Float textures not supported."),Nt||console.log("THREE.WebGLRenderer: Standard derivatives not supported."),Ct||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported."),kt||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported."),void 0===xt.getShaderPrecisionFormat&&(xt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),xt.clearColor(0,0,0,1),xt.clearDepth(1),xt.clearStencil(0),xt.enable(xt.DEPTH_TEST),xt.depthFunc(xt.LEQUAL),xt.frontFace(xt.CCW),xt.cullFace(xt.BACK),xt.enable(xt.CULL_FACE),xt.enable(xt.BLEND),xt.blendEquation(xt.FUNC_ADD),xt.blendFunc(xt.SRC_ALPHA,xt.ONE_MINUS_SRC_ALPHA),xt.viewport(ft,lt,ct,ht),xt.clearColor(I.r,I.g,I.b,q),this.context=xt;var Ot=xt.getParameter(xt.MAX_TEXTURE_IMAGE_UNITS),Mt=xt.getParameter(xt.MAX_VERTEX_TEXTURE_IMAGE_UNITS);xt.getParameter(xt.MAX_TEXTURE_SIZE);var _t=xt.getParameter(xt.MAX_CUBE_MAP_TEXTURE_SIZE),Dt=Ct?xt.getParameter(Ct.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,Pt=0<Mt,Ht=Pt&&Tt;kt&&xt.getParameter(xt.COMPRESSED_TEXTURE_FORMATS);var Bt=xt.getShaderPrecisionFormat(xt.VERTEX_SHADER,xt.HIGH_FLOAT),jt=xt.getShaderPrecisionFormat(xt.VERTEX_SHADER,xt.MEDIUM_FLOAT);xt.getShaderPrecisionFormat(xt.VERTEX_SHADER,xt.LOW_FLOAT);var Ft=xt.getShaderPrecisionFormat(xt.FRAGMENT_SHADER,xt.HIGH_FLOAT),It=xt.getShaderPrecisionFormat(xt.FRAGMENT_SHADER,xt.MEDIUM_FLOAT);xt.getShaderPrecisionFormat(xt.FRAGMENT_SHADER,xt.LOW_FLOAT),xt.getShaderPrecisionFormat(xt.VERTEX_SHADER,xt.HIGH_INT),xt.getShaderPrecisionFormat(xt.VERTEX_SHADER,xt.MEDIUM_INT),xt.getShaderPrecisionFormat(xt.VERTEX_SHADER,xt.LOW_INT),xt.getShaderPrecisionFormat(xt.FRAGMENT_SHADER,xt.HIGH_INT),xt.getShaderPrecisionFormat(xt.FRAGMENT_SHADER,xt.MEDIUM_INT),xt.getShaderPrecisionFormat(xt.FRAGMENT_SHADER,xt.LOW_INT);var qt=0<Bt.precision&&0<Ft.precision,Rt=0<jt.precision&&0<It.precision;"highp"===D&&!qt&&(Rt?(D="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(D="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp"))),"mediump"===D&&!Rt&&(D="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp")),this.getContext=function(){return xt},this.supportsVertexTextures=function(){return Pt},this.supportsFloatTextures=function(){return Tt},this.supportsStandardDerivatives=function(){return Nt},this.supportsCompressedTextureS3TC=function(){return kt},this.getMaxAnisotropy=function(){return Dt},this.getPrecision=function(){return D},this.setSize=function(e,t,n){_.width=e*this.devicePixelRatio,_.height=t*this.devicePixelRatio,1!==this.devicePixelRatio&&!1!==n&&(_.style.width=e+"px",_.style.height=t+"px"),this.setViewport(0,0,_.width,_.height)},this.setViewport=function(e,t,n,r){ft=void 0!==e?e:0,lt=void 0!==t?t:0,ct=void 0!==n?n:_.width,ht=void 0!==r?r:_.height,xt.viewport(ft,lt,ct,ht)},this.setScissor=function(e,t,n,r){xt.scissor(e,t,n,r)},this.enableScissorTest=function(e){e?xt.enable(xt.SCISSOR_TEST):xt.disable(xt.SCISSOR_TEST)},this.setClearColor=function(e,t){I.set(e),q=void 0!==t?t:1,xt.clearColor(I.r,I.g,I.b,q)},this.setClearColorHex=function(e,t){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getClearColor=function(){return I},this.getClearAlpha=function(){return q},this.clear=function(e,t,n){var r=0;if(void 0===e||e)r|=xt.COLOR_BUFFER_BIT;if(void 0===t||t)r|=xt.DEPTH_BUFFER_BIT;if(void 0===n||n)r|=xt.STENCIL_BUFFER_BIT;xt.clear(r)},this.clearColor=function(){xt.clear(xt.COLOR_BUFFER_BIT)},this.clearDepth=function(){xt.clear(xt.DEPTH_BUFFER_BIT)},this.clearStencil=function(){xt.clear(xt.STENCIL_BUFFER_BIT)},this.clearTarget=function(e,t,n,r){this.setRenderTarget(e),this.clear(t,n,r)},this.addPostPlugin=function(e){e.init(this),this.renderPluginsPost.push(e)},this.addPrePlugin=function(e){e.init(this),this.renderPluginsPre.push(e)},this.updateShadowMap=function(e,t){W=null,V=$=it=rt=Z=-1,Et=!0,Y=G=-1,this.shadowMapPlugin.update(e,t)};var Ut=function(e){e=e.target,e.removeEventListener("dispose",Ut),e.__webglInit=void 0;if(e instanceof THREE.BufferGeometry){var t=e.attributes,n;for(n in t)void 0!==t[n].buffer&&xt.deleteBuffer(t[n].buffer);R.info.memory.geometries--}else if(void 0!==e.geometryGroups)for(t in e.geometryGroups){n=e.geometryGroups[t];if(void 0!==n.numMorphTargets)for(var r=0,i=n.numMorphTargets;r<i;r++)xt.deleteBuffer(n.__webglMorphTargetsBuffers[r]);if(void 0!==n.numMorphNormals){r=0;for(i=n.numMorphNormals;r<i;r++)xt.deleteBuffer(n.__webglMorphNormalsBuffers[r])}Vt(n)}else Vt(e)},zt=function(e){e=e.target,e.removeEventListener("dispose",zt),e.image&&e.image.__webglTextureCube?xt.deleteTexture(e.image.__webglTextureCube):e.__webglInit&&(e.__webglInit=!1,xt.deleteTexture(e.__webglTexture)),R.info.memory.textures--},Wt=function(e){e=e.target,e.removeEventListener("dispose",Wt);if(e&&e.__webglTexture)if(xt.deleteTexture(e.__webglTexture),e instanceof THREE.WebGLRenderTargetCube)for(var t=0;6>t;t++)xt.deleteFramebuffer(e.__webglFramebuffer[t]),xt.deleteRenderbuffer(e.__webglRenderbuffer[t]);else xt.deleteFramebuffer(e.__webglFramebuffer),xt.deleteRenderbuffer(e.__webglRenderbuffer);R.info.memory.textures--},Xt=function(e){e=e.target,e.removeEventListener("dispose",Xt),$t(e)},Vt=function(e){void 0!==e.__webglVertexBuffer&&xt.deleteBuffer(e.__webglVertexBuffer),void 0!==e.__webglNormalBuffer&&xt.deleteBuffer(e.__webglNormalBuffer),void 0!==e.__webglTangentBuffer&&xt.deleteBuffer(e.__webglTangentBuffer),void 0!==e.__webglColorBuffer&&xt.deleteBuffer(e.__webglColorBuffer),void 0!==e.__webglUVBuffer&&xt.deleteBuffer(e.__webglUVBuffer),void 0!==e.__webglUV2Buffer&&xt.deleteBuffer(e.__webglUV2Buffer),void 0!==e.__webglSkinIndicesBuffer&&xt.deleteBuffer(e.__webglSkinIndicesBuffer),void 0!==e.__webglSkinWeightsBuffer&&xt.deleteBuffer(e.__webglSkinWeightsBuffer),void 0!==e.__webglFaceBuffer&&xt.deleteBuffer(e.__webglFaceBuffer),void 0!==e.__webglLineBuffer&&xt.deleteBuffer(e.__webglLineBuffer),void 0!==e.__webglLineDistanceBuffer&&xt.deleteBuffer(e.__webglLineDistanceBuffer);if(void 0!==e.__webglCustomAttributesList)for(var t in e.__webglCustomAttributesList)xt.deleteBuffer(e.__webglCustomAttributesList[t].buffer);R.info.memory.geometries--},$t=function(e){var t=e.program;if(void 0!==t){e.program=void 0;var n,r,i=!1,e=0;for(n=U.length;e<n;e++)if(r=U[e],r.program===t){r.usedTimes--,0===r.usedTimes&&(i=!0);break}if(!0===i){i=[],e=0;for(n=U.length;e<n;e++)r=U[e],r.program!==t&&i.push(r);U=i,xt.deleteProgram(t),R.info.memory.programs--}}};this.renderBufferImmediate=function(e,t,n){e.hasPositions&&!e.__webglVertexBuffer&&(e.__webglVertexBuffer=xt.createBuffer()),e.hasNormals&&!e.__webglNormalBuffer&&(e.__webglNormalBuffer=xt.createBuffer()),e.hasUvs&&!e.__webglUvBuffer&&(e.__webglUvBuffer=xt.createBuffer()),e.hasColors&&!e.__webglColorBuffer&&(e.__webglColorBuffer=xt.createBuffer()),e.hasPositions&&(xt.bindBuffer(xt.ARRAY_BUFFER,e.__webglVertexBuffer),xt.bufferData(xt.ARRAY_BUFFER,e.positionArray,xt.DYNAMIC_DRAW),xt.enableVertexAttribArray(t.attributes.position),xt.vertexAttribPointer(t.attributes.position,3,xt.FLOAT,!1,0,0));if(e.hasNormals){xt.bindBuffer(xt.ARRAY_BUFFER,e.__webglNormalBuffer);if(n.shading===THREE.FlatShading){var r,i,s,o,u,a,f,l,c,h,p,d=3*e.count;for(p=0;p<d;p+=9)h=e.normalArray,r=h[p],i=h[p+1],s=h[p+2],o=h[p+3],a=h[p+4],l=h[p+5],u=h[p+6],f=h[p+7],c=h[p+8],r=(r+o+u)/3,i=(i+a+f)/3,s=(s+l+c)/3,h[p]=r,h[p+1]=i,h[p+2]=s,h[p+3]=r,h[p+4]=i,h[p+5]=s,h[p+6]=r,h[p+7]=i,h[p+8]=s}xt.bufferData(xt.ARRAY_BUFFER,e.normalArray,xt.DYNAMIC_DRAW),xt.enableVertexAttribArray(t.attributes.normal),xt.vertexAttribPointer(t.attributes.normal,3,xt.FLOAT,!1,0,0)}e.hasUvs&&n.map&&(xt.bindBuffer(xt.ARRAY_BUFFER,e.__webglUvBuffer),xt.bufferData(xt.ARRAY_BUFFER,e.uvArray,xt.DYNAMIC_DRAW),xt.enableVertexAttribArray(t.attributes.uv),xt.vertexAttribPointer(t.attributes.uv,2,xt.FLOAT,!1,0,0)),e.hasColors&&n.vertexColors!==THREE.NoColors&&(xt.bindBuffer(xt.ARRAY_BUFFER,e.__webglColorBuffer),xt.bufferData(xt.ARRAY_BUFFER,e.colorArray,xt.DYNAMIC_DRAW),xt.enableVertexAttribArray(t.attributes.color),xt.vertexAttribPointer(t.attributes.color,3,xt.FLOAT,!1,0,0)),xt.drawArrays(xt.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,s){if(!1!==r.visible){var a,f,l,c;a=w(e,t,n,r,s),t=a.attributes,e=i.attributes,n=!1,a=16777215*i.id+2*a.id+(r.wireframe?1:0),a!==$&&($=a,n=!0),n&&u();if(s instanceof THREE.Mesh)if(s=e.index){i=i.offsets,1<i.length&&(n=!0);for(var h=0,p=i.length;h<p;h++){var d=i[h].index;if(n){for(f in t)l=t[f],a=e[f],0<=l&&(a?(c=a.itemSize,xt.bindBuffer(xt.ARRAY_BUFFER,a.buffer),o(l),xt.vertexAttribPointer(l,c,xt.FLOAT,!1,0,4*d*c)):r.defaultAttributeValues&&(2===r.defaultAttributeValues[f].length?xt.vertexAttrib2fv(l,r.defaultAttributeValues[f]):3===r.defaultAttributeValues[f].length&&xt.vertexAttrib3fv(l,r.defaultAttributeValues[f])));xt.bindBuffer(xt.ELEMENT_ARRAY_BUFFER,s.buffer)}xt.drawElements(xt.TRIANGLES,i[h].count,xt.UNSIGNED_SHORT,2*i[h].start),R.info.render.calls++,R.info.render.vertices+=i[h].count,R.info.render.faces+=i[h].count/3}}else{if(n)for(f in t)"index"!==f&&(l=t[f],a=e[f],0<=l&&(a?(c=a.itemSize,xt.bindBuffer(xt.ARRAY_BUFFER,a.buffer),o(l),xt.vertexAttribPointer(l,c,xt.FLOAT,!1,0,0)):r.defaultAttributeValues&&r.defaultAttributeValues[f]&&(2===r.defaultAttributeValues[f].length?xt.vertexAttrib2fv(l,r.defaultAttributeValues[f]):3===r.defaultAttributeValues[f].length&&xt.vertexAttrib3fv(l,r.defaultAttributeValues[f]))));r=i.attributes.position,xt.drawArrays(xt.TRIANGLES,0,r.numItems/3),R.info.render.calls++,R.info.render.vertices+=r.numItems/3,R.info.render.faces+=r.numItems/3/3}else if(s instanceof THREE.ParticleSystem){if(n)for(f in t)l=t[f],a=e[f],0<=l&&(a?(c=a.itemSize,xt.bindBuffer(xt.ARRAY_BUFFER,a.buffer),o(l),xt.vertexAttribPointer(l,c,xt.FLOAT,!1,0,0)):r.defaultAttributeValues&&r.defaultAttributeValues[f]&&(2===r.defaultAttributeValues[f].length?xt.vertexAttrib2fv(l,r.defaultAttributeValues[f]):3===r.defaultAttributeValues[f].length&&xt.vertexAttrib3fv(l,r.defaultAttributeValues[f])));r=e.position,xt.drawArrays(xt.POINTS,0,r.numItems/3),R.info.render.calls++,R.info.render.points+=r.numItems/3}else if(s instanceof THREE.Line){if(n)for(f in t)l=t[f],a=e[f],0<=l&&(a?(c=a.itemSize,xt.bindBuffer(xt.ARRAY_BUFFER,a.buffer),o(l),xt.vertexAttribPointer(l,c,xt.FLOAT,!1,0,0)):r.defaultAttributeValues&&r.defaultAttributeValues[f]&&(2===r.defaultAttributeValues[f].length?xt.vertexAttrib2fv(l,r.defaultAttributeValues[f]):3===r.defaultAttributeValues[f].length&&xt.vertexAttrib3fv(l,r.defaultAttributeValues[f])));f=s.type===THREE.LineStrip?xt.LINE_STRIP:xt.LINES,T(r.linewidth),r=e.position,xt.drawArrays(f,0,r.numItems/3),R.info.render.calls++,R.info.render.points+=r.numItems}}},this.renderBuffer=function(e,t,n,r,i,s){if(!1!==r.visible){var a,l,n=w(e,t,n,r,s),e=n.attributes,t=!1,n=16777215*i.id+2*n.id+(r.wireframe?1:0);n!==$&&($=n,t=!0),t&&u();if(!r.morphTargets&&0<=e.position)t&&(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglVertexBuffer),o(e.position),xt.vertexAttribPointer(e.position,3,xt.FLOAT,!1,0,0));else if(s.morphTargetBase){n=r.program.attributes,-1!==s.morphTargetBase&&0<=n.position?(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglMorphTargetsBuffers[s.morphTargetBase]),o(n.position),xt.vertexAttribPointer(n.position,3,xt.FLOAT,!1,0,0)):0<=n.position&&(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglVertexBuffer),o(n.position),xt.vertexAttribPointer(n.position,3,xt.FLOAT,!1,0,0));if(s.morphTargetForcedOrder.length){var c=0;l=s.morphTargetForcedOrder;for(a=s.morphTargetInfluences;c<r.numSupportedMorphTargets&&c<l.length;)0<=n["morphTarget"+c]&&(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglMorphTargetsBuffers[l[c]]),o(n["morphTarget"+c]),xt.vertexAttribPointer(n["morphTarget"+c],3,xt.FLOAT,!1,0,0)),0<=n["morphNormal"+c]&&r.morphNormals&&(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglMorphNormalsBuffers[l[c]]),o(n["morphNormal"+c]),xt.vertexAttribPointer(n["morphNormal"+c],3,xt.FLOAT,!1,0,0)),s.__webglMorphTargetInfluences[c]=a[l[c]],c++}else{l=[],a=s.morphTargetInfluences;var h,p=a.length;for(h=0;h<p;h++)c=a[h],0<c&&l.push([c,h]);l.length>r.numSupportedMorphTargets?(l.sort(f),l.length=r.numSupportedMorphTargets):l.length>r.numSupportedMorphNormals?l.sort(f):0===l.length&&l.push([0,0]);for(c=0;c<r.numSupportedMorphTargets;)l[c]?(h=l[c][1],0<=n["morphTarget"+c]&&(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglMorphTargetsBuffers[h]),o(n["morphTarget"+c]),xt.vertexAttribPointer(n["morphTarget"+c],3,xt.FLOAT,!1,0,0)),0<=n["morphNormal"+c]&&r.morphNormals&&(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglMorphNormalsBuffers[h]),o(n["morphNormal"+c]),xt.vertexAttribPointer(n["morphNormal"+c],3,xt.FLOAT,!1,0,0)),s.__webglMorphTargetInfluences[c]=a[h]):s.__webglMorphTargetInfluences[c]=0,c++}null!==r.program.uniforms.morphTargetInfluences&&xt.uniform1fv(r.program.uniforms.morphTargetInfluences,s.__webglMorphTargetInfluences)}if(t){if(i.__webglCustomAttributesList){a=0;for(l=i.__webglCustomAttributesList.length;a<l;a++)n=i.__webglCustomAttributesList[a],0<=e[n.buffer.belongsToAttribute]&&(xt.bindBuffer(xt.ARRAY_BUFFER,n.buffer),o(e[n.buffer.belongsToAttribute]),xt.vertexAttribPointer(e[n.buffer.belongsToAttribute],n.size,xt.FLOAT,!1,0,0))}0<=e.color&&(0<s.geometry.colors.length||0<s.geometry.faces.length?(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglColorBuffer),o(e.color),xt.vertexAttribPointer(e.color,3,xt.FLOAT,!1,0,0)):r.defaultAttributeValues&&xt.vertexAttrib3fv(e.color,r.defaultAttributeValues.color)),0<=e.normal&&(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglNormalBuffer),o(e.normal),xt.vertexAttribPointer(e.normal,3,xt.FLOAT,!1,0,0)),0<=e.tangent&&(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglTangentBuffer),o(e.tangent),xt.vertexAttribPointer(e.tangent,4,xt.FLOAT,!1,0,0)),0<=e.uv&&(s.geometry.faceVertexUvs[0]?(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglUVBuffer),o(e.uv),xt.vertexAttribPointer(e.uv,2,xt.FLOAT,!1,0,0)):r.defaultAttributeValues&&xt.vertexAttrib2fv(e.uv,r.defaultAttributeValues.uv)),0<=e.uv2&&(s.geometry.faceVertexUvs[1]?(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglUV2Buffer),o(e.uv2),xt.vertexAttribPointer(e.uv2,2,xt.FLOAT,!1,0,0)):r.defaultAttributeValues&&xt.vertexAttrib2fv(e.uv2,r.defaultAttributeValues.uv2)),r.skinning&&0<=e.skinIndex&&0<=e.skinWeight&&(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglSkinIndicesBuffer),o(e.skinIndex),xt.vertexAttribPointer(e.skinIndex,4,xt.FLOAT,!1,0,0),xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglSkinWeightsBuffer),o(e.skinWeight),xt.vertexAttribPointer(e.skinWeight,4,xt.FLOAT,!1,0,0)),0<=e.lineDistance&&(xt.bindBuffer(xt.ARRAY_BUFFER,i.__webglLineDistanceBuffer),o(e.lineDistance),xt.vertexAttribPointer(e.lineDistance,1,xt.FLOAT,!1,0,0))}s instanceof THREE.Mesh?(r.wireframe?(T(r.wireframeLinewidth),t&&xt.bindBuffer(xt.ELEMENT_ARRAY_BUFFER,i.__webglLineBuffer),xt.drawElements(xt.LINES,i.__webglLineCount,xt.UNSIGNED_SHORT,0)):(t&&xt.bindBuffer(xt.ELEMENT_ARRAY_BUFFER,i.__webglFaceBuffer),xt.drawElements(xt.TRIANGLES,i.__webglFaceCount,xt.UNSIGNED_SHORT,0)),R.info.render.calls++,R.info.render.vertices+=i.__webglFaceCount,R.info.render.faces+=i.__webglFaceCount/3):s instanceof THREE.Line?(s=s.type===THREE.LineStrip?xt.LINE_STRIP:xt.LINES,T(r.linewidth),xt.drawArrays(s,0,i.__webglLineCount),R.info.render.calls++):s instanceof THREE.ParticleSystem&&(xt.drawArrays(xt.POINTS,0,i.__webglParticleCount),R.info.render.calls++,R.info.render.points+=i.__webglParticleCount)}},this.render=function(e,t,n,r){if(0==t instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var i,s,o,u,f=e.__lights,p=e.fog;V=-1,Et=!0,!0===e.autoUpdate&&e.updateMatrixWorld(),void 0===t.parent&&t.updateMatrixWorld(),t.matrixWorldInverse.getInverse(t.matrixWorld),gt.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),mt.setFromMatrix(gt),this.autoUpdateObjects&&this.initWebGLObjects(e),l(this.renderPluginsPre,e,t),R.info.render.calls=0,R.info.render.vertices=0,R.info.render.faces=0,R.info.render.points=0,this.setRenderTarget(n),(this.autoClear||r)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),u=e.__webglObjects,r=0;for(i=u.length;r<i;r++)if(s=u[r],o=s.object,s.id=r,s.render=!1,o.visible&&(!(o instanceof THREE.Mesh||o instanceof THREE.ParticleSystem)||!o.frustumCulled||mt.intersectsObject(o))){var d=o;d._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,d.matrixWorld),d._normalMatrix.getNormalMatrix(d._modelViewMatrix);var d=s,v=d.buffer,m=void 0,g=m=void 0,g=d.object.material;if(g instanceof THREE.MeshFaceMaterial)m=v.materialIndex,m=g.materials[m],m.transparent?(d.transparent=m,d.opaque=null):(d.opaque=m,d.transparent=null);else if(m=g)m.transparent?(d.transparent=m,d.opaque=null):(d.opaque=m,d.transparent=null);s.render=!0,!0===this.sortObjects&&(null!==o.renderDepth?s.z=o.renderDepth:(bt.setFromMatrixPosition(o.matrixWorld),bt.applyProjection(gt),s.z=bt.z))}this.sortObjects&&u.sort(a),u=e.__webglObjectsImmediate,r=0;for(i=u.length;r<i;r++)s=u[r],o=s.object,o.visible&&(o._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,o.matrixWorld),o._normalMatrix.getNormalMatrix(o._modelViewMatrix),o=s.object.material,o.transparent?(s.transparent=o,s.opaque=null):(s.opaque=o,s.transparent=null));e.overrideMaterial?(r=e.overrideMaterial,this.setBlending(r.blending,r.blendEquation,r.blendSrc,r.blendDst),this.setDepthTest(r.depthTest),this.setDepthWrite(r.depthWrite),N(r.polygonOffset,r.polygonOffsetFactor,r.polygonOffsetUnits),c(e.__webglObjects,!1,"",t,f,p,!0,r),h(e.__webglObjectsImmediate,"",t,f,p,!1,r)):(r=null,this.setBlending(THREE.NoBlending),c(e.__webglObjects,!0,"opaque",t,f,p,!1,r),h(e.__webglObjectsImmediate,"opaque",t,f,p,!1,r),c(e.__webglObjects,!1,"transparent",t,f,p,!0,r),h(e.__webglObjectsImmediate,"transparent",t,f,p,!0,r)),l(this.renderPluginsPost,e,t),n&&n.generateMipmaps&&n.minFilter!==THREE.NearestFilter&&n.minFilter!==THREE.LinearFilter&&(n instanceof THREE.WebGLRenderTargetCube?(xt.bindTexture(xt.TEXTURE_CUBE_MAP,n.__webglTexture),xt.generateMipmap(xt.TEXTURE_CUBE_MAP),xt.bindTexture(xt.TEXTURE_CUBE_MAP,null)):(xt.bindTexture(xt.TEXTURE_2D,n.__webglTexture),xt.generateMipmap(xt.TEXTURE_2D),xt.bindTexture(xt.TEXTURE_2D,null))),this.setDepthTest(!0),this.setDepthWrite(!0)}},this.renderImmediateObject=function(e,t,n,r,i){var s=w(e,t,n,r,i);$=-1,R.setMaterialFaces(r),i.immediateRenderCallback?i.immediateRenderCallback(s,xt,mt):i.render(function(e){R.renderBufferImmediate(e,s,r)})},this.initWebGLObjects=function(e){e.__webglObjects||(e.__webglObjects=[],e.__webglObjectsImmediate=[],e.__webglSprites=[],e.__webglFlares=[]);for(;e.__objectsAdded.length;)p(e.__objectsAdded[0],e),e.__objectsAdded.splice(0,1);for(;e.__objectsRemoved.length;)g(e.__objectsRemoved[0],e),e.__objectsRemoved.splice(0,1);for(var t=0,o=e.__webglObjects.length;t<o;t++){var u=e.__webglObjects[t].object;void 0===u.__webglInit&&(void 0!==u.__webglActive&&g(u,e),p(u,e));var a=u,l=a.geometry,c=void 0,h=void 0,d=void 0;if(l instanceof THREE.BufferGeometry){var y=xt.DYNAMIC_DRAW,b=!l.dynamic,w=l.attributes,E=void 0,S=void 0;for(E in w)S=w[E],S.needsUpdate&&("index"===E?(xt.bindBuffer(xt.ELEMENT_ARRAY_BUFFER,S.buffer),xt.bufferData(xt.ELEMENT_ARRAY_BUFFER,S.array,y)):(xt.bindBuffer(xt.ARRAY_BUFFER,S.buffer),xt.bufferData(xt.ARRAY_BUFFER,S.array,y)),S.needsUpdate=!1),b&&!S.dynamic&&(S.array=null)}else if(a instanceof THREE.Mesh){for(var x=0,T=l.geometryGroupsList.length;x<T;x++)if(c=l.geometryGroupsList[x],d=r(a,c),l.buffersNeedUpdate&&n(c,a),h=d.attributes&&v(d),l.verticesNeedUpdate||l.morphTargetsNeedUpdate||l.elementsNeedUpdate||l.uvsNeedUpdate||l.normalsNeedUpdate||l.colorsNeedUpdate||l.tangentsNeedUpdate||h){var N=c,C=a,k=xt.DYNAMIC_DRAW,L=!l.dynamic,A=d;if(N.__inittedArrays){var O=i(A),M=A.vertexColors?A.vertexColors:!1,_=s(A),D=O===THREE.SmoothShading,P=void 0,H=void 0,B=void 0,j=void 0,F=void 0,I=void 0,q=void 0,R=void 0,U=void 0,z=void 0,W=void 0,X=void 0,V=void 0,$=void 0,J=void 0,K=void 0,Q=void 0,G=void 0,Y=void 0,Z=void 0,et=void 0,tt=void 0,nt=void 0,rt=void 0,it=void 0,st=void 0,ot=void 0,ut=void 0,at=void 0,ft=void 0,lt=void 0,ct=void 0,ht=void 0,pt=void 0,dt=void 0,vt=void 0,mt=void 0,wt=void 0,Et=void 0,St=void 0,Tt=0,Nt=0,Ct=0,kt=0,Lt=0,At=0,Ot=0,Mt=0,_t=0,Dt=0,Pt=0,Ht=0,Bt=void 0,jt=N.__vertexArray,Ft=N.__uvArray,It=N.__uv2Array,qt=N.__normalArray,Rt=N.__tangentArray,Ut=N.__colorArray,zt=N.__skinIndexArray,Wt=N.__skinWeightArray,Xt=N.__morphTargetsArrays,Vt=N.__morphNormalsArrays,$t=N.__webglCustomAttributesList,Jt=void 0,Kt=N.__faceArray,Qt=N.__lineArray,Gt=C.geometry,Yt=Gt.elementsNeedUpdate,Zt=Gt.uvsNeedUpdate,en=Gt.normalsNeedUpdate,tn=Gt.tangentsNeedUpdate,nn=Gt.colorsNeedUpdate,rn=Gt.morphTargetsNeedUpdate,sn=Gt.vertices,on=N.faces3,un=Gt.faces,an=Gt.faceVertexUvs[0],fn=Gt.faceVertexUvs[1],ln=Gt.skinIndices,cn=Gt.skinWeights,hn=Gt.morphTargets,pn=Gt.morphNormals;if(Gt.verticesNeedUpdate){P=0;for(H=on.length;P<H;P++)j=un[on[P]],X=sn[j.a],V=sn[j.b],$=sn[j.c],jt[Nt]=X.x,jt[Nt+1]=X.y,jt[Nt+2]=X.z,jt[Nt+3]=V.x,jt[Nt+4]=V.y,jt[Nt+5]=V.z,jt[Nt+6]=$.x,jt[Nt+7]=$.y,jt[Nt+8]=$.z,Nt+=9;xt.bindBuffer(xt.ARRAY_BUFFER,N.__webglVertexBuffer),xt.bufferData(xt.ARRAY_BUFFER,jt,k)}if(rn){dt=0;for(vt=hn.length;dt<vt;dt++){P=Pt=0;for(H=on.length;P<H;P++)Et=on[P],j=un[Et],X=hn[dt].vertices[j.a],V=hn[dt].vertices[j.b],$=hn[dt].vertices[j.c],mt=Xt[dt],mt[Pt]=X.x,mt[Pt+1]=X.y,mt[Pt+2]=X.z,mt[Pt+3]=V.x,mt[Pt+4]=V.y,mt[Pt+5]=V.z,mt[Pt+6]=$.x,mt[Pt+7]=$.y,mt[Pt+8]=$.z,A.morphNormals&&(D?(St=pn[dt].vertexNormals[Et],G=St.a,Y=St.b,Z=St.c):Z=Y=G=pn[dt].faceNormals[Et],wt=Vt[dt],wt[Pt]=G.x,wt[Pt+1]=G.y,wt[Pt+2]=G.z,wt[Pt+3]=Y.x,wt[Pt+4]=Y.y,wt[Pt+5]=Y.z,wt[Pt+6]=Z.x,wt[Pt+7]=Z.y,wt[Pt+8]=Z.z),Pt+=9;xt.bindBuffer(xt.ARRAY_BUFFER,N.__webglMorphTargetsBuffers[dt]),xt.bufferData(xt.ARRAY_BUFFER,Xt[dt],k),A.morphNormals&&(xt.bindBuffer(xt.ARRAY_BUFFER,N.__webglMorphNormalsBuffers[dt]),xt.bufferData(xt.ARRAY_BUFFER,Vt[dt],k))}}if(cn.length){P=0;for(H=on.length;P<H;P++)j=un[on[P]],rt=cn[j.a],it=cn[j.b],st=cn[j.c],Wt[Dt]=rt.x,Wt[Dt+1]=rt.y,Wt[Dt+2]=rt.z,Wt[Dt+3]=rt.w,Wt[Dt+4]=it.x,Wt[Dt+5]=it.y,Wt[Dt+6]=it.z,Wt[Dt+7]=it.w,Wt[Dt+8]=st.x,Wt[Dt+9]=st.y,Wt[Dt+10]=st.z,Wt[Dt+11]=st.w,ot=ln[j.a],ut=ln[j.b],at=ln[j.c],zt[Dt]=ot.x,zt[Dt+1]=ot.y,zt[Dt+2]=ot.z,zt[Dt+3]=ot.w,zt[Dt+4]=ut.x,zt[Dt+5]=ut.y,zt[Dt+6]=ut.z,zt[Dt+7]=ut.w,zt[Dt+8]=at.x,zt[Dt+9]=at.y,zt[Dt+10]=at.z,zt[Dt+11]=at.w,Dt+=12;0<Dt&&(xt.bindBuffer(xt.ARRAY_BUFFER,N.__webglSkinIndicesBuffer),xt.bufferData(xt.ARRAY_BUFFER,zt,k),xt.bindBuffer(xt.ARRAY_BUFFER,N.__webglSkinWeightsBuffer),xt.bufferData(xt.ARRAY_BUFFER,Wt,k))}if(nn&&M){P=0;for(H=on.length;P<H;P++)j=un[on[P]],q=j.vertexColors,R=j.color,3===q.length&&M===THREE.VertexColors?(et=q[0],tt=q[1],nt=q[2]):nt=tt=et=R,Ut[_t]=et.r,Ut[_t+1]=et.g,Ut[_t+2]=et.b,Ut[_t+3]=tt.r,Ut[_t+4]=tt.g,Ut[_t+5]=tt.b,Ut[_t+6]=nt.r,Ut[_t+7]=nt.g,Ut[_t+8]=nt.b,_t+=9;0<_t&&(xt.bindBuffer(xt.ARRAY_BUFFER,N.__webglColorBuffer),xt.bufferData(xt.ARRAY_BUFFER,Ut,k))}if(tn&&Gt.hasTangents){P=0;for(H=on.length;P<H;P++)j=un[on[P]],U=j.vertexTangents,J=U[0],K=U[1],Q=U[2],Rt[Ot]=J.x,Rt[Ot+1]=J.y,Rt[Ot+2]=J.z,Rt[Ot+3]=J.w,Rt[Ot+4]=K.x,Rt[Ot+5]=K.y,Rt[Ot+6]=K.z,Rt[Ot+7]=K.w,Rt[Ot+8]=Q.x,Rt[Ot+9]=Q.y,Rt[Ot+10]=Q.z,Rt[Ot+11]=Q.w,Ot+=12;xt.bindBuffer(xt.ARRAY_BUFFER,N.__webglTangentBuffer),xt.bufferData(xt.ARRAY_BUFFER,Rt,k)}if(en&&O){P=0;for(H=on.length;P<H;P++)if(j=un[on[P]],F=j.vertexNormals,I=j.normal,3===F.length&&D)for(ft=0;3>ft;ft++)ct=F[ft],qt[At]=ct.x,qt[At+1]=ct.y,qt[At+2]=ct.z,At+=3;else for(ft=0;3>ft;ft++)qt[At]=I.x,qt[At+1]=I.y,qt[At+2]=I.z,At+=3;xt.bindBuffer(xt.ARRAY_BUFFER,N.__webglNormalBuffer),xt.bufferData(xt.ARRAY_BUFFER,qt,k)}if(Zt&&an&&_){P=0;for(H=on.length;P<H;P++)if(B=on[P],z=an[B],void 0!==z)for(ft=0;3>ft;ft++)ht=z[ft],Ft[Ct]=ht.x,Ft[Ct+1]=ht.y,Ct+=2;0<Ct&&(xt.bindBuffer(xt.ARRAY_BUFFER,N.__webglUVBuffer),xt.bufferData(xt.ARRAY_BUFFER,Ft,k))}if(Zt&&fn&&_){P=0;for(H=on.length;P<H;P++)if(B=on[P],W=fn[B],void 0!==W)for(ft=0;3>ft;ft++)pt=W[ft],It[kt]=pt.x,It[kt+1]=pt.y,kt+=2;0<kt&&(xt.bindBuffer(xt.ARRAY_BUFFER,N.__webglUV2Buffer),xt.bufferData(xt.ARRAY_BUFFER,It,k))}if(Yt){P=0;for(H=on.length;P<H;P++)Kt[Lt]=Tt,Kt[Lt+1]=Tt+1,Kt[Lt+2]=Tt+2,Lt+=3,Qt[Mt]=Tt,Qt[Mt+1]=Tt+1,Qt[Mt+2]=Tt,Qt[Mt+3]=Tt+2,Qt[Mt+4]=Tt+1,Qt[Mt+5]=Tt+2,Mt+=6,Tt+=3;xt.bindBuffer(xt.ELEMENT_ARRAY_BUFFER,N.__webglFaceBuffer),xt.bufferData(xt.ELEMENT_ARRAY_BUFFER,Kt,k),xt.bindBuffer(xt.ELEMENT_ARRAY_BUFFER,N.__webglLineBuffer),xt.bufferData(xt.ELEMENT_ARRAY_BUFFER,Qt,k)}if($t){ft=0;for(lt=$t.length;ft<lt;ft++)if(Jt=$t[ft],Jt.__original.needsUpdate){Ht=0;if(1===Jt.size){if(void 0===Jt.boundTo||"vertices"===Jt.boundTo){P=0;for(H=on.length;P<H;P++)j=un[on[P]],Jt.array[Ht]=Jt.value[j.a],Jt.array[Ht+1]=Jt.value[j.b],Jt.array[Ht+2]=Jt.value[j.c],Ht+=3}else if("faces"===Jt.boundTo){P=0;for(H=on.length;P<H;P++)Bt=Jt.value[on[P]],Jt.array[Ht]=Bt,Jt.array[Ht+1]=Bt,Jt.array[Ht+2]=Bt,Ht+=3}}else if(2===Jt.size){if(void 0===Jt.boundTo||"vertices"===Jt.boundTo){P=0;for(H=on.length;P<H;P++)j=un[on[P]],X=Jt.value[j.a],V=Jt.value[j.b],$=Jt.value[j.c],Jt.array[Ht]=X.x,Jt.array[Ht+1]=X.y,Jt.array[Ht+2]=V.x,Jt.array[Ht+3]=V.y,Jt.array[Ht+4]=$.x,Jt.array[Ht+5]=$.y,Ht+=6}else if("faces"===Jt.boundTo){P=0;for(H=on.length;P<H;P++)$=V=X=Bt=Jt.value[on[P]],Jt.array[Ht]=X.x,Jt.array[Ht+1]=X.y,Jt.array[Ht+2]=V.x,Jt.array[Ht+3]=V.y,Jt.array[Ht+4]=$.x,Jt.array[Ht+5]=$.y,Ht+=6}}else if(3===Jt.size){var dn;dn="c"===Jt.type?["r","g","b"]:["x","y","z"];if(void 0===Jt.boundTo||"vertices"===Jt.boundTo){P=0;for(H=on.length;P<H;P++)j=un[on[P]],X=Jt.value[j.a],V=Jt.value[j.b],$=Jt.value[j.c],Jt.array[Ht]=X[dn[0]],Jt.array[Ht+1]=X[dn[1]],Jt.array[Ht+2]=X[dn[2]],Jt.array[Ht+3]=V[dn[0]],Jt.array[Ht+4]=V[dn[1]],Jt.array[Ht+5]=V[dn[2]],Jt.array[Ht+6]=$[dn[0]],Jt.array[Ht+7]=$[dn[1]],Jt.array[Ht+8]=$[dn[2]],Ht+=9}else if("faces"===Jt.boundTo){P=0;for(H=on.length;P<H;P++)$=V=X=Bt=Jt.value[on[P]],Jt.array[Ht]=X[dn[0]],Jt.array[Ht+1]=X[dn[1]],Jt.array[Ht+2]=X[dn[2]],Jt.array[Ht+3]=V[dn[0]],Jt.array[Ht+4]=V[dn[1]],Jt.array[Ht+5]=V[dn[2]],Jt.array[Ht+6]=$[dn[0]],Jt.array[Ht+7]=$[dn[1]],Jt.array[Ht+8]=$[dn[2]],Ht+=9}else if("faceVertices"===Jt.boundTo){P=0;for(H=on.length;P<H;P++)Bt=Jt.value[on[P]],X=Bt[0],V=Bt[1],$=Bt[2],Jt.array[Ht]=X[dn[0]],Jt.array[Ht+1]=X[dn[1]],Jt.array[Ht+2]=X[dn[2]],Jt.array[Ht+3]=V[dn[0]],Jt.array[Ht+4]=V[dn[1]],Jt.array[Ht+5]=V[dn[2]],Jt.array[Ht+6]=$[dn[0]],Jt.array[Ht+7]=$[dn[1]],Jt.array[Ht+8]=$[dn[2]],Ht+=9}}else if(4===Jt.size)if(void 0===Jt.boundTo||"vertices"===Jt.boundTo){P=0;for(H=on.length;P<H;P++)j=un[on[P]],X=Jt.value[j.a],V=Jt.value[j.b],$=Jt.value[j.c],Jt.array[Ht]=X.x,Jt.array[Ht+1]=X.y,Jt.array[Ht+2]=X.z,Jt.array[Ht+3]=X.w,Jt.array[Ht+4]=V.x,Jt.array[Ht+5]=V.y,Jt.array[Ht+6]=V.z,Jt.array[Ht+7]=V.w,Jt.array[Ht+8]=$.x,Jt.array[Ht+9]=$.y,Jt.array[Ht+10]=$.z,Jt.array[Ht+11]=$.w,Ht+=12}else if("faces"===Jt.boundTo){P=0;for(H=on.length;P<H;P++)$=V=X=Bt=Jt.value[on[P]],Jt.array[Ht]=X.x,Jt.array[Ht+1]=X.y,Jt.array[Ht+2]=X.z,Jt.array[Ht+3]=X.w,Jt.array[Ht+4]=V.x,Jt.array[Ht+5]=V.y,Jt.array[Ht+6]=V.z,Jt.array[Ht+7]=V.w,Jt.array[Ht+8]=$.x,Jt.array[Ht+9]=$.y,Jt.array[Ht+10]=$.z,Jt.array[Ht+11]=$.w,Ht+=12}else if("faceVertices"===Jt.boundTo){P=0;for(H=on.length;P<H;P++)Bt=Jt.value[on[P]],X=Bt[0],V=Bt[1],$=Bt[2],Jt.array[Ht]=X.x,Jt.array[Ht+1]=X.y,Jt.array[Ht+2]=X.z,Jt.array[Ht+3]=X.w,Jt.array[Ht+4]=V.x,Jt.array[Ht+5]=V.y,Jt.array[Ht+6]=V.z,Jt.array[Ht+7]=V.w,Jt.array[Ht+8]=$.x,Jt.array[Ht+9]=$.y,Jt.array[Ht+10]=$.z,Jt.array[Ht+11]=$.w,Ht+=12}xt.bindBuffer(xt.ARRAY_BUFFER,Jt.buffer),xt.bufferData(xt.ARRAY_BUFFER,Jt.array,k)}}L&&(delete N.__inittedArrays,delete N.__colorArray,delete N.__normalArray,delete N.__tangentArray,delete N.__uvArray,delete N.__uv2Array,delete N.__faceArray,delete N.__vertexArray,delete N.__lineArray,delete N.__skinIndexArray,delete N.__skinWeightArray)}}l.verticesNeedUpdate=!1,l.morphTargetsNeedUpdate=!1,l.elementsNeedUpdate=!1,l.uvsNeedUpdate=!1,l.normalsNeedUpdate=!1,l.colorsNeedUpdate=!1,l.tangentsNeedUpdate=!1,l.buffersNeedUpdate=!1,d.attributes&&m(d)}else if(a instanceof THREE.Line){d=r(a,l),h=d.attributes&&v(d);if(l.verticesNeedUpdate||l.colorsNeedUpdate||l.lineDistancesNeedUpdate||h){var vn=l,mn=xt.DYNAMIC_DRAW,gn=void 0,yn=void 0,bn=void 0,wn=void 0,En=void 0,Sn=void 0,xn=vn.vertices,Tn=vn.colors,Nn=vn.lineDistances,Cn=xn.length,kn=Tn.length,Ln=Nn.length,An=vn.__vertexArray,On=vn.__colorArray,Mn=vn.__lineDistanceArray,_n=vn.colorsNeedUpdate,Dn=vn.lineDistancesNeedUpdate,Pn=vn.__webglCustomAttributesList,Hn=void 0,Bn=void 0,jn=void 0,Fn=void 0,In=void 0,qn=void 0;if(vn.verticesNeedUpdate){for(gn=0;gn<Cn;gn++)wn=xn[gn],En=3*gn,An[En]=wn.x,An[En+1]=wn.y,An[En+2]=wn.z;xt.bindBuffer(xt.ARRAY_BUFFER,vn.__webglVertexBuffer),xt.bufferData(xt.ARRAY_BUFFER,An,mn)}if(_n){for(yn=0;yn<kn;yn++)Sn=Tn[yn],En=3*yn,On[En]=Sn.r,On[En+1]=Sn.g,On[En+2]=Sn.b;xt.bindBuffer(xt.ARRAY_BUFFER,vn.__webglColorBuffer),xt.bufferData(xt.ARRAY_BUFFER,On,mn)}if(Dn){for(bn=0;bn<Ln;bn++)Mn[bn]=Nn[bn];xt.bindBuffer(xt.ARRAY_BUFFER,vn.__webglLineDistanceBuffer),xt.bufferData(xt.ARRAY_BUFFER,Mn,mn)}if(Pn){Hn=0;for(Bn=Pn.length;Hn<Bn;Hn++)if(qn=Pn[Hn],qn.needsUpdate&&(void 0===qn.boundTo||"vertices"===qn.boundTo)){En=0,Fn=qn.value.length;if(1===qn.size)for(jn=0;jn<Fn;jn++)qn.array[jn]=qn.value[jn];else if(2===qn.size)for(jn=0;jn<Fn;jn++)In=qn.value[jn],qn.array[En]=In.x,qn.array[En+1]=In.y,En+=2;else if(3===qn.size)if("c"===qn.type)for(jn=0;jn<Fn;jn++)In=qn.value[jn],qn.array[En]=In.r,qn.array[En+1]=In.g,qn.array[En+2]=In.b,En+=3;else for(jn=0;jn<Fn;jn++)In=qn.value[jn],qn.array[En]=In.x,qn.array[En+1]=In.y,qn.array[En+2]=In.z,En+=3;else if(4===qn.size)for(jn=0;jn<Fn;jn++)In=qn.value[jn],qn.array[En]=In.x,qn.array[En+1]=In.y,qn.array[En+2]=In.z,qn.array[En+3]=In.w,En+=4;xt.bindBuffer(xt.ARRAY_BUFFER,qn.buffer),xt.bufferData(xt.ARRAY_BUFFER,qn.array,mn)}}}l.verticesNeedUpdate=!1,l.colorsNeedUpdate=!1,l.lineDistancesNeedUpdate=!1,d.attributes&&m(d)}else if(a instanceof THREE.ParticleSystem){d=r(a,l),h=d.attributes&&v(d);if(l.verticesNeedUpdate||l.colorsNeedUpdate||a.sortParticles||h){var Rn=l,Un=xt.DYNAMIC_DRAW,zn=a,Wn=void 0,Xn=void 0,Vn=void 0,$n=void 0,Jn=void 0,Kn=void 0,Qn=Rn.vertices,Gn=Qn.length,Yn=Rn.colors,Zn=Yn.length,er=Rn.__vertexArray,tr=Rn.__colorArray,nr=Rn.__sortArray,rr=Rn.verticesNeedUpdate,ir=Rn.colorsNeedUpdate,sr=Rn.__webglCustomAttributesList,or=void 0,ur=void 0,ar=void 0,fr=void 0,lr=void 0,cr=void 0;if(zn.sortParticles){yt.copy(gt),yt.multiply(zn.matrixWorld);for(Wn=0;Wn<Gn;Wn++)Vn=Qn[Wn],bt.copy(Vn),bt.applyProjection(yt),nr[Wn]=[bt.z,Wn];nr.sort(f);for(Wn=0;Wn<Gn;Wn++)Vn=Qn[nr[Wn][1]],$n=3*Wn,er[$n]=Vn.x,er[$n+1]=Vn.y,er[$n+2]=Vn.z;for(Xn=0;Xn<Zn;Xn++)$n=3*Xn,Kn=Yn[nr[Xn][1]],tr[$n]=Kn.r,tr[$n+1]=Kn.g,tr[$n+2]=Kn.b;if(sr){or=0;for(ur=sr.length;or<ur;or++)if(cr=sr[or],void 0===cr.boundTo||"vertices"===cr.boundTo)if($n=0,fr=cr.value.length,1===cr.size)for(ar=0;ar<fr;ar++)Jn=nr[ar][1],cr.array[ar]=cr.value[Jn];else if(2===cr.size)for(ar=0;ar<fr;ar++)Jn=nr[ar][1],lr=cr.value[Jn],cr.array[$n]=lr.x,cr.array[$n+1]=lr.y,$n+=2;else if(3===cr.size)if("c"===cr.type)for(ar=0;ar<fr;ar++)Jn=nr[ar][1],lr=cr.value[Jn],cr.array[$n]=lr.r,cr.array[$n+1]=lr.g,cr.array[$n+2]=lr.b,$n+=3;else for(ar=0;ar<fr;ar++)Jn=nr[ar][1],lr=cr.value[Jn],cr.array[$n]=lr.x,cr.array[$n+1]=lr.y,cr.array[$n+2]=lr.z,$n+=3;else if(4===cr.size)for(ar=0;ar<fr;ar++)Jn=nr[ar][1],lr=cr.value[Jn],cr.array[$n]=lr.x,cr.array[$n+1]=lr.y,cr.array[$n+2]=lr.z,cr.array[$n+3]=lr.w,$n+=4}}else{if(rr)for(Wn=0;Wn<Gn;Wn++)Vn=Qn[Wn],$n=3*Wn,er[$n]=Vn.x,er[$n+1]=Vn.y,er[$n+2]=Vn.z;if(ir)for(Xn=0;Xn<Zn;Xn++)Kn=Yn[Xn],$n=3*Xn,tr[$n]=Kn.r,tr[$n+1]=Kn.g,tr[$n+2]=Kn.b;if(sr){or=0;for(ur=sr.length;or<ur;or++)if(cr=sr[or],cr.needsUpdate&&(void 0===cr.boundTo||"vertices"===cr.boundTo))if(fr=cr.value.length,$n=0,1===cr.size)for(ar=0;ar<fr;ar++)cr.array[ar]=cr.value[ar];else if(2===cr.size)for(ar=0;ar<fr;ar++)lr=cr.value[ar],cr.array[$n]=lr.x,cr.array[$n+1]=lr.y,$n+=2;else if(3===cr.size)if("c"===cr.type)for(ar=0;ar<fr;ar++)lr=cr.value[ar],cr.array[$n]=lr.r,cr.array[$n+1]=lr.g,cr.array[$n+2]=lr.b,$n+=3;else for(ar=0;ar<fr;ar++)lr=cr.value[ar],cr.array[$n]=lr.x,cr.array[$n+1]=lr.y,cr.array[$n+2]=lr.z,$n+=3;else if(4===cr.size)for(ar=0;ar<fr;ar++)lr=cr.value[ar],cr.array[$n]=lr.x,cr.array[$n+1]=lr.y,cr.array[$n+2]=lr.z,cr.array[$n+3]=lr.w,$n+=4}}if(rr||zn.sortParticles)xt.bindBuffer(xt.ARRAY_BUFFER,Rn.__webglVertexBuffer),xt.bufferData(xt.ARRAY_BUFFER,er,Un);if(ir||zn.sortParticles)xt.bindBuffer(xt.ARRAY_BUFFER,Rn.__webglColorBuffer),xt.bufferData(xt.ARRAY_BUFFER,tr,Un);if(sr){or=0;for(ur=sr.length;or<ur;or++)if(cr=sr[or],cr.needsUpdate||zn.sortParticles)xt.bindBuffer(xt.ARRAY_BUFFER,cr.buffer),xt.bufferData(xt.ARRAY_BUFFER,cr.array,Un)}}l.verticesNeedUpdate=!1,l.colorsNeedUpdate=!1,d.attributes&&m(d)}}},this.initMaterial=function(e,t,n,r){var i,s,o,u;e.addEventListener("dispose",Xt);var a,f,l,c,h;e instanceof THREE.MeshDepthMaterial?h="depth":e instanceof THREE.MeshNormalMaterial?h="normal":e instanceof THREE.MeshBasicMaterial?h="basic":e instanceof THREE.MeshLambertMaterial?h="lambert":e instanceof THREE.MeshPhongMaterial?h="phong":e instanceof THREE.LineBasicMaterial?h="basic":e instanceof THREE.LineDashedMaterial?h="dashed":e instanceof THREE.ParticleSystemMaterial&&(h="particle_basic");if(h){var p=THREE.ShaderLib[h];e.uniforms=THREE.UniformsUtils.clone(p.uniforms),e.vertexShader=p.vertexShader,e.fragmentShader=p.fragmentShader}var d=i=0,v=0,m=p=0;for(s=t.length;m<s;m++)o=t[m],o.onlyShadow||(o instanceof THREE.DirectionalLight&&i++,o instanceof THREE.PointLight&&d++,o instanceof THREE.SpotLight&&v++,o instanceof THREE.HemisphereLight&&p++);s=d,o=v,u=p,v=p=0;for(d=t.length;v<d;v++)m=t[v],m.castShadow&&(m instanceof THREE.SpotLight&&p++,m instanceof THREE.DirectionalLight&&!m.shadowCascade&&p++);c=p,Ht&&r&&r.useVertexTexture?l=1024:(t=xt.getParameter(xt.MAX_VERTEX_UNIFORM_VECTORS),t=Math.floor((t-20)/4),void 0!==r&&r instanceof THREE.SkinnedMesh&&(t=Math.min(r.bones.length,t),t<r.bones.length&&console.warn("WebGLRenderer: too many bones - "+r.bones.length+", this GPU supports just "+t+" (try OpenGL instead of ANGLE)")),l=t);e:{var v=e.fragmentShader,d=e.vertexShader,p=e.uniforms,t=e.attributes,m=e.defines,n={map:!!e.map,envMap:!!e.envMap,lightMap:!!e.lightMap,bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,specularMap:!!e.specularMap,vertexColors:e.vertexColors,fog:n,useFog:e.fog,fogExp:n instanceof THREE.FogExp2,sizeAttenuation:e.sizeAttenuation,skinning:e.skinning,maxBones:l,useVertexTexture:Ht&&r&&r.useVertexTexture,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:i,maxPointLights:s,maxSpotLights:o,maxHemiLights:u,maxShadows:c,shadowMapEnabled:this.shadowMapEnabled&&r.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:e.alphaTest,metal:e.metal,perPixel:e.perPixel,wrapAround:e.wrapAround,doubleSided:e.side===THREE.DoubleSide,flipSided:e.side===THREE.BackSide},r=e.index0AttributeName,g,y,b;i=[],h?i.push(h):(i.push(v),i.push(d));for(y in m)i.push(y),i.push(m[y]);for(g in n)i.push(g),i.push(n[g]);h=i.join(),g=0;for(y=U.length;g<y;g++)if(i=U[g],i.code===h){i.usedTimes++,f=i.program;break e}g="SHADOWMAP_TYPE_BASIC",n.shadowMapType===THREE.PCFShadowMap?g="SHADOWMAP_TYPE_PCF":n.shadowMapType===THREE.PCFSoftShadowMap&&(g="SHADOWMAP_TYPE_PCF_SOFT"),y=[];for(b in m)i=m[b],!1!==i&&(i="#define "+b+" "+i,y.push(i));i=y.join("\n"),b=xt.createProgram(),y=["precision "+D+" float;","precision "+D+" int;",i,Pt?"#define VERTEX_TEXTURES":"",R.gammaInput?"#define GAMMA_INPUT":"",R.gammaOutput?"#define GAMMA_OUTPUT":"","#define MAX_DIR_LIGHTS "+n.maxDirLights,"#define MAX_POINT_LIGHTS "+n.maxPointLights,"#define MAX_SPOT_LIGHTS "+n.maxSpotLights,"#define MAX_HEMI_LIGHTS "+n.maxHemiLights,"#define MAX_SHADOWS "+n.maxShadows,"#define MAX_BONES "+n.maxBones,n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.lightMap?"#define USE_LIGHTMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.vertexColors?"#define USE_COLOR":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals?"#define USE_MORPHNORMALS":"",n.perPixel?"#define PHONG_PER_PIXEL":"",n.wrapAround?"#define WRAP_AROUND":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+g:"",n.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",n.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n"),g=["precision "+D+" float;","precision "+D+" int;",n.bumpMap||n.normalMap?"#extension GL_OES_standard_derivatives : enable":"",i,"#define MAX_DIR_LIGHTS "+n.maxDirLights,"#define MAX_POINT_LIGHTS "+n.maxPointLights,"#define MAX_SPOT_LIGHTS "+n.maxSpotLights,"#define MAX_HEMI_LIGHTS "+n.maxHemiLights,"#define MAX_SHADOWS "+n.maxShadows,n.alphaTest?"#define ALPHATEST "+n.alphaTest:"",R.gammaInput?"#define GAMMA_INPUT":"",R.gammaOutput?"#define GAMMA_OUTPUT":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.lightMap?"#define USE_LIGHTMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.vertexColors?"#define USE_COLOR":"",n.metal?"#define METAL":"",n.perPixel?"#define PHONG_PER_PIXEL":"",n.wrapAround?"#define WRAP_AROUND":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+g:"",n.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",n.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n"),y=k("vertex",y+d),g=k("fragment",g+v),xt.attachShader(b,y),xt.attachShader(b,g),r&&xt.bindAttribLocation(b,0,r),xt.linkProgram(b),xt.getProgramParameter(b,xt.LINK_STATUS)||(console.error("Could not initialise shader\nVALIDATE_STATUS: "+xt.getProgramParameter(b,xt.VALIDATE_STATUS)+", gl error ["+xt.getError()+"]"),console.error("Program Info Log: "+xt.getProgramInfoLog(b))),xt.deleteShader(g),xt.deleteShader(y),b.uniforms={},b.attributes={};var w;g="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences".split(" "),n.useVertexTexture?(g.push("boneTexture"),g.push("boneTextureWidth"),g.push("boneTextureHeight")):g.push("boneGlobalMatrices");for(w in p)g.push(w);w=g,g=0;for(y=w.length;g<y;g++)p=w[g],b.uniforms[p]=xt.getUniformLocation(b,p);g="position normal uv uv2 tangent color skinIndex skinWeight lineDistance".split(" ");for(w=0;w<n.maxMorphTargets;w++)g.push("morphTarget"+w);for(w=0;w<n.maxMorphNormals;w++)g.push("morphNormal"+w);for(f in t)g.push(f);f=g,w=0;for(t=f.length;w<t;w++)g=f[w],b.attributes[g]=xt.getAttribLocation(b,g);b.id=z++,U.push({program:b,code:h,usedTimes:1}),R.info.memory.programs=U.length,f=b}e.program=f,w=e.program.attributes;if(e.morphTargets){e.numSupportedMorphTargets=0,t="morphTarget";for(f=0;f<this.maxMorphTargets;f++)b=t+f,0<=w[b]&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0,t="morphNormal";for(f=0;f<this.maxMorphNormals;f++)b=t+f,0<=w[b]&&e.numSupportedMorphNormals++}e.uniformsList=[];for(a in e.uniforms)e.uniformsList.push([e.uniforms[a],a])},this.setFaceCulling=function(e,t){e===THREE.CullFaceNone?xt.disable(xt.CULL_FACE):(t===THREE.FrontFaceDirectionCW?xt.frontFace(xt.CW):xt.frontFace(xt.CCW),e===THREE.CullFaceBack?xt.cullFace(xt.BACK):e===THREE.CullFaceFront?xt.cullFace(xt.FRONT):xt.cullFace(xt.FRONT_AND_BACK),xt.enable(xt.CULL_FACE))},this.setMaterialFaces=function(e){var t=e.side===THREE.DoubleSide,e=e.side===THREE.BackSide;G!==t&&(t?xt.disable(xt.CULL_FACE):xt.enable(xt.CULL_FACE),G=t),Y!==e&&(e?xt.frontFace(xt.CW):xt.frontFace(xt.CCW),Y=e)},this.setDepthTest=function(e){rt!==e&&(e?xt.enable(xt.DEPTH_TEST):xt.disable(xt.DEPTH_TEST),rt=e)},this.setDepthWrite=function(e){it!==e&&(xt.depthMask(e),it=e)},this.setBlending=function(e,t,n,r){e!==Z&&(e===THREE.NoBlending?xt.disable(xt.BLEND):e===THREE.AdditiveBlending?(xt.enable(xt.BLEND),xt.blendEquation(xt.FUNC_ADD),xt.blendFunc(xt.SRC_ALPHA,xt.ONE)):e===THREE.SubtractiveBlending?(xt.enable(xt.BLEND),xt.blendEquation(xt.FUNC_ADD),xt.blendFunc(xt.ZERO,xt.ONE_MINUS_SRC_COLOR)):e===THREE.MultiplyBlending?(xt.enable(xt.BLEND),xt.blendEquation(xt.FUNC_ADD),xt.blendFunc(xt.ZERO,xt.SRC_COLOR)):e===THREE.CustomBlending?xt.enable(xt.BLEND):(xt.enable(xt.BLEND),xt.blendEquationSeparate(xt.FUNC_ADD,xt.FUNC_ADD),xt.blendFuncSeparate(xt.SRC_ALPHA,xt.ONE_MINUS_SRC_ALPHA,xt.ONE,xt.ONE_MINUS_SRC_ALPHA)),Z=e);if(e===THREE.CustomBlending){if(t!==et&&(xt.blendEquation(M(t)),et=t),n!==tt||r!==nt)xt.blendFunc(M(n),M(r)),tt=n,nt=r}else nt=tt=et=null},this.setTexture=function(e,t){if(e.needsUpdate){e.__webglInit||(e.__webglInit=!0,e.addEventListener("dispose",zt),e.__webglTexture=xt.createTexture(),R.info.memory.textures++),xt.activeTexture(xt.TEXTURE0+t),xt.bindTexture(xt.TEXTURE_2D,e.__webglTexture),xt.pixelStorei(xt.UNPACK_FLIP_Y_WEBGL,e.flipY),xt.pixelStorei(xt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),xt.pixelStorei(xt.UNPACK_ALIGNMENT,e.unpackAlignment);var n=e.image,r=0===(n.width&n.width-1)&&0===(n.height&n.height-1),i=M(e.format),s=M(e.type);L(xt.TEXTURE_2D,e,r);var o=e.mipmaps;if(e instanceof THREE.DataTexture)if(0<o.length&&r){for(var u=0,a=o.length;u<a;u++)n=o[u],xt.texImage2D(xt.TEXTURE_2D,u,i,n.width,n.height,0,i,s,n.data);e.generateMipmaps=!1}else xt.texImage2D(xt.TEXTURE_2D,0,i,n.width,n.height,0,i,s,n.data);else if(e instanceof THREE.CompressedTexture){u=0;for(a=o.length;u<a;u++)n=o[u],e.format!==THREE.RGBAFormat?xt.compressedTexImage2D(xt.TEXTURE_2D,u,i,n.width,n.height,0,n.data):xt.texImage2D(xt.TEXTURE_2D,u,i,n.width,n.height,0,i,s,n.data)}else if(0<o.length&&r){u=0;for(a=o.length;u<a;u++)n=o[u],xt.texImage2D(xt.TEXTURE_2D,u,i,i,s,n);e.generateMipmaps=!1}else xt.texImage2D(xt.TEXTURE_2D,0,i,i,s,e.image);e.generateMipmaps&&r&&xt.generateMipmap(xt.TEXTURE_2D),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()}else xt.activeTexture(xt.TEXTURE0+t),xt.bindTexture(xt.TEXTURE_2D,e.__webglTexture)},this.setRenderTarget=function(e){var t=e instanceof THREE.WebGLRenderTargetCube;if(e&&!e.__webglFramebuffer){void 0===e.depthBuffer&&(e.depthBuffer=!0),void 0===e.stencilBuffer&&(e.stencilBuffer=!0),e.addEventListener("dispose",Wt),e.__webglTexture=xt.createTexture(),R.info.memory.textures++;var n=0===(e.width&e.width-1)&&0===(e.height&e.height-1),r=M(e.format),i=M(e.type);if(t){e.__webglFramebuffer=[],e.__webglRenderbuffer=[],xt.bindTexture(xt.TEXTURE_CUBE_MAP,e.__webglTexture),L(xt.TEXTURE_CUBE_MAP,e,n);for(var s=0;6>s;s++){e.__webglFramebuffer[s]=xt.createFramebuffer(),e.__webglRenderbuffer[s]=xt.createRenderbuffer(),xt.texImage2D(xt.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,r,e.width,e.height,0,r,i,null);var o=e,u=xt.TEXTURE_CUBE_MAP_POSITIVE_X+s;xt.bindFramebuffer(xt.FRAMEBUFFER,e.__webglFramebuffer[s]),xt.framebufferTexture2D(xt.FRAMEBUFFER,xt.COLOR_ATTACHMENT0,u,o.__webglTexture,0),A(e.__webglRenderbuffer[s],e)}n&&xt.generateMipmap(xt.TEXTURE_CUBE_MAP)}else e.__webglFramebuffer=xt.createFramebuffer(),e.__webglRenderbuffer=e.shareDepthFrom?e.shareDepthFrom.__webglRenderbuffer:xt.createRenderbuffer(),xt.bindTexture(xt.TEXTURE_2D,e.__webglTexture),L(xt.TEXTURE_2D,e,n),xt.texImage2D(xt.TEXTURE_2D,0,r,e.width,e.height,0,r,i,null),r=xt.TEXTURE_2D,xt.bindFramebuffer(xt.FRAMEBUFFER,e.__webglFramebuffer),xt.framebufferTexture2D(xt.FRAMEBUFFER,xt.COLOR_ATTACHMENT0,r,e.__webglTexture,0),e.shareDepthFrom?e.depthBuffer&&!e.stencilBuffer?xt.framebufferRenderbuffer(xt.FRAMEBUFFER,xt.DEPTH_ATTACHMENT,xt.RENDERBUFFER,e.__webglRenderbuffer):e.depthBuffer&&e.stencilBuffer&&xt.framebufferRenderbuffer(xt.FRAMEBUFFER,xt.DEPTH_STENCIL_ATTACHMENT,xt.RENDERBUFFER,e.__webglRenderbuffer):A(e.__webglRenderbuffer,e),n&&xt.generateMipmap(xt.TEXTURE_2D);t?xt.bindTexture(xt.TEXTURE_CUBE_MAP,null):xt.bindTexture(xt.TEXTURE_2D,null),xt.bindRenderbuffer(xt.RENDERBUFFER,null),xt.bindFramebuffer(xt.FRAMEBUFFER,null)}e?(t=t?e.__webglFramebuffer[e.activeCubeFace]:e.__webglFramebuffer,n=e.width,e=e.height,i=r=0):(t=null,n=ct,e=ht,r=ft,i=lt),t!==X&&(xt.bindFramebuffer(xt.FRAMEBUFFER,t),xt.viewport(r,i,n,e),X=t),pt=n,dt=e},this.shadowMapPlugin=new THREE.ShadowMapPlugin,this.addPrePlugin(this.shadowMapPlugin),this.addPostPlugin(new THREE.SpritePlugin),this.addPostPlugin(new THREE.LensFlarePlugin)},THREE.WebGLRenderTarget=function(e,t,n){this.width=e,this.height=t,n=n||{},this.wrapS=void 0!==n.wrapS?n.wrapS:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==n.wrapT?n.wrapT:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==n.magFilter?n.magFilter:THREE.LinearFilter,this.minFilter=void 0!==n.minFilter?n.minFilter:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.format=void 0!==n.format?n.format:THREE.RGBAFormat,this.type=void 0!==n.type?n.type:THREE.UnsignedByteType,this.depthBuffer=void 0!==n.depthBuffer?n.depthBuffer:!0,this.stencilBuffer=void 0!==n.stencilBuffer?n.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=null},THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,clone:function(){var e=new THREE.WebGLRenderTarget(this.width,this.height);return e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.format=this.format,e.type=this.type,e.depthBuffer=this.depthBuffer,e.stencilBuffer=this.stencilBuffer,e.generateMipmaps=this.generateMipmaps,e.shareDepthFrom=this.shareDepthFrom,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube=function(e,t,n){THREE.WebGLRenderTarget.call(this,e,t,n),this.activeCubeFace=0},THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype),THREE.RenderableVertex=function(){this.position=new THREE.Vector3,this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)},THREE.RenderableFace3=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.centroidModel=new THREE.Vector3,this.normalModel=new THREE.Vector3,this.normalModelView=new THREE.Vector3,this.vertexNormalsLength=0,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.material=this.color=null,this.uvs=[[]],this.z=0},THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0},THREE.RenderableSprite=function(){this.id=0,this.object=null,this.rotation=this.z=this.y=this.x=0,this.scale=new THREE.Vector2,this.material=null},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null,this.z=0},THREE.GeometryUtils={merge:function(e,t,n){var r,i,s=e.vertices.length,o=t instanceof THREE.Mesh?t.geometry:t,u=e.vertices,a=o.vertices,f=e.faces,l=o.faces,e=e.faceVertexUvs[0],o=o.faceVertexUvs[0];void 0===n&&(n=0),t instanceof THREE.Mesh&&(t.matrixAutoUpdate&&t.updateMatrix(),r=t.matrix,i=(new THREE.Matrix3).getNormalMatrix(r));for(var t=0,c=a.length;t<c;t++){var h=a[t].clone();r&&h.applyMatrix4(r),u.push(h)}t=0;for(c=l.length;t<c;t++){var h=l[t],p,d,v=h.vertexNormals,m=h.vertexColors;p=new THREE.Face3(h.a+s,h.b+s,h.c+s),p.normal.copy(h.normal),i&&p.normal.applyMatrix3(i).normalize(),u=0;for(a=v.length;u<a;u++)d=v[u].clone(),i&&d.applyMatrix3(i).normalize(),p.vertexNormals.push(d);p.color.copy(h.color),u=0;for(a=m.length;u<a;u++)d=m[u],p.vertexColors.push(d.clone());p.materialIndex=h.materialIndex+n,p.centroid.copy(h.centroid),r&&p.centroid.applyMatrix4(r),f.push(p)}t=0;for(c=o.length;t<c;t++){n=o[t],r=[],u=0;for(a=n.length;u<a;u++)r.push(new THREE.Vector2(n[u].x,n[u].y));e.push(r)}},randomPointInTriangle:function(){var e=new THREE.Vector3;return function(t,n,r){var i=new THREE.Vector3,s=THREE.Math.random16(),o=THREE.Math.random16();1<s+o&&(s=1-s,o=1-o);var u=1-s-o;return i.copy(t),i.multiplyScalar(s),e.copy(n),e.multiplyScalar(o),i.add(e),e.copy(r),e.multiplyScalar(u),i.add(e),i}}(),randomPointInFace:function(e,t){return THREE.GeometryUtils.randomPointInTriangle(t.vertices[e.a],t.vertices[e.b],t.vertices[e.c])},randomPointsInGeometry:function(e,t){function n(e){function t(n,r){if(r<n)return n;var i=n+Math.floor((r-n)/2);return f[i]>e?t(n,i-1):f[i]<e?t(i+1,r):i}return t(0,f.length-1)}var r,i,s=e.faces,o=e.vertices,u=s.length,a=0,f=[],l,c,h;for(i=0;i<u;i++)r=s[i],l=o[r.a],c=o[r.b],h=o[r.c],r._area=THREE.GeometryUtils.triangleArea(l,c,h),a+=r._area,f[i]=a;r=[];for(i=0;i<t;i++)o=THREE.Math.random16()*a,o=n(o),r[i]=THREE.GeometryUtils.randomPointInFace(s[o],e,!0);return r},triangleArea:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(n,r,i){return e.subVectors(r,n),t.subVectors(i,n),e.cross(t),.5*e.length()}}(),center:function(e){e.computeBoundingBox();var t=e.boundingBox,n=new THREE.Vector3;return n.addVectors(t.min,t.max),n.multiplyScalar(-0.5),e.applyMatrix((new THREE.Matrix4).makeTranslation(n.x,n.y,n.z)),e.computeBoundingBox(),n},triangulateQuads:function(e){var t,n,r,i,s=[],o=[];t=0;for(n=e.faceVertexUvs.length;t<n;t++)o[t]=[];t=0;for(n=e.faces.length;t<n;t++){s.push(e.faces[t]),r=0;for(i=e.faceVertexUvs.length;r<i;r++)o[r].push(e.faceVertexUvs[r][t])}e.faces=s,e.faceVertexUvs=o,e.computeCentroids(),e.computeFaceNormals(),e.computeVertexNormals(),e.hasTangents&&e.computeTangents()}},THREE.ImageUtils={crossOrigin:void 0,loadTexture:function(e,t,n){var r=new THREE.ImageLoader;r.crossOrigin=this.crossOrigin;var i=new THREE.Texture(void 0,t),t=r.load(e,function(){i.needsUpdate=!0,n&&n(i)});return i.image=t,i.sourceFile=e,i},loadCompressedTexture:function(e,t,n,r){var i=new THREE.CompressedTexture;i.mapping=t;var s=new XMLHttpRequest;return s.onload=function(){var e=THREE.ImageUtils.parseDDS(s.response,!0);i.format=e.format,i.mipmaps=e.mipmaps,i.image.width=e.width,i.image.height=e.height,i.generateMipmaps=!1,i.needsUpdate=!0,n&&n(i)},s.onerror=r,s.open("GET",e,!0),s.responseType="arraybuffer",s.send(null),i},loadTextureCube:function(e,t,n,r){var i=[];i.loadCount=0;var s=new THREE.Texture;s.image=i,void 0!==t&&(s.mapping=t),s.flipY=!1;for(var t=0,o=e.length;t<o;++t){var u=new Image;i[t]=u,u.onload=function(){i.loadCount+=1,6===i.loadCount&&(s.needsUpdate=!0,n&&n(s))},u.onerror=r,u.crossOrigin=this.crossOrigin,u.src=e[t]}return s},loadCompressedTextureCube:function(e,t,n,r){var i=[];i.loadCount=0;var s=new THREE.CompressedTexture;s.image=i,void 0!==t&&(s.mapping=t),s.flipY=!1,s.generateMipmaps=!1,t=function(e,t){return function(){var r=THREE.ImageUtils.parseDDS(e.response,!0);t.format=r.format,t.mipmaps=r.mipmaps,t.width=r.width,t.height=r.height,i.loadCount+=1,6===i.loadCount&&(s.format=r.format,s.needsUpdate=!0,n&&n(s))}};if(e instanceof Array)for(var o=0,u=e.length;o<u;++o){var a={};i[o]=a;var f=new XMLHttpRequest;f.onload=t(f,a),f.onerror=r,a=e[o],f.open("GET",a,!0),f.responseType="arraybuffer",f.send(null)}else f=new XMLHttpRequest,f.onload=function(){var e=THREE.ImageUtils.parseDDS(f.response,!0);if(e.isCubemap){for(var t=e.mipmaps.length/e.mipmapCount,r=0;r<t;r++){i[r]={mipmaps:[]};for(var o=0;o<e.mipmapCount;o++)i[r].mipmaps.push(e.mipmaps[r*e.mipmapCount+o]),i[r].format=e.format,i[r].width=e.width,i[r].height=e.height}s.format=e.format,s.needsUpdate=!0,n&&n(s)}},f.onerror=r,f.open("GET",e,!0),f.responseType="arraybuffer",f.send(null);return s},loadDDSTexture:function(e,t,n,r){var i=[];i.loadCount=0;var s=new THREE.CompressedTexture;s.image=i,void 0!==t&&(s.mapping=t),s.flipY=!1,s.generateMipmaps=!1;var o=new XMLHttpRequest;return o.onload=function(){var e=THREE.ImageUtils.parseDDS(o.response,!0);if(e.isCubemap)for(var t=e.mipmaps.length/e.mipmapCount,r=0;r<t;r++){i[r]={mipmaps:[]};for(var u=0;u<e.mipmapCount;u++)i[r].mipmaps.push(e.mipmaps[r*e.mipmapCount+u]),i[r].format=e.format,i[r].width=e.width,i[r].height=e.height}else s.image.width=e.width,s.image.height=e.height,s.mipmaps=e.mipmaps;s.format=e.format,s.needsUpdate=!0,n&&n(s)},o.onerror=r,o.open("GET",e,!0),o.responseType="arraybuffer",o.send(null),s},parseDDS:function(e,t){function n(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var r={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},i=n("DXT1"),s=n("DXT3"),o=n("DXT5"),u=new Int32Array(e,0,31);if(542327876!==u[0])return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),r;if(!u[20]&4)return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),r;var a=u[21],f=!1;switch(a){case i:i=8,r.format=THREE.RGB_S3TC_DXT1_Format;break;case s:i=16,r.format=THREE.RGBA_S3TC_DXT3_Format;break;case o:i=16,r.format=THREE.RGBA_S3TC_DXT5_Format;break;default:if(!(32==u[22]&&u[23]&16711680&&u[24]&65280&&u[25]&255&&u[26]&4278190080))return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)),r;f=!0,i=64,r.format=THREE.RGBAFormat}r.mipmapCount=1,u[2]&131072&&!1!==t&&(r.mipmapCount=Math.max(1,u[7])),r.isCubemap=u[28]&512?!0:!1,r.width=u[4],r.height=u[3];for(var u=u[1]+4,s=r.width,o=r.height,a=r.isCubemap?6:1,l=0;l<a;l++){for(var c=0;c<r.mipmapCount;c++){if(f){var h;h=s;for(var p=o,d=4*h*p,v=new Uint8Array(e,u,d),d=new Uint8Array(d),m=0,g=0,y=0;y<p;y++)for(var b=0;b<h;b++){var w=v[g];g++;var E=v[g];g++;var S=v[g];g++;var x=v[g];g++,d[m]=S,m++,d[m]=E,m++,d[m]=w,m++,d[m]=x,m++}h=d,p=h.length}else p=Math.max(4,s)/4*Math.max(4,o)/4*i,h=new Uint8Array(e,u,p);r.mipmaps.push({data:h,width:s,height:o}),u+=p,s=Math.max(.5*s,1),o=Math.max(.5*o,1)}s=r.width,o=r.height}return r},getNormalMap:function(e,t){var n=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]},t=t|1,r=e.width,i=e.height,s=document.createElement("canvas");s.width=r,s.height=i;var o=s.getContext("2d");o.drawImage(e,0,0);for(var u=o.getImageData(0,0,r,i).data,a=o.createImageData(r,i),f=a.data,l=0;l<r;l++)for(var c=0;c<i;c++){var h=0>c-1?0:c-1,p=c+1>i-1?i-1:c+1,d=0>l-1?0:l-1,v=l+1>r-1?r-1:l+1,m=[],g=[0,0,u[4*(c*r+l)]/255*t];m.push([-1,0,u[4*(c*r+d)]/255*t]),m.push([-1,-1,u[4*(h*r+d)]/255*t]),m.push([0,-1,u[4*(h*r+l)]/255*t]),m.push([1,-1,u[4*(h*r+v)]/255*t]),m.push([1,0,u[4*(c*r+v)]/255*t]),m.push([1,1,u[4*(p*r+v)]/255*t]),m.push([0,1,u[4*(p*r+l)]/255*t]),m.push([-1,1,u[4*(p*r+d)]/255*t]),h=[],d=m.length;for(p=0;p<d;p++){var v=m[p],y=m[(p+1)%d],v=[v[0]-g[0],v[1]-g[1],v[2]-g[2]],y=[y[0]-g[0],y[1]-g[1],y[2]-g[2]];h.push(n([v[1]*y[2]-v[2]*y[1],v[2]*y[0]-v[0]*y[2],v[0]*y[1]-v[1]*y[0]]))}m=[0,0,0];for(p=0;p<h.length;p++)m[0]+=h[p][0],m[1]+=h[p][1],m[2]+=h[p][2];m[0]/=h.length,m[1]/=h.length,m[2]/=h.length,g=4*(c*r+l),f[g]=255*((m[0]+1)/2)|0,f[g+1]=255*((m[1]+1)/2)|0,f[g+2]=255*m[2]|0,f[g+3]=255}return o.putImageData(a,0,0),s},generateDataTexture:function(e,t,n){for(var r=e*t,i=new Uint8Array(3*r),s=Math.floor(255*n.r),o=Math.floor(255*n.g),n=Math.floor(255*n.b),u=0;u<r;u++)i[3*u]=s,i[3*u+1]=o,i[3*u+2]=n;return e=new THREE.DataTexture(i,e,t,THREE.RGBFormat),e.needsUpdate=!0,e}},THREE.SceneUtils={createMultiMaterialObject:function(e,t){for(var n=new THREE.Object3D,r=0,i=t.length;r<i;r++)n.add(new THREE.Mesh(e,t[r]));return n},detach:function(e,t,n){e.applyMatrix(t.matrixWorld),t.remove(e),n.add(e)},attach:function(e,t,n){var r=new THREE.Matrix4;r.getInverse(n.matrixWorld),e.applyMatrix(r),t.remove(e),n.add(e)}},THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(e){var t=e.familyName.toLowerCase();return this.faces[t]=this.faces[t]||{},this.faces[t][e.cssFontWeight]=this.faces[t][e.cssFontWeight]||{},this.faces[t][e.cssFontWeight][e.cssFontStyle]=e,this.faces[t][e.cssFontWeight][e.cssFontStyle]=e},drawText:function(e){for(var t=this.getFace(),n=this.size/t.resolution,r=0,i=String(e).split(""),s=i.length,o=[],e=0;e<s;e++){var u=new THREE.Path,u=this.extractGlyphPoints(i[e],t,n,r,u),r=r+u.offset;o.push(u.path)}return{paths:o,offset:r/2}},extractGlyphPoints:function(e,t,n,r,i){var s=[],o,u,a,f,l,c,h,p,d,v,m,g=t.glyphs[e]||t.glyphs["?"];if(g){if(g.o){t=g._cachedOutline||(g._cachedOutline=g.o.split(" ")),f=t.length;for(e=0;e<f;)switch(a=t[e++],a){case"m":a=t[e++]*n+r,l=t[e++]*n,i.moveTo(a,l);break;case"l":a=t[e++]*n+r,l=t[e++]*n,i.lineTo(a,l);break;case"q":a=t[e++]*n+r,l=t[e++]*n,p=t[e++]*n+r,d=t[e++]*n,i.quadraticCurveTo(p,d,a,l);if(o=s[s.length-1]){c=o.x,h=o.y,o=1;for(u=this.divisions;o<=u;o++){var y=o/u;THREE.Shape.Utils.b2(y,c,p,a),THREE.Shape.Utils.b2(y,h,d,l)}}break;case"b":if(a=t[e++]*n+r,l=t[e++]*n,p=t[e++]*n+r,d=t[e++]*-n,v=t[e++]*n+r,m=t[e++]*-n,i.bezierCurveTo(a,l,p,d,v,m),o=s[s.length-1]){c=o.x,h=o.y,o=1;for(u=this.divisions;o<=u;o++)y=o/u,THREE.Shape.Utils.b3(y,c,p,v,a),THREE.Shape.Utils.b3(y,h,d,m,l)}}}return{offset:g.ha*n,path:i}}}},THREE.FontUtils.generateShapes=function(e,t){var t=t||{},n=void 0!==t.curveSegments?t.curveSegments:4,r=void 0!==t.font?t.font:"helvetiker",i=void 0!==t.weight?t.weight:"normal",s=void 0!==t.style?t.style:"normal";THREE.FontUtils.size=void 0!==t.size?t.size:100,THREE.FontUtils.divisions=n,THREE.FontUtils.face=r,THREE.FontUtils.weight=i,THREE.FontUtils.style=s,n=THREE.FontUtils.drawText(e).paths,r=[],i=0;for(s=n.length;i<s;i++)Array.prototype.push.apply(r,n[i].toShapes());return r},function(e){var t=function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n};return e.Triangulate=function(e,n){var r=e.length;if(3>r)return null;var i=[],s=[],o=[],u,a,f;if(0<t(e))for(a=0;a<r;a++)s[a]=a;else for(a=0;a<r;a++)s[a]=r-1-a;var l=2*r;for(a=r-1;2<r;){if(0>=l--){console.log("Warning, unable to triangulate polygon!");break}u=a,r<=u&&(u=0),a=u+1,r<=a&&(a=0),f=a+1,r<=f&&(f=0);var c;e:{var h=c=void 0,p=void 0,d=void 0,v=void 0,m=void 0,g=void 0,y=void 0,w=void 0,h=e[s[u]].x,p=e[s[u]].y,d=e[s[a]].x,v=e[s[a]].y,m=e[s[f]].x,g=e[s[f]].y;if(1e-10>(d-h)*(g-p)-(v-p)*(m-h))c=!1;else{var E=void 0,S=void 0,x=void 0,T=void 0,N=void 0,C=void 0,k=void 0,L=void 0,A=void 0,O=void 0,A=L=k=w=y=void 0,E=m-d,S=g-v,x=h-m,T=p-g,N=d-h,C=v-p;for(c=0;c<r;c++)if(c!==u&&c!==a&&c!==f)if(y=e[s[c]].x,w=e[s[c]].y,k=y-h,L=w-p,A=y-d,O=w-v,y-=m,w-=g,A=E*O-S*A,k=N*L-C*k,L=x*w-T*y,-1e-10<=A&&-1e-10<=L&&-1e-10<=k){c=!1;break e}c=!0}}if(c){i.push([e[s[u]],e[s[a]],e[s[f]]]),o.push([s[u],s[a],s[f]]),u=a;for(f=a+1;f<r;u++,f++)s[u]=s[f];r--,l=2*r}}return n?o:i},e.Triangulate.area=t,e}(THREE.FontUtils),self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace},THREE.typeface_js=self._typeface_js,THREE.Curve=function(){},THREE.Curve.prototype.getPoint=function(){return console.log("Warning, getPoint() not implemented!"),null},THREE.Curve.prototype.getPointAt=function(e){return e=this.getUtoTmapping(e),this.getPoint(e)},THREE.Curve.prototype.getPoints=function(e){e||(e=5);var t,n=[];for(t=0;t<=e;t++)n.push(this.getPoint(t/e));return n},THREE.Curve.prototype.getSpacedPoints=function(e){e||(e=5);var t,n=[];for(t=0;t<=e;t++)n.push(this.getPointAt(t/e));return n},THREE.Curve.prototype.getLength=function(){var e=this.getLengths();return e[e.length-1]},THREE.Curve.prototype.getLengths=function(e){e||(e=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length==e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t=[],n,r=this.getPoint(0),i,s=0;t.push(0);for(i=1;i<=e;i++)n=this.getPoint(i/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t},THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},THREE.Curve.prototype.getUtoTmapping=function(e,t){var n=this.getLengths(),r=0,i=n.length,s;s=t?t:e*n[i-1];for(var o=0,u=i-1,a;o<=u;)if(r=Math.floor(o+(u-o)/2),a=n[r]-s,0>a)o=r+1;else{if(!(0<a)){u=r;break}u=r-1}return r=u,n[r]==s?r/(i-1):(o=n[r],n=(r+(s-o)/(n[r+1]-o))/(i-1))},THREE.Curve.prototype.getTangent=function(e){var t=e-1e-4,e=e+1e-4;return 0>t&&(t=0),1<e&&(e=1),t=this.getPoint(t),this.getPoint(e).clone().sub(t).normalize()},THREE.Curve.prototype.getTangentAt=function(e){return e=this.getUtoTmapping(e),this.getTangent(e)},THREE.Curve.Utils={tangentQuadraticBezier:function(e,t,n,r){return 2*(1-e)*(n-t)+2*e*(r-n)},tangentCubicBezier:function(e,t,n,r,i){return-3*t*(1-e)*(1-e)+3*n*(1-e)*(1-e)-6*e*n*(1-e)+6*e*r*(1-e)-3*e*e*r+3*e*e*i},tangentSpline:function(e){return 6*e*e-6*e+(3*e*e-4*e+1)+(-6*e*e+6*e)+(3*e*e-2*e)},interpolate:function(e,t,n,r,i){var e=.5*(n-e),r=.5*(r-t),s=i*i;return(2*t-2*n+e+r)*i*s+(-3*t+3*n-2*e-r)*s+e*i+t}},THREE.Curve.create=function(e,t){return e.prototype=Object.create(THREE.Curve.prototype),e.prototype.getPoint=t,e},THREE.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype),THREE.CurvePath.prototype.add=function(e){this.curves.push(e)},THREE.CurvePath.prototype.checkConnection=function(){},THREE.CurvePath.prototype.closePath=function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new THREE.LineCurve(t,e))},THREE.CurvePath.prototype.getPoint=function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),e=0;e<n.length;){if(n[e]>=t)return t=n[e]-t,e=this.curves[e],t=1-t/e.getLength(),e.getPointAt(t);e++}return null},THREE.CurvePath.prototype.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]},THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var e=[],t=0,n,r=this.curves.length;for(n=0;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e},THREE.CurvePath.prototype.getBoundingBox=function(){var e=this.getPoints(),t,n,r,i,s,o;t=n=Number.NEGATIVE_INFINITY,i=s=Number.POSITIVE_INFINITY;var u,a,f,l,c=e[0]instanceof THREE.Vector3;l=c?new THREE.Vector3:new THREE.Vector2,a=0;for(f=e.length;a<f;a++)u=e[a],u.x>t?t=u.x:u.x<i&&(i=u.x),u.y>n?n=u.y:u.y<s&&(s=u.y),c&&(u.z>r?r=u.z:u.z<o&&(o=u.z)),l.add(u);return e={minX:i,minY:s,maxX:t,maxY:n,centroid:l.divideScalar(f)},c&&(e.maxZ=r,e.minZ=o),e},THREE.CurvePath.prototype.createPointsGeometry=function(e){return e=this.getPoints(e,!0),this.createGeometry(e)},THREE.CurvePath.prototype.createSpacedPointsGeometry=function(e){return e=this.getSpacedPoints(e,!0),this.createGeometry(e)},THREE.CurvePath.prototype.createGeometry=function(e){for(var t=new THREE.Geometry,n=0;n<e.length;n++)t.vertices.push(new THREE.Vector3(e[n].x,e[n].y,e[n].z||0));return t},THREE.CurvePath.prototype.addWrapPath=function(e){this.bends.push(e)},THREE.CurvePath.prototype.getTransformedPoints=function(e,t){var n=this.getPoints(e),r,i;t||(t=this.bends),r=0;for(i=t.length;r<i;r++)n=this.getWrapPoints(n,t[r]);return n},THREE.CurvePath.prototype.getTransformedSpacedPoints=function(e,t){var n=this.getSpacedPoints(e),r,i;t||(t=this.bends),r=0;for(i=t.length;r<i;r++)n=this.getWrapPoints(n,t[r]);return n},THREE.CurvePath.prototype.getWrapPoints=function(e,t){var n=this.getBoundingBox(),r,i,s,o,u,a;r=0;for(i=e.length;r<i;r++)s=e[r],o=s.x,u=s.y,a=o/n.maxX,a=t.getUtoTmapping(a,o),o=t.getPoint(a),a=t.getTangent(a),a.set(-a.y,a.x).multiplyScalar(u),s.x=o.x+a.x,s.y=o.y+a.y;return e},THREE.Gyroscope=function(){THREE.Object3D.call(this)},THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype),THREE.Gyroscope.prototype.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||e)this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.quaternionWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.quaternionObject,this.scaleObject),this.matrixWorld.compose(this.translationWorld,this.quaternionObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0;for(var t=0,n=this.children.length;t<n;t++)this.children[t].updateMatrixWorld(e)},THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3,THREE.Gyroscope.prototype.translationObject=new THREE.Vector3,THREE.Gyroscope.prototype.quaternionWorld=new THREE.Quaternion,THREE.Gyroscope.prototype.quaternionObject=new THREE.Quaternion,THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3,THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3,THREE.Path=function(e){THREE.CurvePath.call(this),this.actions=[],e&&this.fromPoints(e)},THREE.Path.prototype=Object.create(THREE.CurvePath.prototype),THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},THREE.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},THREE.Path.prototype.moveTo=function(e,t){var n=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:n})},THREE.Path.prototype.lineTo=function(e,t){var n=Array.prototype.slice.call(arguments),r=this.actions[this.actions.length-1].args,r=new THREE.LineCurve(new THREE.Vector2(r[r.length-2],r[r.length-1]),new THREE.Vector2(e,t));this.curves.push(r),this.actions.push({action:THREE.PathActions.LINE_TO,args:n})},THREE.Path.prototype.quadraticCurveTo=function(e,t,n,r){var i=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,s=new THREE.QuadraticBezierCurve(new THREE.Vector2(s[s.length-2],s[s.length-1]),new THREE.Vector2(e,t),new THREE.Vector2(n,r));this.curves.push(s),this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:i})},THREE.Path.prototype.bezierCurveTo=function(e,t,n,r,i,s){var o=Array.prototype.slice.call(arguments),u=this.actions[this.actions.length-1].args,u=new THREE.CubicBezierCurve(new THREE.Vector2(u[u.length-2],u[u.length-1]),new THREE.Vector2(e,t),new THREE.Vector2(n,r),new THREE.Vector2(i,s));this.curves.push(u),this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:o})},THREE.Path.prototype.splineThru=function(e){var t=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,n=[new THREE.Vector2(n[n.length-2],n[n.length-1])];Array.prototype.push.apply(n,e),n=new THREE.SplineCurve(n),this.curves.push(n),this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:t})},THREE.Path.prototype.arc=function(e,t,n,r,i,s){var o=this.actions[this.actions.length-1].args;this.absarc(e+o[o.length-2],t+o[o.length-1],n,r,i,s)},THREE.Path.prototype.absarc=function(e,t,n,r,i,s){this.absellipse(e,t,n,n,r,i,s)},THREE.Path.prototype.ellipse=function(e,t,n,r,i,s,o){var u=this.actions[this.actions.length-1].args;this.absellipse(e+u[u.length-2],t+u[u.length-1],n,r,i,s,o)},THREE.Path.prototype.absellipse=function(e,t,n,r,i,s,o){var u=Array.prototype.slice.call(arguments),a=new THREE.EllipseCurve(e,t,n,r,i,s,o);this.curves.push(a),a=a.getPoint(1),u.push(a.x),u.push(a.y),this.actions.push({action:THREE.PathActions.ELLIPSE,args:u})},THREE.Path.prototype.getSpacedPoints=function(e){e||(e=40);for(var t=[],n=0;n<e;n++)t.push(this.getPoint(n/e));return t},THREE.Path.prototype.getPoints=function(e,t){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(e,t);var e=e||12,n=[],r,i,s,o,u,a,f,l,c,h,p,d,v;r=0;for(i=this.actions.length;r<i;r++)switch(s=this.actions[r],o=s.action,s=s.args,o){case THREE.PathActions.MOVE_TO:n.push(new THREE.Vector2(s[0],s[1]));break;case THREE.PathActions.LINE_TO:n.push(new THREE.Vector2(s[0],s[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:u=s[2],a=s[3],c=s[0],h=s[1],0<n.length?(o=n[n.length-1],p=o.x,d=o.y):(o=this.actions[r-1].args,p=o[o.length-2],d=o[o.length-1]);for(s=1;s<=e;s++)v=s/e,o=THREE.Shape.Utils.b2(v,p,c,u),v=THREE.Shape.Utils.b2(v,d,h,a),n.push(new THREE.Vector2(o,v));break;case THREE.PathActions.BEZIER_CURVE_TO:u=s[4],a=s[5],c=s[0],h=s[1],f=s[2],l=s[3],0<n.length?(o=n[n.length-1],p=o.x,d=o.y):(o=this.actions[r-1].args,p=o[o.length-2],d=o[o.length-1]);for(s=1;s<=e;s++)v=s/e,o=THREE.Shape.Utils.b3(v,p,c,f,u),v=THREE.Shape.Utils.b3(v,d,h,l,a),n.push(new THREE.Vector2(o,v));break;case THREE.PathActions.CSPLINE_THRU:o=this.actions[r-1].args,v=[new THREE.Vector2(o[o.length-2],o[o.length-1])],o=e*s[0].length,v=v.concat(s[0]),v=new THREE.SplineCurve(v);for(s=1;s<=o;s++)n.push(v.getPointAt(s/o));break;case THREE.PathActions.ARC:u=s[0],a=s[1],h=s[2],f=s[3],o=s[4],c=!!s[5],p=o-f,d=2*e;for(s=1;s<=d;s++)v=s/d,c||(v=1-v),v=f+v*p,o=u+h*Math.cos(v),v=a+h*Math.sin(v),n.push(new THREE.Vector2(o,v));break;case THREE.PathActions.ELLIPSE:u=s[0],a=s[1],h=s[2],l=s[3],f=s[4],o=s[5],c=!!s[6],p=o-f,d=2*e;for(s=1;s<=d;s++)v=s/d,c||(v=1-v),v=f+v*p,o=u+h*Math.cos(v),v=a+l*Math.sin(v),n.push(new THREE.Vector2(o,v))}return r=n[n.length-1],1e-10>Math.abs(r.x-n[0].x)&&1e-10>Math.abs(r.y-n[0].y)&&n.splice(n.length-1,1),t&&n.push(n[0]),n},THREE.Path.prototype.toShapes=function(e){var t,n,r,i,s=[],o=new THREE.Path;t=0;for(n=this.actions.length;t<n;t++)r=this.actions[t],i=r.args,r=r.action,r==THREE.PathActions.MOVE_TO&&0!=o.actions.length&&(s.push(o),o=new THREE.Path),o[r].apply(o,i);0!=o.actions.length&&s.push(o);if(0==s.length)return[];var u;i=[];if(1==s.length)return r=s[0],u=new THREE.Shape,u.actions=r.actions,u.curves=r.curves,i.push(u),i;t=!THREE.Shape.Utils.isClockWise(s[0].getPoints());if(e?!t:t){u=new THREE.Shape,t=0;for(n=s.length;t<n;t++)r=s[t],o=THREE.Shape.Utils.isClockWise(r.getPoints()),(o=e?!o:o)?(u.actions=r.actions,u.curves=r.curves,i.push(u),u=new THREE.Shape):u.holes.push(r)}else{u=void 0,t=0;for(n=s.length;t<n;t++)r=s[t],o=THREE.Shape.Utils.isClockWise(r.getPoints()),(o=e?!o:o)?(u&&i.push(u),u=new THREE.Shape,u.actions=r.actions,u.curves=r.curves):u.holes.push(r);i.push(u)}return i},THREE.Shape=function(){THREE.Path.apply(this,arguments),this.holes=[]},THREE.Shape.prototype=Object.create(THREE.Path.prototype),THREE.Shape.prototype.extrude=function(e){return new THREE.ExtrudeGeometry(this,e)},THREE.Shape.prototype.makeGeometry=function(e){return new THREE.ShapeGeometry(this,e)},THREE.Shape.prototype.getPointsHoles=function(e){var t,n=this.holes.length,r=[];for(t=0;t<n;t++)r[t]=this.holes[t].getTransformedPoints(e,this.bends);return r},THREE.Shape.prototype.getSpacedPointsHoles=function(e){var t,n=this.holes.length,r=[];for(t=0;t<n;t++)r[t]=this.holes[t].getTransformedSpacedPoints(e,this.bends);return r},THREE.Shape.prototype.extractAllPoints=function(e){return{shape:this.getTransformedPoints(e),holes:this.getPointsHoles(e)}},THREE.Shape.prototype.extractPoints=function(e){return this.useSpacedPoints?this.extractAllSpacedPoints(e):this.extractAllPoints(e)},THREE.Shape.prototype.extractAllSpacedPoints=function(e){return{shape:this.getTransformedSpacedPoints(e),holes:this.getSpacedPointsHoles(e)}},THREE.Shape.Utils={removeHoles:function(e,t){var n=e.concat(),r=n.concat(),i,s,o,u,a,f,l,c,h,p,d=[];for(a=0;a<t.length;a++){f=t[a],Array.prototype.push.apply(r,f),s=Number.POSITIVE_INFINITY;for(i=0;i<f.length;i++){h=f[i],p=[];for(c=0;c<n.length;c++)l=n[c],l=h.distanceToSquared(l),p.push(l),l<s&&(s=l,o=i,u=c)}i=0<=u-1?u-1:n.length-1,s=0<=o-1?o-1:f.length-1;var v=[f[o],n[u],n[i]];c=THREE.FontUtils.Triangulate.area(v);var m=[f[o],f[s],n[u]];h=THREE.FontUtils.Triangulate.area(m),p=u,l=o,u+=1,o+=-1,0>u&&(u+=n.length),u%=n.length,0>o&&(o+=f.length),o%=f.length,i=0<=u-1?u-1:n.length-1,s=0<=o-1?o-1:f.length-1,v=[f[o],n[u],n[i]],v=THREE.FontUtils.Triangulate.area(v),m=[f[o],f[s],n[u]],m=THREE.FontUtils.Triangulate.area(m),c+h>v+m&&(u=p,o=l,0>u&&(u+=n.length),u%=n.length,0>o&&(o+=f.length),o%=f.length,i=0<=u-1?u-1:n.length-1,s=0<=o-1?o-1:f.length-1),c=n.slice(0,u),h=n.slice(u),p=f.slice(o),l=f.slice(0,o),s=[f[o],f[s],n[u]],d.push([f[o],n[u],n[i]]),d.push(s),n=c.concat(p).concat(l).concat(h)}return{shape:n,isolatedPts:d,allpoints:r}},triangulateShape:function(e,t){var n=THREE.Shape.Utils.removeHoles(e,t),r=n.allpoints,i=n.isolatedPts,n=THREE.FontUtils.Triangulate(n.shape,!1),s,o,u,a,f={};s=0;for(o=r.length;s<o;s++)a=r[s].x+":"+r[s].y,void 0!==f[a]&&console.log("Duplicate point",a),f[a]=s;s=0;for(o=n.length;s<o;s++){u=n[s];for(r=0;3>r;r++)a=u[r].x+":"+u[r].y,a=f[a],void 0!==a&&(u[r]=a)}s=0;for(o=i.length;s<o;s++){u=i[s];for(r=0;3>r;r++)a=u[r].x+":"+u[r].y,a=f[a],void 0!==a&&(u[r]=a)}return n.concat(i)},isClockWise:function(e){return 0>THREE.FontUtils.Triangulate.area(e)},b2p0:function(e,t){var n=1-e;return n*n*t},b2p1:function(e,t){return 2*(1-e)*e*t},b2p2:function(e,t){return e*e*t},b2:function(e,t,n,r){return this.b2p0(e,t)+this.b2p1(e,n)+this.b2p2(e,r)},b3p0:function(e,t){var n=1-e;return n*n*n*t},b3p1:function(e,t){var n=1-e;return 3*n*n*e*t},b3p2:function(e,t){return 3*(1-e)*e*e*t},b3p3:function(e,t){return e*e*e*t},b3:function(e,t,n,r,i){return this.b3p0(e,t)+this.b3p1(e,n)+this.b3p2(e,r)+this.b3p3(e,i)}},THREE.LineCurve=function(e,t){this.v1=e,this.v2=t},THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},THREE.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)},THREE.LineCurve.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},THREE.QuadraticBezierCurve=function(e,t,n){this.v0=e,this.v1=t,this.v2=n},THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.getPoint=function(e){var t;return t=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),e=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),new THREE.Vector2(t,e)},THREE.QuadraticBezierCurve.prototype.getTangent=function(e){var t;return t=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.x,this.v1.x,this.v2.x),e=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.y,this.v1.y,this.v2.y),t=new THREE.Vector2(t,e),t.normalize(),t},THREE.CubicBezierCurve=function(e,t,n,r){this.v0=e,this.v1=t,this.v2=n,this.v3=r},THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.getPoint=function(e){var t;return t=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new THREE.Vector2(t,e)},THREE.CubicBezierCurve.prototype.getTangent=function(e){var t;return t=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),t=new THREE.Vector2(t,e),t.normalize(),t},THREE.SplineCurve=function(e){this.points=void 0==e?[]:e},THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.getPoint=function(e){var t=new THREE.Vector2,n=[],r=this.points,i;return i=(r.length-1)*e,e=Math.floor(i),i-=e,n[0]=0==e?e:e-1,n[1]=e,n[2]=e>r.length-2?r.length-1:e+1,n[3]=e>r.length-3?r.length-1:e+2,t.x=THREE.Curve.Utils.interpolate(r[n[0]].x,r[n[1]].x,r[n[2]].x,r[n[3]].x,i),t.y=THREE.Curve.Utils.interpolate(r[n[0]].y,r[n[1]].y,r[n[2]].y,r[n[3]].y,i),t},THREE.EllipseCurve=function(e,t,n,r,i,s,o){this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=s,this.aClockwise=o},THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.getPoint=function(e){var t;return t=this.aEndAngle-this.aStartAngle,0>t&&(t+=2*Math.PI),t>2*Math.PI&&(t-=2*Math.PI),t=!0===this.aClockwise?this.aEndAngle+(1-e)*(2*Math.PI-t):this.aStartAngle+e*t,e=this.aX+this.xRadius*Math.cos(t),t=this.aY+this.yRadius*Math.sin(t),new THREE.Vector2(e,t)},THREE.ArcCurve=function(e,t,n,r,i,s){THREE.EllipseCurve.call(this,e,t,n,n,r,i,s)},THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype),THREE.LineCurve3=THREE.Curve.create(function(e,t){this.v1=e,this.v2=t},function(e){var t=new THREE.Vector3;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t}),THREE.QuadraticBezierCurve3=THREE.Curve.create(function(e,t,n){this.v0=e,this.v1=t,this.v2=n},function(e){var t,n;return t=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),n=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),e=THREE.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z),new THREE.Vector3(t,n,e)}),THREE.CubicBezierCurve3=THREE.Curve.create(function(e,t,n,r){this.v0=e,this.v1=t,this.v2=n,this.v3=r},function(e){var t,n;return t=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e=THREE.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new THREE.Vector3(t,n,e)}),THREE.SplineCurve3=THREE.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var t=new THREE.Vector3,n=[],r=this.points,i,e=(r.length-1)*e;i=Math.floor(e),e-=i,n[0]=0==i?i:i-1,n[1]=i,n[2]=i>r.length-2?r.length-1:i+1,n[3]=i>r.length-3?r.length-1:i+2,i=r[n[0]];var s=r[n[1]],o=r[n[2]],n=r[n[3]];return t.x=THREE.Curve.Utils.interpolate(i.x,s.x,o.x,n.x,e),t.y=THREE.Curve.Utils.interpolate(i.y,s.y,o.y,n.y,e),t.z=THREE.Curve.Utils.interpolate(i.z,s.z,o.z,n.z,e),t}),THREE.ClosedSplineCurve3=THREE.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var t=new THREE.Vector3,n=[],r=this.points,i;return i=(r.length-0)*e,e=Math.floor(i),i-=e,e+=0<e?0:(Math.floor(Math.abs(e)/r.length)+1)*r.length,n[0]=(e-1)%r.length,n[1]=e%r.length,n[2]=(e+1)%r.length,n[3]=(e+2)%r.length,t.x=THREE.Curve.Utils.interpolate(r[n[0]].x,r[n[1]].x,r[n[2]].x,r[n[3]].x,i),t.y=THREE.Curve.Utils.interpolate(r[n[0]].y,r[n[1]].y,r[n[2]].y,r[n[3]].y,i),t.z=THREE.Curve.Utils.interpolate(r[n[0]].z,r[n[1]].z,r[n[2]].z,r[n[3]].z,i),t}),THREE.AnimationHandler=function(){var e=[],t={},n={update:function(t){for(var n=0;n<e.length;n++)e[n].update(t)},addToUpdate:function(t){-1===e.indexOf(t)&&e.push(t)},removeFromUpdate:function(t){t=e.indexOf(t),-1!==t&&e.splice(t,1)},add:function(e){void 0!==t[e.name]&&console.log("THREE.AnimationHandler.add: Warning! "+e.name+" already exists in library. Overwriting."),t[e.name]=e;if(!0!==e.initialized){for(var n=0;n<e.hierarchy.length;n++){for(var r=0;r<e.hierarchy[n].keys.length;r++)if(0>e.hierarchy[n].keys[r].time&&(e.hierarchy[n].keys[r].time=0),void 0!==e.hierarchy[n].keys[r].rot&&!(e.hierarchy[n].keys[r].rot instanceof THREE.Quaternion)){var i=e.hierarchy[n].keys[r].rot;e.hierarchy[n].keys[r].rot=new THREE.Quaternion(i[0],i[1],i[2],i[3])}if(e.hierarchy[n].keys.length&&void 0!==e.hierarchy[n].keys[0].morphTargets){i={};for(r=0;r<e.hierarchy[n].keys.length;r++)for(var s=0;s<e.hierarchy[n].keys[r].morphTargets.length;s++){var o=e.hierarchy[n].keys[r].morphTargets[s];i[o]=-1}e.hierarchy[n].usedMorphTargets=i;for(r=0;r<e.hierarchy[n].keys.length;r++){var u={};for(o in i){for(s=0;s<e.hierarchy[n].keys[r].morphTargets.length;s++)if(e.hierarchy[n].keys[r].morphTargets[s]===o){u[o]=e.hierarchy[n].keys[r].morphTargetsInfluences[s];break}s===e.hierarchy[n].keys[r].morphTargets.length&&(u[o]=0)}e.hierarchy[n].keys[r].morphTargetsInfluences=u}}for(r=1;r<e.hierarchy[n].keys.length;r++)e.hierarchy[n].keys[r].time===e.hierarchy[n].keys[r-1].time&&(e.hierarchy[n].keys.splice(r,1),r--);for(r=0;r<e.hierarchy[n].keys.length;r++)e.hierarchy[n].keys[r].index=r}r=parseInt(e.length*e.fps,10),e.JIT={},e.JIT.hierarchy=[];for(n=0;n<e.hierarchy.length;n++)e.JIT.hierarchy.push(Array(r));e.initialized=!0}},get:function(e){if("string"==typeof e)return t[e]?t[e]:(console.log("THREE.AnimationHandler.get: Couldn't find animation "+e),null)},parse:function(e){var t=[];if(e instanceof THREE.SkinnedMesh)for(var n=0;n<e.bones.length;n++)t.push(e.bones[n]);else r(e,t);return t}},r=function(e,t){t.push(e);for(var n=0;n<e.children.length;n++)r(e.children[n],t)};return n.LINEAR=0,n.CATMULLROM=1,n.CATMULLROM_FORWARD=2,n}(),THREE.Animation=function(e,t,n){this.root=e,this.data=THREE.AnimationHandler.get(t),this.hierarchy=THREE.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.loop=this.isPaused=!0,this.interpolationType=void 0!==n?n:THREE.AnimationHandler.LINEAR,this.points=[],this.target=new THREE.Vector3},THREE.Animation.prototype.play=function(e,t){if(!1===this.isPlaying){this.isPlaying=!0,this.loop=void 0!==e?e:!0,this.currentTime=void 0!==t?t:0;var n,r=this.hierarchy.length,i;for(n=0;n<r;n++){i=this.hierarchy[n],i.matrixAutoUpdate=!0,void 0===i.animationCache&&(i.animationCache={},i.animationCache.prevKey={pos:0,rot:0,scl:0},i.animationCache.nextKey={pos:0,rot:0,scl:0},i.animationCache.originalMatrix=i instanceof THREE.Bone?i.skinMatrix:i.matrix);var s=i.animationCache.prevKey;i=i.animationCache.nextKey,s.pos=this.data.hierarchy[n].keys[0],s.rot=this.data.hierarchy[n].keys[0],s.scl=this.data.hierarchy[n].keys[0],i.pos=this.getNextKeyWith("pos",n,1),i.rot=this.getNextKeyWith("rot",n,1),i.scl=this.getNextKeyWith("scl",n,1)}this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.Animation.prototype.pause=function(){!0===this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1,THREE.AnimationHandler.removeFromUpdate(this)},THREE.Animation.prototype.update=function(e){if(!1!==this.isPlaying){var t=["pos","rot","scl"],n,r,i,s,o,u,a,f,l;for(l=this.currentTime+=e*this.timeScale;this.currentTime>this.data.length;)this.currentTime-=this.data.length;f=this.currentTime%=this.data.length,parseInt(Math.min(f*this.data.fps,this.data.length*this.data.fps),10);for(var c=0,h=this.hierarchy.length;c<h;c++){e=this.hierarchy[c],a=e.animationCache;for(var p=0;3>p;p++){n=t[p],o=a.prevKey[n],u=a.nextKey[n];if(u.time<=l){if(f<=l){if(!this.loop){this.stop();return}o=this.data.hierarchy[c].keys[0];for(u=this.getNextKeyWith(n,c,1);null!==u&&u.time<f&&u.index>o.index;)o=u,u=this.getNextKeyWith(n,c,u.index+1)}else do o=u,u=this.getNextKeyWith(n,c,u.index+1);while(null!==u&&u.time<f&&u.index>o.index);a.prevKey[n]=o,a.nextKey[n]=u}e.matrixAutoUpdate=!0,e.matrixWorldNeedsUpdate=!0,r=(f-o.time)/(u.time-o.time),i=o[n],s=u[n];if(0>r||1<r)console.log("THREE.Animation.update: Warning! Scale out of bounds:"+r+" on bone "+c),r=0>r?0:1;if("pos"===n){if(n=e.position,this.interpolationType===THREE.AnimationHandler.LINEAR)n.x=i[0]+(s[0]-i[0])*r,n.y=i[1]+(s[1]-i[1])*r,n.z=i[2]+(s[2]-i[2])*r;else if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)this.points[0]=this.getPrevKeyWith("pos",c,o.index-1).pos,this.points[1]=i,this.points[2]=s,this.points[3]=this.getNextKeyWith("pos",c,u.index+1).pos,r=.33*r+.33,i=this.interpolateCatmullRom(this.points,r),n.x=i[0],n.y=i[1],n.z=i[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(r=this.interpolateCatmullRom(this.points,1.01*r),this.target.set(r[0],r[1],r[2]),this.target.sub(n),this.target.y=0,this.target.normalize(),r=Math.atan2(this.target.x,this.target.z),e.rotation.set(0,r,0))}else"rot"===n?THREE.Quaternion.slerp(i,s,e.quaternion,r):"scl"===n&&(n=e.scale,n.x=i[0]+(s[0]-i[0])*r,n.y=i[1]+(s[1]-i[1])*r,n.z=i[2]+(s[2]-i[2])*r)}}}},THREE.Animation.prototype.interpolateCatmullRom=function(e,t){var n=[],r=[],i,s,o,u,a,f;return i=(e.length-1)*t,s=Math.floor(i),i-=s,n[0]=0===s?s:s-1,n[1]=s,n[2]=s>e.length-2?s:s+1,n[3]=s>e.length-3?s:s+2,s=e[n[0]],u=e[n[1]],a=e[n[2]],f=e[n[3]],n=i*i,o=i*n,r[0]=this.interpolate(s[0],u[0],a[0],f[0],i,n,o),r[1]=this.interpolate(s[1],u[1],a[1],f[1],i,n,o),r[2]=this.interpolate(s[2],u[2],a[2],f[2],i,n,o),r},THREE.Animation.prototype.interpolate=function(e,t,n,r,i,s,o){return e=.5*(n-e),r=.5*(r-t),(2*(t-n)+e+r)*o+(-3*(t-n)-2*e-r)*s+e*i+t},THREE.Animation.prototype.getNextKeyWith=function(e,t,n){for(var r=this.data.hierarchy[t].keys,n=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?n<r.length-1?n:r.length-1:n%r.length;n<r.length;n++)if(void 0!==r[n][e])return r[n];return this.data.hierarchy[t].keys[0]},THREE.Animation.prototype.getPrevKeyWith=function(e,t,n){for(var r=this.data.hierarchy[t].keys,n=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<n?n:0:0<=n?n:n+r.length;0<=n;n--)if(void 0!==r[n][e])return r[n];return this.data.hierarchy[t].keys[r.length-1]},THREE.KeyFrameAnimation=function(e,t,n){this.root=e,this.data=THREE.AnimationHandler.get(t),this.hierarchy=THREE.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.loop=this.isPaused=!0,this.JITCompile=void 0!==n?n:!0,e=0;for(t=this.hierarchy.length;e<t;e++){var n=this.data.hierarchy[e].sids,r=this.hierarchy[e];if(this.data.hierarchy[e].keys.length&&n){for(var i=0;i<n.length;i++){var s=n[i],o=this.getNextKeyWith(s,e,0);o&&o.apply(s)}r.matrixAutoUpdate=!1,this.data.hierarchy[e].node.updateMatrix(),r.matrixWorldNeedsUpdate=!0}}},THREE.KeyFrameAnimation.prototype.play=function(e,t){if(!this.isPlaying){this.isPlaying=!0,this.loop=void 0!==e?e:!0,this.currentTime=void 0!==t?t:0,this.startTimeMs=t,this.startTime=1e7,this.endTime=-this.startTime;var n,r=this.hierarchy.length,i,s;for(n=0;n<r;n++)i=this.hierarchy[n],s=this.data.hierarchy[n],void 0===s.animationCache&&(s.animationCache={},s.animationCache.prevKey=null,s.animationCache.nextKey=null,s.animationCache.originalMatrix=i instanceof THREE.Bone?i.skinMatrix:i.matrix),i=this.data.hierarchy[n].keys,i.length&&(s.animationCache.prevKey=i[0],s.animationCache.nextKey=i[1],this.startTime=Math.min(i[0].time,this.startTime),this.endTime=Math.max(i[i.length-1].time,this.endTime));this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1,THREE.AnimationHandler.removeFromUpdate(this);for(var e=0;e<this.data.hierarchy.length;e++){var t=this.hierarchy[e],n=this.data.hierarchy[e];if(void 0!==n.animationCache){var r=n.animationCache.originalMatrix;t instanceof THREE.Bone?(r.copy(t.skinMatrix),t.skinMatrix=r):(r.copy(t.matrix),t.matrix=r),delete n.animationCache}}},THREE.KeyFrameAnimation.prototype.update=function(e){if(this.isPlaying){var t,n,r,i,s=this.data.JIT.hierarchy,o,u,a;u=this.currentTime+=e*this.timeScale,o=this.currentTime%=this.data.length,o<this.startTimeMs&&(o=this.currentTime=this.startTimeMs+o),i=parseInt(Math.min(o*this.data.fps,this.data.length*this.data.fps),10);if((a=o<u)&&!this.loop){for(var e=0,f=this.hierarchy.length;e<f;e++){var l=this.data.hierarchy[e].keys,s=this.data.hierarchy[e].sids;r=l.length-1,i=this.hierarchy[e];if(l.length){for(l=0;l<s.length;l++)o=s[l],(u=this.getPrevKeyWith(o,e,r))&&u.apply(o);this.data.hierarchy[e].node.updateMatrix(),i.matrixWorldNeedsUpdate=!0}}this.stop()}else if(!(o<this.startTime)){e=0;for(f=this.hierarchy.length;e<f;e++){r=this.hierarchy[e],t=this.data.hierarchy[e];var l=t.keys,c=t.animationCache;if(this.JITCompile&&void 0!==s[e][i])r instanceof THREE.Bone?(r.skinMatrix=s[e][i],r.matrixWorldNeedsUpdate=!1):(r.matrix=s[e][i],r.matrixWorldNeedsUpdate=!0);else if(l.length){this.JITCompile&&c&&(r instanceof THREE.Bone?r.skinMatrix=c.originalMatrix:r.matrix=c.originalMatrix),t=c.prevKey,n=c.nextKey;if(t&&n){if(n.time<=u){if(a&&this.loop){t=l[0];for(n=l[1];n.time<o;)t=n,n=l[t.index+1]}else if(!a)for(var h=l.length-1;n.time<o&&n.index!==h;)t=n,n=l[t.index+1];c.prevKey=t,c.nextKey=n}n.time>=o?t.interpolate(n,o):t.interpolate(n,n.time)}this.data.hierarchy[e].node.updateMatrix(),r.matrixWorldNeedsUpdate=!0}}if(this.JITCompile&&void 0===s[0][i]){this.hierarchy[0].updateMatrixWorld(!0);for(e=0;e<this.hierarchy.length;e++)s[e][i]=this.hierarchy[e]instanceof THREE.Bone?this.hierarchy[e].skinMatrix.clone():this.hierarchy[e].matrix.clone()}}}},THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(e,t,n){t=this.data.hierarchy[t].keys;for(n%=t.length;n<t.length;n++)if(t[n].hasTarget(e))return t[n];return t[0]},THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(e,t,n){t=this.data.hierarchy[t].keys;for(n=0<=n?n:n+t.length;0<=n;n--)if(t[n].hasTarget(e))return t[n];return t[t.length-1]},THREE.CubeCamera=function(e,t,n){THREE.Object3D.call(this);var r=new THREE.PerspectiveCamera(90,1,e,t);r.up.set(0,-1,0),r.lookAt(new THREE.Vector3(1,0,0)),this.add(r);var i=new THREE.PerspectiveCamera(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new THREE.Vector3(-1,0,0)),this.add(i);var s=new THREE.PerspectiveCamera(90,1,e,t);s.up.set(0,0,1),s.lookAt(new THREE.Vector3(0,1,0)),this.add(s);var o=new THREE.PerspectiveCamera(90,1,e,t);o.up.set(0,0,-1),o.lookAt(new THREE.Vector3(0,-1,0)),this.add(o);var u=new THREE.PerspectiveCamera(90,1,e,t);u.up.set(0,-1,0),u.lookAt(new THREE.Vector3(0,0,1)),this.add(u);var a=new THREE.PerspectiveCamera(90,1,e,t);a.up.set(0,-1,0),a.lookAt(new THREE.Vector3(0,0,-1)),this.add(a),this.renderTarget=new THREE.WebGLRenderTargetCube(n,n,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter}),this.updateCubeMap=function(e,t){var n=this.renderTarget,l=n.generateMipmaps;n.generateMipmaps=!1,n.activeCubeFace=0,e.render(t,r,n),n.activeCubeFace=1,e.render(t,i,n),n.activeCubeFace=2,e.render(t,s,n),n.activeCubeFace=3,e.render(t,o,n),n.activeCubeFace=4,e.render(t,u,n),n.generateMipmaps=l,n.activeCubeFace=5,e.render(t,a,n)}},THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype),THREE.CombinedCamera=function(e,t,n,r,i,s,o){THREE.Camera.call(this),this.fov=n,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2,this.cameraO=new THREE.OrthographicCamera(e/-2,e/2,t/2,t/-2,s,o),this.cameraP=new THREE.PerspectiveCamera(n,e/t,r,i),this.zoom=1,this.toPerspective()},THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype),THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near,this.far=this.cameraP.far,this.cameraP.fov=this.fov/this.zoom,this.cameraP.updateProjectionMatrix(),this.projectionMatrix=this.cameraP.projectionMatrix,this.inPerspectiveMode=!0,this.inOrthographicMode=!1},THREE.CombinedCamera.prototype.toOrthographic=function(){var e=this.cameraP.aspect,t=(this.cameraP.near+this.cameraP.far)/2,t=Math.tan(this.fov/2)*t,e=2*t*e/2,t=t/this.zoom,e=e/this.zoom;this.cameraO.left=-e,this.cameraO.right=e,this.cameraO.top=t,this.cameraO.bottom=-t,this.cameraO.updateProjectionMatrix(),this.near=this.cameraO.near,this.far=this.cameraO.far,this.projectionMatrix=this.cameraO.projectionMatrix,this.inPerspectiveMode=!1,this.inOrthographicMode=!0},THREE.CombinedCamera.prototype.setSize=function(e,t){this.cameraP.aspect=e/t,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2},THREE.CombinedCamera.prototype.setFov=function(e){this.fov=e,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())},THREE.CombinedCamera.prototype.setLens=function(e,t){void 0===t&&(t=24);var n=2*THREE.Math.radToDeg(Math.atan(t/(2*e)));return this.setFov(n),n},THREE.CombinedCamera.prototype.setZoom=function(e){this.zoom=e,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0,this.rotation.y=Math.PI,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0,this.rotation.y=-Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0,this.rotation.y=Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CircleGeometry=function(e,t,n,r){THREE.Geometry.call(this),this.radius=e=e||50,this.segments=t=void 0!==t?Math.max(3,t):8,this.thetaStart=n=void 0!==n?n:0,this.thetaLength=r=void 0!==r?r:2*Math.PI;var i,s=[];i=new THREE.Vector3;var o=new THREE.Vector2(.5,.5);this.vertices.push(i),s.push(o);for(i=0;i<=t;i++){var u=new THREE.Vector3,a=n+i/t*r;u.x=e*Math.cos(a),u.y=e*Math.sin(a),this.vertices.push(u),s.push(new THREE.Vector2((u.x/e+1)/2,(u.y/e+1)/2))}n=new THREE.Vector3(0,0,1);for(i=1;i<=t;i++)this.faces.push(new THREE.Face3(i,i+1,0,[n.clone(),n.clone(),n.clone()])),this.faceVertexUvs[0].push([s[i].clone(),s[i+1].clone(),o.clone()]);this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)},THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CubeGeometry=function(e,t,n,r,i,s){function o(e,t,n,r,i,s,o,a){var f,l=u.widthSegments,c=u.heightSegments,p=i/2,d=s/2,v=u.vertices.length;if("x"===e&&"y"===t||"y"===e&&"x"===t)f="z";else if("x"===e&&"z"===t||"z"===e&&"x"===t)f="y",c=u.depthSegments;else if("z"===e&&"y"===t||"y"===e&&"z"===t)f="x",l=u.depthSegments;var m=l+1,g=c+1,y=i/l,b=s/c,w=new THREE.Vector3;w[f]=0<o?1:-1;for(i=0;i<g;i++)for(s=0;s<m;s++){var E=new THREE.Vector3;E[e]=(s*y-p)*n,E[t]=(i*b-d)*r,E[f]=o,u.vertices.push(E)}for(i=0;i<c;i++)for(s=0;s<l;s++)d=s+m*i,e=s+m*(i+1),t=s+1+m*(i+1),n=s+1+m*i,r=new THREE.Vector2(s/l,1-i/c),o=new THREE.Vector2(s/l,1-(i+1)/c),f=new THREE.Vector2((s+1)/l,1-(i+1)/c),p=new THREE.Vector2((s+1)/l,1-i/c),d=new THREE.Face3(d+v,e+v,n+v),d.normal.copy(w),d.vertexNormals.push(w.clone(),w.clone(),w.clone()),d.materialIndex=a,u.faces.push(d),u.faceVertexUvs[0].push([r,o,p]),d=new THREE.Face3(e+v,t+v,n+v),d.normal.copy(w),d.vertexNormals.push(w.clone(),w.clone(),w.clone()),d.materialIndex=a,u.faces.push(d),u.faceVertexUvs[0].push([o.clone(),f,p.clone()])}THREE.Geometry.call(this);var u=this;this.width=e,this.height=t,this.depth=n,this.widthSegments=r||1,this.heightSegments=i||1,this.depthSegments=s||1,e=this.width/2,t=this.height/2,n=this.depth/2,o("z","y",-1,-1,this.depth,this.height,e,0),o("z","y",1,-1,this.depth,this.height,-e,1),o("x","z",1,1,this.width,this.depth,t,2),o("x","z",1,-1,this.width,this.depth,-t,3),o("x","y",1,-1,this.width,this.height,n,4),o("x","y",-1,-1,this.width,this.height,-n,5),this.computeCentroids(),this.mergeVertices()},THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CylinderGeometry=function(e,t,n,r,i,s){THREE.Geometry.call(this),this.radiusTop=e=void 0!==e?e:20,this.radiusBottom=t=void 0!==t?t:20,this.height=n=void 0!==n?n:100,this.radialSegments=r=r||8,this.heightSegments=i=i||1,this.openEnded=s=void 0!==s?s:!1;var o=n/2,u,a,f=[],l=[];for(a=0;a<=i;a++){var c=[],h=[],p=a/i,d=p*(t-e)+e;for(u=0;u<=r;u++){var v=u/r,m=new THREE.Vector3;m.x=d*Math.sin(2*v*Math.PI),m.y=-p*n+o,m.z=d*Math.cos(2*v*Math.PI),this.vertices.push(m),c.push(this.vertices.length-1),h.push(new THREE.Vector2(v,1-p))}f.push(c),l.push(h)}n=(t-e)/n;for(u=0;u<r;u++){0!==e?(c=this.vertices[f[0][u]].clone(),h=this.vertices[f[0][u+1]].clone()):(c=this.vertices[f[1][u]].clone(),h=this.vertices[f[1][u+1]].clone()),c.setY(Math.sqrt(c.x*c.x+c.z*c.z)*n).normalize(),h.setY(Math.sqrt(h.x*h.x+h.z*h.z)*n).normalize();for(a=0;a<i;a++){var p=f[a][u],d=f[a+1][u],v=f[a+1][u+1],m=f[a][u+1],g=c.clone(),y=c.clone(),b=h.clone(),w=h.clone(),E=l[a][u].clone(),S=l[a+1][u].clone(),x=l[a+1][u+1].clone(),T=l[a][u+1].clone();this.faces.push(new THREE.Face3(p,d,m,[g,y,w])),this.faceVertexUvs[0].push([E,S,T]),this.faces.push(new THREE.Face3(d,v,m,[y.clone(),b,w.clone()])),this.faceVertexUvs[0].push([S.clone(),x,T.clone()])}}if(!1===s&&0<e){this.vertices.push(new THREE.Vector3(0,o,0));for(u=0;u<r;u++)p=f[0][u],d=f[0][u+1],v=this.vertices.length-1,g=new THREE.Vector3(0,1,0),y=new THREE.Vector3(0,1,0),b=new THREE.Vector3(0,1,0),E=l[0][u].clone(),S=l[0][u+1].clone(),x=new THREE.Vector2(S.x,0),this.faces.push(new THREE.Face3(p,d,v,[g,y,b])),this.faceVertexUvs[0].push([E,S,x])}if(!1===s&&0<t){this.vertices.push(new THREE.Vector3(0,-o,0));for(u=0;u<r;u++)p=f[a][u+1],d=f[a][u],v=this.vertices.length-1,g=new THREE.Vector3(0,-1,0),y=new THREE.Vector3(0,-1,0),b=new THREE.Vector3(0,-1,0),E=l[a][u+1].clone(),S=l[a][u].clone(),x=new THREE.Vector2(S.x,1),this.faces.push(new THREE.Face3(p,d,v,[g,y,b])),this.faceVertexUvs[0].push([E,S,x])}this.computeCentroids(),this.computeFaceNormals()},THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry=function(e,t){"undefined"!=typeof e&&(THREE.Geometry.call(this),e=e instanceof Array?e:[e],this.shapebb=e[e.length-1].getBoundingBox(),this.addShapeList(e,t),this.computeCentroids(),this.computeFaceNormals())},THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.addShapeList=function(e,t){for(var n=e.length,r=0;r<n;r++)this.addShape(e[r],t)},THREE.ExtrudeGeometry.prototype.addShape=function(e,t){function n(e,t,n){return t||console.log("die"),t.clone().multiplyScalar(n).add(e)}function r(e,t,n){var r=THREE.ExtrudeGeometry.__v1,i=THREE.ExtrudeGeometry.__v2,s=THREE.ExtrudeGeometry.__v3,o=THREE.ExtrudeGeometry.__v4,u=THREE.ExtrudeGeometry.__v5,a=THREE.ExtrudeGeometry.__v6;return r.set(e.x-t.x,e.y-t.y),i.set(e.x-n.x,e.y-n.y),r=r.normalize(),i=i.normalize(),s.set(-r.y,r.x),o.set(i.y,-i.x),u.copy(e).add(s),a.copy(e).add(o),u.equals(a)?o.clone():(u.copy(t).add(s),a.copy(n).add(o),s=r.dot(o),o=a.sub(u).dot(o),0===s&&(console.log("Either infinite or no solutions!"),0===o?console.log("Its finite solutions."):console.log("Too bad, no solutions.")),o/=s,0>o?(t=Math.atan2(t.y-e.y,t.x-e.x),e=Math.atan2(n.y-e.y,n.x-e.x),t>e&&(e+=2*Math.PI),n=(t+e)/2,e=-Math.cos(n),n=-Math.sin(n),new THREE.Vector2(e,n)):r.multiplyScalar(o).add(u).sub(e).clone())}function i(n,r){var i,s;for(F=n.length;0<=--F;){i=F,s=F-1,0>s&&(s=n.length-1);for(var o=0,u=p+2*l,o=0;o<u;o++){var a=H*o,f=H*(o+1),c=r+i+a,a=r+s+a,h=r+s+f,f=r+i+f,d=n,v=o,m=u,g=i,w=s,c=c+L,a=a+L,h=h+L,f=f+L;k.faces.push(new THREE.Face3(c,a,f,null,null,y)),k.faces.push(new THREE.Face3(a,h,f,null,null,y)),c=b.generateSideWallUV(k,e,d,t,c,a,h,f,v,m,g,w),k.faceVertexUvs[0].push([c[0],c[1],c[3]]),k.faceVertexUvs[0].push([c[1],c[2],c[3]])}}}function s(e,t,n){k.vertices.push(new THREE.Vector3(e,t,n))}function o(n,r,i,s){n+=L,r+=L,i+=L,k.faces.push(new THREE.Face3(n,r,i,null,null,g)),n=s?b.generateBottomUV(k,e,t,n,r,i):b.generateTopUV(k,e,t,n,r,i),k.faceVertexUvs[0].push(n)}var u=void 0!==t.amount?t.amount:100,a=void 0!==t.bevelThickness?t.bevelThickness:6,f=void 0!==t.bevelSize?t.bevelSize:a-2,l=void 0!==t.bevelSegments?t.bevelSegments:3,c=void 0!==t.bevelEnabled?t.bevelEnabled:!0,h=void 0!==t.curveSegments?t.curveSegments:12,p=void 0!==t.steps?t.steps:1,d=t.extrudePath,v,m=!1,g=t.material,y=t.extrudeMaterial,b=void 0!==t.UVGenerator?t.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,w,E,S,x;d&&(v=d.getSpacedPoints(p),m=!0,c=!1,w=void 0!==t.frames?t.frames:new THREE.TubeGeometry.FrenetFrames(d,p,!1),E=new THREE.Vector3,S=new THREE.Vector3,x=new THREE.Vector3),c||(f=a=l=0);var T,N,C,k=this,L=this.vertices.length,h=e.extractPoints(h),A=h.shape,h=h.holes;if(d=!THREE.Shape.Utils.isClockWise(A)){A=A.reverse(),N=0;for(C=h.length;N<C;N++)T=h[N],THREE.Shape.Utils.isClockWise(T)&&(h[N]=T.reverse());d=!1}var O=THREE.Shape.Utils.triangulateShape(A,h),d=A;N=0;for(C=h.length;N<C;N++)T=h[N],A=A.concat(T);var M,_,D,P,H=A.length,B=O.length,j=[],F=0,I=d.length;M=I-1;for(_=F+1;F<I;F++,M++,_++)M===I&&(M=0),_===I&&(_=0),j[F]=r(d[F],d[M],d[_]);var q=[],R,U=j.concat();N=0;for(C=h.length;N<C;N++){T=h[N],R=[],F=0,I=T.length,M=I-1;for(_=F+1;F<I;F++,M++,_++)M===I&&(M=0),_===I&&(_=0),R[F]=r(T[F],T[M],T[_]);q.push(R),U=U.concat(R)}for(M=0;M<l;M++){T=M/l,D=a*(1-T),_=f*Math.sin(T*Math.PI/2),F=0;for(I=d.length;F<I;F++)P=n(d[F],j[F],_),s(P.x,P.y,-D);N=0;for(C=h.length;N<C;N++){T=h[N],R=q[N],F=0;for(I=T.length;F<I;F++)P=n(T[F],R[F],_),s(P.x,P.y,-D)}}_=f;for(F=0;F<H;F++)P=c?n(A[F],U[F],_):A[F],m?(S.copy(w.normals[0]).multiplyScalar(P.x),E.copy(w.binormals[0]).multiplyScalar(P.y),x.copy(v[0]).add(S).add(E),s(x.x,x.y,x.z)):s(P.x,P.y,0);for(T=1;T<=p;T++)for(F=0;F<H;F++)P=c?n(A[F],U[F],_):A[F],m?(S.copy(w.normals[T]).multiplyScalar(P.x),E.copy(w.binormals[T]).multiplyScalar(P.y),x.copy(v[T]).add(S).add(E),s(x.x,x.y,x.z)):s(P.x,P.y,u/p*T);for(M=l-1;0<=M;M--){T=M/l,D=a*(1-T),_=f*Math.sin(T*Math.PI/2),F=0;for(I=d.length;F<I;F++)P=n(d[F],j[F],_),s(P.x,P.y,u+D);N=0;for(C=h.length;N<C;N++){T=h[N],R=q[N],F=0;for(I=T.length;F<I;F++)P=n(T[F],R[F],_),m?s(P.x,P.y+v[p-1].y,v[p-1].x+D):s(P.x,P.y,u+D)}}if(c){a=0*H;for(F=0;F<B;F++)u=O[F],o(u[2]+a,u[1]+a,u[0]+a,!0);a=H*(p+2*l);for(F=0;F<B;F++)u=O[F],o(u[0]+a,u[1]+a,u[2]+a,!1)}else{for(F=0;F<B;F++)u=O[F],o(u[2],u[1],u[0],!0);for(F=0;F<B;F++)u=O[F],o(u[0]+H*p,u[1]+H*p,u[2]+H*p,!1)}u=0,i(d,u),u+=d.length,N=0;for(C=h.length;N<C;N++)T=h[N],i(T,u),u+=T.length},THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,t,n,r,i,s){return t=e.vertices[i].x,i=e.vertices[i].y,n=e.vertices[s].x,s=e.vertices[s].y,[new THREE.Vector2(e.vertices[r].x,e.vertices[r].y),new THREE.Vector2(t,i),new THREE.Vector2(n,s)]},generateBottomUV:function(e,t,n,r,i,s){return this.generateTopUV(e,t,n,r,i,s)},generateSideWallUV:function(e,t,n,r,i,s,o,u){var t=e.vertices[i].x,n=e.vertices[i].y,i=e.vertices[i].z,r=e.vertices[s].x,a=e.vertices[s].y,s=e.vertices[s].z,f=e.vertices[o].x,l=e.vertices[o].y,o=e.vertices[o].z,c=e.vertices[u].x,h=e.vertices[u].y,e=e.vertices[u].z;return.01>Math.abs(n-a)?[new THREE.Vector2(t,1-i),new THREE.Vector2(r,1-s),new THREE.Vector2(f,1-o),new THREE.Vector2(c,1-e)]:[new THREE.Vector2(n,1-i),new THREE.Vector2(a,1-s),new THREE.Vector2(l,1-o),new THREE.Vector2(h,1-e)]}},THREE.ExtrudeGeometry.__v1=new THREE.Vector2,THREE.ExtrudeGeometry.__v2=new THREE.Vector2,THREE.ExtrudeGeometry.__v3=new THREE.Vector2,THREE.ExtrudeGeometry.__v4=new THREE.Vector2,THREE.ExtrudeGeometry.__v5=new THREE.Vector2,THREE.ExtrudeGeometry.__v6=new THREE.Vector2,THREE.ShapeGeometry=function(e,t){THREE.Geometry.call(this),0==e instanceof Array&&(e=[e]),this.shapebb=e[e.length-1].getBoundingBox(),this.addShapeList(e,t),this.computeCentroids(),this.computeFaceNormals()},THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.addShapeList=function(e,t){for(var n=0,r=e.length;n<r;n++)this.addShape(e[n],t);return this},THREE.ShapeGeometry.prototype.addShape=function(e,t){void 0===t&&(t={});var n=t.material,r=void 0===t.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:t.UVGenerator,i,s,o,u=this.vertices.length;i=e.extractPoints(void 0!==t.curveSegments?t.curveSegments:12);var a=i.shape,f=i.holes;if(!THREE.Shape.Utils.isClockWise(a)){a=a.reverse(),i=0;for(s=f.length;i<s;i++)o=f[i],THREE.Shape.Utils.isClockWise(o)&&(f[i]=o.reverse())}var l=THREE.Shape.Utils.triangulateShape(a,f);i=0;for(s=f.length;i<s;i++)o=f[i],a=a.concat(o);f=a.length,s=l.length;for(i=0;i<f;i++)o=a[i],this.vertices.push(new THREE.Vector3(o.x,o.y,0));for(i=0;i<s;i++)f=l[i],a=f[0]+u,o=f[1]+u,f=f[2]+u,this.faces.push(new THREE.Face3(a,o,f,null,null,n)),this.faceVertexUvs[0].push(r.generateBottomUV(this,e,t,a,o,f))},THREE.LatheGeometry=function(e,t,n,r){THREE.Geometry.call(this);for(var t=t||12,n=n||0,r=r||2*Math.PI,i=1/(e.length-1),s=1/t,o=0,u=t;o<=u;o++)for(var a=n+o*s*r,f=Math.cos(a),l=Math.sin(a),a=0,c=e.length;a<c;a++){var h=e[a],p=new THREE.Vector3;p.x=f*h.x-l*h.y,p.y=l*h.x+f*h.y,p.z=h.z,this.vertices.push(p)}n=e.length,o=0;for(u=t;o<u;o++){a=0;for(c=e.length-1;a<c;a++){var t=l=a+n*o,r=l+n,f=l+1+n,l=l+1,h=o*s,p=a*i,d=h+s,v=p+i;this.faces.push(new THREE.Face3(t,r,l)),this.faceVertexUvs[0].push([new THREE.Vector2(h,p),new THREE.Vector2(d,p),new THREE.Vector2(h,v)]),this.faces.push(new THREE.Face3(r,f,l)),this.faceVertexUvs[0].push([new THREE.Vector2(d,p),new THREE.Vector2(d,v),new THREE.Vector2(h,v)])}}this.mergeVertices(),this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry=function(e,t,n,r){THREE.Geometry.call(this),this.width=e,this.height=t,this.widthSegments=n||1,this.heightSegments=r||1;for(var i=e/2,s=t/2,n=this.widthSegments,r=this.heightSegments,o=n+1,u=r+1,a=this.width/n,f=this.height/r,l=new THREE.Vector3(0,0,1),e=0;e<u;e++)for(t=0;t<o;t++)this.vertices.push(new THREE.Vector3(t*a-i,-(e*f-s),0));for(e=0;e<r;e++)for(t=0;t<n;t++){var c=t+o*e,i=t+o*(e+1),s=t+1+o*(e+1),u=t+1+o*e,a=new THREE.Vector2(t/n,1-e/r),f=new THREE.Vector2(t/n,1-(e+1)/r),h=new THREE.Vector2((t+1)/n,1-(e+1)/r),p=new THREE.Vector2((t+1)/n,1-e/r),c=new THREE.Face3(c,i,u);c.normal.copy(l),c.vertexNormals.push(l.clone(),l.clone(),l.clone()),this.faces.push(c),this.faceVertexUvs[0].push([a,f,p]),c=new THREE.Face3(i,s,u),c.normal.copy(l),c.vertexNormals.push(l.clone(),l.clone(),l.clone()),this.faces.push(c),this.faceVertexUvs[0].push([f.clone(),h,p.clone()])}this.computeCentroids()},THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.RingGeometry=function(e,t,n,r,i,s){THREE.Geometry.call(this);for(var e=e||0,t=t||50,i=void 0!==i?i:0,s=void 0!==s?s:2*Math.PI,n=void 0!==n?Math.max(3,n):8,r=void 0!==r?Math.max(3,r):8,o,u=[],a=e,f=(t-e)/r,e=0;e<=r;e++){for(o=0;o<=n;o++){var l=new THREE.Vector3,c=i+o/n*s;l.x=a*Math.cos(c),l.y=a*Math.sin(c),this.vertices.push(l),u.push(new THREE.Vector2((l.x/t+1)/2,(l.y/t+1)/2))}a+=f}t=new THREE.Vector3(0,0,1);for(e=0;e<r;e++){i=e*n;for(o=0;o<=n;o++)c=o+i,s=c+e,f=c+n+e,l=c+n+1+e,this.faces.push(new THREE.Face3(s,f,l,[t.clone(),t.clone(),t.clone()])),this.faceVertexUvs[0].push([u[s].clone(),u[f].clone(),u[l].clone()]),s=c+e,f=c+n+1+e,l=c+1+e,this.faces.push(new THREE.Face3(s,f,l,[t.clone(),t.clone(),t.clone()])),this.faceVertexUvs[0].push([u[s].clone(),u[f].clone(),u[l].clone()])}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)},THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.SphereGeometry=function(e,t,n,r,i,s,o){THREE.Geometry.call(this),this.radius=e=e||50,this.widthSegments=t=Math.max(3,Math.floor(t)||8),this.heightSegments=n=Math.max(2,Math.floor(n)||6),this.phiStart=r=void 0!==r?r:0,this.phiLength=i=void 0!==i?i:2*Math.PI,this.thetaStart=s=void 0!==s?s:0,this.thetaLength=o=void 0!==o?o:Math.PI;var u,a,f=[],l=[];for(a=0;a<=n;a++){var c=[],h=[];for(u=0;u<=t;u++){var p=u/t,d=a/n,v=new THREE.Vector3;v.x=-e*Math.cos(r+p*i)*Math.sin(s+d*o),v.y=e*Math.cos(s+d*o),v.z=e*Math.sin(r+p*i)*Math.sin(s+d*o),this.vertices.push(v),c.push(this.vertices.length-1),h.push(new THREE.Vector2(p,1-d))}f.push(c),l.push(h)}for(a=0;a<this.heightSegments;a++)for(u=0;u<this.widthSegments;u++){var t=f[a][u+1],n=f[a][u],r=f[a+1][u],i=f[a+1][u+1],s=this.vertices[t].clone().normalize(),o=this.vertices[n].clone().normalize(),c=this.vertices[r].clone().normalize(),h=this.vertices[i].clone().normalize(),p=l[a][u+1].clone(),d=l[a][u].clone(),v=l[a+1][u].clone(),m=l[a+1][u+1].clone();Math.abs(this.vertices[t].y)===this.radius?(p.x=(p.x+d.x)/2,this.faces.push(new THREE.Face3(t,r,i,[s,c,h])),this.faceVertexUvs[0].push([p,v,m])):Math.abs(this.vertices[r].y)===this.radius?(v.x=(v.x+m.x)/2,this.faces.push(new THREE.Face3(t,n,r,[s,o,c])),this.faceVertexUvs[0].push([p,d,v])):(this.faces.push(new THREE.Face3(t,n,i,[s,o,h])),this.faceVertexUvs[0].push([p,d,m]),this.faces.push(new THREE.Face3(n,r,i,[o.clone(),c,h.clone()])),this.faceVertexUvs[0].push([d.clone(),v,m.clone()]))}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)},THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TextGeometry=function(e,t){var t=t||{},n=THREE.FontUtils.generateShapes(e,t);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),THREE.ExtrudeGeometry.call(this,n,t)},THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype),THREE.TorusGeometry=function(e,t,n,r,i){THREE.Geometry.call(this),this.radius=e||100,this.tube=t||40,this.radialSegments=n||8,this.tubularSegments=r||6,this.arc=i||2*Math.PI,i=new THREE.Vector3,e=[],t=[];for(n=0;n<=this.radialSegments;n++)for(r=0;r<=this.tubularSegments;r++){var s=r/this.tubularSegments*this.arc,o=2*n/this.radialSegments*Math.PI;i.x=this.radius*Math.cos(s),i.y=this.radius*Math.sin(s);var u=new THREE.Vector3;u.x=(this.radius+this.tube*Math.cos(o))*Math.cos(s),u.y=(this.radius+this.tube*Math.cos(o))*Math.sin(s),u.z=this.tube*Math.sin(o),this.vertices.push(u),e.push(new THREE.Vector2(r/this.tubularSegments,n/this.radialSegments)),t.push(u.clone().sub(i).normalize())}for(n=1;n<=this.radialSegments;n++)for(r=1;r<=this.tubularSegments;r++){var i=(this.tubularSegments+1)*n+r-1,s=(this.tubularSegments+1)*(n-1)+r-1,o=(this.tubularSegments+1)*(n-1)+r,u=(this.tubularSegments+1)*n+r,a=new THREE.Face3(i,s,u,[t[i].clone(),t[s].clone(),t[u].clone()]);this.faces.push(a),this.faceVertexUvs[0].push([e[i].clone(),e[s].clone(),e[u].clone()]),a=new THREE.Face3(s,o,u,[t[s].clone(),t[o].clone(),t[u].clone()]),this.faces.push(a),this.faceVertexUvs[0].push([e[s].clone(),e[o].clone(),e[u].clone()])}this.computeCentroids(),this.computeFaceNormals()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry=function(e,t,n,r,i,s,o){function u(e,t,n,r,i){var s=Math.cos(e),o=Math.sin(e),e=t/n*e,t=Math.cos(e),s=.5*r*(2+t)*s,o=.5*r*(2+t)*o,r=.5*i*r*Math.sin(e);return new THREE.Vector3(s,o,r)}THREE.Geometry.call(this),this.radius=e||100,this.tube=t||40,this.radialSegments=n||64,this.tubularSegments=r||8,this.p=i||2,this.q=s||3,this.heightScale=o||1,this.grid=Array(this.radialSegments),n=new THREE.Vector3,r=new THREE.Vector3,i=new THREE.Vector3;for(e=0;e<this.radialSegments;++e){this.grid[e]=Array(this.tubularSegments),t=2*(e/this.radialSegments)*this.p*Math.PI,s=u(t,this.q,this.p,this.radius,this.heightScale),t=u(t+.01,this.q,this.p,this.radius,this.heightScale),n.subVectors(t,s),r.addVectors(t,s),i.crossVectors(n,r),r.crossVectors(i,n),i.normalize(),r.normalize();for(t=0;t<this.tubularSegments;++t){var a=2*(t/this.tubularSegments)*Math.PI,o=-this.tube*Math.cos(a),a=this.tube*Math.sin(a),f=new THREE.Vector3;f.x=s.x+o*r.x+a*i.x,f.y=s.y+o*r.y+a*i.y,f.z=s.z+o*r.z+a*i.z,this.grid[e][t]=this.vertices.push(f)-1}}for(e=0;e<this.radialSegments;++e)for(t=0;t<this.tubularSegments;++t){var i=(e+1)%this.radialSegments,s=(t+1)%this.tubularSegments,n=this.grid[e][t],r=this.grid[i][t],i=this.grid[i][s],s=this.grid[e][s],o=new THREE.Vector2(e/this.radialSegments,t/this.tubularSegments),a=new THREE.Vector2((e+1)/this.radialSegments,t/this.tubularSegments),f=new THREE.Vector2((e+1)/this.radialSegments,(t+1)/this.tubularSegments),l=new THREE.Vector2(e/this.radialSegments,(t+1)/this.tubularSegments);this.faces.push(new THREE.Face3(n,r,s)),this.faceVertexUvs[0].push([o,a,l]),this.faces.push(new THREE.Face3(r,i,s)),this.faceVertexUvs[0].push([a.clone(),f,l.clone()])}this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry=function(e,t,n,r,i){THREE.Geometry.call(this),this.path=e,this.segments=t||64,this.radius=n||1,this.radialSegments=r||8,this.closed=i||!1,this.grid=[];var s,o,r=this.segments+1,u,a,f,i=new THREE.Vector3,l,c,t=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed);l=t.normals,c=t.binormals,this.tangents=t.tangents,this.normals=l,this.binormals=c;for(t=0;t<r;t++){this.grid[t]=[],n=t/(r-1),f=e.getPointAt(n),s=l[t],o=c[t];for(n=0;n<this.radialSegments;n++)u=2*(n/this.radialSegments)*Math.PI,a=-this.radius*Math.cos(u),u=this.radius*Math.sin(u),i.copy(f),i.x+=a*s.x+u*o.x,i.y+=a*s.y+u*o.y,i.z+=a*s.z+u*o.z,this.grid[t][n]=this.vertices.push(new THREE.Vector3(i.x,i.y,i.z))-1}for(t=0;t<this.segments;t++)for(n=0;n<this.radialSegments;n++)i=this.closed?(t+1)%this.segments:t+1,l=(n+1)%this.radialSegments,e=this.grid[t][n],r=this.grid[i][n],i=this.grid[i][l],l=this.grid[t][l],c=new THREE.Vector2(t/this.segments,n/this.radialSegments),s=new THREE.Vector2((t+1)/this.segments,n/this.radialSegments),o=new THREE.Vector2((t+1)/this.segments,(n+1)/this.radialSegments),a=new THREE.Vector2(t/this.segments,(n+1)/this.radialSegments),this.faces.push(new THREE.Face3(e,r,l)),this.faceVertexUvs[0].push([c,s,a]),this.faces.push(new THREE.Face3(r,i,l)),this.faceVertexUvs[0].push([s.clone(),o,a.clone()]);this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.FrenetFrames=function(e,t,n){new THREE.Vector3;var r=new THREE.Vector3;new THREE.Vector3;var i=[],s=[],o=[],u=new THREE.Vector3,a=new THREE.Matrix4,t=t+1,f,l,c;this.tangents=i,this.normals=s,this.binormals=o;for(f=0;f<t;f++)l=f/(t-1),i[f]=e.getTangentAt(l),i[f].normalize();s[0]=new THREE.Vector3,o[0]=new THREE.Vector3,e=Number.MAX_VALUE,f=Math.abs(i[0].x),l=Math.abs(i[0].y),c=Math.abs(i[0].z),f<=e&&(e=f,r.set(1,0,0)),l<=e&&(e=l,r.set(0,1,0)),c<=e&&r.set(0,0,1),u.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],u),o[0].crossVectors(i[0],s[0]);for(f=1;f<t;f++)s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),u.crossVectors(i[f-1],i[f]),1e-4<u.length()&&(u.normalize(),r=Math.acos(THREE.Math.clamp(i[f-1].dot(i[f]),-1,1)),s[f].applyMatrix4(a.makeRotationAxis(u,r))),o[f].crossVectors(i[f],s[f]);if(n){r=Math.acos(THREE.Math.clamp(s[0].dot(s[t-1]),-1,1)),r/=t-1,0<i[0].dot(u.crossVectors(s[0],s[t-1]))&&(r=-r);for(f=1;f<t;f++)s[f].applyMatrix4(a.makeRotationAxis(i[f],r*f)),o[f].crossVectors(i[f],s[f])}},THREE.PolyhedronGeometry=function(e,t,n,r){function i(e){var t=e.normalize().clone();t.index=u.vertices.push(t)-1;var n=Math.atan2(e.z,-e.x)/2/Math.PI+.5,e=Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5;return t.uv=new THREE.Vector2(n,1-e),t}function s(e,t,n){var r=new THREE.Face3(e.index,t.index,n.index,[e.clone(),t.clone(),n.clone()]);r.centroid.add(e).add(t).add(n).divideScalar(3),u.faces.push(r),r=Math.atan2(r.centroid.z,-r.centroid.x),u.faceVertexUvs[0].push([o(e.uv,e,r),o(t.uv,t,r),o(n.uv,n,r)])}function o(e,t,n){return 0>n&&1===e.x&&(e=new THREE.Vector2(e.x-1,e.y)),0===t.x&&0===t.z&&(e=new THREE.Vector2(n/2/Math.PI+.5,e.y)),e.clone()}THREE.Geometry.call(this);for(var n=n||1,r=r||0,u=this,a=0,f=e.length;a<f;a++)i(new THREE.Vector3(e[a][0],e[a][1],e[a][2]));for(var l=this.vertices,e=[],a=0,f=t.length;a<f;a++){var c=l[t[a][0]],h=l[t[a][1]],p=l[t[a][2]];e[a]=new THREE.Face3(c.index,h.index,p.index,[c.clone(),h.clone(),p.clone()])}a=0;for(f=e.length;a<f;a++){h=e[a],l=r,t=Math.pow(2,l),Math.pow(4,l);for(var l=i(u.vertices[h.a]),c=i(u.vertices[h.b]),d=i(u.vertices[h.c]),h=[],p=0;p<=t;p++){h[p]=[];for(var v=i(l.clone().lerp(d,p/t)),m=i(c.clone().lerp(d,p/t)),g=t-p,y=0;y<=g;y++)h[p][y]=0==y&&p==t?v:i(v.clone().lerp(m,y/g))}for(p=0;p<t;p++)for(y=0;y<2*(t-p)-1;y++)l=Math.floor(y/2),0==y%2?s(h[p][l+1],h[p+1][l],h[p][l]):s(h[p][l+1],h[p+1][l+1],h[p+1][l])}a=0;for(f=this.faceVertexUvs[0].length;a<f;a++)r=this.faceVertexUvs[0][a],e=r[0].x,t=r[1].x,l=r[2].x,c=Math.max(e,Math.max(t,l)),h=Math.min(e,Math.min(t,l)),.9<c&&.1>h&&(.2>e&&(r[0].x+=1),.2>t&&(r[1].x+=1),.2>l&&(r[2].x+=1));a=0;for(f=this.vertices.length;a<f;a++)this.vertices[a].multiplyScalar(n);this.mergeVertices(),this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,n)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.IcosahedronGeometry=function(e,t){this.radius=e,this.detail=t;var n=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[[-1,n,0],[1,n,0],[-1,-n,0],[1,-n,0],[0,-1,n],[0,1,n],[0,-1,-n],[0,1,-n],[n,0,-1],[n,0,1],[-n,0,-1],[-n,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],e,t)},THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.OctahedronGeometry=function(e,t){THREE.PolyhedronGeometry.call(this,[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]],e,t)},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TetrahedronGeometry=function(e,t){THREE.PolyhedronGeometry.call(this,[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],[[2,1,0],[0,3,2],[1,3,0],[2,3,1]],e,t)},THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ParametricGeometry=function(e,t,n){THREE.Geometry.call(this);var r=this.vertices,i=this.faces,s=this.faceVertexUvs[0],o,u,a,f,l=t+1;for(o=0;o<=n;o++){f=o/n;for(u=0;u<=t;u++)a=u/t,a=e(a,f),r.push(a)}var c,h,p,d;for(o=0;o<n;o++)for(u=0;u<t;u++)e=o*l+u,r=o*l+u+1,f=(o+1)*l+u+1,a=(o+1)*l+u,c=new THREE.Vector2(u/t,o/n),h=new THREE.Vector2((u+1)/t,o/n),p=new THREE.Vector2((u+1)/t,(o+1)/n),d=new THREE.Vector2(u/t,(o+1)/n),i.push(new THREE.Face3(e,r,a)),s.push([c,h,d]),i.push(new THREE.Face3(r,f,a)),s.push([h.clone(),p,d.clone()]);this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.AxisHelper=function(e){var e=e||1,t=new THREE.Geometry;t.vertices.push(new THREE.Vector3,new THREE.Vector3(e,0,0),new THREE.Vector3,new THREE.Vector3(0,e,0),new THREE.Vector3,new THREE.Vector3(0,0,e)),t.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775)),e=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors}),THREE.Line.call(this,t,e,THREE.LinePieces)},THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype),THREE.ArrowHelper=function(e,t,n,r,i,s){THREE.Object3D.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),void 0===i&&(i=.2*n),void 0===s&&(s=.2*i),this.position=t,t=new THREE.Geometry,t.vertices.push(new THREE.Vector3(0,0,0)),t.vertices.push(new THREE.Vector3(0,1,0)),this.line=new THREE.Line(t,new THREE.LineBasicMaterial({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),t=new THREE.CylinderGeometry(0,.5,1,5,1),t.applyMatrix((new THREE.Matrix4).makeTranslation(0,-0.5,0)),this.cone=new THREE.Mesh(t,new THREE.MeshBasicMaterial({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,s)},THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.ArrowHelper.prototype.setDirection=function(){var e=new THREE.Vector3,t;return function(n){.99999<n.y?this.quaternion.set(0,0,0,1):-0.99999>n.y?this.quaternion.set(1,0,0,0):(e.set(n.z,0,-n.x).normalize(),t=Math.acos(n.y),this.quaternion.setFromAxisAngle(e,t))}}(),THREE.ArrowHelper.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,e,1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},THREE.ArrowHelper.prototype.setColor=function(e){this.line.material.color.setHex(e),this.cone.material.color.setHex(e)},THREE.BoxHelper=function(e){var t=[new THREE.Vector3(1,1,1),new THREE.Vector3(-1,1,1),new THREE.Vector3(-1,-1,1),new THREE.Vector3(1,-1,1),new THREE.Vector3(1,1,-1),new THREE.Vector3(-1,1,-1),new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,-1,-1)];this.vertices=t;var n=new THREE.Geometry;n.vertices.push(t[0],t[1],t[1],t[2],t[2],t[3],t[3],t[0],t[4],t[5],t[5],t[6],t[6],t[7],t[7],t[4],t[0],t[4],t[1],t[5],t[2],t[6],t[3],t[7]),THREE.Line.call(this,n,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces),void 0!==e&&this.update(e)},THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype),THREE.BoxHelper.prototype.update=function(e){var t=e.geometry;null===t.boundingBox&&t.computeBoundingBox();var n=t.boundingBox.min,t=t.boundingBox.max,r=this.vertices;r[0].set(t.x,t.y,t.z),r[1].set(n.x,t.y,t.z),r[2].set(n.x,n.y,t.z),r[3].set(t.x,n.y,t.z),r[4].set(t.x,t.y,n.z),r[5].set(n.x,t.y,n.z),r[6].set(n.x,n.y,n.z),r[7].set(t.x,n.y,n.z),this.geometry.computeBoundingSphere(),this.geometry.verticesNeedUpdate=!0,this.matrixAutoUpdate=!1,this.matrixWorld=e.matrixWorld},THREE.BoundingBoxHelper=function(e,t){var n=void 0!==t?t:8947848;this.object=e,this.box=new THREE.Box3,THREE.Mesh.call(this,new THREE.CubeGeometry(1,1,1),new THREE.MeshBasicMaterial({color:n,wireframe:!0}))},THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},THREE.CameraHelper=function(e){function t(e,t,r){n(e,r),n(t,r)}function n(e,t){r.vertices.push(new THREE.Vector3),r.colors.push(new THREE.Color(t)),void 0===s[e]&&(s[e]=[]),s[e].push(r.vertices.length-1)}var r=new THREE.Geometry,i=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),s={};t("n1","n2",16755200),t("n2","n4",16755200),t("n4","n3",16755200),t("n3","n1",16755200),t("f1","f2",16755200),t("f2","f4",16755200),t("f4","f3",16755200),t("f3","f1",16755200),t("n1","f1",16755200),t("n2","f2",16755200),t("n3","f3",16755200),t("n4","f4",16755200),t("p","n1",16711680),t("p","n2",16711680),t("p","n3",16711680),t("p","n4",16711680),t("u1","u2",43775),t("u2","u3",43775),t("u3","u1",43775),t("c","t",16777215),t("p","c",3355443),t("cn1","cn2",3355443),t("cn3","cn4",3355443),t("cf1","cf2",3355443),t("cf3","cf4",3355443),THREE.Line.call(this,r,i,THREE.LinePieces),this.camera=e,this.matrixWorld=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()},THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype),THREE.CameraHelper.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Camera,n=new THREE.Projector;return function(){function r(r,s,o,u){e.set(s,o,u),n.unprojectVector(e,t),r=i.pointMap[r];if(void 0!==r){s=0;for(o=r.length;s<o;s++)i.geometry.vertices[r[s]].copy(e)}}var i=this;t.projectionMatrix.copy(this.camera.projectionMatrix),r("c",0,0,-1),r("t",0,0,1),r("n1",-1,-1,-1),r("n2",1,-1,-1),r("n3",-1,1,-1),r("n4",1,1,-1),r("f1",-1,-1,1),r("f2",1,-1,1),r("f3",-1,1,1),r("f4",1,1,1),r("u1",.7,1.1,-1),r("u2",-0.7,1.1,-1),r("u3",0,2,-1),r("cf1",-1,0,1),r("cf2",1,0,1),r("cf3",0,-1,1),r("cf4",0,1,1),r("cn1",-1,0,-1),r("cn2",1,0,-1),r("cn3",0,-1,-1),r("cn4",0,1,-1),this.geometry.verticesNeedUpdate=!0}}(),THREE.DirectionalLightHelper=function(e,t){THREE.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrixWorld=e.matrixWorld,this.matrixAutoUpdate=!1;var t=t||1,n=new THREE.PlaneGeometry(t,t),r=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});r.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new THREE.Mesh(n,r),this.add(this.lightPlane),n=new THREE.Geometry,n.vertices.push(new THREE.Vector3),n.vertices.push(new THREE.Vector3),r=new THREE.LineBasicMaterial({fog:!1}),r.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new THREE.Line(n,r),this.add(this.targetLine),this.update()},THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},THREE.DirectionalLightHelper.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(t,e),this.lightPlane.lookAt(n),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(n),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),THREE.EdgesHelper=function(e,t){var n=void 0!==t?t:16777215,r=[0,0],i={},s=function(e,t){return e-t},o=["a","b","c"],u=new THREE.BufferGeometry,a=e.geometry.clone();a.mergeVertices(),a.computeFaceNormals();for(var f=a.vertices,a=a.faces,l=0,c=0,h=a.length;c<h;c++)for(var p=a[c],d=0;3>d;d++){r[0]=p[o[d]],r[1]=p[o[(d+1)%3]],r.sort(s);var v=r.toString();void 0===i[v]?(i[v]={vert1:r[0],vert2:r[1],face1:c,face2:void 0},l++):i[v].face2=c}u.addAttribute("position",Float32Array,2*l,3),r=u.attributes.position.array,s=0;for(v in i)if(o=i[v],void 0===o.face2||.9999>a[o.face1].normal.dot(a[o.face2].normal))l=f[o.vert1],r[s++]=l.x,r[s++]=l.y,r[s++]=l.z,l=f[o.vert2],r[s++]=l.x,r[s++]=l.y,r[s++]=l.z;THREE.Line.call(this,u,new THREE.LineBasicMaterial({color:n}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.matrixWorld=e.matrixWorld},THREE.EdgesHelper.prototype=Object.create(THREE.Line.prototype),THREE.FaceNormalsHelper=function(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;for(var e=void 0!==n?n:16776960,r=void 0!==r?r:1,t=new THREE.Geometry,n=0,i=this.object.geometry.faces.length;n<i;n++)t.vertices.push(new THREE.Vector3),t.vertices.push(new THREE.Vector3);THREE.Line.call(this,t,new THREE.LineBasicMaterial({color:e,linewidth:r}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new THREE.Matrix3,this.update()},THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype),THREE.FaceNormalsHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var t=this.geometry.vertices,n=this.object.geometry.faces,r=this.object.matrixWorld,i=0,s=n.length;i<s;i++){var o=n[i];e.copy(o.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);var u=2*i;t[u].copy(o.centroid).applyMatrix4(r),t[u+1].addVectors(t[u],e)}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.GridHelper=function(e,t){var n=new THREE.Geometry,r=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924),this.color2=new THREE.Color(8947848);for(var i=-e;i<=e;i+=t){n.vertices.push(new THREE.Vector3(-e,0,i),new THREE.Vector3(e,0,i),new THREE.Vector3(i,0,-e),new THREE.Vector3(i,0,e));var s=0===i?this.color1:this.color2;n.colors.push(s,s,s,s)}THREE.Line.call(this,n,r,THREE.LinePieces)},THREE.GridHelper.prototype=Object.create(THREE.Line.prototype),THREE.GridHelper.prototype.setColors=function(e,t){this.color1.set(e),this.color2.set(t),this.geometry.colorsNeedUpdate=!0},THREE.HemisphereLightHelper=function(e,t){THREE.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrixWorld=e.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new THREE.Color,new THREE.Color];var n=new THREE.SphereGeometry(t,4,2);n.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var r=0;8>r;r++)n.faces[r].color=this.colors[4>r?0:1];r=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0}),this.lightSphere=new THREE.Mesh(n,r),this.add(this.lightSphere),this.update()},THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},THREE.HemisphereLightHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),THREE.PointLightHelper=function(e,t){this.light=e,this.light.updateMatrixWorld();var n=new THREE.SphereGeometry(t,4,2),r=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});r.color.copy(this.light.color).multiplyScalar(this.light.intensity),THREE.Mesh.call(this,n,r),this.matrixWorld=this.light.matrixWorld,this.matrixAutoUpdate=!1},THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.SpotLightHelper=function(e){THREE.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrixWorld=e.matrixWorld,this.matrixAutoUpdate=!1,e=new THREE.CylinderGeometry(0,1,1,8,1,!0),e.applyMatrix((new THREE.Matrix4).makeTranslation(0,-0.5,0)),e.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var t=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(e,t),this.add(this.cone),this.update()},THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},THREE.SpotLightHelper.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(){var n=this.light.distance?this.light.distance:1e4,r=n*Math.tan(this.light.angle);this.cone.scale.set(r,r,n),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),THREE.VertexNormalsHelper=function(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;for(var t=void 0!==n?n:16711680,r=void 0!==r?r:1,n=new THREE.Geometry,e=e.geometry.faces,i=0,s=e.length;i<s;i++)for(var o=0,u=e[i].vertexNormals.length;o<u;o++)n.vertices.push(new THREE.Vector3),n.vertices.push(new THREE.Vector3);THREE.Line.call(this,n,new THREE.LineBasicMaterial({color:t,linewidth:r}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new THREE.Matrix3,this.update()},THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype),THREE.VertexNormalsHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){var t=["a","b","c","d"];this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var n=this.geometry.vertices,r=this.object.geometry.vertices,i=this.object.geometry.faces,s=this.object.matrixWorld,o=0,u=0,f=i.length;u<f;u++)for(var l=i[u],c=0,h=l.vertexNormals.length;c<h;c++){var p=l.vertexNormals[c];n[o].copy(r[l[t[c]]]).applyMatrix4(s),e.copy(p).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size),e.add(n[o]),o+=1,n[o].copy(e),o+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.VertexTangentsHelper=function(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;for(var t=void 0!==n?n:255,r=void 0!==r?r:1,n=new THREE.Geometry,e=e.geometry.faces,i=0,s=e.length;i<s;i++)for(var o=0,u=e[i].vertexTangents.length;o<u;o++)n.vertices.push(new THREE.Vector3),n.vertices.push(new THREE.Vector3);THREE.Line.call(this,n,new THREE.LineBasicMaterial({color:t,linewidth:r}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.update()},THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype),THREE.VertexTangentsHelper.prototype.update=function(){var e=new THREE.Vector3;return function(){var t=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var n=this.geometry.vertices,r=this.object.geometry.vertices,i=this.object.geometry.faces,s=this.object.matrixWorld,o=0,u=0,f=i.length;u<f;u++)for(var l=i[u],c=0,h=l.vertexTangents.length;c<h;c++){var p=l.vertexTangents[c];n[o].copy(r[l[t[c]]]).applyMatrix4(s),e.copy(p).transformDirection(s).multiplyScalar(this.size),e.add(n[o]),o+=1,n[o].copy(e),o+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.WireframeHelper=function(e,t){var n=void 0!==t?t:16777215,r=[0,0],i={},s=function(e,t){return e-t},o=["a","b","c"],u=new THREE.BufferGeometry;if(e.geometry instanceof THREE.Geometry){for(var a=e.geometry.vertices,f=e.geometry.faces,l=0,c=new Uint32Array(6*f.length),h=0,p=f.length;h<p;h++)for(var d=f[h],v=0;3>v;v++){r[0]=d[o[v]],r[1]=d[o[(v+1)%3]],r.sort(s);var m=r.toString();void 0===i[m]&&(c[2*l]=r[0],c[2*l+1]=r[1],i[m]=!0,l++)}u.addAttribute("position",Float32Array,2*l,3),r=u.attributes.position.array,h=0;for(p=l;h<p;h++)for(v=0;2>v;v++)l=a[c[2*h+v]],o=6*h+3*v,r[o+0]=l.x,r[o+1]=l.y,r[o+2]=l.z}else if(e.geometry instanceof THREE.BufferGeometry&&void 0!==e.geometry.attributes.index){for(var a=e.geometry.attributes.position.array,p=e.geometry.attributes.index.array,f=e.geometry.offsets,l=0,c=new Uint32Array(2*p.length),d=0,g=f.length;d<g;++d)for(var v=f[d].start,m=f[d].count,o=f[d].index,h=v,y=v+m;h<y;h+=3)for(v=0;3>v;v++)r[0]=o+p[h+v],r[1]=o+p[h+(v+1)%3],r.sort(s),m=r.toString(),void 0===i[m]&&(c[2*l]=r[0],c[2*l+1]=r[1],i[m]=!0,l++);u.addAttribute("position",Float32Array,2*l,3),r=u.attributes.position.array,h=0;for(p=l;h<p;h++)for(v=0;2>v;v++)o=6*h+3*v,l=3*c[2*h+v],r[o+0]=a[l],r[o+1]=a[l+1],r[o+2]=a[l+2]}else if(e.geometry instanceof THREE.BufferGeometry){a=e.geometry.attributes.position.array,l=a.length/3,c=l/3,u.addAttribute("position",Float32Array,2*l,3),r=u.attributes.position.array,h=0;for(p=c;h<p;h++)for(v=0;3>v;v++)o=18*h+6*v,c=9*h+3*v,r[o+0]=a[c],r[o+1]=a[c+1],r[o+2]=a[c+2],l=9*h+3*((v+1)%3),r[o+3]=a[l],r[o+4]=a[l+1],r[o+5]=a[l+2]}THREE.Line.call(this,u,new THREE.LineBasicMaterial({color:n}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.matrixWorld=e.matrixWorld},THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype),THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this),this.render=function(){}},THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare=function(e,t,n,r,i){THREE.Object3D.call(this),this.lensFlares=[],this.positionScreen=new THREE.Vector3,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,n,r,i)},THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare.prototype.add=function(e,t,n,r,i,s){void 0===t&&(t=-1),void 0===n&&(n=0),void 0===s&&(s=1),void 0===i&&(i=new THREE.Color(16777215)),void 0===r&&(r=THREE.NormalBlending),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:e,size:t,distance:n,x:0,y:0,z:0,scale:1,rotation:1,opacity:s,color:i,blending:r})},THREE.LensFlare.prototype.updateLensFlares=function(){var e,t=this.lensFlares.length,n,r=2*-this.positionScreen.x,i=2*-this.positionScreen.y;for(e=0;e<t;e++)n=this.lensFlares[e],n.x=this.positionScreen.x+r*n.distance,n.y=this.positionScreen.y+i*n.distance,n.wantedRotation=.25*n.x*Math.PI,n.rotation+=.25*(n.wantedRotation-n.rotation)},THREE.MorphBlendMesh=function(e,t){THREE.Mesh.call(this,e,t),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length;this.createAnimation("__default",0,n-1,n/1),this.setAnimationWeight("__default",1)},THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.createAnimation=function(e,t,n,r){t={startFrame:t,endFrame:n,length:n-t+1,fps:r,duration:(n-t)/r,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1},this.animationsMap[e]=t,this.animationsList.push(t)},THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(e){for(var t=/([a-z]+)(\d+)/,n,r={},i=this.geometry,s=0,o=i.morphTargets.length;s<o;s++){var u=i.morphTargets[s].name.match(t);if(u&&1<u.length){var a=u[1];r[a]||(r[a]={start:Infinity,end:-Infinity}),u=r[a],s<u.start&&(u.start=s),s>u.end&&(u.end=s),n||(n=a)}}for(a in r)u=r[a],this.createAnimation(a,u.start,u.end,e);this.firstAnimation=n},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){if(e=this.animationsMap[e])e.direction=1,e.directionBackwards=!1},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){if(e=this.animationsMap[e])e.direction=-1,e.directionBackwards=!0},THREE.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var n=this.animationsMap[e];n&&(n.fps=t,n.duration=(n.end-n.start)/n.fps)},THREE.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var n=this.animationsMap[e];n&&(n.duration=t,n.fps=(n.end-n.start)/n.duration)},THREE.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var n=this.animationsMap[e];n&&(n.weight=t)},THREE.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var n=this.animationsMap[e];n&&(n.time=t)},THREE.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0;if(e=this.animationsMap[e])t=e.time;return t},THREE.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1;if(e=this.animationsMap[e])t=e.duration;return t},THREE.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("animation["+e+"] undefined")},THREE.MorphBlendMesh.prototype.stopAnimation=function(e){if(e=this.animationsMap[e])e.active=!1},THREE.MorphBlendMesh.prototype.update=function(e){for(var t=0,n=this.animationsList.length;t<n;t++){var r=this.animationsList[t];if(r.active){var i=r.duration/r.length;r.time+=r.direction*e;if(r.mirroredLoop){if(r.time>r.duration||0>r.time)r.direction*=-1,r.time>r.duration&&(r.time=r.duration,r.directionBackwards=!0),0>r.time&&(r.time=0,r.directionBackwards=!1)}else r.time%=r.duration,0>r.time&&(r.time+=r.duration);var s=r.startFrame+THREE.Math.clamp(Math.floor(r.time/i),0,r.length-1),o=r.weight;s!==r.currentFrame&&(this.morphTargetInfluences[r.lastFrame]=0,this.morphTargetInfluences[r.currentFrame]=1*o,this.morphTargetInfluences[s]=0,r.lastFrame=r.currentFrame,r.currentFrame=s),i=r.time%i/i,r.directionBackwards&&(i=1-i),this.morphTargetInfluences[r.currentFrame]=i*o,this.morphTargetInfluences[r.lastFrame]=(1-i)*o}}},THREE.LensFlarePlugin=function(){function e(e,n){var r=t.createProgram(),i=t.createShader(t.FRAGMENT_SHADER),s=t.createShader(t.VERTEX_SHADER),o="precision "+n+" float;\n";return t.shaderSource(i,o+e.fragmentShader),t.shaderSource(s,o+e.vertexShader),t.compileShader(i),t.compileShader(s),t.attachShader(r,i),t.attachShader(r,s),t.linkProgram(r),r}var t,n,r,i,s,o,u,a,f,l,c,h,p;this.init=function(v){t=v.context,n=v,r=v.getPrecision(),i=new Float32Array(16),s=new Uint16Array(6),v=0,i[v++]=-1,i[v++]=-1,i[v++]=0,i[v++]=0,i[v++]=1,i[v++]=-1,i[v++]=1,i[v++]=0,i[v++]=1,i[v++]=1,i[v++]=1,i[v++]=1,i[v++]=-1,i[v++]=1,i[v++]=0,i[v++]=1,v=0,s[v++]=0,s[v++]=1,s[v++]=2,s[v++]=0,s[v++]=2,s[v++]=3,o=t.createBuffer(),u=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u),t.bufferData(t.ELEMENT_ARRAY_BUFFER,s,t.STATIC_DRAW),a=t.createTexture(),f=t.createTexture(),t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,t.RGB,16,16,0,t.RGB,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.bindTexture(t.TEXTURE_2D,f),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,16,16,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),0>=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(l=!1,c=e(THREE.ShaderFlares.lensFlare,r)):(l=!0,c=e(THREE.ShaderFlares.lensFlareVertexTexture,r)),h={},p={},h.vertex=t.getAttribLocation(c,"position"),h.uv=t.getAttribLocation(c,"uv"),p.renderType=t.getUniformLocation(c,"renderType"),p.map=t.getUniformLocation(c,"map"),p.occlusionMap=t.getUniformLocation(c,"occlusionMap"),p.opacity=t.getUniformLocation(c,"opacity"),p.color=t.getUniformLocation(c,"color"),p.scale=t.getUniformLocation(c,"scale"),p.rotation=t.getUniformLocation(c,"rotation"),p.screenPosition=t.getUniformLocation(c,"screenPosition")},this.render=function(e,r,i,s){var e=e.__webglFlares,d=e.length;if(d){var v=new THREE.Vector3,m=s/i,y=.5*i,w=.5*s,E=16/s,S=new THREE.Vector2(E*m,E),x=new THREE.Vector3(1,1,0),T=new THREE.Vector2(1,1),N=p,E=h;t.useProgram(c),t.enableVertexAttribArray(h.vertex),t.enableVertexAttribArray(h.uv),t.uniform1i(N.occlusionMap,0),t.uniform1i(N.map,1),t.bindBuffer(t.ARRAY_BUFFER,o),t.vertexAttribPointer(E.vertex,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(E.uv,2,t.FLOAT,!1,16,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u),t.disable(t.CULL_FACE),t.depthMask(!1);var C,L,A,O,M;for(C=0;C<d;C++)if(E=16/s,S.set(E*m,E),O=e[C],v.set(O.matrixWorld.elements[12],O.matrixWorld.elements[13],O.matrixWorld.elements[14]),v.applyMatrix4(r.matrixWorldInverse),v.applyProjection(r.projectionMatrix),x.copy(v),T.x=x.x*y+y,T.y=x.y*w+w,l||0<T.x&&T.x<i&&0<T.y&&T.y<s){t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,a),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGB,T.x-8,T.y-8,16,16,0),t.uniform1i(N.renderType,0),t.uniform2f(N.scale,S.x,S.y),t.uniform3f(N.screenPosition,x.x,x.y,x.z),t.disable(t.BLEND),t.enable(t.DEPTH_TEST),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,f),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,T.x-8,T.y-8,16,16,0),t.uniform1i(N.renderType,1),t.disable(t.DEPTH_TEST),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,a),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),O.positionScreen.copy(x),O.customUpdateCallback?O.customUpdateCallback(O):O.updateLensFlares(),t.uniform1i(N.renderType,2),t.enable(t.BLEND),L=0;for(A=O.lensFlares.length;L<A;L++)M=O.lensFlares[L],.001<M.opacity&&.001<M.scale&&(x.x=M.x,x.y=M.y,x.z=M.z,E=M.size*M.scale/s,S.x=E*m,S.y=E,t.uniform3f(N.screenPosition,x.x,x.y,x.z),t.uniform2f(N.scale,S.x,S.y),t.uniform1f(N.rotation,M.rotation),t.uniform1f(N.opacity,M.opacity),t.uniform3f(N.color,M.color.r,M.color.g,M.color.b),n.setBlending(M.blending,M.blendEquation,M.blendSrc,M.blendDst),n.setTexture(M.texture,1),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),t.depthMask(!0)}}},THREE.ShadowMapPlugin=function(){var e,t,n,r,i,s,o=new THREE.Frustum,u=new THREE.Matrix4,a=new THREE.Vector3,f=new THREE.Vector3,l=new THREE.Vector3;this.init=function(o){e=o.context,t=o;var o=THREE.ShaderLib.depthRGBA,u=THREE.UniformsUtils.clone(o.uniforms);n=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u}),r=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u,morphTargets:!0}),i=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u,skinning:!0}),s=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u,morphTargets:!0,skinning:!0}),n._shadowPass=!0,r._shadowPass=!0,i._shadowPass=!0,s._shadowPass=!0},this.render=function(e,n){t.shadowMapEnabled&&t.shadowMapAutoUpdate&&this.update(e,n)},this.update=function(p,v){var m,y,w,E,S,x,T,N,C,L=[];E=0,e.clearColor(1,1,1,1),e.disable(e.BLEND),e.enable(e.CULL_FACE),e.frontFace(e.CCW),t.shadowMapCullFace===THREE.CullFaceFront?e.cullFace(e.FRONT):e.cullFace(e.BACK),t.setDepthTest(!0),m=0;for(y=p.__lights.length;m<y;m++)if(w=p.__lights[m],w.castShadow)if(w instanceof THREE.DirectionalLight&&w.shadowCascade)for(S=0;S<w.shadowCascadeCount;S++){var A;if(w.shadowCascadeArray[S])A=w.shadowCascadeArray[S];else{C=w,T=S,A=new THREE.DirectionalLight,A.isVirtual=!0,A.onlyShadow=!0,A.castShadow=!0,A.shadowCameraNear=C.shadowCameraNear,A.shadowCameraFar=C.shadowCameraFar,A.shadowCameraLeft=C.shadowCameraLeft,A.shadowCameraRight=C.shadowCameraRight,A.shadowCameraBottom=C.shadowCameraBottom,A.shadowCameraTop=C.shadowCameraTop,A.shadowCameraVisible=C.shadowCameraVisible,A.shadowDarkness=C.shadowDarkness,A.shadowBias=C.shadowCascadeBias[T],A.shadowMapWidth=C.shadowCascadeWidth[T],A.shadowMapHeight=C.shadowCascadeHeight[T],A.pointsWorld=[],A.pointsFrustum=[],N=A.pointsWorld,x=A.pointsFrustum;for(var O=0;8>O;O++)N[O]=new THREE.Vector3,x[O]=new THREE.Vector3;N=C.shadowCascadeNearZ[T],C=C.shadowCascadeFarZ[T],x[0].set(-1,-1,N),x[1].set(1,-1,N),x[2].set(-1,1,N),x[3].set(1,1,N),x[4].set(-1,-1,C),x[5].set(1,-1,C),x[6].set(-1,1,C),x[7].set(1,1,C),A.originalCamera=v,x=new THREE.Gyroscope,x.position=w.shadowCascadeOffset,x.add(A),x.add(A.target),v.add(x),w.shadowCascadeArray[S]=A,console.log("Created virtualLight",A)}T=w,N=S,C=T.shadowCascadeArray[N],C.position.copy(T.position),C.target.position.copy(T.target.position),C.lookAt(C.target),C.shadowCameraVisible=T.shadowCameraVisible,C.shadowDarkness=T.shadowDarkness,C.shadowBias=T.shadowCascadeBias[N],x=T.shadowCascadeNearZ[N],T=T.shadowCascadeFarZ[N],C=C.pointsFrustum,C[0].z=x,C[1].z=x,C[2].z=x,C[3].z=x,C[4].z=T,C[5].z=T,C[6].z=T,C[7].z=T,L[E]=A,E++}else L[E]=w,E++;m=0;for(y=L.length;m<y;m++){w=L[m],w.shadowMap||(S=THREE.LinearFilter,t.shadowMapType===THREE.PCFSoftShadowMap&&(S=THREE.NearestFilter),w.shadowMap=new THREE.WebGLRenderTarget(w.shadowMapWidth,w.shadowMapHeight,{minFilter:S,magFilter:S,format:THREE.RGBAFormat}),w.shadowMapSize=new THREE.Vector2(w.shadowMapWidth,w.shadowMapHeight),w.shadowMatrix=new THREE.Matrix4);if(!w.shadowCamera){if(w instanceof THREE.SpotLight)w.shadowCamera=new THREE.PerspectiveCamera(w.shadowCameraFov,w.shadowMapWidth/w.shadowMapHeight,w.shadowCameraNear,w.shadowCameraFar);else{if(!(w instanceof THREE.DirectionalLight)){console.error("Unsupported light type for shadow");continue}w.shadowCamera=new THREE.OrthographicCamera(w.shadowCameraLeft,w.shadowCameraRight,w.shadowCameraTop,w.shadowCameraBottom,w.shadowCameraNear,w.shadowCameraFar)}p.add(w.shadowCamera),!0===p.autoUpdate&&p.updateMatrixWorld()}w.shadowCameraVisible&&!w.cameraHelper&&(w.cameraHelper=new THREE.CameraHelper(w.shadowCamera),w.shadowCamera.add(w.cameraHelper));if(w.isVirtual&&A.originalCamera==v){S=v,E=w.shadowCamera,x=w.pointsFrustum,C=w.pointsWorld,a.set(Infinity,Infinity,Infinity),f.set(-Infinity,-Infinity,-Infinity);for(T=0;8>T;T++)N=C[T],N.copy(x[T]),THREE.ShadowMapPlugin.__projector.unprojectVector(N,S),N.applyMatrix4(E.matrixWorldInverse),N.x<a.x&&(a.x=N.x),N.x>f.x&&(f.x=N.x),N.y<a.y&&(a.y=N.y),N.y>f.y&&(f.y=N.y),N.z<a.z&&(a.z=N.z),N.z>f.z&&(f.z=N.z);E.left=a.x,E.right=f.x,E.top=f.y,E.bottom=a.y,E.updateProjectionMatrix()}E=w.shadowMap,x=w.shadowMatrix,S=w.shadowCamera,S.position.setFromMatrixPosition(w.matrixWorld),l.setFromMatrixPosition(w.target.matrixWorld),S.lookAt(l),S.updateMatrixWorld(),S.matrixWorldInverse.getInverse(S.matrixWorld),w.cameraHelper&&(w.cameraHelper.visible=w.shadowCameraVisible),w.shadowCameraVisible&&w.cameraHelper.update(),x.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),x.multiply(S.projectionMatrix),x.multiply(S.matrixWorldInverse),u.multiplyMatrices(S.projectionMatrix,S.matrixWorldInverse),o.setFromMatrix(u),t.setRenderTarget(E),t.clear(),C=p.__webglObjects,w=0;for(E=C.length;w<E;w++)if(T=C[w],x=T.object,T.render=!1,x.visible&&x.castShadow&&(!(x instanceof THREE.Mesh||x instanceof THREE.ParticleSystem)||!x.frustumCulled||o.intersectsObject(x)))x._modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,x.matrixWorld),T.render=!0;w=0;for(E=C.length;w<E;w++)T=C[w],T.render&&(x=T.object,T=T.buffer,O=x.material instanceof THREE.MeshFaceMaterial?x.material.materials[0]:x.material,N=0<x.geometry.morphTargets.length&&O.morphTargets,O=x instanceof THREE.SkinnedMesh&&O.skinning,N=x.customDepthMaterial?x.customDepthMaterial:O?N?s:i:N?r:n,T instanceof THREE.BufferGeometry?t.renderBufferDirect(S,p.__lights,null,N,T,x):t.renderBuffer(S,p.__lights,null,N,T,x));C=p.__webglObjectsImmediate,w=0;for(E=C.length;w<E;w++)T=C[w],x=T.object,x.visible&&x.castShadow&&(x._modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,x.matrixWorld),t.renderImmediateObject(S,p.__lights,null,n,x))}m=t.getClearColor(),y=t.getClearAlpha(),e.clearColor(m.r,m.g,m.b,y),e.enable(e.BLEND),t.shadowMapCullFace===THREE.CullFaceFront&&e.cullFace(e.BACK)}},THREE.ShadowMapPlugin.__projector=new THREE.Projector,THREE.SpritePlugin=function(){function g(e,t){return e.z!==t.z?t.z-e.z:t.id-e.id}var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,y,b,w,E,S,x,T,N;this.init=function(g){y=g.context,b=g,E=new Float32Array([-0.5,-0.5,0,0,.5,-0.5,1,0,.5,.5,1,1,-0.5,.5,0,1]),S=new Uint16Array([0,1,2,0,2,3]),x=y.createBuffer(),T=y.createBuffer(),y.bindBuffer(y.ARRAY_BUFFER,x),y.bufferData(y.ARRAY_BUFFER,E,y.STATIC_DRAW),y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,T),y.bufferData(y.ELEMENT_ARRAY_BUFFER,S,y.STATIC_DRAW);var g=y.createProgram(),L=y.createShader(y.VERTEX_SHADER),A=y.createShader(y.FRAGMENT_SHADER);y.shaderSource(L,["precision "+b.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n")),y.shaderSource(A,["precision "+b.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n")),y.compileShader(L),y.compileShader(A),y.attachShader(g,L),y.attachShader(g,A),y.linkProgram(g),N=g,v=y.getAttribLocation(N,"position"),m=y.getAttribLocation(N,"uv"),e=y.getUniformLocation(N,"uvOffset"),t=y.getUniformLocation(N,"uvScale"),n=y.getUniformLocation(N,"rotation"),r=y.getUniformLocation(N,"scale"),i=y.getUniformLocation(N,"color"),s=y.getUniformLocation(N,"map"),o=y.getUniformLocation(N,"opacity"),u=y.getUniformLocation(N,"modelViewMatrix"),a=y.getUniformLocation(N,"projectionMatrix"),f=y.getUniformLocation(N,"fogType"),l=y.getUniformLocation(N,"fogDensity"),c=y.getUniformLocation(N,"fogNear"),h=y.getUniformLocation(N,"fogFar"),p=y.getUniformLocation(N,"fogColor"),d=y.getUniformLocation(N,"alphaTest"),g=document.createElement("canvas"),g.width=8,g.height=8,L=g.getContext("2d"),L.fillStyle="#ffffff",L.fillRect(0,0,g.width,g.height),w=new THREE.Texture(g),w.needsUpdate=!0},this.render=function(E,S){var L=E.__webglSprites,A=L.length;if(A){y.useProgram(N),y.enableVertexAttribArray(v),y.enableVertexAttribArray(m),y.disable(y.CULL_FACE),y.enable(y.BLEND),y.bindBuffer(y.ARRAY_BUFFER,x),y.vertexAttribPointer(v,2,y.FLOAT,!1,16,0),y.vertexAttribPointer(m,2,y.FLOAT,!1,16,8),y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,T),y.uniformMatrix4fv(a,!1,S.projectionMatrix.elements),y.activeTexture(y.TEXTURE0),y.uniform1i(s,0);var O=0,M=0,_=E.fog;_?(y.uniform3f(p,_.color.r,_.color.g,_.color.b),_ instanceof THREE.Fog?(y.uniform1f(c,_.near),y.uniform1f(h,_.far),y.uniform1i(f,1),M=O=1):_ instanceof THREE.FogExp2&&(y.uniform1f(l,_.density),y.uniform1i(f,2),M=O=2)):(y.uniform1i(f,0),M=O=0);for(var D,P,H=[],_=0;_<A;_++)D=L[_],!1!==D.visible&&(D._modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,D.matrixWorld),D.z=-D._modelViewMatrix.elements[14]);L.sort(g);for(_=0;_<A;_++)D=L[_],!1!==D.visible&&(P=D.material,y.uniform1f(d,P.alphaTest),y.uniformMatrix4fv(u,!1,D._modelViewMatrix.elements),H[0]=D.scale.x,H[1]=D.scale.y,D=E.fog&&P.fog?M:0,O!==D&&(y.uniform1i(f,D),O=D),null!==P.map?(y.uniform2f(e,P.map.offset.x,P.map.offset.y),y.uniform2f(t,P.map.repeat.x,P.map.repeat.y)):(y.uniform2f(e,0,0),y.uniform2f(t,1,1)),y.uniform1f(o,P.opacity),y.uniform3f(i,P.color.r,P.color.g,P.color.b),y.uniform1f(n,P.rotation),y.uniform2fv(r,H),b.setBlending(P.blending,P.blendEquation,P.blendSrc,P.blendDst),b.setDepthTest(P.depthTest),b.setDepthWrite(P.depthWrite),P.map&&P.map.image&&P.map.image.width?b.setTexture(P.map,0):b.setTexture(w,0),y.drawElements(y.TRIANGLES,6,y.UNSIGNED_SHORT,0));y.enable(y.CULL_FACE)}}},THREE.DepthPassPlugin=function(){this.enabled=!1,this.renderTarget=null;var e,t,n,r,i,s,o=new THREE.Frustum,u=new THREE.Matrix4;this.init=function(o){e=o.context,t=o;var o=THREE.ShaderLib.depthRGBA,u=THREE.UniformsUtils.clone(o.uniforms);n=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u}),r=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u,morphTargets:!0}),i=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u,skinning:!0}),s=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u,morphTargets:!0,skinning:!0}),n._shadowPass=!0,r._shadowPass=!0,i._shadowPass=!0,s._shadowPass=!0},this.render=function(e,t){this.enabled&&this.update(e,t)},this.update=function(l,p){var v,m,y,w,E,S;e.clearColor(1,1,1,1),e.disable(e.BLEND),t.setDepthTest(!0),!0===l.autoUpdate&&l.updateMatrixWorld(),p.matrixWorldInverse.getInverse(p.matrixWorld),u.multiplyMatrices(p.projectionMatrix,p.matrixWorldInverse),o.setFromMatrix(u),t.setRenderTarget(this.renderTarget),t.clear(),S=l.__webglObjects,v=0;for(m=S.length;v<m;v++)if(y=S[v],E=y.object,y.render=!1,E.visible&&(!(E instanceof THREE.Mesh||E instanceof THREE.ParticleSystem)||!E.frustumCulled||o.intersectsObject(E)))E._modelViewMatrix.multiplyMatrices(p.matrixWorldInverse,E.matrixWorld),y.render=!0;var x;v=0;for(m=S.length;v<m;v++)if(y=S[v],y.render&&(E=y.object,y=y.buffer,!(E instanceof THREE.ParticleSystem)||E.customDepthMaterial))(x=E.material instanceof THREE.MeshFaceMaterial?E.material.materials[0]:E.material)&&t.setMaterialFaces(E.material),w=0<E.geometry.morphTargets.length&&x.morphTargets,x=E instanceof THREE.SkinnedMesh&&x.skinning,w=E.customDepthMaterial?E.customDepthMaterial:x?w?s:i:w?r:n,y instanceof THREE.BufferGeometry?t.renderBufferDirect(p,l.__lights,null,w,y,E):t.renderBuffer(p,l.__lights,null,w,y,E);S=l.__webglObjectsImmediate,v=0;for(m=S.length;v<m;v++)y=S[v],E=y.object,E.visible&&(E._modelViewMatrix.multiplyMatrices(p.matrixWorldInverse,E.matrixWorld),t.renderImmediateObject(p,l.__lights,null,n,E));v=t.getClearColor(),m=t.getClearAlpha(),e.clearColor(v.r,v.g,v.b,m),e.enable(e.BLEND)}},THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},lensFlare:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}},define("three",function(){});var THREEx=THREEx||{};THREEx.KeyboardState=function(){this.keyCodes={},this.modifiers={};var e=this;this._onKeyDown=function(t){e._onKeyChange(t,!0)},this._onKeyUp=function(t){e._onKeyChange(t,!1)},document.addEventListener("keydown",this._onKeyDown,!1),document.addEventListener("keyup",this._onKeyUp,!1)},THREEx.KeyboardState.prototype.destroy=function(){document.removeEventListener("keydown",this._onKeyDown,!1),document.removeEventListener("keyup",this._onKeyUp,!1)},THREEx.KeyboardState.MODIFIERS=["shift","ctrl","alt","meta"],THREEx.KeyboardState.ALIAS={left:37,up:38,right:39,down:40,space:32,pageup:33,pagedown:34,enter:13,tab:9,escape:27},THREEx.KeyboardState.prototype._onKeyChange=function(e,t){var n=e.keyCode;this.keyCodes[n]=t,this.modifiers.shift=e.shiftKey,this.modifiers.ctrl=e.ctrlKey,this.modifiers.alt=e.altKey,this.modifiers.meta=e.metaKey},THREEx.KeyboardState.prototype.pressed=function(e){var t=e.split("+");for(var n=0;n<t.length;n++){var r=t[n],i;THREEx.KeyboardState.MODIFIERS.indexOf(r)!==-1?i=this.modifiers[r]:Object.keys(THREEx.KeyboardState.ALIAS).indexOf(r)!=-1?i=this.keyCodes[THREEx.KeyboardState.ALIAS[r]]:i=this.keyCodes[r.toUpperCase().charCodeAt(0)];if(!i)return!1}return!0},define("vendor/THREEx.KeyboardState",function(){}),THREE.ColladaLoader=function(){function L(e,t,n){var i=0;if(document.implementation&&document.implementation.createDocument){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState==4){if(s.status==0||s.status==200)if(s.responseXML)r=t,A(s.responseXML,undefined,e);else if(s.responseText){r=t;var o=new DOMParser,u=o.parseFromString(s.responseText,"application/xml");A(u,undefined,e)}else console.error("ColladaLoader: Empty or non-existing file ("+e+")")}else s.readyState==3&&n&&(i==0&&(i=s.getResponseHeader("Content-Length")),n({total:i,loaded:s.responseText.length}))},s.open("GET",e,!0),s.send(null)}else alert("Don't know how to parse XML!")}function A(i,s,o){e=i,s=s||r;if(o!==undefined){var v=o.split("/");v.pop(),y=(v.length<1?".":v.join("/"))+"/"}M(),Kt(),u=_("library_images image",rt,"image"),c=_("library_materials material",St,"material"),h=_("library_effects effect",kt,"effect"),l=_("library_geometries geometry",pt,"geometry"),p=_("library_cameras camera",Dt,"camera"),d=_("library_lights light",Ht,"light"),f=_("library_controllers controller",it,"controller"),a=_("library_animations animation",At,"animation"),g=_("library_visual_scenes visual_scene",ut,"visual_scene"),b=[],E=[],n=D(),t=new THREE.Object3D;for(var w=0;w<n.nodes.length;w++)t.add(X(n.nodes[w]));t.scale.multiplyScalar(N),P();var S={scene:t,morphs:b,skins:E,animations:m,dae:{images:u,materials:c,cameras:p,lights:d,effects:h,geometries:l,controllers:f,animations:a,visualScenes:g,scene:n}};return s&&s(S),S}function O(e){x=e}function M(){var t=e.querySelectorAll("asset"),n=t[0];if(n&&n.childNodes)for(var r=0;r<n.childNodes.length;r++){var i=n.childNodes[r];switch(i.nodeName){case"unit":var s=i.getAttribute("meter");s&&(N=parseFloat(s));break;case"up_axis":C=i.textContent.charAt(0)}}}function _(t,n,r){var i=e.querySelectorAll(t),s={},o=0,u=i.length;for(var a=0;a<u;a++){var f=i[a],l=(new n).parse(f);if(!l.id||l.id.length==0)l.id=r+o++;s[l.id]=l}return s}function D(){var t=e.querySelectorAll("scene instance_visual_scene")[0];if(t){var n=t.getAttribute("url").replace(/^#/,"");return g[n.length>0?n:"visual_scene0"]}return null}function P(){m=[],H(t)}function H(e){var t=n.getChildById(e.id,!0),r=null;if(t&&t.keys){r={fps:60,hierarchy:[{node:t,keys:t.keys,sids:t.sids}],node:e,name:"animation_"+e.name,length:0},m.push(r);for(var i=0,s=t.keys.length;i<s;i++)r.length=Math.max(r.length,t.keys[i].time)}else r={hierarchy:[{keys:[],sids:[]}]};for(var i=0,s=e.children.length;i<s;i++){var o=H(e.children[i]);for(var u=0,a=o.hierarchy.length;u<a;u++)r.hierarchy.push({keys:[],sids:[]})}return r}function B(){var e=1e6,t=-e,n=0,r;for(var i in a){var s=a[i];r=r||s.id;for(var o=0;o<s.sampler.length;o++){var u=s.sampler[o];u.create(),e=Math.min(e,u.startTime),t=Math.max(t,u.endTime),n=Math.max(n,u.input.length)}}return{start:e,end:t,frames:n,ID:r}}function F(e,t){var n=t instanceof lt?f[t.url]:t;if(!n||!n.morph){console.log("could not find morph controller!");return}var r=n.morph;for(var i=0;i<r.targets.length;i++){var s=r.targets[i],o=l[s];if(!o.mesh||!o.mesh.primitives||!o.mesh.primitives.length)continue;var u=o.mesh.primitives[0].geometry;u.vertices.length===e.vertices.length&&e.morphTargets.push({name:"target_1",vertices:u.vertices})}e.morphTargets.push({name:"target_Z",vertices:e.vertices})}function I(e,t,r){var i=f[t.url];if(!i||!i.skin){console.log("could not find skin controller!");return}if(!t.skeleton||!t.skeleton.length){console.log("could not find the skeleton for the skin!");return}var s=i.skin,o=n.getChildById(t.skeleton[0]),u=[];r=r!==undefined?r:!0;var a=[];e.skinWeights=[],e.skinIndices=[];if(r)for(var l=0;l<e.vertices.length;l++)e.vertices[l].applyMatrix4(s.bindShapeMatrix)}function q(e,t,n,r){e.world=e.world||new THREE.Matrix4,e.localworld=e.localworld||new THREE.Matrix4,e.world.copy(e.matrix),e.localworld.copy(e.matrix);if(e.channels&&e.channels.length){var i=e.channels[0],s=i.sampler.output[n];s instanceof THREE.Matrix4&&(e.world.copy(s),e.localworld.copy(s),n==0&&e.matrix.copy(s))}r&&e.world.multiplyMatrices(r,e.world),t.push(e);for(var o=0;o<e.nodes.length;o++)q(e.nodes[o],t,n,e.world)}function R(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=-1;if(r.type!="JOINT")continue;for(var s=0;s<t.joints.length;s++)if(r.sid==t.joints[s]){i=s;break}if(i>=0){var o=t.invBindMatrices[i];r.invBindMatrix=o,r.skinningMatrix=new THREE.Matrix4,r.skinningMatrix.multiplyMatrices(r.world,o),r.animatrix=new THREE.Matrix4,r.animatrix.copy(r.localworld),r.weights=[];for(var s=0;s<t.weights.length;s++)for(var u=0;u<t.weights[s].length;u++){var a=t.weights[s][u];a.joint==i&&r.weights.push(a)}}else console.warn("ColladaLoader: Could not find joint '"+r.sid+"'."),r.skinningMatrix=new THREE.Matrix4,r.weights=[]}}function U(e){var t=[],n=function(e,t,r){var i={};i.name=t.sid,i.parent=e,i.matrix=t.matrix;var s=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];i.matrix.decompose(s[0],s[1],s[2]),i.pos=[s[0].x,s[0].y,s[0].z],i.scl=[s[2].x,s[2].y,s[2].z],i.rotq=[s[1].x,s[1].y,s[1].z,s[1].w],r.push(i);for(var o in t.nodes)n(t.sid,t.nodes[o],r)};return n(-1,e,t),t}function z(e,t,n){var r=[];q(t,r,-1),R(r,n.skin),v=new THREE.Vector3;var i=[];for(var u=0;u<e.vertices.length;u++)i.push(new THREE.Vector3);for(u=0;u<r.length;u++){if(r[u].type!="JOINT")continue;for(j=0;j<r[u].weights.length;j++)w=r[u].weights[j],vidx=w.index,weight=w.weight,o=e.vertices[vidx],s=i[vidx],v.x=o.x,v.y=o.y,v.z=o.z,v.applyMatrix4(r[u].skinningMatrix),s.x+=v.x*weight,s.y+=v.y*weight,s.z+=v.z*weight}for(var u=0;u<e.vertices.length;u++)e.vertices[u]=i[u]}function W(e,t,r){var i=30,s=f[t.url];r=r!==undefined?r:40;if(!s||!s.skin){console.log("ColladaLoader: Could not find skin controller.");return}if(!t.skeleton||!t.skeleton.length){console.log("ColladaLoader: Could not find the skeleton for the skin. ");return}var o=B(),u=n.getChildById(t.skeleton[0],!0)||n.getChildBySid(t.skeleton[0],!0),a=U(u),l=s.skin.joints,c=[];for(var h=0;h<l.length;h++)for(var p=0;p<a.length;p++)a[p].name==l[h]&&(c[h]=a[p]);for(var h=0;h<c.length;h++)for(var p=0;p<c.length;p++)c[h].parent==c[p].name&&(c[h].parent=p);var h,p,d,v,m,g=new THREE.Vector3,y,b;for(h=0;h<e.vertices.length;h++)e.vertices[h].applyMatrix4(s.skin.bindShapeMatrix);var w=[],E=[],S=s.skin.weights;for(var h=0;h<S.length;h++){var x=new THREE.Vector4(S[h][0]?S[h][0].joint:0,S[h][1]?S[h][1].joint:0,S[h][2]?S[h][2].joint:0,S[h][3]?S[h][3].joint:0),m=new THREE.Vector4(S[h][0]?S[h][0].weight:0,S[h][1]?S[h][1].weight:0,S[h][2]?S[h][2].weight:0,S[h][3]?S[h][3].weight:0);w.push(x),E.push(m)}e.skinIndices=w,e.skinWeights=E,e.bones=c;var T={name:o.ID,fps:30,length:o.frames/30,hierarchy:[]};for(var p=0;p<c.length;p++)T.hierarchy.push({parent:c[p].parent,name:c[p].name,keys:[]});c.length<i&&z(e,u,s);for(r=0;r<o.frames;r++){var N=[],C=[];q(u,N,r),R(N,s.skin);if(c.length<i){for(var h=0;h<N.length;h++)for(var p=0;p<T.hierarchy.length;p++)if(T.hierarchy[p].name==N[h].sid){var k={};k.time=r/30,k.matrix=N[h].animatrix,r==0&&(N[h].matrix=k.matrix);var L=[new THREE.Vector3,new THREE.Quaternion,new THREE.Vector3];k.matrix.decompose(L[0],L[1],L[2]),k.pos=[L[0].x,L[0].y,L[0].z],k.scl=[L[2].x,L[2].y,L[2].z],k.rot=L[1],T.hierarchy[p].keys.push(k)}e.animation=T}else{for(h=0;h<e.vertices.length;h++)C.push(new THREE.Vector3);for(h=0;h<N.length;h++){if(N[h].type!="JOINT")continue;for(p=0;p<N[h].weights.length;p++)d=N[h].weights[p],v=d.index,m=d.weight,y=e.vertices[v],b=C[v],g.x=y.x,g.y=y.y,g.z=y.z,g.applyMatrix4(N[h].skinningMatrix),b.x+=g.x*m,b.y+=g.y*m,b.z+=g.z*m}e.morphTargets.push({name:"target_"+r,vertices:C})}}}function X(e,t){var n=new THREE.Object3D,r=!1,i,s,o,u;for(o=0;o<e.controllers.length;o++){var a=f[e.controllers[o].url];switch(a.type){case"skin":if(l[a.skin.source]){var v=new ht;v.url=a.skin.source,v.instance_material=e.controllers[o].instance_material,e.geometries.push(v),r=!0,i=e.controllers[o]}else if(f[a.skin.source]){var m=f[a.skin.source];s=m;if(m.morph&&l[m.morph.source]){var v=new ht;v.url=m.morph.source,v.instance_material=e.controllers[o].instance_material,e.geometries.push(v)}}break;case"morph":if(l[a.morph.source]){var v=new ht;v.url=a.morph.source,v.instance_material=e.controllers[o].instance_material,e.geometries.push(v),s=e.controllers[o]}console.log("ColladaLoader: Morph-controller partially supported.");default:}}var g={};for(o=0;o<e.geometries.length;o++){var y=e.geometries[o],w=y.instance_material,S=l[y.url],x={},N=[],C=0,k;if(S){if(!S.mesh||!S.mesh.primitives)continue;n.name.length==0&&(n.name=S.id);if(w)for(u=0;u<w.length;u++){var L=w[u],A=c[L.target],O=A.instance_effect.url,M=h[O].shader,_=M.material;if(S.doubleSided){if(!(L.symbol in g)){var D=_.clone();D.side=THREE.DoubleSide,g[L.symbol]=D}_=g[L.symbol]}_.opacity=_.opacity?_.opacity:1,x[L.symbol]=C,N.push(_),k=_,k.name=A.name==null||A.name===""?A.id:A.name,C++}var P,H=k||new THREE.MeshLambertMaterial({color:14540253,shading:THREE.FlatShading,side:S.doubleSided?THREE.DoubleSide:THREE.FrontSide}),B=S.mesh.geometry3js;if(C>1){H=new THREE.MeshFaceMaterial(N);for(u=0;u<B.faces.length;u++){var j=B.faces[u];j.materialIndex=x[j.daeMaterial]}}i!==undefined?(W(B,i),B.morphTargets.length>0?(H.morphTargets=!0,H.skinning=!1):(H.morphTargets=!1,H.skinning=!0),P=new THREE.SkinnedMesh(B,H,!1),P.name="skin_"+E.length,E.push(P)):s!==undefined?(F(B,s),H.morphTargets=!0,P=new THREE.Mesh(B,H),P.name="morph_"+b.length,b.push(P)):P=new THREE.Mesh(B,H),n.add(P)}}for(o=0;o<e.cameras.length;o++){var I=e.cameras[o],q=p[I.url],R=new THREE.PerspectiveCamera(q.yfov,parseFloat(q.aspect_ratio),parseFloat(q.znear),parseFloat(q.zfar));n.add(R)}for(o=0;o<e.lights.length;o++){var U=null,z=e.lights[o],V=d[z.url];if(V&&V.technique){var $=V.color.getHex(),J=V.intensity,K=0,Q=V.falloff_angle,G;switch(V.technique){case"directional":U=new THREE.DirectionalLight($,J,K),U.position.set(0,0,1);break;case"point":U=new THREE.PointLight($,J,K);break;case"spot":U=new THREE.SpotLight($,J,K,Q,G),U.position.set(0,0,1);break;case"ambient":U=new THREE.AmbientLight($)}}U&&n.add(U)}n.name=e.name||e.id||"",n.id=e.id||"",n.layer=e.layer||"",n.matrix=e.matrix,n.matrix.decompose(n.position,n.quaternion,n.scale);if(T.centerGeometry&&n.geometry){var Y=THREE.GeometryUtils.center(n.geometry);Y.multiply(n.scale),Y.applyQuaternion(n.quaternion),n.position.sub(Y)}for(o=0;o<e.nodes.length;o++)n.add(X(e.nodes[o],e));return n}function V(e,t){for(var n=0;n<e.joints.length;n++)if(e.joints[n]==t)return n}function $(t){var n=e.querySelectorAll("library_nodes node");for(var r=0;r<n.length;r++){var i=n[r].attributes.getNamedItem("id");if(i&&i.value===t)return n[r]}return undefined}function J(e){var t=[],n=1e6,r=-1e6;for(var i in a){var s=a[i];for(var o=0;o<s.channel.length;o++){var u=s.channel[o],f=s.sampler[o],i=u.target.split("/")[0];i==e.id&&(f.create(),u.sampler=f,n=Math.min(n,f.startTime),r=Math.max(r,f.endTime),t.push(u))}}return t.length&&(e.startTime=n,e.endTime=r),t}function K(e){var t=1e7;for(var n=0;n<e.channels.length;n++){var r=e.channels[n].sampler;for(var i=0;i<r.input.length-1;i++){var s=r.input[i],o=r.input[i+1];t=Math.min(t,o-s)}}return t}function Q(e,t){var n={},r,i;for(r=0;r<e.channels.length;r++){var s=e.channels[r];n[s.sid]=s}var o=new THREE.Matrix4;for(r=0;r<e.transforms.length;r++){var u=e.transforms[r],s=n[u.sid];if(s!==undefined){var a=s.sampler,f;for(i=0;i<a.input.length-1;i++)if(a.input[i+1]>t){f=a.output[i];break}f!==undefined?f instanceof THREE.Matrix4?o.multiplyMatrices(o,f):o.multiplyMatrices(o,u.matrix):o.multiplyMatrices(o,u.matrix)}else o.multiplyMatrices(o,u.matrix)}return o}function G(e){if(e.channels&&e.channels.length){var t=[],n=[];for(var r=0,i=e.channels.length;r<i;r++){var s=e.channels[r],o=s.fullSid,u=s.sampler,a=u.input,f=e.getTransformBySid(s.sid),l;if(s.arrIndices){l=[];for(var c=0,h=s.arrIndices.length;c<h;c++)l[c]=en(s.arrIndices[c])}else l=tn(s.member);if(f){n.indexOf(o)===-1&&n.push(o);for(var c=0,h=a.length;c<h;c++){var p=a[c],d=u.getData(f.type,c,l),v=Y(t,p);if(!v){v=new _t(p);var m=Z(t,p);t.splice(m==-1?t.length:m,0,v)}v.addTarget(o,f,l,d)}}else console.log('Could not find transform "'+s.sid+'" in node '+e.id)}for(var r=0;r<n.length;r++){var g=n[r];for(var c=0;c<t.length;c++){var v=t[c];v.hasTarget(g)||et(t,v,c,g)}}e.keys=t,e.sids=n}}function Y(e,t){var n=null;for(var r=0,i=e.length;r<i&&n==null;r++){var s=e[r];if(s.time===t)n=s;else if(s.time>t)break}return n}function Z(e,t){var n=-1;for(var r=0,i=e.length;r<i&&n==-1;r++){var s=e[r];s.time>=t&&(n=r)}return n}function et(e,t,n,r){var i=nt(e,r,n?n-1:0),s=tt(e,r,n+1);if(i&&s){var o=(t.time-i.time)/(s.time-i.time),u=i.getTarget(r),a=s.getTarget(r).data,f=u.data,l;if(u.type==="matrix")l=f;else if(f.length){l=[];for(var c=0;c<f.length;++c)l[c]=f[c]+(a[c]-f[c])*o}else l=f+(a-f)*o;t.addTarget(r,u.transform,u.member,l)}}function tt(e,t,n){for(;n<e.length;n++){var r=e[n];if(r.hasTarget(t))return r}return null}function nt(e,t,n){n=n>=0?n:n+e.length;for(;n>=0;n--){var r=e[n];if(r.hasTarget(t))return r}return null}function rt(){this.id="",this.init_from=""}function it(){this.id="",this.name="",this.type="",this.skin=null,this.morph=null}function st(){this.method=null,this.source=null,this.targets=null,this.weights=null}function ot(){this.source="",this.bindShapeMatrix=null,this.invBindMatrices=[],this.joints=[],this.weights=[]}function ut(){this.id="",this.name="",this.nodes=[],this.scene=new THREE.Object3D}function at(){this.id="",this.name="",this.sid="",this.nodes=[],this.controllers=[],this.transforms=[],this.geometries=[],this.channels=[],this.matrix=new THREE.Matrix4}function ft(){this.sid="",this.type="",this.data=[],this.obj=null}function lt(){this.url="",this.skeleton=[],this.instance_material=[]}function ct(){this.symbol="",this.target=""}function ht(){this.url="",this.instance_material=[]}function pt(){this.id="",this.mesh=null}function dt(e){this.geometry=e.id,this.primitives=[],this.vertices=null,this.geometry3js=null}function vt(){this.material="",this.count=0,this.inputs=[],this.vcount=null,this.p=[],this.geometry=new THREE.Geometry}function mt(){vt.call(this),this.vcount=[]}function gt(){vt.call(this),this.vcount=3}function yt(){this.source="",this.count=0,this.stride=0,this.params=[]}function bt(){this.input={}}function wt(){this.semantic="",this.offset=0,this.source="",this.set=0}function Et(e){this.id=e,this.type=null}function St(){this.id="",this.name="",this.instance_effect=null}function xt(){this.color=new THREE.Color,this.color.setRGB(Math.random(),Math.random(),Math.random()),this.color.a=1,this.texture=null,this.texcoord=null,this.texOpts=null}function Tt(e,t){this.type=e,this.effect=t,this.material=null}function Nt(e){this.effect=e,this.init_from=null,this.format=null}function Ct(e){this.effect=e,this.source=null,this.wrap_s=null,this.wrap_t=null,this.minfilter=null,this.magfilter=null,this.mipfilter=null}function kt(){this.id="",this.name="",this.shader=null,this.surface={},this.sampler={}}function Lt(){this.url=""}function At(){this.id="",this.name="",this.source={},this.sampler=[],this.channel=[]}function Ot(e){this.animation=e,this.source="",this.target="",this.fullSid=null,this.sid=null,this.dotSyntax=null,this.arrSyntax=null,this.arrIndices=null,this.member=null}function Mt(e){this.id="",this.animation=e,this.inputs=[],this.input=null,this.output=null,this.strideOut=null,this.interpolation=null,this.startTime=null,this.endTime=null,this.duration=0}function _t(e){this.targets=[],this.time=e}function Dt(){this.id="",this.name="",this.technique=""}function Pt(){this.url=""}function Ht(){this.id="",this.name="",this.technique=""}function Bt(){this.url=""}function jt(e){var t=e.getAttribute("id");return i[t]!=undefined?i[t]:(i[t]=(new Et(t)).parse(e),i[t])}function Ft(e){return e=="dae"?"http://www.collada.org/2005/11/COLLADASchema":null}function It(e){var t=Ut(e),n=[];for(var r=0,i=t.length;r<i;r++)n.push(t[r]=="true"||t[r]=="1"?!0:!1);return n}function qt(e){var t=Ut(e),n=[];for(var r=0,i=t.length;r<i;r++)n.push(parseFloat(t[r]));return n}function Rt(e){var t=Ut(e),n=[];for(var r=0,i=t.length;r<i;r++)n.push(parseInt(t[r],10));return n}function Ut(e){return e.length>0?zt(e).split(/\s+/):[]}function zt(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function Wt(e,t,n){return e.hasAttribute(t)?parseFloat(e.getAttribute(t)):n}function Xt(e,t,n){return e.hasAttribute(t)?parseInt(e.getAttribute(t),10):n}function Vt(e,t,n){return e.hasAttribute(t)?e.getAttribute(t):n}function $t(e,t){if(e===undefined){var n="0.";while(n.length<t+2)n+="0";return n}t=t||2;var r=e.toString().split(".");r[1]=r.length>1?r[1].substr(0,t):"0";while(r[1].length<t)r[1]+="0";return r.join(".")}function Jt(e,t){e.doubleSided=!1;var n=t.querySelectorAll("extra double_sided")[0];n&&n&&parseInt(n.textContent,10)===1&&(e.doubleSided=!0)}function Kt(){if(T.convertUpAxis!==!0||C===T.upAxis)k=null;else switch(C){case"X":k=T.upAxis==="Y"?"XtoY":"XtoZ";break;case"Y":k=T.upAxis==="X"?"YtoX":"YtoZ";break;case"Z":k=T.upAxis==="X"?"ZtoX":"ZtoY"}}function Qt(e,t){if(T.convertUpAxis!==!0||C===T.upAxis)return;switch(k){case"XtoY":var n=e[0];e[0]=t*e[1],e[1]=n;break;case"XtoZ":var n=e[2];e[2]=e[1],e[1]=e[0],e[0]=n;break;case"YtoX":var n=e[0];e[0]=e[1],e[1]=t*n;break;case"YtoZ":var n=e[1];e[1]=t*e[2],e[2]=n;break;case"ZtoX":var n=e[0];e[0]=e[1],e[1]=e[2],e[2]=n;break;case"ZtoY":var n=e[1];e[1]=e[2],e[2]=t*n}}function Gt(e,t){if(T.convertUpAxis!==!0||C===T.upAxis)return t;switch(e){case"X":t=k=="XtoY"?t*-1:t;break;case"Y":t=k=="YtoZ"||k=="YtoX"?t*-1:t;break;case"Z":t=k=="ZtoY"?t*-1:t;break;default:}return t}function Yt(e,t){var n=[e[t],e[t+1],e[t+2]];return Qt(n,-1),new THREE.Vector3(n[0],n[1],n[2])}function Zt(e){if(T.convertUpAxis){var t=[e[0],e[4],e[8]];Qt(t,-1),e[0]=t[0],e[4]=t[1],e[8]=t[2],t=[e[1],e[5],e[9]],Qt(t,-1),e[1]=t[0],e[5]=t[1],e[9]=t[2],t=[e[2],e[6],e[10]],Qt(t,-1),e[2]=t[0],e[6]=t[1],e[10]=t[2],t=[e[0],e[1],e[2]],Qt(t,-1),e[0]=t[0],e[1]=t[1],e[2]=t[2],t=[e[4],e[5],e[6]],Qt(t,-1),e[4]=t[0],e[5]=t[1],e[6]=t[2],t=[e[8],e[9],e[10]],Qt(t,-1),e[8]=t[0],e[9]=t[1],e[10]=t[2],t=[e[3],e[7],e[11]],Qt(t,-1),e[3]=t[0],e[7]=t[1],e[11]=t[2]}return new THREE.Matrix4(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function en(e){if(e>-1&&e<3){var t=["X","Y","Z"],n={X:0,Y:1,Z:2};e=tn(t[e]),e=n[e]}return e}function tn(e){if(T.convertUpAxis)switch(e){case"X":switch(k){case"XtoY":case"XtoZ":case"YtoX":e="Y";break;case"ZtoX":e="Z"}break;case"Y":switch(k){case"XtoY":case"YtoX":case"ZtoX":e="X";break;case"XtoZ":case"YtoZ":case"ZtoY":e="Z"}break;case"Z":switch(k){case"XtoZ":e="X";break;case"YtoZ":case"ZtoX":case"ZtoY":e="Y"}}return e}var e=null,t=null,n,r=null,i={},u={},a={},f={},l={},c={},h={},p={},d={},m,g,y,b,E,S=!0,x=THREE.SmoothShading,T={centerGeometry:!1,convertUpAxis:!1,subdivideFaces:!0,upAxis:"Y",defaultEnvMap:null},N=1,C="Y",k=null;return rt.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];n.nodeName=="init_from"&&(this.init_from=n.textContent)}return this},it.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.type="none";for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];switch(n.nodeName){case"skin":this.skin=(new ot).parse(n),this.type=n.nodeName;break;case"morph":this.morph=(new st).parse(n),this.type=n.nodeName;break;default:}}return this},st.prototype.parse=function(e){var t={},n=[],r;this.method=e.getAttribute("method"),this.source=e.getAttribute("source").replace(/^#/,"");for(r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(i.nodeType!=1)continue;switch(i.nodeName){case"source":var s=(new Et).parse(i);t[s.id]=s;break;case"targets":n=this.parseInputs(i);break;default:console.log(i.nodeName)}}for(r=0;r<n.length;r++){var o=n[r],s=t[o.source];switch(o.semantic){case"MORPH_TARGET":this.targets=s.read();break;case"MORPH_WEIGHT":this.weights=s.read();break;default:}}return this},st.prototype.parseInputs=function(e){var t=[];for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(r.nodeType!=1)continue;switch(r.nodeName){case"input":t.push((new wt).parse(r));break;default:}}return t},ot.prototype.parse=function(e){var t={},n,r;this.source=e.getAttribute("source").replace(/^#/,""),this.invBindMatrices=[],this.joints=[],this.weights=[];for(var i=0;i<e.childNodes.length;i++){var s=e.childNodes[i];if(s.nodeType!=1)continue;switch(s.nodeName){case"bind_shape_matrix":var o=qt(s.textContent);this.bindShapeMatrix=Zt(o);break;case"source":var u=(new Et).parse(s);t[u.id]=u;break;case"joints":n=s;break;case"vertex_weights":r=s;break;default:console.log(s.nodeName)}}return this.parseJoints(n,t),this.parseWeights(r,t),this},ot.prototype.parseJoints=function(e,t){for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(r.nodeType!=1)continue;switch(r.nodeName){case"input":var i=(new wt).parse(r),s=t[i.source];i.semantic=="JOINT"?this.joints=s.read():i.semantic=="INV_BIND_MATRIX"&&(this.invBindMatrices=s.read());break;default:}}},ot.prototype.parseWeights=function(e,t){var n,r,i=[];for(var s=0;s<e.childNodes.length;s++){var o=e.childNodes[s];if(o.nodeType!=1)continue;switch(o.nodeName){case"input":i.push((new wt).parse(o));break;case"v":n=Rt(o.textContent);break;case"vcount":r=Rt(o.textContent);break;default:}}var u=0;for(var s=0;s<r.length;s++){var a=r[s],f=[];for(var l=0;l<a;l++){var c={};for(var h=0;h<i.length;h++){var p=i[h],d=n[u+p.offset];switch(p.semantic){case"JOINT":c.joint=d;break;case"WEIGHT":c.weight=t[p.source].data[d];break;default:}}f.push(c),u+=i.length}for(var l=0;l<f.length;l++)f[l].index=s;this.weights.push(f)}},ut.prototype.getChildById=function(e,t){for(var n=0;n<this.nodes.length;n++){var r=this.nodes[n].getChildById(e,t);if(r)return r}return null},ut.prototype.getChildBySid=function(e,t){for(var n=0;n<this.nodes.length;n++){var r=this.nodes[n].getChildBySid(e,t);if(r)return r}return null},ut.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.nodes=[];for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;switch(n.nodeName){case"node":this.nodes.push((new at).parse(n));break;default:}}return this},at.prototype.getChannelForTransform=function(e){for(var t=0;t<this.channels.length;t++){var n=this.channels[t],r=n.target.split("/"),i=r.shift(),s=r.shift(),o=s.indexOf(".")>=0,u=s.indexOf("(")>=0,a,f;if(o)r=s.split("."),s=r.shift(),f=r.shift();else if(u){a=s.split("("),s=a.shift();for(var l=0;l<a.length;l++)a[l]=parseInt(a[l].replace(/\)/,""))}if(s==e)return n.info={sid:s,dotSyntax:o,arrSyntax:u,arrIndices:a},n}return null},at.prototype.getChildById=function(e,t){if(this.id==e)return this;if(t)for(var n=0;n<this.nodes.length;n++){var r=this.nodes[n].getChildById(e,t);if(r)return r}return null},at.prototype.getChildBySid=function(e,t){if(this.sid==e)return this;if(t)for(var n=0;n<this.nodes.length;n++){var r=this.nodes[n].getChildBySid(e,t);if(r)return r}return null},at.prototype.getTransformBySid=function(e){for(var t=0;t<this.transforms.length;t++)if(this.transforms[t].sid==e)return this.transforms[t];return null},at.prototype.parse=function(e){var t;this.id=e.getAttribute("id"),this.sid=e.getAttribute("sid"),this.name=e.getAttribute("name"),this.type=e.getAttribute("type"),this.layer=e.getAttribute("layer"),this.type=this.type=="JOINT"?this.type:"NODE",this.nodes=[],this.transforms=[],this.geometries=[],this.cameras=[],this.lights=[],this.controllers=[],this.matrix=new THREE.Matrix4;for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(r.nodeType!=1)continue;switch(r.nodeName){case"node":this.nodes.push((new at).parse(r));break;case"instance_camera":this.cameras.push((new Pt).parse(r));break;case"instance_controller":this.controllers.push((new lt).parse(r));break;case"instance_geometry":this.geometries.push((new ht).parse(r));break;case"instance_light":this.lights.push((new Bt).parse(r));break;case"instance_node":t=r.getAttribute("url").replace(/^#/,"");var i=$(t);i&&this.nodes.push((new at).parse(i));break;case"rotate":case"translate":case"scale":case"matrix":case"lookat":case"skew":this.transforms.push((new ft).parse(r));break;case"extra":break;default:console.log(r.nodeName)}}return this.channels=J(this),G(this),this.updateMatrix(),this},at.prototype.updateMatrix=function(){this.matrix.identity();for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(this.matrix)},ft.prototype.parse=function(e){return this.sid=e.getAttribute("sid"),this.type=e.nodeName,this.data=qt(e.textContent),this.convert(),this},ft.prototype.convert=function(){switch(this.type){case"matrix":this.obj=Zt(this.data);break;case"rotate":this.angle=THREE.Math.degToRad(this.data[3]);case"translate":Qt(this.data,-1),this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;case"scale":Qt(this.data,1),this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;default:console.log("Can not convert Transform of type "+this.type)}},ft.prototype.apply=function(){var e=new THREE.Matrix4;return function(t){switch(this.type){case"matrix":t.multiply(this.obj);break;case"translate":t.multiply(e.makeTranslation(this.obj.x,this.obj.y,this.obj.z));break;case"rotate":t.multiply(e.makeRotationAxis(this.obj,this.angle));break;case"scale":t.scale(this.obj)}}}(),ft.prototype.update=function(e,t){var n=["X","Y","Z","ANGLE"];switch(this.type){case"matrix":if(!t)this.obj.copy(e);else if(t.length===1)switch(t[0]){case 0:this.obj.n11=e[0],this.obj.n21=e[1],this.obj.n31=e[2],this.obj.n41=e[3];break;case 1:this.obj.n12=e[0],this.obj.n22=e[1],this.obj.n32=e[2],this.obj.n42=e[3];break;case 2:this.obj.n13=e[0],this.obj.n23=e[1],this.obj.n33=e[2],this.obj.n43=e[3];break;case 3:this.obj.n14=e[0],this.obj.n24=e[1],this.obj.n34=e[2],this.obj.n44=e[3]}else if(t.length===2){var r="n"+(t[0]+1)+(t[1]+1);this.obj[r]=e}else console.log("Incorrect addressing of matrix in transform.");break;case"translate":case"scale":Object.prototype.toString.call(t)==="[object Array]"&&(t=n[t[0]]);switch(t){case"X":this.obj.x=e;break;case"Y":this.obj.y=e;break;case"Z":this.obj.z=e;break;default:this.obj.x=e[0],this.obj.y=e[1],this.obj.z=e[2]}break;case"rotate":Object.prototype.toString.call(t)==="[object Array]"&&(t=n[t[0]]);switch(t){case"X":this.obj.x=e;break;case"Y":this.obj.y=e;break;case"Z":this.obj.z=e;break;case"ANGLE":this.angle=THREE.Math.degToRad(e);break;default:this.obj.x=e[0],this.obj.y=e[1],this.obj.z=e[2],this.angle=THREE.Math.degToRad(e[3])}}},lt.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,""),this.skeleton=[],this.instance_material=[];for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!==1)continue;switch(n.nodeName){case"skeleton":this.skeleton.push(n.textContent.replace(/^#/,""));break;case"bind_material":var r=n.querySelectorAll("instance_material");for(var i=0;i<r.length;i++){var s=r[i];this.instance_material.push((new ct).parse(s))}break;case"extra":break;default:}}return this},ct.prototype.parse=function(e){return this.symbol=e.getAttribute("symbol"),this.target=e.getAttribute("target").replace(/^#/,""),this},ht.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,""),this.instance_material=[];for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;if(n.nodeName=="bind_material"){var r=n.querySelectorAll("instance_material");for(var i=0;i<r.length;i++){var s=r[i];this.instance_material.push((new ct).parse(s))}break}}return this},pt.prototype.parse=function(e){this.id=e.getAttribute("id"),Jt(this,e);for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];switch(n.nodeName){case"mesh":this.mesh=(new dt(this)).parse(n);break;case"extra":break;default:}}return this},dt.prototype.parse=function(e){this.primitives=[];var t,n;for(t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"source":jt(r);break;case"vertices":this.vertices=(new bt).parse(r);break;case"triangles":this.primitives.push((new gt).parse(r));break;case"polygons":this.primitives.push((new vt).parse(r));break;case"polylist":this.primitives.push((new mt).parse(r));break;default:}}this.geometry3js=new THREE.Geometry;var s=i[this.vertices.input.POSITION.source].data;for(t=0;t<s.length;t+=3)this.geometry3js.vertices.push(Yt(s,t).clone());for(t=0;t<this.primitives.length;t++){var o=this.primitives[t];o.setVertices(this.vertices),this.handlePrimitive(o,this.geometry3js)}return this.geometry3js.computeFaceNormals(),this.geometry3js.calcNormals&&(this.geometry3js.computeVertexNormals(),delete this.geometry3js.calcNormals),this},dt.prototype.handlePrimitive=function(e,t){var n,r,s=e.p,o=e.inputs,u,a,f,l,c,h=0,p=3,d=0,v=[];for(n=0;n<o.length;n++){u=o[n];var m=u.offset+1;d=d<m?m:d;switch(u.semantic){case"TEXCOORD":v.push(u.set)}}for(var g=0;g<s.length;++g){var y=s[g],b=0;while(b<y.length){var w=[],E=[],S=null,x=[];e.vcount?p=e.vcount.length?e.vcount[h++]:e.vcount:p=y.length/d;for(n=0;n<p;n++)for(r=0;r<o.length;r++){u=o[r],l=i[u.source],a=y[b+n*d+u.offset],c=l.accessor.params.length,f=a*c;switch(u.semantic){case"VERTEX":w.push(a);break;case"NORMAL":E.push(Yt(l.data,f));break;case"TEXCOORD":S=S||{},S[u.set]===undefined&&(S[u.set]=[]),S[u.set].push(new THREE.Vector2(l.data[f],l.data[f+1]));break;case"COLOR":x.push((new THREE.Color).setRGB(l.data[f],l.data[f+1],l.data[f+2]));break;default:}}if(E.length==0){u=this.vertices.input.NORMAL;if(u){l=i[u.source],c=l.accessor.params.length;for(var N=0,C=w.length;N<C;N++)E.push(Yt(l.data,w[N]*c))}else t.calcNormals=!0}if(!S){S={},u=this.vertices.input.TEXCOORD;if(u){v.push(u.set),l=i[u.source],c=l.accessor.params.length;for(var N=0,C=w.length;N<C;N++)f=w[N]*c,S[u.set]===undefined&&(S[u.set]=[]),S[u.set].push(new THREE.Vector2(l.data[f],1-l.data[f+1]))}}if(x.length==0){u=this.vertices.input.COLOR;if(u){l=i[u.source],c=l.accessor.params.length;for(var N=0,C=w.length;N<C;N++)f=w[N]*c,x.push((new THREE.Color).setRGB(l.data[f],l.data[f+1],l.data[f+2]))}}var k=null,L=[],A,O;if(p===3)L.push(new THREE.Face3(w[0],w[1],w[2],E,x.length?x:new THREE.Color));else if(p===4)L.push(new THREE.Face3(w[0],w[1],w[3],[E[0],E[1],E[3]],x.length?[x[0],x[1],x[3]]:new THREE.Color)),L.push(new THREE.Face3(w[1],w[2],w[3],[E[1],E[2],E[3]],x.length?[x[1],x[2],x[3]]:new THREE.Color));else if(p>4&&T.subdivideFaces){var M=x.length?x:new THREE.Color,_,D,P,H,B,j;for(r=1;r<p-1;)L.push(new THREE.Face3(w[0],w[r],w[r+1],[E[0],E[r++],E[r]],M))}if(L.length)for(var N=0,C=L.length;N<C;N++){k=L[N],k.daeMaterial=e.material,t.faces.push(k);for(r=0;r<v.length;r++)A=S[v[r]],p>4?O=[A[0],A[N+1],A[N+2]]:p===4?N===0?O=[A[0],A[1],A[3]]:O=[A[1].clone(),A[2],A[3].clone()]:O=[A[0],A[1],A[2]],t.faceVertexUvs[r]===undefined&&(t.faceVertexUvs[r]=[]),t.faceVertexUvs[r].push(O)}else console.log("dropped face with vcount "+p+" for geometry with id: "+t.id);b+=d*p}}},vt.prototype.setVertices=function(e){for(var t=0;t<this.inputs.length;t++)this.inputs[t].source==e.id&&(this.inputs[t].source=e.input.POSITION.source)},vt.prototype.parse=function(e){this.material=e.getAttribute("material"),this.count=Xt(e,"count",0);for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];switch(n.nodeName){case"input":this.inputs.push((new wt).parse(e.childNodes[t]));break;case"vcount":this.vcount=Rt(n.textContent);break;case"p":this.p.push(Rt(n.textContent));break;case"ph":console.warn("polygon holes not yet supported!");break;default:}}return this},mt.prototype=Object.create(vt.prototype),gt.prototype=Object.create(vt.prototype),yt.prototype.parse=function(e){this.params=[],this.source=e.getAttribute("source"),this.count=Xt(e,"count",0),this.stride=Xt(e,"stride",0);for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeName=="param"){var r={};r.name=n.getAttribute("name"),r.type=n.getAttribute("type"),this.params.push(r)}}return this},bt.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++)if(e.childNodes[t].nodeName=="input"){var n=(new wt).parse(e.childNodes[t]);this.input[n.semantic]=n}return this},wt.prototype.parse=function(e){return this.semantic=e.getAttribute("semantic"),this.source=e.getAttribute("source").replace(/^#/,""),this.set=Xt(e,"set",-1),this.offset=Xt(e,"offset",0),this.semantic=="TEXCOORD"&&this.set<0&&(this.set=0),this},Et.prototype.parse=function(e){this.id=e.getAttribute("id");for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];switch(n.nodeName){case"bool_array":this.data=It(n.textContent),this.type=n.nodeName;break;case"float_array":this.data=qt(n.textContent),this.type=n.nodeName;break;case"int_array":this.data=Rt(n.textContent),this.type=n.nodeName;break;case"IDREF_array":case"Name_array":this.data=Ut(n.textContent),this.type=n.nodeName;break;case"technique_common":for(var r=0;r<n.childNodes.length;r++)if(n.childNodes[r].nodeName=="accessor"){this.accessor=(new yt).parse(n.childNodes[r]);break}break;default:}}return this},Et.prototype.read=function(){var e=[],t=this.accessor.params[0];switch(t.type){case"IDREF":case"Name":case"name":case"float":return this.data;case"float4x4":for(var n=0;n<this.data.length;n+=16){var r=this.data.slice(n,n+16),i=Zt(r);e.push(i)}break;default:console.log("ColladaLoader: Source: Read dont know how to read "+t.type+".")}return e},St.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++)if(e.childNodes[t].nodeName=="instance_effect"){this.instance_effect=(new Lt).parse(e.childNodes[t]);break}return this},xt.prototype.isColor=function(){return this.texture==null},xt.prototype.isTexture=function(){return this.texture!=null},xt.prototype.parse=function(e){e.nodeName=="transparent"&&(this.opaque=e.getAttribute("opaque"));for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;switch(n.nodeName){case"color":var r=qt(n.textContent);this.color=new THREE.Color,this.color.setRGB(r[0],r[1],r[2]),this.color.a=r[3];break;case"texture":this.texture=n.getAttribute("texture"),this.texcoord=n.getAttribute("texcoord"),this.texOpts={offsetU:0,offsetV:0,repeatU:1,repeatV:1,wrapU:1,wrapV:1},this.parseTexture(n);break;default:}}return this},xt.prototype.parseTexture=function(e){if(!e.childNodes)return this;e.childNodes[1]&&e.childNodes[1].nodeName==="extra"&&(e=e.childNodes[1],e.childNodes[1]&&e.childNodes[1].nodeName==="technique"&&(e=e.childNodes[1]));for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];switch(n.nodeName){case"offsetU":case"offsetV":case"repeatU":case"repeatV":this.texOpts[n.nodeName]=parseFloat(n.textContent);break;case"wrapU":case"wrapV":n.textContent.toUpperCase()==="TRUE"?this.texOpts[n.nodeName]=1:this.texOpts[n.nodeName]=parseInt(n.textContent);break;default:this.texOpts[n.nodeName]=n.textContent}}return this},Tt.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;switch(n.nodeName){case"ambient":case"emission":case"diffuse":case"specular":case"transparent":this[n.nodeName]=(new xt).parse(n);break;case"bump":var r=n.getAttribute("bumptype");r?r.toLowerCase()==="heightfield"?this.bump=(new xt).parse(n):r.toLowerCase()==="normalmap"?this.normal=(new xt).parse(n):(console.error("Shader.prototype.parse: Invalid value for attribute 'bumptype' ("+r+") - valid bumptypes are 'HEIGHTFIELD' and 'NORMALMAP' - defaulting to 'HEIGHTFIELD'"),this.bump=(new xt).parse(n)):(console.warn("Shader.prototype.parse: Attribute 'bumptype' missing from bump node - defaulting to 'HEIGHTFIELD'"),this.bump=(new xt).parse(n));break;case"shininess":case"reflectivity":case"index_of_refraction":case"transparency":var i=n.querySelectorAll("float");i.length>0&&(this[n.nodeName]=parseFloat(i[0].textContent));break;default:}}return this.create(),this},Tt.prototype.create=function(){var e={},t=!1;if(this.transparency!==undefined&&this.transparent!==undefined){var n=this.transparent,r=(this.transparent.color.r+this.transparent.color.g+this.transparent.color.b)/3*this.transparency;r>0&&(t=!0,e.transparent=!0,e.opacity=1-r)}var i={diffuse:"map",ambient:"lightMap",specular:"specularMap",emission:"emissionMap",bump:"bumpMap",normal:"normalMap"};for(var s in this)switch(s){case"ambient":case"emission":case"diffuse":case"specular":case"bump":case"normal":var o=this[s];if(o instanceof xt)if(o.isTexture()){var u=o.texture,a=this.effect.sampler[u];if(a!==undefined&&a.source!==undefined){var f=this.effect.surface[a.source],l=!1;if(l){var c=THREE.ImageUtils.loadTexture(y+l.init_from);c.wrapS=o.texOpts.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,c.wrapT=o.texOpts.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,c.offset.x=o.texOpts.offsetU,c.offset.y=o.texOpts.offsetV,c.repeat.x=o.texOpts.repeatU,c.repeat.y=o.texOpts.repeatV,e[i[s]]=c,s==="emission"&&(e.emissive=16777215)}}}else if(s==="diffuse"||!t)s==="emission"?e.emissive=o.color.getHex():e[s]=o.color.getHex();break;case"shininess":e[s]=this[s];break;case"reflectivity":e[s]=this[s],e[s]>0&&(e.envMap=T.defaultEnvMap),e.combine=THREE.MixOperation;break;case"index_of_refraction":e.refractionRatio=this[s],this[s]!==1&&(e.envMap=T.defaultEnvMap);break;case"transparency":break;default:}e.shading=x,e.side=this.effect.doubleSided?THREE.DoubleSide:THREE.FrontSide;switch(this.type){case"constant":e.emissive!=undefined&&(e.color=e.emissive),this.material=new THREE.MeshBasicMaterial(e);break;case"phong":case"blinn":e.diffuse!=undefined&&(e.color=e.diffuse),this.material=new THREE.MeshPhongMaterial(e);break;case"lambert":default:e.diffuse!=undefined&&(e.color=e.diffuse),this.material=new THREE.MeshLambertMaterial(e)}return this.material},Nt.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;switch(n.nodeName){case"init_from":this.init_from=n.textContent;break;case"format":this.format=n.textContent;break;default:console.log("unhandled Surface prop: "+n.nodeName)}}return this},Ct.prototype.parse=function(e){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;switch(n.nodeName){case"source":this.source=n.textContent;break;case"minfilter":this.minfilter=n.textContent;break;case"magfilter":this.magfilter=n.textContent;break;case"mipfilter":this.mipfilter=n.textContent;break;case"wrap_s":this.wrap_s=n.textContent;break;case"wrap_t":this.wrap_t=n.textContent;break;default:console.log("unhandled Sampler2D prop: "+n.nodeName)}}return this},kt.prototype.create=function(){if(this.shader==null)return null},kt.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),Jt(this,e),this.shader=null;for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;switch(n.nodeName){case"profile_COMMON":this.parseTechnique(this.parseProfileCOMMON(n));break;default:}}return this},kt.prototype.parseNewparam=function(e){var t=e.getAttribute("sid");for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(r.nodeType!=1)continue;switch(r.nodeName){case"surface":this.surface[t]=(new Nt(this)).parse(r);break;case"sampler2D":this.sampler[t]=(new Ct(this)).parse(r);break;case"extra":break;default:console.log(r.nodeName)}}},kt.prototype.parseProfileCOMMON=function(e){var t;for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(r.nodeType!=1)continue;switch(r.nodeName){case"profile_COMMON":this.parseProfileCOMMON(r);break;case"technique":t=r;break;case"newparam":this.parseNewparam(r);break;case"image":var i=(new rt).parse(r);u[i.id]=i;break;case"extra":break;default:console.log(r.nodeName)}}return t},kt.prototype.parseTechnique=function(e){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;switch(n.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.shader=(new Tt(n.nodeName,this)).parse(n);break;case"extra":this.parseExtra(n);break;default:}}},kt.prototype.parseExtra=function(e){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;switch(n.nodeName){case"technique":this.parseExtraTechnique(n);break;default:}}},kt.prototype.parseExtraTechnique=function(e){for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;switch(n.nodeName){case"bump":this.shader.parse(e);break;default:}}},Lt.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},At.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name"),this.source={};for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;switch(n.nodeName){case"animation":var r=(new At).parse(n);for(var i in r.source)this.source[i]=r.source[i];for(var s=0;s<r.channel.length;s++)this.channel.push(r.channel[s]),this.sampler.push(r.sampler[s]);break;case"source":var i=(new Et).parse(n);this.source[i.id]=i;break;case"sampler":this.sampler.push((new Mt(this)).parse(n));break;case"channel":this.channel.push((new Ot(this)).parse(n));break;default:}}return this},Ot.prototype.parse=function(e){this.source=e.getAttribute("source").replace(/^#/,""),this.target=e.getAttribute("target");var t=this.target.split("/"),n=t.shift(),r=t.shift(),i=r.indexOf(".")>=0,s=r.indexOf("(")>=0;if(i)t=r.split("."),this.sid=t.shift(),this.member=t.shift();else if(s){var o=r.split("(");this.sid=o.shift();for(var u=0;u<o.length;u++)o[u]=parseInt(o[u].replace(/\)/,""));this.arrIndices=o}else this.sid=r;return this.fullSid=r,this.dotSyntax=i,this.arrSyntax=s,this},Mt.prototype.parse=function(e){this.id=e.getAttribute("id"),this.inputs=[];for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;switch(n.nodeName){case"input":this.inputs.push((new wt).parse(n));break;default:}}return this},Mt.prototype.create=function(){for(var e=0;e<this.inputs.length;e++){var t=this.inputs[e],n=this.animation.source[t.source];switch(t.semantic){case"INPUT":this.input=n.read();break;case"OUTPUT":this.output=n.read(),this.strideOut=n.accessor.stride;break;case"INTERPOLATION":this.interpolation=n.read();break;case"IN_TANGENT":break;case"OUT_TANGENT":break;default:console.log(t.semantic)}}this.startTime=0,this.endTime=0,this.duration=0;if(this.input.length){this.startTime=1e8,this.endTime=-1e8;for(var e=0;e<this.input.length;e++)this.startTime=Math.min(this.startTime,this.input[e]),this.endTime=Math.max(this.endTime,this.input[e]);this.duration=this.endTime-this.startTime}},Mt.prototype.getData=function(e,t,n){var r;if(e==="matrix"&&this.strideOut===16)r=this.output[t];else if(this.strideOut>1){r=[],t*=this.strideOut;for(var i=0;i<this.strideOut;++i)r[i]=this.output[t+i];if(this.strideOut===3)switch(e){case"rotate":case"translate":Qt(r,-1);break;case"scale":Qt(r,1)}else this.strideOut===4&&e==="matrix"&&Qt(r,-1)}else r=this.output[t],n&&e=="translate"&&(r=Gt(n,r));return r},_t.prototype.addTarget=function(e,t,n,r){this.targets.push({sid:e,member:n,transform:t,data:r})},_t.prototype.apply=function(e){for(var t=0;t<this.targets.length;++t){var n=this.targets[t];(!e||n.sid===e)&&n.transform.update(n.data,n.member)}},_t.prototype.getTarget=function(e){for(var t=0;t<this.targets.length;++t)if(this.targets[t].sid===e)return this.targets[t];return null},_t.prototype.hasTarget=function(e){for(var t=0;t<this.targets.length;++t)if(this.targets[t].sid===e)return!0;return!1},_t.prototype.interpolate=function(e,t){for(var n=0,r=this.targets.length;n<r;n++){var i=this.targets[n],s=e.getTarget(i.sid),o;if(i.transform.type!=="matrix"&&s){var u=(t-this.time)/(e.time-this.time),a=s.data,f=i.data;u<0&&(u=0),u>1&&(u=1);if(f.length){o=[];for(var l=0;l<f.length;++l)o[l]=f[l]+(a[l]-f[l])*u}else o=f+(a-f)*u}else o=i.data;i.transform.update(o,i.member)}},Dt.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;switch(n.nodeName){case"optics":this.parseOptics(n);break;default:}}return this},Dt.prototype.parseOptics=function(e){for(var t=0;t<e.childNodes.length;t++)if(e.childNodes[t].nodeName=="technique_common"){var n=e.childNodes[t];for(var r=0;r<n.childNodes.length;r++){this.technique=n.childNodes[r].nodeName;if(this.technique=="perspective"){var i=n.childNodes[r];for(var s=0;s<i.childNodes.length;s++){var o=i.childNodes[s];switch(o.nodeName){case"yfov":this.yfov=o.textContent;break;case"xfov":this.xfov=o.textContent;break;case"znear":this.znear=o.textContent;break;case"zfar":this.zfar=o.textContent;break;case"aspect_ratio":this.aspect_ratio=o.textContent}}}else if(this.technique=="orthographic"){var u=n.childNodes[r];for(var s=0;s<u.childNodes.length;s++){var o=u.childNodes[s];switch(o.nodeName){case"xmag":this.xmag=o.textContent;break;case"ymag":this.ymag=o.textContent;break;case"znear":this.znear=o.textContent;break;case"zfar":this.zfar=o.textContent;break;case"aspect_ratio":this.aspect_ratio=o.textContent}}}}}return this},Pt.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},Ht.prototype.parse=function(e){this.id=e.getAttribute("id"),this.name=e.getAttribute("name");for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];if(n.nodeType!=1)continue;switch(n.nodeName){case"technique_common":this.parseCommon(n);break;case"technique":this.parseTechnique(n);break;default:}}return this},Ht.prototype.parseCommon=function(e){for(var t=0;t<e.childNodes.length;t++)switch(e.childNodes[t].nodeName){case"directional":case"point":case"spot":case"ambient":this.technique=e.childNodes[t].nodeName;var n=e.childNodes[t];for(var r=0;r<n.childNodes.length;r++){var i=n.childNodes[r];switch(i.nodeName){case"color":var s=qt(i.textContent);this.color=new THREE.Color(0),this.color.setRGB(s[0],s[1],s[2]),this.color.a=s[3];break;case"falloff_angle":this.falloff_angle=parseFloat(i.textContent)}}}return this},Ht.prototype.parseTechnique=function(e){this.profile=e.getAttribute("profile");for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t];switch(n.nodeName){case"intensity":this.intensity=parseFloat(n.textContent)}}return this},Bt.prototype.parse=function(e){return this.url=e.getAttribute("url").replace(/^#/,""),this},{load:L,parse:A,setPreferredShading:O,applySkin:W,geometries:l,options:T}},define("vendor/ColladaLoader",function(){}),THREE.OBJLoader=function(e){this.manager=e!==undefined?e:THREE.DefaultLoadingManager},THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(e,t,n,r){var i=this,s=new THREE.XHRLoader(i.manager);s.setCrossOrigin(this.crossOrigin),s.load(e,function(e){t(i.parse(e))})},parse:function(e){function t(e,t,n){return new THREE.Vector3(parseFloat(e),parseFloat(t),parseFloat(n))}function n(e,t){return new THREE.Vector2(parseFloat(e),parseFloat(t))}function r(e,t,n,r){return new THREE.Face3(e,t,n,r)}function a(e){return e=parseInt(e),e>=0?e-1:e+d.length}function f(e){return e=parseInt(e),e>=0?e-1:e+v.length}function l(e){return e=parseInt(e),e>=0?e-1:e+m.length}function c(e,t,n,i){i===undefined?s.faces.push(r(d[a(e)]-1,d[a(t)]-1,d[a(n)]-1)):s.faces.push(r(d[a(e)]-1,d[a(t)]-1,d[a(n)]-1,[v[f(i[0])].clone(),v[f(i[1])].clone(),v[f(i[2])].clone()]))}function h(e,t,n){s.faceVertexUvs[0].push([m[l(e)].clone(),m[l(t)].clone(),m[l(n)].clone()])}function p(e,t,n){e[3]===undefined?(c(e[0],e[1],e[2],n),t!==undefined&&t.length>0&&h(t[0],t[1],t[2])):(n!==undefined&&n.length>0?(c(e[0],e[1],e[3],[n[0],n[1],n[3]]),c(e[1],e[2],e[3],[n[1],n[2],n[3]])):(c(e[0],e[1],e[3]),c(e[1],e[2],e[3])),t!==undefined&&t.length>0&&(h(t[0],t[1],t[3]),h(t[1],t[2],t[3])))}var i=new THREE.Object3D,s,o,u;/^o /gm.test(e)===!1&&(s=new THREE.Geometry,o=new THREE.MeshLambertMaterial,u=new THREE.Mesh(s,o),i.add(u));var d=[],v=[],m=[],g=/v( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,y=/vn( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,b=/vt( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,w=/f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/,E=/f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/,S=/f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/,x=/f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/;e=e.replace(/\\\r\n/g,"");var T=e.split("\n");for(var N=0;N<T.length;N++){var C=T[N];C=C.trim();var k;if(C.length===0||C.charAt(0)==="#")continue;(k=g.exec(C))!==null?d.push(s.vertices.push(t(k[1],k[2],k[3]))):(k=y.exec(C))!==null?v.push(t(k[1],k[2],k[3])):(k=b.exec(C))!==null?m.push(n(k[1],k[2])):(k=w.exec(C))!==null?p([k[1],k[2],k[3],k[4]]):(k=E.exec(C))!==null?p([k[2],k[5],k[8],k[11]],[k[3],k[6],k[9],k[12]]):(k=S.exec(C))!==null?p([k[2],k[6],k[10],k[14]],[k[3],k[7],k[11],k[15]],[k[4],k[8],k[12],k[16]]):(k=x.exec(C))!==null?p([k[2],k[5],k[8],k[11]],[],[k[3],k[6],k[9],k[12]]):/^o /.test(C)?(s=new THREE.Geometry,o=new THREE.MeshLambertMaterial,u=new THREE.Mesh(s,o),u.name=C.substring(2).trim(),i.add(u)):/^g /.test(C)||(/^usemtl /.test(C)?o.name=C.substring(7).trim():/^mtllib /.test(C)||/^s /.test(C))}var L=i.children;for(var N=0,A=L.length;N<A;N++){var s=L[N].geometry;s.computeFaceNormals(),s.computeBoundingSphere()}return i}},define("vendor/OBJLoader",function(){}),function(e,t){typeof exports=="object"&&typeof require=="function"?module.exports=t(require("underscore"),require("backbone")):typeof define=="function"&&define.amd?define("vendor/backbone-localStorage.min",["underscore","backbone"],function(n,r){return t(n||e._,r||e.Backbone)}):t(_,Backbone)}(this,function(e,t){function n(){return((1+Math.random())*65536|0).toString(16).substring(1)}function r(){return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}return t.LocalStorage=window.Store=function(e){if(!this.localStorage)throw"Backbone.localStorage: Environment does not support localStorage.";this.name=e;var t=this.localStorage().getItem(this.name);this.records=t&&t.split(",")||[]},e.extend(t.LocalStorage.prototype,{save:function(){this.localStorage().setItem(this.name,this.records.join(","))},create:function(e){return e.id||(e.id=r(),e.set(e.idAttribute,e.id)),this.localStorage().setItem(this.name+"-"+e.id,JSON.stringify(e)),this.records.push(e.id.toString()),this.save(),this.find(e)},update:function(t){return this.localStorage().setItem(this.name+"-"+t.id,JSON.stringify(t)),e.include(this.records,t.id.toString())||this.records.push(t.id.toString()),this.save(),this.find(t)},find:function(e){return this.jsonData(this.localStorage().getItem(this.name+"-"+e.id))},findAll:function(){return(e.chain||e)(this.records).map(function(e){return this.jsonData(this.localStorage().getItem(this.name+"-"+e))},this).compact().value()},destroy:function(t){return t.isNew()?!1:(this.localStorage().removeItem(this.name+"-"+t.id),this.records=e.reject(this.records,function(e){return e===t.id.toString()}),this.save(),t)},localStorage:function(){return localStorage},jsonData:function(e){return e&&JSON.parse(e)},_clear:function(){var t=this.localStorage(),n=new RegExp("^"+this.name+"-");t.removeItem(this.name),(e.chain||e)(t).keys().filter(function(e){return n.test(e)}).each(function(e){t.removeItem(e)}),this.records.length=0},_storageSize:function(){return this.localStorage().length}}),t.LocalStorage.sync=window.Store.sync=t.localSync=function(e,n,r){var i=n.localStorage||n.collection.localStorage,s,o,u=t.$.Deferred&&t.$.Deferred();try{switch(e){case"read":s=n.id!=undefined?i.find(n):i.findAll();break;case"create":s=i.create(n);break;case"update":s=i.update(n);break;case"delete":s=i.destroy(n)}}catch(a){a.code===22&&i._storageSize()===0?o="Private browsing is unsupported":o=a.message}return s?(r&&r.success&&(t.VERSION==="0.9.10"?r.success(n,s,r):r.success(s)),u&&u.resolve(s)):(o=o?o:"Record Not Found",r&&r.error&&(t.VERSION==="0.9.10"?r.error(n,o,r):r.error(o)),u&&u.reject(o)),r&&r.complete&&r.complete(s),u&&u.promise()},t.ajaxSync=t.sync,t.getSyncMethod=function(e){return e.localStorage||e.collection&&e.collection.localStorage?t.localSync:t.ajaxSync},t.sync=function(e,n,r){return t.getSyncMethod(n).apply(this,[e,n,r])},t.LocalStorage}),define("SandboxConsole",["require","backbone","jquery","underscore","vendor/backbone-localStorage.min"],function(require){return function(GEPPETTO){var delta=500,lastKeypressTime=0,doubleTab=!1,Backbone=require("backbone"),$=require("jquery"),_=require("underscore");require("vendor/backbone-localStorage.min"),GEPPETTO.Sandbox={Model:Backbone.Model.extend({defaults:{history:[],iframe:!1,fallback:!0},initialize:function(){this.fetch()},localStorage:function(){return new Store("SandboxConsole")},parse:function(e){return!_.isArray(e)||e.length<1||!e[0]?e:(e[0].history=_.map(e[0].history,function(e){return e._hidden=!0,e.result&&delete e.result,e._class&&delete e._class,e}),delete e[0].iframe,e[0])},stringify:function(e){try{return JSON.stringify(e)}catch(t){return e.toString()}}}),View:Backbone.View.extend({initialize:function(e){_(this).bindAll("render","updateConsole","updateInputArea","focus","keydown","keyup","debugLog","showCommandsSuggestions","showMessage","executeCommand","loadScript","clear","getCaret","setCaret","setValue","specialCommands"),this.model.get("iframe")&&this.iframeSetup(),this.model.set("history",[]),this.historyState=this.model.get("history").length,this.currentHistory="",this.resultPrefix=e.resultPrefix||"  => ",this.tabCharacter=e.tabCharacter||"	",this.placeholder=e.placeholder||"// type some javascript and hit enter (help() for info)",this.helpText=e.helpText||"type javascript commands into the console, hit enter to evaluate. \n[up/down] to scroll through history, ':clear' to reset it. \n[alt + return/up/down] for returns and multi-line editing.",this.model.on("update:console",this.updateConsole,this),this.$el.delegate("textarea",{keydown:this.keydown,keyup:this.keyup}),this.$el.delegate(".output",{click:this.focus}),this.render()},template:_.template($("#tplSandbox").html()),format:_.template($("#tplCommand").html()),formatDebug:_.template($("#tplDebug").html()),render:function(){return this.$el.html(this.template({placeholder:this.placeholder})),this.textarea=this.$el.find("textarea"),this.output=this.$el.find(".output"),this},updateInputArea:function(){typeof this.currentHistory!="undefined"&&this.textarea.val(this.currentHistory).attr("rows",this.currentHistory.split("\n").length)},updateConsole:function(e){this.output.html(_.reduce(this.model.get("history"),function(e,t){var n;if(t.command!=null)return n=this.format({_hidden:t._hidden,_class:t._class,command:t.command,result:this.toEscaped(t.result)}),typeof e=="undefined"&&(e=""),e+n;if(t.result!=null)return n=this.formatDebug({_hidden:t._hidden,_class:t._class,result:this.toEscaped(t.result)+"\n"}),e+n},"",this)),this.output.scrollTop(this.output[0].scrollHeight-this.output.height())},debugLog:function(e){this.addMessageHistory("debugMessage",{result:e})},showCommandsSuggestions:function(e){this.addMessageHistory("commandsSuggestions",{result:e})},showMessage:function(e){this.addMessageHistory("logMessage",{result:e,_class:"string"})},executeCommand:function(e){this.currentHistory="",this.specialCommands(e)||this.evaluate(e),this.historyState=this.model.get("history").length},clear:function(){this.model.set("history",[]),this.model.trigger("update:console")},setValue:function(e){return this.currentHistory=e,this.updateConsole(),this.setCaret(this.textarea.val().length),this.textarea.focus(),!1},getCaret:function(){if(this.textarea[0].selectionStart)return this.textarea[0].selectionStart;if(document.selection){this.textarea[0].focus();var e=document.selection.createRange();if(e===null)return 0;var t=this.textarea[0].createTextRange(),n=t.duplicate();return t.moveToBookmark(e.getBookmark()),n.setEndPoint("EndToStart",t),n.text.length}return 0},setCaret:function(e){this.textarea[0].selectionStart=e,this.textarea[0].selectionEnd=e},toEscaped:function(e){return String(e).replace(/\\"/g,'"').replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},focus:function(e){return e.preventDefault(),this.textarea.focus(),!1},keydown:function(e){if(e.which===13){e.preventDefault();var t=this.textarea.val().trim();return this.currentHistory="",this.updateInputArea(),this.specialCommands(t)||this.evaluate(t),this.historyState=this.model.get("history").length,!1}(e.which===20||e.which===16)&&e.preventDefault();if(!this.ctrl&&(e.which===38||e.which===40)){e.preventDefault();var n=this.model.get("history"),r=e.which-39;return this.historyState+=r,this.historyState<0?this.historyState=0:this.historyState>=n.length&&(this.historyState=n.length),this.currentHistory=n[this.historyState]?n[this.historyState].command:"",this.updateConsole(),this.updateInputArea(),!1}if(e.which===9){e.preventDefault();var i=new Date,s=GEPPETTO.Console.availableCommands(),o=$("#commandInputArea").val();if(o.split(".").length>1)s=GEPPETTO.Console.availableTags(),i-lastKeypressTime<=delta?(this.showCommandsSuggestions(this.getSuggestions(s,o)+"\n"),i=0,doubleTab=!0):this.singleTab(s,i);else if(i-lastKeypressTime<=delta){var u="",a=[];for(var f=0;f<s.length;f++){var l=s[f];if(l.indexOf($("#commandInputArea").val())!=-1)if(l.length<=80)if((f+1)%2==0)u=u+l+"\n";else{var c=90-l.length,h="";for(var p=0;p<c;p++)h+=" ";u=u+l+h}else a[a.length]=l}for(var f=0;f<a.length;f++){var l=a[f];u=u+l+"\n"}this.showCommandsSuggestions(u+"\n"),i=0,doubleTab=!0}else this.singleTab(s,i);return lastKeypressTime=i,!1}},keyup:function(e){},specialCommands:function(e){return e=="help()"?(this.evaluate("GEPPETTO.Console.help()"),!0):!1},singleTab:function(e){var t=this.textarea.val(),n=$.map(e,function(e){if(e.toUpperCase().indexOf(t.toUpperCase())===0)return e}),r=null;if(n.length>1){var i=n.slice(0).sort(),s=i[0],o=i[i.length-1],u=0;if(s!=o){while(s.charAt(u)==o.charAt(u))++u;r=s.substring(0,u)}else r=s}n.length==1&&(r=n[0]);if(r!=null){var a=r.match(/\(.*?\)/);if(a!=null){var f=r.match(/\".*?\"/);f!=null?a=f[0].replace(/[""""]/gi,"").split(","):a=a[0].replace(/[()]/gi,"").split(",")}r=r.replace(a,""),this.textarea.val(r);var l=this.textarea.val();l.slice(-1)==")"&&a!=""?l.indexOf('""')!=-1?this.setCaret(l.length-2):this.setCaret(l.length-1):this.setCaret(l.length)}},getSuggestions:function(e,t){var n="",r=t.split("."),i="";r.length>1&&(r[r.length-1]==""&&r.pop(r.length-1),i=t.replace("."+r[r.length-1],""));var s={};for(var o=0;o<e.length;o++){var u=e[o];if(u.indexOf(t)!=-1&&u!=t){u=u.replace(i,""),u.substring(0,1)=="."&&(u=u.substring(1));var a=u.split(".");a.length>1&&(u=a[0],u in s||(t.substring(t.length-1)!="."?u="."+a[1]:r[r.length-1]==u&&(u=a[1])));if(!(u in s)){if((o+1)%3==0)n=n+u+"\n";else{var f=60-u.length,l="";for(var c=0;c<f;c++)l+=" ";n=n+u+l}s[u]={}}}}return n},addHistory:function(e){var t=this.model.get("history");_.isString(e.result)&&(e.result='"'+e.result.toString().replace(/"/g,'\\"')+'"'),_.isFunction(e.result)&&(e.result=e.result.toString().replace(/"/g,'\\"')),_.isObject(e.result)&&(e.result=this.model.stringify(e.result).replace(/"/g,'\\"')),_.isUndefined(e.result)&&(e.result="undefined"),t.push(e),this.model.set("history",t),this.model.trigger("update:console"),this.model.save()},addMessageHistory:function(e,t){var n=this.model.get("history");e=="debugMessage"?t._class="debug":e=="logMessage"?t._class="message":e=="commandsSuggestions"&&(t._class="commandsSuggestions"),n.push(t),this.model.set("history",n),this.model.trigger("update:console")},evaluate:function(command){if(!command)return!1;var multipleCommands=command.split("\n");if(multipleCommands.length>1)return GEPPETTO.ScriptRunner.runScript(command),!1;var str=command.replace(/&lt;/g,"<");command=str.replace(/&gt;/g,">");var item={command:command};try{item.result=this.model.get("iframe")?this.iframeEval(command):eval.call(window,command),_.isUndefined(item.result)&&(item._class="undefined"),_.isNumber(item.result)&&(item._class="number"),_.isString(item.result)&&(item._class="string")}catch(error){item.result=error.toString(),item._class="error"}str=command.replace(/\</g,"&lt;");var formattedCommand=str.replace(/\>/g,"&gt;");item.command=formattedCommand,this.addHistory(item)},iframeSetup:function(){this.sandboxFrame=$('<iframe width="0" height="0"/>').css({visibility:"hidden"}).appendTo("body")[0],this.sandbox=this.sandboxFrame.contentWindow,!this.sandbox.eval&&this.sandbox.execScript&&this.sandbox.execScript("null")},iframeEval:function(command){return this.sandbox||this.iframeSetup(),this.sandbox.eval?this.sandbox.eval(command):this.model.get("fallback")?eval(command):new Error("Can't evaluate inside the iframe - please report this bug along with your browser information!")},loadScript:function(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,this.model.get("iframe")?this.sandboxFrame?this.sandboxFrame.contentDocument.body.appendChild(t):new Error("sandbox: iframe has not been created yet, cannot load "+e):document.body.appendChild(t)}})}}}),define("GEPPETTO.Resources",["require"],function(e){return function(e){e.Resources={SIMULATION_LOADED:"Simulation Loaded",SIMULATION_STARTED:"Simulation Started",UNABLE_TO_START_SIMULATION:"Simulation not loaded, must load simulation first",SIMULATION_PAUSED:"Simulation Paused",UNABLE_TO_PAUSE_SIMULATION:"Simulation not running, must run simulation first",SIMULATION_STOP:"Simulation Stopped",LOADING_SIMULATION:"Loading Simulation",LOADING_SIMULATION_SLOW:"Still loading, but things are taking longer than expected, are you on low bandwidth?",SIMULATION_NOT_RUNNING:"Unable to stop simulation, loaded but not running",SIMULATION_NOT_LOADED:"Unable to stop simulation that hasn't been loaded",SIMULATION_UNSPECIFIED:"Simulation not specified",SIMULATION_ALREADY_STOPPED:"Simulation was already stopped",LOADING_FROM_CONTENT:"Outbound Message Sent: Load Simulation from editing console",MESSAGE_OUTBOUND_LOAD:"Outbound Message Sent: Loading Simulation",MESSAGE_OUTBOUND_STOP:"Outbund Message Sent: Simulation Stopped",MESSAGE_OUTBOUND_PAUSE:"Outbund Message Sent: Simulation Paused",MESSAGE_OUTBOUND_START:"Outbund Message Sent: Simulation Started",MESSAGE_OUTBOUND_LIST_WATCH:"Outbund Message Sent: List watchable variables",MESSAGE_OUTBOUND_LIST_FORCE:"Outbund Message Sent: List forceable variables",MESSAGE_OUTBOUND_SET_WATCH:"Outbund Message Sent: add watch lists",MESSAGE_OUTBOUND_GET_WATCH:"Outbund Message Sent: get watch lists",MESSAGE_OUTBOUND_START_WATCH:"Outbund Message Sent: start watch lists",MESSAGE_OUTBOUND_STOP_WATCH:"Outbund Message Sent: stop watch lists",MESSAGE_OUTBOUND_CLEAR_WATCH:"Outbund Message Sent: clear watch lists",SIMULATION_NOT_LOADED_ERROR:"Unable to perform operation, the simulation hasn't been loaded",SIMULATION_VARS_LIST:"Simulation Variables List requested",SIMULATION_SET_WATCH:"Simulation add watchlists requested",SIMULATION_GET_WATCH:"Simulation get watchlists requested",SIMULATION_START_WATCH:"Simulation start watch requested",SIMULATION_STOP_WATCH:"Simulation stop watch requested",SIMULATION_CLEAR_WATCH:"Simulation clear watchlists requested",WATCHED_SIMULATION_STATES:"You are currently watching the following states : \n",EMPTY_WATCH_TREE:"There are no simulation states to watch",RUNNING_SCRIPT:"Running script",NO_SIMULATION_TO_GET:"No Simulation to get as no simulation is running",DEBUG_ON:"Debug log statements on",DEBUG_OFF:"Debug log statements off",CLEAR_HISTORY:"Console history cleared",COPY_CONSOLE_HISTORY:"Copying history to clipboard",EMPTY_CONSOLE_HISTORY:"No console history to copy to clipboard",COPY_TO_CLIPBOARD_WINDOWS:"Copy to Clipboard: CTRL+C , OK",COPY_TO_CLIPBOARD_MAC:"Copy to Clipboard: Cmd+C , OK",INVALID_WAIT_USE:"GEPPETTO.G.wait(ms) command must be used inside script",WAITING:"Waiting ms",SHOW_CONSOLE:"Showing Console",HIDE_CONSOLE:"Hiding Console",CONSOLE_ALREADY_VISIBLE:"Console is already visible",CONSOLE_ALREADY_HIDDEN:"Console is already hidden",SHOW_SHAREBAR:"Showing ShareBar",HIDE_SHAREBAR:"Hiding ShareBar",SHAREBAR_ALREADY_VISIBLE:"ShareBar is already visible",SHAREBAR_ALREADY_HIDDEN:"Sharebar is already hidden",SHARE_ON_TWITTER:"Sharing Geppetto on Twitter",SHARE_ON_FACEBOOK:"Sharing Geppetto on Facebook",SHOW_HELP_WINDOW:"Showing Help Window",HIDE_HELP_WINDOW:"Hiding Help Window",HELP_ALREADY_VISIBLE:"Help Window is already visible",HELP_ALREADY_HIDDEN:"Help Window is already hidden",CAMERA_PAN_INCREMENT:"Panning increment",CAMERA_ROTATE_INCREMENT:"Rotation increment",CAMERA_ZOOM_INCREMENT:"Zoom increment",CAMERA_RESET:"Camera reset",RETRIEVING_MODEL_TREE:"Model tree requested",EMPTY_MODEL_TREE:"Model is empty, nothing to see here.",NO_SIMULATION_TREE:"Simulation tree is not available.",NO_VISUALIZATION_TREE:"Visualization tree is not available.",RETRIEVING_SIMULATION_TREE:"Simulation tree: ",RETRIEVING_VISUALIZATION_TREE:"Visualization tree: ",GEPPETTO_INITIALIZED:"Geppetto Initialised",SIMULATION_OBSERVED:"Sent: Simulation being observed",WEBSOCKET_NOT_SUPPORTED:"Error: WebSocket is not supported by this browser.",WEBSOCKET_OPENED:"Info: WebSocket connection opened",WEBSOCKET_CLOSED:"Info: WebSocket connection closed",CLEAR_CANVAS:"Inbound Message Received: Clear canvas",INVALID_SIMULATION_FILE:"Invalid Simulation File",ERROR:"Rats! Something went wrong.",INVALID_WATCH_LIST:"Invalid Watch List",LOADING_MODEL:"Inbound Message Received: Loading Model ",OBSERVING_MODE:"Observing Simulation Mode",SERVER_UNAVAILABLE:"Server Unavailable",SERVER_AVAILABLE:"Server Available",WEBGL_FAILED:"Initializing Error: Unable to initialize WebGL",WEBGL_MESSAGE:"Unable to detect WebGl in your browser. \nTry updating your browser and video card drivers to resolve issue",ALL_COMMANDS_AVAILABLE_MESSAGE:"The following commands are available in the Geppetto console.",GEPPETTO_VERSION_HOLDER:"geppetto v$1 is ready",LISTING_WATCH_VARS:"Inbound Message Received: List watch variables",LISTING_FORCE_VARS:"Inbound Message Received: List force variables",SIMULATOR_UNAVAILABLE:" is Unavailable",WEBSOCKET_CONNECTION_ERROR:"Server Connection Error",STOP_SIMULATION_TUTORIAL:"Tutorial Starting",STOP_SIMULATION_TUTORIAL_MSG:"Current Simulation will be stopping in order to start tutorial, press Okay and enjoy the show!",SELECTING_ENTITY:"Selecting entity ",UNSELECTING_ENTITY:"Unselecting entity ",CANT_FIND_ENTITY:"Entity not found, can't use selection on it",NO_ENTITIES_SELECTED:"No entities are currently selected.",SHOW_ENTITY:"Showing entity ",ENTITY_ALREADY_VISIBLE:"Entity already visible.",HIDE_ENTITY:"Hiding entity ",ENTITY_ALREADY_HIDDING:"Entity already invisible.",ZOOM_TO_ENTITY:"Zooming to entity ",ENTITY_ALREADY_SELECTED:"Entity already selected",ENTITY_NOT_SELECTED:"Entity not selected, can't uselect what it isn't selected.",SELECTING_ASPECT:"Selecting aspect ",UNSELECTING_ASPECT:"Unselecting aspect ",SHOW_ASPECT:"Showing aspect ",ASPECT_ALREADY_VISIBLE:"Aspect already visible.",HIDE_ASPECT:"Hiding aspect ",ASPECT_ALREADY_HIDDING:"Aspect already invisible.",ZOOM_TO_ASPECT:"Zooming to aspect ",ASPECT_ALREADY_SELECTED:"Aspect already selected",ASPECT_NOT_SELECTED:"Aspect not selected, can't uselect what it isn't selected.",UPDATE_FRAME_STARTING:"Starting update frame",UPDATE_FRAME_END:"Ending update frame",SAMPLES_DROPDOWN_PLACEHOLDER:"Select simulation from list...",COMMANDS:" commands: \n\n",WIDGET_CREATED:" widget created",REMOVE_PLOT_WIDGETS:"Plotting widget(s) removed",REMOVE_POPUP_WIDGETS:"Popup widget(s) removed",REMOVE_TREEVISUALISERDAT_WIDGETS:"Tree Visualiser DAT widget(s) removed",REMOVE_TREEVISUALISERD3_WIDGETS:"Tree Visualiser D3 widget(s) removed",NON_EXISTENT_WIDGETS:"Unable to remove widgets, type doesn't exist",IDLE_MESSAGE:"Are you still there?",DISCONNECT_MESSAGE:"A prolonged inactivity has been detected and you have been disconnected from Geppetto. Please refresh your browser if you wish to continue",SERVER_CONNECTION_ERROR:"Error communicating with Geppetto servlet. \nReload page if problems persits",ENTITY_NODE:"EntityNode",ASPECT_NODE:"AspectNode",ASPECT_SUBTREE_NODE:"AspectSubTreeNode",VARIABLE_NODE:"VariableNode",FUNCTION_NODE:"FunctionNode",PARAMETER_SPEC_NODE:"ParameterSpecificationNode",PARAMETER_NODE:"ParameterNode",COMPOSITE_NODE:"CompositeNode",DYNAMICS_NODE:"DynamicsSpecificationNode"}}}),define("GEPPETTO.Init",["require","jquery","three","vendor/THREEx.KeyboardState"],function(e){return function(t){var n=e("jquery");e("three"),e("vendor/THREEx.KeyboardState");var r={debug:!1,camera:null,container:null,controls:null,scene:null,entities:{},aspects:{},renderer:null,stats:null,gui:null,projector:null,keyboard:new THREEx.KeyboardState,needsUpdate:!1,metadata:{},customUpdate:null,mouseClickListener:null,rotationMode:!1,mouse:{x:0,y:0},visualModelMap:null,idCounter:0,sceneCenter:new THREE.Vector3,cameraPosition:new THREE.Vector3,canvasCreated:!1,selected:[]},i=function(){r.scene=new THREE.Scene,r.visualModelMap={}},s=function(){var e=n(r.container).width(),t=n(r.container).height(),i=45,s=e/t,o=.1,u=5e5;r.camera=new THREE.PerspectiveCamera(i,s,o,u),r.scene.add(r.camera),r.camera.position.set(r.cameraPosition.x,r.cameraPosition.y,r.cameraPosition.z),r.camera.lookAt(r.sceneCenter),r.projector=new THREE.Projector},o=function(){r.renderer=new THREE.WebGLRenderer({antialias:!0}),r.renderer.setClearColor(0,1);var e=n(r.container).width(),t=n(r.container).height();r.renderer.setSize(e,t),r.renderer.autoClear=!0,r.container.appendChild(r.renderer.domElement),r.canvasCreated=!0},u=function(){r.scene.add(new THREE.AmbientLight(0)),r.scene.add(new THREE.HemisphereLight(16777215,0,1.1));var e=new THREE.DirectionalLight(16777215,.09);e.position.set(0,1,0),e.castShadow=!0,r.scene.add(e);var t=new THREE.SpotLight(16777215,.1);t.position.set(100,1e3,100),t.castShadow=!0,t.shadowDarkness=.2,r.scene.add(t);var n=new THREE.SpotLight(16777215,.22);n.position.set(100,1e3,100),n.castShadow=!0,n.shadowDarkness=.2,r.scene.add(n)},a=function(){r.controls=new THREE.TrackballControls(r.camera,r.renderer.domElement),r.controls.noZoom=!1,r.controls.noPan=!1,r.controls.addEventListener("change",t.render)},f=function(){r.renderer.domElement.addEventListener("mousedown",function(e){var n=t.getIntersectedObjects();if(n.length>0){var i=n[0].object.name;i==""&&(i=n[0].object.parent.name),(r.aspects.hasOwnProperty(i)||r.entities.hasOwnProperty(i))&&t.Console.executeCommand(i+".select()")}},!1),r.renderer.domElement.addEventListener("mousemove",function(e){r.mouse.x=e.clientX/window.innerWidth*2-1,r.mouse.y=-(e.clientY/window.innerHeight)*2+1},!1),window.addEventListener("resize",function(){var e=n(r.container),t=e.width(),i=e.height();r.camera.aspect=t/i,r.camera.updateProjectionMatrix(),r.renderer.setSize(t,i)},!1),document.addEventListener("keydown",t.Vanilla.checkKeyboard,!1)};t.Init={initialize:function(e){return r.container=e,i(),s(),o(),u(),a(),f(),r}}}}),define("GEPPETTO.Vanilla",["require"],function(e){return function(e){e.Vanilla={keyboardEnabled:!0,checkKeyboard:function(){e.isKeyPressed("ctrl+alt+p")?e.PlotsController.toggle():e.isKeyPressed("ctrl+alt+j")?e.Console.toggleConsole():e.isKeyPressed("ctrl+alt+s")&&e.Scatter3dController.toggle()},isKeyboardEnabled:function(){this.keyboardEnabled},enableKeyboard:function(e){this.keyboardEnabled=e}}}}),!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define("react",e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.React=e()}}(function(){var e,t,n;return function r(e,t,n){function i(o,u){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=t[o]={exports:{}};e[o][0].call(f.exports,function(t){var n=e[o][1][t];return i(n?n:t)},f,f.exports,r,e,t,n)}return t[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,n){var r=e("./focusNode"),i={componentDidMount:function(){this.props.autoFocus&&r(this.getDOMNode())}};t.exports=i},{"./focusNode":100}],2:[function(e,t,n){function i(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var r={columnCount:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},s=["Webkit","ms","Moz","O"];Object.keys(r).forEach(function(e){s.forEach(function(t){r[i(t,e)]=r[e]})});var o={background:{backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundColor:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0}},u={isUnitlessNumber:r,shorthandPropertyExpansions:o};t.exports=u},{}],3:[function(e,t,n){var r=e("./CSSProperty"),i=e("./dangerousStyleValue"),s=e("./escapeTextForBrowser"),o=e("./hyphenate"),u=e("./memoizeStringOnly"),a=u(function(e){return s(o(e))}),f={createMarkupForStyles:function(e){var t="";for(var n in e){if(!e.hasOwnProperty(n))continue;var r=e[n];r!=null&&(t+=a(n)+":",t+=i(n,r)+";")}return t||null},setValueForStyles:function(e,t){var n=e.style;for(var s in t){if(!t.hasOwnProperty(s))continue;var o=i(s,t[s]);if(o)n[s]=o;else{var u=r.shorthandPropertyExpansions[s];if(u)for(var a in u)n[a]="";else n[s]=""}}}};t.exports=f},{"./CSSProperty":2,"./dangerousStyleValue":95,"./escapeTextForBrowser":98,"./hyphenate":110,"./memoizeStringOnly":120}],4:[function(e,t,n){function y(e){return e.nodeName==="SELECT"||e.nodeName==="INPUT"&&e.type==="file"}function w(e){var t=a.getPooled(p.change,v,e);s.accumulateTwoPhaseDispatches(t),u.batchedUpdates(E,t)}function E(e){i.enqueueEvents(e),i.processEventQueue()}function S(e,t){d=e,v=t,d.attachEvent("onchange",w)}function x(){if(!d)return;d.detachEvent("onchange",w),d=null,v=null}function T(e,t,n){if(e===h.topChange)return n}function N(e,t,n){e===h.topFocus?(x(),S(t,n)):e===h.topBlur&&x()}function L(e,t){d=e,v=t,m=e.value,g=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value"),Object.defineProperty(d,"value",k),d.attachEvent("onpropertychange",O)}function A(){if(!d)return;delete d.value,d.detachEvent("onpropertychange",O),d=null,v=null,m=null,g=null}function O(e){if(e.propertyName!=="value")return;var t=e.srcElement.value;if(t===m)return;m=t,w(e)}function M(e,t,n){if(e===h.topInput)return n}function _(e,t,n){e===h.topFocus?(A(),L(t,n)):e===h.topBlur&&A()}function D(e,t,n){if(e===h.topSelectionChange||e===h.topKeyUp||e===h.topKeyDown)if(d&&d.value!==m)return m=d.value,v}function P(e){return e.nodeName==="INPUT"&&(e.type==="checkbox"||e.type==="radio")}function H(e,t,n){if(e===h.topClick)return n}var r=e("./EventConstants"),i=e("./EventPluginHub"),s=e("./EventPropagators"),o=e("./ExecutionEnvironment"),u=e("./ReactUpdates"),a=e("./SyntheticEvent"),f=e("./isEventSupported"),l=e("./isTextInputElement"),c=e("./keyOf"),h=r.topLevelTypes,p={change:{phasedRegistrationNames:{bubbled:c({onChange:null}),captured:c({onChangeCapture:null})},dependencies:[h.topBlur,h.topChange,h.topClick,h.topFocus,h.topInput,h.topKeyDown,h.topKeyUp,h.topSelectionChange]}},d=null,v=null,m=null,g=null,b=!1;o.canUseDOM&&(b=f("change")&&(!("documentMode"in document)||document.documentMode>8));var C=!1;o.canUseDOM&&(C=f("input")&&(!("documentMode"in document)||document.documentMode>9));var k={get:function(){return g.get.call(this)},set:function(e){m=""+e,g.set.call(this,e)}},B={eventTypes:p,extractEvents:function(e,t,n,r){var i,o;y(t)?b?i=T:o=N:l(t)?C?i=M:(i=D,o=_):P(t)&&(i=H);if(i){var u=i(e,t,n);if(u){var f=a.getPooled(p.change,u,r);return s.accumulateTwoPhaseDispatches(f),f}}o&&o(e,t,n)}};t.exports=B},{"./EventConstants":14,"./EventPluginHub":16,"./EventPropagators":19,"./ExecutionEnvironment":20,"./ReactUpdates":71,"./SyntheticEvent":78,"./isEventSupported":113,"./isTextInputElement":115,"./keyOf":119}],5:[function(e,t,n){var r=0,i={createReactRootIndex:function(){return r++}};t.exports=i},{}],6:[function(e,t,n){function g(e){switch(e){case d.topCompositionStart:return m.compositionStart;case d.topCompositionEnd:return m.compositionEnd;case d.topCompositionUpdate:return m.compositionUpdate}}function y(e,t){return e===d.topKeyDown&&t.keyCode===c}function b(e,t){switch(e){case d.topKeyUp:return l.indexOf(t.keyCode)!==-1;case d.topKeyDown:return t.keyCode!==c;case d.topKeyPress:case d.topMouseDown:case d.topBlur:return!0;default:return!1}}function w(e){this.root=e,this.startSelection=o.getSelection(e),this.startValue=this.getText()}var r=e("./EventConstants"),i=e("./EventPropagators"),s=e("./ExecutionEnvironment"),o=e("./ReactInputSelection"),u=e("./SyntheticCompositionEvent"),a=e("./getTextContentAccessor"),f=e("./keyOf"),l=[9,13,27,32],c=229,h=s.canUseDOM&&"CompositionEvent"in window,p=!h||"documentMode"in document&&document.documentMode>8,d=r.topLevelTypes,v=null,m={compositionEnd:{phasedRegistrationNames:{bubbled:f({onCompositionEnd:null}),captured:f({onCompositionEndCapture:null})},dependencies:[d.topBlur,d.topCompositionEnd,d.topKeyDown,d.topKeyPress,d.topKeyUp,d.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:f({onCompositionStart:null}),captured:f({onCompositionStartCapture:null})},dependencies:[d.topBlur,d.topCompositionStart,d.topKeyDown,d.topKeyPress,d.topKeyUp,d.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:f({onCompositionUpdate:null}),captured:f({onCompositionUpdateCapture:null})},dependencies:[d.topBlur,d.topCompositionUpdate,d.topKeyDown,d.topKeyPress,d.topKeyUp,d.topMouseDown]}};w.prototype.getText=function(){return this.root.value||this.root[a()]},w.prototype.getData=function(){var e=this.getText(),t=this.startSelection.start,n=this.startValue.length-this.startSelection.end;return e.substr(t,e.length-n-t)};var E={eventTypes:m,extractEvents:function(e,t,n,r){var s,o;h?s=g(e):v?b(e,r)&&(s=m.compositionEnd):y(e,r)&&(s=m.compositionStart),p&&(!v&&s===m.compositionStart?v=new w(t):s===m.compositionEnd&&v&&(o=v.getData(),v=null));if(s){var a=u.getPooled(s,n,r);return o&&(a.data=o),i.accumulateTwoPhaseDispatches(a),a}}};t.exports=E},{"./EventConstants":14,"./EventPropagators":19,"./ExecutionEnvironment":20,"./ReactInputSelection":52,"./SyntheticCompositionEvent":76,"./getTextContentAccessor":108,"./keyOf":119}],7:[function(e,t,n){function u(e,t,n){var r=e.childNodes;if(r[n]===t)return;t.parentNode===e&&e.removeChild(t),n>=r.length?e.appendChild(t):e.insertBefore(t,r[n])}var r=e("./Danger"),i=e("./ReactMultiChildUpdateTypes"),s=e("./getTextContentAccessor"),o=s(),a;o==="textContent"?a=function(e,t){e.textContent=t}:a=function(e,t){while(e.firstChild)e.removeChild(e.firstChild);if(t){var n=e.ownerDocument||document;e.appendChild(n.createTextNode(t))}};var f={dangerouslyReplaceNodeWithMarkup:r.dangerouslyReplaceNodeWithMarkup,updateTextContent:a,processUpdates:function(e,t){var n,s=null,o=null;for(var f=0;n=e[f];f++)if(n.type===i.MOVE_EXISTING||n.type===i.REMOVE_NODE){var l=n.fromIndex,c=n.parentNode.childNodes[l],h=n.parentID;s=s||{},s[h]=s[h]||[],s[h][l]=c,o=o||[],o.push(c)}var p=r.dangerouslyRenderMarkup(t);if(o)for(var d=0;d<o.length;d++)o[d].parentNode.removeChild(o[d]);for(var v=0;n=e[v];v++)switch(n.type){case i.INSERT_MARKUP:u(n.parentNode,p[n.markupIndex],n.toIndex);break;case i.MOVE_EXISTING:u(n.parentNode,s[n.parentID][n.fromIndex],n.toIndex);break;case i.TEXT_CONTENT:a(n.parentNode,n.textContent);break;case i.REMOVE_NODE:}}};t.exports=f},{"./Danger":10,"./ReactMultiChildUpdateTypes":58,"./getTextContentAccessor":108}],8:[function(e,t,n){var r=e("./invariant"),i={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_POSITIVE_NUMERIC_VALUE:16,injectDOMPropertyConfig:function(e){var t=e.Properties||{},n=e.DOMAttributeNames||{},s=e.DOMPropertyNames||{},u=e.DOMMutationMethods||{};e.isCustomAttribute&&o._isCustomAttributeFunctions.push(e.isCustomAttribute);for(var a in t){r(!o.isStandardName[a],"injectDOMPropertyConfig(...): You're trying to inject DOM property '%s' which has already been injected. You may be accidentally injecting the same DOM property config twice, or you may be injecting two configs that have conflicting property names.",a),o.isStandardName[a]=!0;var f=a.toLowerCase();o.getPossibleStandardName[f]=a;var l=n[a];l&&(o.getPossibleStandardName[l]=a),o.getAttributeName[a]=l||f,o.getPropertyName[a]=s[a]||a;var c=u[a];c&&(o.getMutationMethod[a]=c);var h=t[a];o.mustUseAttribute[a]=h&i.MUST_USE_ATTRIBUTE,o.mustUseProperty[a]=h&i.MUST_USE_PROPERTY,o.hasSideEffects[a]=h&i.HAS_SIDE_EFFECTS,o.hasBooleanValue[a]=h&i.HAS_BOOLEAN_VALUE,o.hasPositiveNumericValue[a]=h&i.HAS_POSITIVE_NUMERIC_VALUE,r(!o.mustUseAttribute[a]||!o.mustUseProperty[a],"DOMProperty: Cannot require using both attribute and property: %s",a),r(o.mustUseProperty[a]||!o.hasSideEffects[a],"DOMProperty: Properties that have side effects must use property: %s",a),r(!o.hasBooleanValue[a]||!o.hasPositiveNumericValue[a],"DOMProperty: Cannot have both boolean and positive numeric value: %s",a)}}},s={},o={ID_ATTRIBUTE_NAME:"data-reactid",isStandardName:{},getPossibleStandardName:{},getAttributeName:{},getPropertyName:{},getMutationMethod:{},mustUseAttribute:{},mustUseProperty:{},hasSideEffects:{},hasBooleanValue:{},hasPositiveNumericValue:{},_isCustomAttributeFunctions:[],isCustomAttribute:function(e){for(var t=0;t<o._isCustomAttributeFunctions.length;t++){var n=o._isCustomAttributeFunctions[t];if(n(e))return!0}return!1},getDefaultValueForProperty:function(e,t){var n=s[e],r;return n||(s[e]=n={}),t in n||(r=document.createElement(e),n[t]=r[t]),n[t]},injection:i};t.exports=o},{"./invariant":112}],9:[function(e,t,n){function u(e,t){return t==null||r.hasBooleanValue[e]&&!t||r.hasPositiveNumericValue[e]&&(isNaN(t)||t<1)}var r=e("./DOMProperty"),i=e("./escapeTextForBrowser"),s=e("./memoizeStringOnly"),o=e("./warning"),a=s(function(e){return i(e)+'="'}),f={children:!0,dangerouslySetInnerHTML:!0,key:!0,ref:!0},l={},c=function(e){if(f[e]||l[e])return;l[e]=!0;var t=e.toLowerCase(),n=r.isCustomAttribute(t)?t:r.getPossibleStandardName[t];o(n==null,"Unknown DOM property "+e+". Did you mean "+n+"?")},h={createMarkupForID:function(e){return a(r.ID_ATTRIBUTE_NAME)+i(e)+'"'},createMarkupForProperty:function(e,t){if(r.isStandardName[e]){if(u(e,t))return"";var n=r.getAttributeName[e];return r.hasBooleanValue[e]?i(n):a(n)+i(t)+'"'}return r.isCustomAttribute(e)?t==null?"":a(e)+i(t)+'"':(c(e),null)},setValueForProperty:function(e,t,n){if(r.isStandardName[t]){var i=r.getMutationMethod[t];if(i)i(e,n);else if(u(t,n))this.deleteValueForProperty(e,t);else if(r.mustUseAttribute[t])e.setAttribute(r.getAttributeName[t],""+n);else{var s=r.getPropertyName[t];if(!r.hasSideEffects[t]||e[s]!==n)e[s]=n}}else r.isCustomAttribute(t)?n==null?e.removeAttribute(r.getAttributeName[t]):e.setAttribute(t,""+n):c(t)},deleteValueForProperty:function(e,t){if(r.isStandardName[t]){var n=r.getMutationMethod[t];if(n)n(e,undefined);else if(r.mustUseAttribute[t])e.removeAttribute(r.getAttributeName[t]);else{var i=r.getPropertyName[t],s=r.getDefaultValueForProperty(e.nodeName,i);if(!r.hasSideEffects[t]||e[i]!==s)e[i]=s}}else r.isCustomAttribute(t)?e.removeAttribute(t):c(t)}};t.exports=h},{"./DOMProperty":8,"./escapeTextForBrowser":98,"./memoizeStringOnly":120,"./warning":134}],10:[function(e,t,n){function l(e){return e.substring(1,e.indexOf(" "))}var r=e("./ExecutionEnvironment"),i=e("./createNodesFromMarkup"),s=e("./emptyFunction"),o=e("./getMarkupWrap"),u=e("./invariant"),a=/^(<[^ \/>]+)/,f="data-danger-index",c={dangerouslyRenderMarkup:function(e){u(r.canUseDOM,"dangerouslyRenderMarkup(...): Cannot render markup in a Worker thread. This is likely a bug in the framework. Please report immediately.");var t,n={};for(var c=0;c<e.length;c++)u(e[c],"dangerouslyRenderMarkup(...): Missing markup."),t=l(e[c]),t=o(t)?t:"*",n[t]=n[t]||[],n[t][c]=e[c];var h=[],p=0;for(t in n){if(!n.hasOwnProperty(t))continue;var d=n[t];for(var v in d)if(d.hasOwnProperty(v)){var m=d[v];d[v]=m.replace(a,"$1 "+f+'="'+v+'" ')}var g=i(d.join(""),s);for(c=0;c<g.length;++c){var y=g[c];y.hasAttribute&&y.hasAttribute(f)?(v=+y.getAttribute(f),y.removeAttribute(f),u(!h.hasOwnProperty(v),"Danger: Assigning to an already-occupied result index."),h[v]=y,p+=1):console.error("Danger: Discarding unexpected node:",y)}}return u(p===h.length,"Danger: Did not assign to every index of resultList."),u(h.length===e.length,"Danger: Expected markup to render %s nodes, but rendered %s.",e.length,h.length),h},dangerouslyReplaceNodeWithMarkup:function(e,t){u(r.canUseDOM,"dangerouslyReplaceNodeWithMarkup(...): Cannot render markup in a worker thread. This is likely a bug in the framework. Please report immediately."),u(t,"dangerouslyReplaceNodeWithMarkup(...): Missing markup."),u(e.tagName.toLowerCase()!=="html","dangerouslyReplaceNodeWithMarkup(...): Cannot replace markup of the <html> node. This is because browser quirks make this unreliable and/or slow. If you want to render to the root you must use server rendering. See renderComponentToString().");var n=i(t,s)[0];e.parentNode.replaceChild(n,e)}};t.exports=c},{"./ExecutionEnvironment":20,"./createNodesFromMarkup":93,"./emptyFunction":96,"./getMarkupWrap":105,"./invariant":112}],11:[function(e,t,n){var r=e("./DOMProperty"),i=r.injection.MUST_USE_ATTRIBUTE,s=r.injection.MUST_USE_PROPERTY,o=r.injection.HAS_BOOLEAN_VALUE,u=r.injection.HAS_SIDE_EFFECTS,a=r.injection.HAS_POSITIVE_NUMERIC_VALUE,f={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,accessKey:null,action:null,allowFullScreen:i|o,allowTransparency:i,alt:null,async:o,autoComplete:null,autoPlay:o,cellPadding:null,cellSpacing:null,charSet:i,checked:s|o,className:s,cols:i|a,colSpan:null,content:null,contentEditable:null,contextMenu:i,controls:s|o,crossOrigin:null,data:null,dateTime:i,defer:o,dir:null,disabled:i|o,download:null,draggable:null,encType:null,form:i,formNoValidate:o,frameBorder:i,height:i,hidden:i|o,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:s,label:null,lang:null,list:null,loop:s|o,max:null,maxLength:i,mediaGroup:null,method:null,min:null,multiple:s|o,muted:s|o,name:null,noValidate:o,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:s|o,rel:null,required:o,role:i,rows:i|a,rowSpan:null,sandbox:null,scope:null,scrollLeft:s,scrollTop:s,seamless:i|o,selected:s|o,size:i|a,span:a,spellCheck:null,src:null,srcDoc:s,srcSet:null,step:null,style:null,tabIndex:null,target:null,title:null,type:null,value:s|u,width:i,wmode:i,autoCapitalize:null,autoCorrect:null,property:null,cx:i,cy:i,d:i,fill:i,fx:i,fy:i,gradientTransform:i,gradientUnits:i,offset:i,points:i,r:i,rx:i,ry:i,spreadMethod:i,stopColor:i,stopOpacity:i,stroke:i,strokeLinecap:i,strokeWidth:i,textAnchor:i,transform:i,version:i,viewBox:i,x1:i,x2:i,x:i,y1:i,y2:i,y:i},DOMAttributeNames:{className:"class",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",htmlFor:"for",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeLinecap:"stroke-linecap",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox"},DOMPropertyNames:{autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"enctype",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};t.exports=f},{"./DOMProperty":8}],12:[function(e,t,n){var r=e("./keyOf"),i=[r({ResponderEventPlugin:null}),r({SimpleEventPlugin:null}),r({TapEventPlugin:null}),r({EnterLeaveEventPlugin:null}),r({ChangeEventPlugin:null}),r({SelectEventPlugin:null}),r({CompositionEventPlugin:null}),r({AnalyticsEventPlugin:null}),r({MobileSafariClickEventPlugin:null})];t.exports=i},{"./keyOf":119}],13:[function(e,t,n){var r=e("./EventConstants"),i=e("./EventPropagators"),s=e("./SyntheticMouseEvent"),o=e("./ReactMount"),u=e("./keyOf"),a=r.topLevelTypes,f=o.getFirstReactDOM,l={mouseEnter:{registrationName:u({onMouseEnter:null}),dependencies:[a.topMouseOut,a.topMouseOver]},mouseLeave:{registrationName:u({onMouseLeave:null}),dependencies:[a.topMouseOut,a.topMouseOver]}},c=[null,null],h={eventTypes:l,extractEvents:function(e,t,n,r){if(e===a.topMouseOver&&(r.relatedTarget||r.fromElement))return null;if(e!==a.topMouseOut&&e!==a.topMouseOver)return null;var u;if(t.window===t)u=t;else{var h=t.ownerDocument;h?u=h.defaultView||h.parentWindow:u=window}var p,d;e===a.topMouseOut?(p=t,d=f(r.relatedTarget||r.toElement)||u):(p=u,d=t);if(p===d)return null;var v=p?o.getID(p):"",m=d?o.getID(d):"",g=s.getPooled(l.mouseLeave,v,r);g.type="mouseleave",g.target=p,g.relatedTarget=d;var y=s.getPooled(l.mouseEnter,m,r);return y.type="mouseenter",y.target=d,y.relatedTarget=p,i.accumulateEnterLeaveDispatches(g,y,v,m),c[0]=g,c[1]=y,c}};t.exports=h},{"./EventConstants":14,"./EventPropagators":19,"./ReactMount":55,"./SyntheticMouseEvent":81,"./keyOf":119}],14:[function(e,t,n){var r=e("./keyMirror"),i=r({bubbled:null,captured:null}),s=r({topBlur:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topReset:null,topScroll:null,topSelectionChange:null,topSubmit:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topWheel:null}),o={topLevelTypes:s,PropagationPhases:i};t.exports=o},{"./keyMirror":118}],15:[function(e,t,n){var r=e("./emptyFunction"),i={listen:function(e,t,n){if(e.addEventListener)return e.addEventListener(t,n,!1),{remove:function(){e.removeEventListener(t,n,!1)}};if(e.attachEvent)return e.attachEvent("on"+t,n),{remove:function(){e.detachEvent(t,n)}}},capture:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!0),{remove:function(){e.removeEventListener(t,n,!0)}}):(console.error("Attempted to listen to events during the capture phase on a browser that does not support the capture phase. Your application will not receive some events."),{remove:r})}};t.exports=i},{"./emptyFunction":96}],16:[function(e,t,n){function v(){var e=!d||!d.traverseTwoPhase||!d.traverseEnterLeave;if(e)throw new Error("InstanceHandle not injected before use!")}var r=e("./EventPluginRegistry"),i=e("./EventPluginUtils"),s=e("./ExecutionEnvironment"),o=e("./accumulate"),u=e("./forEachAccumulated"),a=e("./invariant"),f=e("./isEventSupported"),l=e("./monitorCodeUse"),c={},h=null,p=function(e){if(e){var t=i.executeDispatch,n=r.getPluginModuleForEvent(e);n&&n.executeDispatch&&(t=n.executeDispatch),i.executeDispatchesInOrder(e,t),e.isPersistent()||e.constructor.release(e)}},d=null,m={injection:{injectMount:i.injection.injectMount,injectInstanceHandle:function(e){d=e,v()},getInstanceHandle:function(){return v(),d},injectEventPluginOrder:r.injectEventPluginOrder,injectEventPluginsByName:r.injectEventPluginsByName},eventNameDispatchConfigs:r.eventNameDispatchConfigs,registrationNameModules:r.registrationNameModules,putListener:function(e,t,n){a(s.canUseDOM,"Cannot call putListener() in a non-DOM environment."),a(!n||typeof n=="function","Expected %s listener to be a function, instead got type %s",t,typeof n),t==="onScroll"&&!f("scroll",!0)&&(l("react_no_scroll_event"),console.warn("This browser doesn't support the `onScroll` event"));var r=c[t]||(c[t]={});r[e]=n},getListener:function(e,t){var n=c[t];return n&&n[e]},deleteListener:function(e,t){var n=c[t];n&&delete n[e]},deleteAllListeners:function(e){for(var t in c)delete c[t][e]},extractEvents:function(e,t,n,i){var s,u=r.plugins;for(var a=0,f=u.length;a<f;a++){var l=u[a];if(l){var c=l.extractEvents(e,t,n,i);c&&(s=o(s,c))}}return s},enqueueEvents:function(e){e&&(h=o(h,e))},processEventQueue:function(){var e=h;h=null,u(e,p),a(!h,"processEventQueue(): Additional events were enqueued while processing an event queue. Support for this has not yet been implemented.")},__purge:function(){c={}},__getListenerBank:function(){return c}};t.exports=m},{"./EventPluginRegistry":17,"./EventPluginUtils":18,"./ExecutionEnvironment":20,"./accumulate":87,"./forEachAccumulated":101,"./invariant":112,"./isEventSupported":113,"./monitorCodeUse":125}],17:[function(e,t,n){function o(){if(!i)return;for(var e in s){var t=s[e],n=i.indexOf(e);r(n>-1,"EventPluginRegistry: Cannot inject event plugins that do not exist in the plugin ordering, `%s`.",e);if(f.plugins[n])continue;r(t.extractEvents,"EventPluginRegistry: Event plugins must implement an `extractEvents` method, but `%s` does not.",e),f.plugins[n]=t;var o=t.eventTypes;for(var a in o)r(u(o[a],t,a),"EventPluginRegistry: Failed to publish event `%s` for plugin `%s`.",a,e)}}function u(e,t,n){r(!f.eventNameDispatchConfigs[n],"EventPluginHub: More than one plugin attempted to publish the same event name, `%s`.",n),f.eventNameDispatchConfigs[n]=e;var i=e.phasedRegistrationNames;if(i){for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];a(o,t,n)}return!0}return e.registrationName?(a(e.registrationName,t,n),!0):!1}function a(e,t,n){r(!f.registrationNameModules[e],"EventPluginHub: More than one plugin attempted to publish the same registration name, `%s`.",e),f.registrationNameModules[e]=t,f.registrationNameDependencies[e]=t.eventTypes[n].dependencies}var r=e("./invariant"),i=null,s={},f={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(e){r(!i,"EventPluginRegistry: Cannot inject event plugin ordering more than once."),i=Array.prototype.slice.call(e),o()},injectEventPluginsByName:function(e){var t=!1;for(var n in e){if(!e.hasOwnProperty(n))continue;var i=e[n];s[n]!==i&&(r(!s[n],"EventPluginRegistry: Cannot inject two different event plugins using the same name, `%s`.",n),s[n]=i,t=!0)}t&&o()},getPluginModuleForEvent:function(e){var t=e.dispatchConfig;if(t.registrationName)return f.registrationNameModules[t.registrationName]||null;for(var n in t.phasedRegistrationNames){if(!t.phasedRegistrationNames.hasOwnProperty(n))continue;var r=f.registrationNameModules[t.phasedRegistrationNames[n]];if(r)return r}return null},_resetEventPlugins:function(){i=null;for(var e in s)s.hasOwnProperty(e)&&delete s[e];f.plugins.length=0;var t=f.eventNameDispatchConfigs;for(var n in t)t.hasOwnProperty(n)&&delete t[n];var r=f.registrationNameModules;for(var o in r)r.hasOwnProperty(o)&&delete r[o]}};t.exports=f},{"./invariant":112}],18:[function(e,t,n){function u(e){return e===o.topMouseUp||e===o.topTouchEnd||e===o.topTouchCancel}function a(e){return e===o.topMouseMove||e===o.topTouchMove}function f(e){return e===o.topMouseDown||e===o.topTouchStart}function c(e,t){var n=e._dispatchListeners,r=e._dispatchIDs;l(e);if(Array.isArray(n))for(var i=0;i<n.length;i++){if(e.isPropagationStopped())break;t(e,n[i],r[i])}else n&&t(e,n,r)}function h(e,t,n){e.currentTarget=s.Mount.getNode(n);var r=t(e,n);return e.currentTarget=null,r}function p(e,t){c(e,t),e._dispatchListeners=null,e._dispatchIDs=null}function d(e){var t=e._dispatchListeners,n=e._dispatchIDs;l(e);if(Array.isArray(t))for(var r=0;r<t.length;r++){if(e.isPropagationStopped())break;if(t[r](e,n[r]))return n[r]}else if(t&&t(e,n))return n;return null}function v(e){l(e);var t=e._dispatchListeners,n=e._dispatchIDs;i(!Array.isArray(t),"executeDirectDispatch(...): Invalid `event`.");var r=t?t(e,n):null;return e._dispatchListeners=null,e._dispatchIDs=null,r}function m(e){return!!e._dispatchListeners}var r=e("./EventConstants"),i=e("./invariant"),s={Mount:null,injectMount:function(e){s.Mount=e,i(e&&e.getNode,"EventPluginUtils.injection.injectMount(...): Injected Mount module is missing getNode.")}},o=r.topLevelTypes,l;l=function(e){var t=e._dispatchListeners,n=e._dispatchIDs,r=Array.isArray(t),s=Array.isArray(n),o=s?n.length:n?1:0,u=r?t.length:t?1:0;i(s===r&&o===u,"EventPluginUtils: Invalid `event`.")};var g={isEndish:u,isMoveish:a,isStartish:f,executeDirectDispatch:v,executeDispatch:h,executeDispatchesInOrder:p,executeDispatchesInOrderStopAtTrue:d,hasDispatches:m,injection:s,useTouchEvents:!1};t.exports=g},{"./EventConstants":14,"./invariant":112}],19:[function(e,t,n){function f(e,t,n){var r=t.dispatchConfig.phasedRegistrationNames[n];return a(e,r)}function l(e,t,n){if(!e)throw new Error("Dispatching id must not be null");var r=t?u.bubbled:u.captured,i=f(e,n,r);i&&(n._dispatchListeners=s(n._dispatchListeners,i),n._dispatchIDs=s(n._dispatchIDs,e))}function c(e){e&&e.dispatchConfig.phasedRegistrationNames&&i.injection.getInstanceHandle().traverseTwoPhase(e.dispatchMarker,l,e)}function h(e,t,n){if(n&&n.dispatchConfig.registrationName){var r=n.dispatchConfig.registrationName,i=a(e,r);i&&(n._dispatchListeners=s(n._dispatchListeners,i),n._dispatchIDs=s(n._dispatchIDs,e))}}function p(e){e&&e.dispatchConfig.registrationName&&h(e.dispatchMarker,null,e)}function d(e){o(e,c)}function v(e,t,n,r){i.injection.getInstanceHandle().traverseEnterLeave(n,r,h,e,t)}function m(e){o(e,p)}var r=e("./EventConstants"),i=e("./EventPluginHub"),s=e("./accumulate"),o=e("./forEachAccumulated"),u=r.PropagationPhases,a=i.getListener,g={accumulateTwoPhaseDispatches:d,accumulateDirectDispatches:m,accumulateEnterLeaveDispatches:v};t.exports=g},{"./EventConstants":14,"./EventPluginHub":16,"./accumulate":87,"./forEachAccumulated":101}],20:[function(e,t,n){var r=typeof window!="undefined",i={canUseDOM:r,canUseWorkers:typeof Worker!="undefined",canUseEventListeners:r&&(window.addEventListener||window.attachEvent),isInWorker:!r};t.exports=i},{}],21:[function(e,t,n){function u(e){i(e.props.checkedLink==null||e.props.valueLink==null,"Cannot provide a checkedLink and a valueLink. If you want to use checkedLink, you probably don't want to use valueLink and vice versa.")}function a(e){u(e),i(e.props.value==null&&e.props.onChange==null,"Cannot provide a valueLink and a value or onChange event. If you want to use value or onChange, you probably don't want to use valueLink.")}function f(e){u(e),i(e.props.checked==null&&e.props.onChange==null,"Cannot provide a checkedLink and a checked property or onChange event. If you want to use checked or onChange, you probably don't want to use checkedLink")}function l(e){this.props.valueLink.requestChange(e.target.value)}function c(e){this.props.checkedLink.requestChange(e.target.checked)}var r=e("./ReactPropTypes"),i=e("./invariant"),s=e("./warning"),o={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0},h={Mixin:{propTypes:{value:function(e,t,n){s(!e[t]||o[e.type]||e.onChange||e.readOnly||e.disabled,"You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function(e,t,n){s(!e[t]||e.onChange||e.readOnly||e.disabled,"You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")},onChange:r.func}},getValue:function(e){return e.props.valueLink?(a(e),e.props.valueLink.value):e.props.value},getChecked:function(e){return e.props.checkedLink?(f(e),e.props.checkedLink.value):e.props.checked},getOnChange:function(e){return e.props.valueLink?(a(e),l):e.props.checkedLink?(f(e),c):e.props.onChange}};t.exports=h},{"./ReactPropTypes":64,"./invariant":112,"./warning":134}],22:[function(e,t,n){var r=e("./EventConstants"),i=e("./emptyFunction"),s=r.topLevelTypes,o={eventTypes:null,extractEvents:function(e,t,n,r){if(e===s.topTouchStart){var o=r.target;o&&!o.onclick&&(o.onclick=i)}}};t.exports=o},{"./EventConstants":14,"./emptyFunction":96}],23:[function(e,t,n){var r=e("./invariant"),i=function(e){var t=this;if(t.instancePool.length){var n=t.instancePool.pop();return t.call(n,e),n}return new t(e)},s=function(e,t){var n=this;if(n.instancePool.length){var r=n.instancePool.pop();return n.call(r,e,t),r}return new n(e,t)},o=function(e,t,n){var r=this;if(r.instancePool.length){var i=r.instancePool.pop();return r.call(i,e,t,n),i}return new r(e,t,n)},u=function(e,t,n,r,i){var s=this;if(s.instancePool.length){var o=s.instancePool.pop();return s.call(o,e,t,n,r,i),o}return new s(e,t,n,r,i)},a=function(e){var t=this;r(e instanceof t,"Trying to release an instance into a pool of a different type."),e.destructor&&e.destructor(),t.instancePool.length<t.poolSize&&t.instancePool.push(e)},f=10,l=i,c=function(e,t){var n=e;return n.instancePool=[],n.getPooled=t||l,n.poolSize||(n.poolSize=f),n.release=a,n},h={addPoolingTo:c,oneArgumentPooler:i,twoArgumentPooler:s,threeArgumentPooler:o,fiveArgumentPooler:u};t.exports=h},{"./invariant":112}],24:[function(e,t,n){var r=e("./DOMPropertyOperations"),i=e("./EventPluginUtils"),s=e("./ReactChildren"),o=e("./ReactComponent"),u=e("./ReactCompositeComponent"),a=e("./ReactContext"),f=e("./ReactCurrentOwner"),l=e("./ReactDOM"),c=e("./ReactDOMComponent"),h=e("./ReactDefaultInjection"),p=e("./ReactInstanceHandles"),d=e("./ReactMount"),v=e("./ReactMultiChild"),m=e("./ReactPerf"),g=e("./ReactPropTypes"),y=e("./ReactServerRendering"),b=e("./ReactTextComponent"),w=e("./onlyChild");h.inject();var E={Children:{map:s.map,forEach:s.forEach,only:w},DOM:l,PropTypes:g,initializeTouchEvents:function(e){i.useTouchEvents=e},createClass:u.createClass,constructAndRenderComponent:d.constructAndRenderComponent,constructAndRenderComponentByID:d.constructAndRenderComponentByID,renderComponent:m.measure("React","renderComponent",d.renderComponent),renderComponentToString:y.renderComponentToString,renderComponentToStaticMarkup:y.renderComponentToStaticMarkup,unmountComponentAtNode:d.unmountComponentAtNode,isValidClass:u.isValidClass,isValidComponent:o.isValidComponent,withContext:a.withContext,__internals:{Component:o,CurrentOwner:f,DOMComponent:c,DOMPropertyOperations:r,InstanceHandles:p,Mount:d,MultiChild:v,TextComponent:b}},S=e("./ExecutionEnvironment");S.canUseDOM&&window.top===window.self&&navigator.userAgent.indexOf("Chrome")>-1&&console.debug("Download the React DevTools for a better development experience: http://fb.me/react-devtools"),E.version="0.10.0",t.exports=E},{"./DOMPropertyOperations":9,"./EventPluginUtils":18,"./ExecutionEnvironment":20,"./ReactChildren":26,"./ReactComponent":27,"./ReactCompositeComponent":29,"./ReactContext":30,"./ReactCurrentOwner":31,"./ReactDOM":32,"./ReactDOMComponent":34,"./ReactDefaultInjection":44,"./ReactInstanceHandles":53,"./ReactMount":55,"./ReactMultiChild":57,"./ReactPerf":60,"./ReactPropTypes":64,"./ReactServerRendering":68,"./ReactTextComponent":70,"./onlyChild":128}],25:[function(e,t,n){var r=e("./ReactMount"),i=e("./invariant"),s={getDOMNode:function(){return i(this.isMounted(),"getDOMNode(): A component must be mounted to have a DOM node."),r.getNode(this._rootNodeID)}};t.exports=s},{"./ReactMount":55,"./invariant":112}],26:[function(e,t,n){function a(e,t){this.forEachFunction=e,this.forEachContext=t}function f(e,t,n,r){var i=e;i.forEachFunction.call(i.forEachContext,t,r)}function l(e,t,n){if(e==null)return e;var r=a.getPooled(t,n);s(e,f,r),a.release(r)}function c(e,t,n){this.mapResult=e,this.mapFunction=t,this.mapContext=n}function h(e,t,n,r){var s=e,o=s.mapResult,u=s.mapFunction.call(s.mapContext,t,r);i(!o.hasOwnProperty(n),"ReactChildren.map(...): Encountered two children with the same key, `%s`. Children keys must be unique.",n),o[n]=u}function p(e,t,n){if(e==null)return e;var r={},i=c.getPooled(r,t,n);return s(e,h,i),c.release(i),r}var r=e("./PooledClass"),i=e("./invariant"),s=e("./traverseAllChildren"),o=r.twoArgumentPooler,u=r.threeArgumentPooler;r.addPoolingTo(a,o),r.addPoolingTo(c,u);var d={forEach:l,map:p};t.exports=d},{"./PooledClass":23,"./invariant":112,"./traverseAllChildren":133}],27:[function(e,t,n){function y(e){if(e.__keyValidated__||e.props.key!=null)return;e.__keyValidated__=!0;if(!r.current)return;var t=r.current.constructor.displayName;if(c.hasOwnProperty(t))return;c[t]=!0;var n='Each child in an array should have a unique "key" prop. Check the render method of '+t+".",i=null;e.isOwnedBy(r.current)||(i=e._owner&&e._owner.constructor.displayName,n+=" It was passed a child from "+i+"."),n+=" See http://fb.me/react-warning-keys for more information.",f("react_key_warning",{component:t,componentOwner:i}),console.warn(n)}function b(e){if(d.test(e)){var t=r.current.constructor.displayName;if(h.hasOwnProperty(t))return;h[t]=!0,f("react_numeric_key_warning"),console.warn("Child objects should have non-numeric keys so ordering is preserved. Check the render method of "+t+". "+"See http://fb.me/react-warning-keys for more information.")}}function w(){var e=r.current&&r.current.constructor.displayName||"";if(p.hasOwnProperty(e))return;p[e]=!0,f("react_object_map_children")}function E(e){if(Array.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];S.isValidComponent(n)&&y(n)}else if(S.isValidComponent(e))e.__keyValidated__=!0;else if(e&&typeof e=="object"){w();for(var r in e)b(r,e)}}var r=e("./ReactCurrentOwner"),i=e("./ReactOwner"),s=e("./ReactUpdates"),o=e("./invariant"),u=e("./keyMirror"),a=e("./merge"),f=e("./monitorCodeUse"),l=u({MOUNTED:null,UNMOUNTED:null}),c={},h={},p={},d=/^\d+$/,v=!1,m=null,g=null,S={injection:{injectEnvironment:function(e){o(!v,"ReactComponent: injectEnvironment() can only be called once."),g=e.mountImageIntoNode,m=e.unmountIDFromEnvironment,S.BackendIDOperations=e.BackendIDOperations,S.ReactReconcileTransaction=e.ReactReconcileTransaction,v=!0}},isValidComponent:function(e){if(!e||!e.type||!e.type.prototype)return!1;var t=e.type.prototype;return typeof t.mountComponentIntoNode=="function"&&typeof t.receiveComponent=="function"},LifeCycle:l,BackendIDOperations:null,ReactReconcileTransaction:null,Mixin:{isMounted:function(){return this._lifeCycleState===l.MOUNTED},setProps:function(e,t){this.replaceProps(a(this._pendingProps||this.props,e),t)},replaceProps:function(e,t){o(this.isMounted(),"replaceProps(...): Can only update a mounted component."),o(this._mountDepth===0,"replaceProps(...): You called `setProps` or `replaceProps` on a component with a parent. This is an anti-pattern since props will get reactively updated when rendered. Instead, change the owner's `render` method to pass the correct value as props to the component where it is created."),this._pendingProps=e,s.enqueueUpdate(this,t)},construct:function(e,t){this.props=e||{},this._owner=r.current,this._lifeCycleState=l.UNMOUNTED,this._pendingProps=null,this._pendingCallbacks=null,this._pendingOwner=this._owner;var n=arguments.length-1;if(n===1)E(t),this.props.children=t;else if(n>1){var i=Array(n);for(var s=0;s<n;s++)E(arguments[s+1]),i[s]=arguments[s+1];this.props.children=i}},mountComponent:function(e,t,n){o(!this.isMounted(),"mountComponent(%s, ...): Can only mount an unmounted component. Make sure to avoid storing components between renders or reusing a single component instance in multiple places.",e);var r=this.props;r.ref!=null&&i.addComponentAsRefTo(this,r.ref,this._owner),this._rootNodeID=e,this._lifeCycleState=l.MOUNTED,this._mountDepth=n},unmountComponent:function(){o(this.isMounted(),"unmountComponent(): Can only unmount a mounted component.");var e=this.props;e.ref!=null&&i.removeComponentAsRefFrom(this,e.ref,this._owner),m(this._rootNodeID),this._rootNodeID=null,this._lifeCycleState=l.UNMOUNTED},receiveComponent:function(e,t){o(this.isMounted(),"receiveComponent(...): Can only update a mounted component."),this._pendingOwner=e._owner,this._pendingProps=e.props,this._performUpdateIfNecessary(t)},performUpdateIfNecessary:function(){var e=S.ReactReconcileTransaction.getPooled();e.perform(this._performUpdateIfNecessary,this,e),S.ReactReconcileTransaction.release(e)},_performUpdateIfNecessary:function(e){if(this._pendingProps==null)return;var t=this.props,n=this._owner;this.props=this._pendingProps,this._owner=this._pendingOwner,this._pendingProps=null,this.updateComponent(e,t,n)},updateComponent:function(e,t,n){var r=this.props;if(this._owner!==n||r.ref!==t.ref)t.ref!=null&&i.removeComponentAsRefFrom(this,t.ref,n),r.ref!=null&&i.addComponentAsRefTo(this,r.ref,this._owner)},mountComponentIntoNode:function(e,t,n){var r=S.ReactReconcileTransaction.getPooled();r.perform(this._mountComponentIntoNode,this,e,t,r,n),S.ReactReconcileTransaction.release(r)},_mountComponentIntoNode:function(e,t,n,r){var i=this.mountComponent(e,n,0);g(i,t,r)},isOwnedBy:function(e){return this._owner===e},getSiblingByRef:function(e){var t=this._owner;return!t||!t.refs?null:t.refs[e]}}};t.exports=S},{"./ReactCurrentOwner":31,"./ReactOwner":59,"./ReactUpdates":71,"./invariant":112,"./keyMirror":118,"./merge":121,"./monitorCodeUse":125}],28:[function(e,t,n){var r=e("./ReactDOMIDOperations"),i=e("./ReactMarkupChecksum"),s=e("./ReactMount"),o=e("./ReactPerf"),u=e("./ReactReconcileTransaction"),a=e("./getReactRootElementInContainer"),f=e("./invariant"),l=1,c=9,h={ReactReconcileTransaction:u,BackendIDOperations:r,unmountIDFromEnvironment:function(e){s.purgeID(e)},mountImageIntoNode:o.measure("ReactComponentBrowserEnvironment","mountImageIntoNode",function(e,t,n){f(t&&(t.nodeType===l||t.nodeType===c),"mountComponentIntoNode(...): Target container is not valid.");if(n){if(i.canReuseMarkup(e,a(t)))return;f(t.nodeType!==c,"You're trying to render a component to the document using server rendering but the checksum was invalid. This usually means you rendered a different component type or props on the client from the one on the server, or your render() methods are impure. React cannot handle this case due to cross-browser quirks by rendering at the document root. You should look for environment dependent code in your components and ensure the props are the same client and server side."),console.warn("React attempted to use reuse markup in a container but the checksum was invalid. This generally means that you are using server rendering and the markup generated on the server was not what the client was expecting. React injectednew markup to compensate which works but you have lost many of the benefits of server rendering. Instead, figure out why the markup being generated is different on the client or server.")}f(t.nodeType!==c,"You're trying to render a component to the document but you didn't use server rendering. We can't do this without using server rendering due to cross-browser quirks. See renderComponentToString() for server rendering."),t.innerHTML=e})};t.exports=h},{"./ReactDOMIDOperations":36,"./ReactMarkupChecksum":54,"./ReactMount":55,"./ReactPerf":60,"./ReactReconcileTransaction":66,"./getReactRootElementInContainer":107,"./invariant":112}],29:[function(e,t,n){function C(e,t,n){for(var r in t)t.hasOwnProperty(r)&&d(typeof t[r]=="function","%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",e.displayName||"ReactCompositeComponent",c[n],r)}function k(e,t){var n=T[t];W.hasOwnProperty(t)&&d(n===S.OVERRIDE_BASE,"ReactCompositeComponentInterface: You are attempting to override `%s` from your class specification. Ensure that your method names do not overlap with React methods.",t),e.hasOwnProperty(t)&&d(n===S.DEFINE_MANY||n===S.DEFINE_MANY_MERGED,"ReactCompositeComponentInterface: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",t)}function L(e){var t=e._compositeLifeCycleState;d(e.isMounted()||t===z.MOUNTING,"replaceState(...): Can only update a mounted or mounting component."),d(t!==z.RECEIVING_STATE,"replaceState(...): Cannot update during an existing state transition (such as within `render`). This could potentially cause an infinite loop so it is forbidden."),d(t!==z.UNMOUNTING,"replaceState(...): Cannot update while unmounting component. This usually means you called setState() on an unmounted component.")}function A(e,t){d(!V(t),"ReactCompositeComponent: You're attempting to use a component class as a mixin. Instead, just use a regular object."),d(!r.isValidComponent(t),"ReactCompositeComponent: You're attempting to use a component as a mixin. Instead, just use a regular object.");var n=e.componentConstructor,i=n.prototype;for(var s in t){var o=t[s];if(!t.hasOwnProperty(s))continue;k(i,s);if(N.hasOwnProperty(s))N[s](e,o);else{var u=s in T,a=s in i,f=o&&o.__reactDontBind,l=typeof o=="function",c=l&&!u&&!a&&!f;c?(i.__reactAutoBindMap||(i.__reactAutoBindMap={}),i.__reactAutoBindMap[s]=o,i[s]=o):a?T[s]===S.DEFINE_MANY_MERGED?i[s]=_(i[s],o):i[s]=D(i[s],o):i[s]=o}}}function O(e,t){if(!t)return;for(var n in t){var r=t[n];if(!t.hasOwnProperty(n))return;var i=n in e,s=r;if(i){var o=e[n],u=typeof o,a=typeof r;d(u==="function"&&a==="function","ReactCompositeComponent: You are attempting to define `%s` on your component more than once, but that is only supported for functions, which are chained together. This conflict may be due to a mixin.",n),s=D(o,r)}e[n]=s,e.componentConstructor[n]=s}}function M(e,t){return d(e&&t&&typeof e=="object"&&typeof t=="object","mergeObjectsWithNoDuplicateKeys(): Cannot merge non-objects"),b(t,function(t,n){d(e[n]===undefined,"mergeObjectsWithNoDuplicateKeys(): Tried to merge two objects with the same key: %s",n),e[n]=t}),e}function _(e,t){return function(){var r=e.apply(this,arguments),i=t.apply(this,arguments);return r==null?i:i==null?r:M(r,i)}}function D(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function V(e){return e instanceof Function&&"componentConstructor"in e&&e.componentConstructor instanceof Function}var r=e("./ReactComponent"),i=e("./ReactContext"),s=e("./ReactCurrentOwner"),o=e("./ReactErrorUtils"),u=e("./ReactOwner"),a=e("./ReactPerf"),f=e("./ReactPropTransferer"),l=e("./ReactPropTypeLocations"),c=e("./ReactPropTypeLocationNames"),h=e("./ReactUpdates"),p=e("./instantiateReactComponent"),d=e("./invariant"),v=e("./keyMirror"),m=e("./merge"),g=e("./mixInto"),y=e("./monitorCodeUse"),b=e("./objMap"),w=e("./shouldUpdateReactComponent"),E=e("./warning"),S=v({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null}),x=[],T={mixins:S.DEFINE_MANY,statics:S.DEFINE_MANY,propTypes:S.DEFINE_MANY,contextTypes:S.DEFINE_MANY,childContextTypes:S.DEFINE_MANY,getDefaultProps:S.DEFINE_MANY_MERGED,getInitialState:S.DEFINE_MANY_MERGED,getChildContext:S.DEFINE_MANY_MERGED,render:S.DEFINE_ONCE,componentWillMount:S.DEFINE_MANY,componentDidMount:S.DEFINE_MANY,componentWillReceiveProps:S.DEFINE_MANY,shouldComponentUpdate:S.DEFINE_ONCE,componentWillUpdate:S.DEFINE_MANY,componentDidUpdate:S.DEFINE_MANY,componentWillUnmount:S.DEFINE_MANY,updateComponent:S.OVERRIDE_BASE},N={displayName:function(e,t){e.componentConstructor.displayName=t},mixins:function(e,t){if(t)for(var n=0;n<t.length;n++)A(e,t[n])},childContextTypes:function(e,t){var n=e.componentConstructor;C(n,t,l.childContext),n.childContextTypes=m(n.childContextTypes,t)},contextTypes:function(e,t){var n=e.componentConstructor;C(n,t,l.context),n.contextTypes=m(n.contextTypes,t)},propTypes:function(e,t){var n=e.componentConstructor;C(n,t,l.prop),n.propTypes=m(n.propTypes,t)},statics:function(e,t){O(e,t)}},P={constructor:!0,construct:!0,isOwnedBy:!0,type:!0,props:!0,__keyValidated__:!0,_owner:!0,_currentContext:!0},H={__keyValidated__:!0,__keySetters:!0,_compositeLifeCycleState:!0,_currentContext:!0,_defaultProps:!0,_instance:!0,_lifeCycleState:!0,_mountDepth:!0,_owner:!0,_pendingCallbacks:!0,_pendingContext:!0,_pendingForceUpdate:!0,_pendingOwner:!0,_pendingProps:!0,_pendingState:!0,_renderedComponent:!0,_rootNodeID:!0,context:!0,props:!0,refs:!0,state:!0,_pendingQueries:!0,_queryPropListeners:!0,queryParams:!0},B={},j=0,F=function(e,t){var n=P.hasOwnProperty(t);if(j>0||n)return;var r=e.constructor.displayName||"Unknown",i=s.current,o=i&&i.constructor.displayName||"Unknown",u=t+"|"+r+"|"+o;if(B.hasOwnProperty(u))return;B[u]=!0;var a=i?" in "+o+".":" at the top level.",f="<"+r+" />.type."+t+"(...)";y("react_descriptor_property_access",{component:r}),console.warn('Invalid access to component property "'+t+'" on '+r+a+" See http://fb.me/react-warning-descriptors ."+" Use a static method instead: "+f)},I=function(e,t){return e.__reactMembraneFunction&&e.__reactMembraneSelf===t?e.__reactMembraneFunction:e.__reactMembraneFunction=function(){j++;try{var n=this===t?this.__realComponentInstance:this;return e.apply(n,arguments)}finally{j--}}},q=function(e,t,n){Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:function(){if(this===e)return t[n];F(this,n);var r=this.__realComponentInstance[n];return typeof r=="function"&&n!=="type"&&n!=="constructor"?I(r,this):r},set:function(r){if(this===e){t[n]=r;return}F(this,n),this.__realComponentInstance[n]=r}})},R=function(e){var t={},n;for(n in e)q(t,e,n);for(n in H)H.hasOwnProperty(n)&&!(n in e)&&q(t,e,n);return t},U=function(e){try{var t=function(){this.__realComponentInstance=new e,Object.freeze(this)};return t.prototype=R(e.prototype),t}catch(n){return e}},z=v({MOUNTING:null,UNMOUNTING:null,RECEIVING_PROPS:null,RECEIVING_STATE:null}),W={construct:function(e,t){r.Mixin.construct.apply(this,arguments),u.Mixin.construct.apply(this,arguments),this.state=null,this._pendingState=null,this.context=null,this._currentContext=i.current,this._pendingContext=null,this._descriptor=null,this._compositeLifeCycleState=null},toJSON:function(){return{type:this.type,props:this.props}},isMounted:function(){return r.Mixin.isMounted.call(this)&&this._compositeLifeCycleState!==z.MOUNTING},mountComponent:a.measure("ReactCompositeComponent","mountComponent",function(e,t,n){r.Mixin.mountComponent.call(this,e,t,n),this._compositeLifeCycleState=z.MOUNTING,this.context=this._processContext(this._currentContext),this._defaultProps=this.getDefaultProps?this.getDefaultProps():null,this.props=this._processProps(this.props),this.__reactAutoBindMap&&this._bindAutoBindMethods(),this.state=this.getInitialState?this.getInitialState():null,d(typeof this.state=="object"&&!Array.isArray(this.state),"%s.getInitialState(): must return an object or null",this.constructor.displayName||"ReactCompositeComponent"),this._pendingState=null,this._pendingForceUpdate=!1,this.componentWillMount&&(this.componentWillMount(),this._pendingState&&(this.state=this._pendingState,this._pendingState=null)),this._renderedComponent=p(this._renderValidatedComponent()),this._compositeLifeCycleState=null;var i=this._renderedComponent.mountComponent(e,t,n+1);return this.componentDidMount&&t.getReactMountReady().enqueue(this,this.componentDidMount),i}),unmountComponent:function(){this._compositeLifeCycleState=z.UNMOUNTING,this.componentWillUnmount&&this.componentWillUnmount(),this._compositeLifeCycleState=null,this._defaultProps=null,this._renderedComponent.unmountComponent(),this._renderedComponent=null,r.Mixin.unmountComponent.call(this)},setState:function(e,t){d(typeof e=="object"||e==null,"setState(...): takes an object of state variables to update."),E(e!=null,"setState(...): You passed an undefined or null state object; instead, use forceUpdate()."),this.replaceState(m(this._pendingState||this.state,e),t)},replaceState:function(e,t){L(this),this._pendingState=e,h.enqueueUpdate(this,t)},_processContext:function(e){var t=null,n=this.constructor.contextTypes;if(n){t={};for(var r in n)t[r]=e[r];this._checkPropTypes(n,t,l.context)}return t},_processChildContext:function(e){var t=this.getChildContext&&this.getChildContext(),n=this.constructor.displayName||"ReactCompositeComponent";if(t){d(typeof this.constructor.childContextTypes=="object","%s.getChildContext(): childContextTypes must be defined in order to use getChildContext().",n),this._checkPropTypes(this.constructor.childContextTypes,t,l.childContext);for(var r in t)d(r in this.constructor.childContextTypes,'%s.getChildContext(): key "%s" is not defined in childContextTypes.',n,r);return m(e,t)}return e},_processProps:function(e){var t=m(e),n=this._defaultProps;for(var r in n)typeof t[r]=="undefined"&&(t[r]=n[r]);var i=this.constructor.propTypes;return i&&this._checkPropTypes(i,t,l.prop),t},_checkPropTypes:function(e,t,n){var r=this.constructor.displayName;for(var i in e)e.hasOwnProperty(i)&&e[i](t,i,r,n)},performUpdateIfNecessary:function(){var e=this._compositeLifeCycleState;if(e===z.MOUNTING||e===z.RECEIVING_PROPS)return;r.Mixin.performUpdateIfNecessary.call(this)},_performUpdateIfNecessary:function(e){if(this._pendingProps==null&&this._pendingState==null&&this._pendingContext==null&&!this._pendingForceUpdate)return;var t=this._pendingContext||this._currentContext,n=this._processContext(t);this._pendingContext=null;var r=this.props;this._pendingProps!=null&&(r=this._processProps(this._pendingProps),this._pendingProps=null,this._compositeLifeCycleState=z.RECEIVING_PROPS,this.componentWillReceiveProps&&this.componentWillReceiveProps(r,n)),this._compositeLifeCycleState=z.RECEIVING_STATE;var i=this._pendingOwner,s=this._pendingState||this.state;this._pendingState=null;try{this._pendingForceUpdate||!this.shouldComponentUpdate||this.shouldComponentUpdate(r,s,n)?(this._pendingForceUpdate=!1,this._performComponentUpdate(r,i,s,t,n,e)):(this.props=r,this._owner=i,this.state=s,this._currentContext=t,this.context=n)}finally{this._compositeLifeCycleState=null}},_performComponentUpdate:function(e,t,n,r,i,s){var o=this.props,u=this._owner,a=this.state,f=this.context;this.componentWillUpdate&&this.componentWillUpdate(e,n,i),this.props=e,this._owner=t,this.state=n,this._currentContext=r,this.context=i,this.updateComponent(s,o,u,a,f),this.componentDidUpdate&&s.getReactMountReady().enqueue(this,this.componentDidUpdate.bind(this,o,a,f))},receiveComponent:function(e,t){if(e===this._descriptor)return;this._descriptor=e,this._pendingContext=e._currentContext,r.Mixin.receiveComponent.call(this,e,t)},updateComponent:a.measure("ReactCompositeComponent","updateComponent",function(e,t,n,i,s){r.Mixin.updateComponent.call(this,e,t,n);var o=this._renderedComponent,u=this._renderValidatedComponent();if(w(o,u))o.receiveComponent(u,e);else{var a=this._rootNodeID,f=o._rootNodeID;o.unmountComponent(),this._renderedComponent=p(u);var l=this._renderedComponent.mountComponent(a,e,this._mountDepth+1);r.BackendIDOperations.dangerouslyReplaceNodeWithMarkupByID(f,l)}}),forceUpdate:function(e){var t=this._compositeLifeCycleState;d(this.isMounted()||t===z.MOUNTING,"forceUpdate(...): Can only force an update on mounted or mounting components."),d(t!==z.RECEIVING_STATE&&t!==z.UNMOUNTING,"forceUpdate(...): Cannot force an update while unmounting component or during an existing state transition (such as within `render`)."),this._pendingForceUpdate=!0,h.enqueueUpdate(this,e)},_renderValidatedComponent:a.measure("ReactCompositeComponent","_renderValidatedComponent",function(){var e,t=i.current;i.current=this._processChildContext(this._currentContext),s.current=this;try{e=this.render()}finally{i.current=t,s.current=null}return d(r.isValidComponent(e),"%s.render(): A valid ReactComponent must be returned. You may have returned null, undefined, an array, or some other invalid object.",this.constructor.displayName||"ReactCompositeComponent"),e}),_bindAutoBindMethods:function(){for(var e in this.__reactAutoBindMap){if(!this.__reactAutoBindMap.hasOwnProperty(e))continue;var t=this.__reactAutoBindMap[e];this[e]=this._bindAutoBindMethod(o.guard(t,this.constructor.displayName+"."+e))}},_bindAutoBindMethod:function(e){var t=this,n=function(){return e.apply(t,arguments)};n.__reactBoundContext=t,n.__reactBoundMethod=e,n.__reactBoundArguments=null;var r=t.constructor.displayName,i=n.bind;return n.bind=function(s){var o=Array.prototype.slice.call(arguments,1);if(s!==t&&s!==null)y("react_bind_warning",{component:r}),console.warn("bind(): React component methods may only be bound to the component instance. See "+r);else if(!o.length)return y("react_bind_warning",{component:r}),console.warn("bind(): You are binding a component method to the component. React does this for you automatically in a high-performance way, so you can safely remove this call. See "+r),n;var u=i.apply(n,arguments);return u.__reactBoundContext=t,u.__reactBoundMethod=e,u.__reactBoundArguments=o,u},n}},X=function(){};g(X,r.Mixin),g(X,u.Mixin),g(X,f.Mixin),g(X,W);var $={LifeCycle:z,Base:X,createClass:function(e){var t=function(){};t.prototype=new X,t.prototype.constructor=t;var n=t,r=function(e,t){var r=new n;return r.construct.apply(r,arguments),r};r.componentConstructor=t,t.ConvenienceConstructor=r,r.originalSpec=e,x.forEach(A.bind(null,r)),A(r,e),d(t.prototype.render,"createClass(...): Class specification must implement a `render` method."),t.prototype.componentShouldUpdate&&(y("react_component_should_update_warning",{component:e.displayName}),console.warn((e.displayName||"A component")+" has a method called "+"componentShouldUpdate(). Did you mean shouldComponentUpdate()? "+"The name is phrased as a question because the function is "+"expected to return a value.")),r.type=t,t.prototype.type=t;for(var i in T)t.prototype[i]||(t.prototype[i]=null);return n=U(t),r},isValidClass:V,injection:{injectMixin:function(e){x.push(e)}}};t.exports=$},{"./ReactComponent":27,"./ReactContext":30,"./ReactCurrentOwner":31,"./ReactErrorUtils":47,"./ReactOwner":59,"./ReactPerf":60,"./ReactPropTransferer":61,"./ReactPropTypeLocationNames":62,"./ReactPropTypeLocations":63,"./ReactUpdates":71,"./instantiateReactComponent":111,"./invariant":112,"./keyMirror":118,"./merge":121,"./mixInto":124,"./monitorCodeUse":125,"./objMap":126,"./shouldUpdateReactComponent":131,"./warning":134}],30:[function(e,t,n){var r=e("./merge"),i={current:{},withContext:function(e,t){var n,s=i.current;i.current=r(s,e);try{n=t()}finally{i.current=s}return n}};t.exports=i},{"./merge":121}],31:[function(e,t,n){var r={current:null};t.exports=r},{}],32:[function(e,t,n){function o(e,t){var n=function(){};n.prototype=new r(e,t),n.prototype.constructor=n,n.displayName=e;var i=function(e,t){var r=new n;return r.construct.apply(r,arguments),r};return i.type=n,n.prototype.type=n,n.ConvenienceConstructor=i,i.componentConstructor=n,i}var r=e("./ReactDOMComponent"),i=e("./mergeInto"),s=e("./objMapKeyVal"),u=s({a:!1,abbr:!1,address:!1,area:!0,article:!1,aside:!1,audio:!1,b:!1,base:!0,bdi:!1,bdo:!1,big:!1,blockquote:!1,body:!1,br:!0,button:!1,canvas:!1,caption:!1,cite:!1,code:!1,col:!0,colgroup:!1,data:!1,datalist:!1,dd:!1,del:!1,details:!1,dfn:!1,div:!1,dl:!1,dt:!1,em:!1,embed:!0,fieldset:!1,figcaption:!1,figure:!1,footer:!1,form:!1,h1:!1,h2:!1,h3:!1,h4:!1,h5:!1,h6:!1,head:!1,header:!1,hr:!0,html:!1,i:!1,iframe:!1,img:!0,input:!0,ins:!1,kbd:!1,keygen:!0,label:!1,legend:!1,li:!1,link:!0,main:!1,map:!1,mark:!1,menu:!1,menuitem:!1,meta:!0,meter:!1,nav:!1,noscript:!1,object:!1,ol:!1,optgroup:!1,option:!1,output:!1,p:!1,param:!0,pre:!1,progress:!1,q:!1,rp:!1,rt:!1,ruby:!1,s:!1,samp:!1,script:!1,section:!1,select:!1,small:!1,source:!0,span:!1,strong:!1,style:!1,sub:!1,summary:!1,sup:!1,table:!1,tbody:!1,td:!1,textarea:!1,tfoot:!1,th:!1,thead:!1,time:!1,title:!1,tr:!1,track:!0,u:!1,ul:!1,"var":!1,video:!1,wbr:!0,circle:!1,defs:!1,g:!1,line:!1,linearGradient:!1,path:!1,polygon:!1,polyline:!1,radialGradient:!1,rect:!1,stop:!1,svg:!1,text:!1},o),a={injectComponentClasses:function(e){i(u,e)}};u.injection=a,t.exports=u},{"./ReactDOMComponent":34,"./mergeInto":123,"./objMapKeyVal":127}],33:[function(e,t,n){var r=e("./AutoFocusMixin"),i=e("./ReactBrowserComponentMixin"),s=e("./ReactCompositeComponent"),o=e("./ReactDOM"),u=e("./keyMirror"),a=o.button,f=u({onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0}),l=s.createClass({displayName:"ReactDOMButton",mixins:[r,i],render:function(){var e={};for(var t in this.props)this.props.hasOwnProperty(t)&&(!this.props.disabled||!f[t])&&(e[t]=this.props[t]);return a(e,this.props.children)}});t.exports=l},{"./AutoFocusMixin":1,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./keyMirror":118}],34:[function(e,t,n){function x(e){if(!e)return;p(e.children==null||e.dangerouslySetInnerHTML==null,"Can only set one of `children` or `props.dangerouslySetInnerHTML`."),p(e.style==null||typeof e.style=="object","The `style` prop expects a mapping from style properties to values, not a string.")}function T(e,t,n,r){var i=f.findReactContainerForID(e);if(i){var s=i.nodeType===S?i.ownerDocument:i;y(t,s)}r.getPutListenerQueue().enqueuePutListener(e,t,n)}function N(e,t){this._tagOpen="<"+e,this._tagClose=t?"":"</"+e+">",this.tagName=e.toUpperCase()}var r=e("./CSSPropertyOperations"),i=e("./DOMProperty"),s=e("./DOMPropertyOperations"),o=e("./ReactBrowserComponentMixin"),u=e("./ReactComponent"),a=e("./ReactEventEmitter"),f=e("./ReactMount"),l=e("./ReactMultiChild"),c=e("./ReactPerf"),h=e("./escapeTextForBrowser"),p=e("./invariant"),d=e("./keyOf"),v=e("./merge"),m=e("./mixInto"),g=a.deleteListener,y=a.listenTo,b=a.registrationNameModules,w={string:!0,number:!0},E=d({style:null}),S=1;N.Mixin={mountComponent:c.measure("ReactDOMComponent","mountComponent",function(e,t,n){return u.Mixin.mountComponent.call(this,e,t,n),x(this.props),this._createOpenTagMarkupAndPutListeners(t)+this._createContentMarkup(t)+this._tagClose}),_createOpenTagMarkupAndPutListeners:function(e){var t=this.props,n=this._tagOpen;for(var i in t){if(!t.hasOwnProperty(i))continue;var o=t[i];if(o==null)continue;if(b[i])T(this._rootNodeID,i,o,e);else{i===E&&(o&&(o=t.style=v(t.style)),o=r.createMarkupForStyles(o));var u=s.createMarkupForProperty(i,o);u&&(n+=" "+u)}}if(e.renderToStaticMarkup)return n+">";var a=s.createMarkupForID(this._rootNodeID);return n+" "+a+">"},_createContentMarkup:function(e){var t=this.props.dangerouslySetInnerHTML;if(t!=null){if(t.__html!=null)return t.__html}else{var n=w[typeof this.props.children]?this.props.children:null,r=n!=null?null:this.props.children;if(n!=null)return h(n);if(r!=null){var i=this.mountChildren(r,e);return i.join("")}}return""},receiveComponent:function(e,t){if(e===this)return;x(e.props),u.Mixin.receiveComponent.call(this,e,t)},updateComponent:c.measure("ReactDOMComponent","updateComponent",function(e,t,n){u.Mixin.updateComponent.call(this,e,t,n),this._updateDOMProperties(t,e),this._updateDOMChildren(t,e)}),_updateDOMProperties:function(e,t){var n=this.props,r,s,o;for(r in e){if(n.hasOwnProperty(r)||!e.hasOwnProperty(r))continue;if(r===E){var a=e[r];for(s in a)a.hasOwnProperty(s)&&(o=o||{},o[s]="")}else b[r]?g(this._rootNodeID,r):(i.isStandardName[r]||i.isCustomAttribute(r))&&u.BackendIDOperations.deletePropertyByID(this._rootNodeID,r)}for(r in n){var f=n[r],l=e[r];if(!n.hasOwnProperty(r)||f===l)continue;if(r===E){f&&(f=n.style=v(f));if(l){for(s in l)l.hasOwnProperty(s)&&!f.hasOwnProperty(s)&&(o=o||{},o[s]="");for(s in f)f.hasOwnProperty(s)&&l[s]!==f[s]&&(o=o||{},o[s]=f[s])}else o=f}else b[r]?T(this._rootNodeID,r,f,t):(i.isStandardName[r]||i.isCustomAttribute(r))&&u.BackendIDOperations.updatePropertyByID(this._rootNodeID,r,f)}o&&u.BackendIDOperations.updateStylesByID(this._rootNodeID,o)},_updateDOMChildren:function(e,t){var n=this.props,r=w[typeof e.children]?e.children:null,i=w[typeof n.children]?n.children:null,s=e.dangerouslySetInnerHTML&&e.dangerouslySetInnerHTML.__html,o=n.dangerouslySetInnerHTML&&n.dangerouslySetInnerHTML.__html,a=r!=null?null:e.children,f=i!=null?null:n.children,l=r!=null||s!=null,c=i!=null||o!=null;a!=null&&f==null?this.updateChildren(null,t):l&&!c&&this.updateTextContent(""),i!=null?r!==i&&this.updateTextContent(""+i):o!=null?s!==o&&u.BackendIDOperations.updateInnerHTMLByID(this._rootNodeID,o):f!=null&&this.updateChildren(f,t)},unmountComponent:function(){this.unmountChildren(),a.deleteAllListeners(this._rootNodeID),u.Mixin.unmountComponent.call(this)}},m(N,u.Mixin),m(N,N.Mixin),m(N,l.Mixin),m(N,o),t.exports=N},{"./CSSPropertyOperations":3,"./DOMProperty":8,"./DOMPropertyOperations":9,"./ReactBrowserComponentMixin":25,"./ReactComponent":27,"./ReactEventEmitter":48,"./ReactMount":55,"./ReactMultiChild":57,"./ReactPerf":60,"./escapeTextForBrowser":98,"./invariant":112,"./keyOf":119,"./merge":121,"./mixInto":124}],35:[function(e,t,n){var r=e("./ReactBrowserComponentMixin"),i=e("./ReactCompositeComponent"),s=e("./ReactDOM"),o=e("./ReactEventEmitter"),u=e("./EventConstants"),a=s.form,f=i.createClass({displayName:"ReactDOMForm",mixins:[r],render:function(){return this.transferPropsTo(a(null,this.props.children))},componentDidMount:function(){o.trapBubbledEvent(u.topLevelTypes.topReset,"reset",this.getDOMNode()),o.trapBubbledEvent(u.topLevelTypes.topSubmit,"submit",this.getDOMNode())}});t.exports=f},{"./EventConstants":14,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./ReactEventEmitter":48}],36:[function(e,t,n){var r=e("./CSSPropertyOperations"),i=e("./DOMChildrenOperations"),s=e("./DOMPropertyOperations"),o=e("./ReactMount"),u=e("./ReactPerf"),a=e("./invariant"),f={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},l,c={updatePropertyByID:u.measure("ReactDOMIDOperations","updatePropertyByID",function(e,t,n){var r=o.getNode(e);a(!f.hasOwnProperty(t),"updatePropertyByID(...): %s",f[t]),n!=null?s.setValueForProperty(r,t,n):s.deleteValueForProperty(r,t)}),deletePropertyByID:u.measure("ReactDOMIDOperations","deletePropertyByID",function(e,t,n){var r=o.getNode(e);a(!f.hasOwnProperty(t),"updatePropertyByID(...): %s",f[t]),s.deleteValueForProperty(r,t,n)}),updateStylesByID:u.measure("ReactDOMIDOperations","updateStylesByID",function(e,t){var n=o.getNode(e);r.setValueForStyles(n,t)}),updateInnerHTMLByID:u.measure("ReactDOMIDOperations","updateInnerHTMLByID",function(e,t){var n=o.getNode(e);if(l===undefined){var r=document.createElement("div");r.innerHTML=" ",l=r.innerHTML===""}l&&n.parentNode.replaceChild(n,n),l&&t.match(/^[ \r\n\t\f]/)?(n.innerHTML="﻿"+t,n.firstChild.deleteData(0,1)):n.innerHTML=t}),updateTextContentByID:u.measure("ReactDOMIDOperations","updateTextContentByID",function(e,t){var n=o.getNode(e);i.updateTextContent(n,t)}),dangerouslyReplaceNodeWithMarkupByID:u.measure("ReactDOMIDOperations","dangerouslyReplaceNodeWithMarkupByID",function(e,t){var n=o.getNode(e);i.dangerouslyReplaceNodeWithMarkup(n,t)}),dangerouslyProcessChildrenUpdates:u.measure("ReactDOMIDOperations","dangerouslyProcessChildrenUpdates",function(e,t){for(var n=0;n<e.length;n++)e[n].parentNode=o.getNode(e[n].parentID);i.processUpdates(e,t)})};t.exports=c},{"./CSSPropertyOperations":3,"./DOMChildrenOperations":7,"./DOMPropertyOperations":9,"./ReactMount":55,"./ReactPerf":60,"./invariant":112}],37:[function(e,t,n){var r=e("./ReactBrowserComponentMixin"),i=e("./ReactCompositeComponent"),s=e("./ReactDOM"),o=e("./ReactEventEmitter"),u=e("./EventConstants"),a=s.img,f=i.createClass({displayName:"ReactDOMImg",tagName:"IMG",mixins:[r],render:function(){return a(this.props)},componentDidMount:function(){var e=this.getDOMNode();o.trapBubbledEvent(u.topLevelTypes.topLoad,"load",e),o.trapBubbledEvent(u.topLevelTypes.topError,"error",e)}});t.exports=f},{"./EventConstants":14,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./ReactEventEmitter":48}],38:[function(e,t,n){var r=e("./AutoFocusMixin"),i=e("./DOMPropertyOperations"),s=e("./LinkedValueUtils"),o=e("./ReactBrowserComponentMixin"),u=e("./ReactCompositeComponent"),a=e("./ReactDOM"),f=e("./ReactMount"),l=e("./invariant"),c=e("./merge"),h=a.input,p={},d=u.createClass({displayName:"ReactDOMInput",mixins:[r,s.Mixin,o],getInitialState:function(){var e=this.props.defaultValue;return{checked:this.props.defaultChecked||!1,value:e!=null?e:null}},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var e=c(this.props);e.defaultChecked=null,e.defaultValue=null;var t=s.getValue(this);e.value=t!=null?t:this.state.value;var n=s.getChecked(this);return e.checked=n!=null?n:this.state.checked,e.onChange=this._handleChange,h(e,this.props.children)},componentDidMount:function(){var e=f.getID(this.getDOMNode());p[e]=this},componentWillUnmount:function(){var e=this.getDOMNode(),t=f.getID(e);delete p[t]},componentDidUpdate:function(e,t,n){var r=this.getDOMNode();this.props.checked!=null&&i.setValueForProperty(r,"checked",this.props.checked||!1);var o=s.getValue(this);o!=null&&i.setValueForProperty(r,"value",""+o)},_handleChange:function(e){var t,n=s.getOnChange(this);n&&(this._isChanging=!0,t=n.call(this,e),this._isChanging=!1),this.setState({checked:e.target.checked,value:e.target.value});var r=this.props.name;if(this.props.type==="radio"&&r!=null){var i=this.getDOMNode(),o=i;while(o.parentNode)o=o.parentNode;var u=o.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]');for(var a=0,c=u.length;a<c;a++){var h=u[a];if(h===i||h.form!==i.form)continue;var d=f.getID(h);l(d,"ReactDOMInput: Mixing React and non-React radio inputs with the same `name` is not supported.");var v=p[d];l(v,"ReactDOMInput: Unknown radio button ID %s.",d),v.setState({checked:!1})}}return t}});t.exports=d},{"./AutoFocusMixin":1,"./DOMPropertyOperations":9,"./LinkedValueUtils":21,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./ReactMount":55,"./invariant":112,"./merge":121}],39:[function(e,t,n){var r=e("./ReactBrowserComponentMixin"),i=e("./ReactCompositeComponent"),s=e("./ReactDOM"),o=e("./warning"),u=s.option,a=i.createClass({displayName:"ReactDOMOption",mixins:[r],componentWillMount:function(){o(this.props.selected==null,"Use the `defaultValue` or `value` props on <select> instead of setting `selected` on <option>.")},render:function(){return u(this.props,this.props.children)}});t.exports=a},{"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./warning":134}],40:[function(e,t,n){function c(e,t,n){if(e[t]==null)return;e.multiple?a(Array.isArray(e[t]),"The `%s` prop supplied to <select> must be an array if `multiple` is true.",t):a(!Array.isArray(e[t]),"The `%s` prop supplied to <select> must be a scalar value if `multiple` is false.",t)}function h(e,t){var n=e.props.multiple,r=t!=null?t:e.state.value,i=e.getDOMNode().options,s,o,u;if(n){s={};for(o=0,u=r.length;o<u;++o)s[""+r[o]]=!0}else s=""+r;for(o=0,u=i.length;o<u;o++){var a=n?s.hasOwnProperty(i[o].value):i[o].value===s;a!==i[o].selected&&(i[o].selected=a)}}var r=e("./AutoFocusMixin"),i=e("./LinkedValueUtils"),s=e("./ReactBrowserComponentMixin"),o=e("./ReactCompositeComponent"),u=e("./ReactDOM"),a=e("./invariant"),f=e("./merge"),l=u.select,p=o.createClass({displayName:"ReactDOMSelect",mixins:[r,i.Mixin,s],propTypes:{defaultValue:c,value:c},getInitialState:function(){return{value:this.props.defaultValue||(this.props.multiple?[]:"")}},componentWillReceiveProps:function(e){!this.props.multiple&&e.multiple?this.setState({value:[this.state.value]}):this.props.multiple&&!e.multiple&&this.setState({value:this.state.value[0]})},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var e=f(this.props);return e.onChange=this._handleChange,e.value=null,l(e,this.props.children)},componentDidMount:function(){h(this,i.getValue(this))},componentDidUpdate:function(){var e=i.getValue(this);e!=null&&h(this,e)},_handleChange:function(e){var t,n=i.getOnChange(this);n&&(this._isChanging=!0,t=n.call(this,e),this._isChanging=!1);var r;if(this.props.multiple){r=[];var s=e.target.options;for(var o=0,u=s.length;o<u;o++)s[o].selected&&r.push(s[o].value)}else r=e.target.value;return this.setState({value:r}),t}});t.exports=p},{"./AutoFocusMixin":1,"./LinkedValueUtils":21,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./invariant":112,"./merge":121}],41:[function(e,t,n){function s(e){var t=document.selection,n=t.createRange(),r=n.text.length,i=n.duplicate();i.moveToElementText(e),i.setEndPoint("EndToStart",n);var s=i.text.length,o=s+r;return{start:s,end:o}}function o(e){var t=window.getSelection();if(t.rangeCount===0)return null;var n=t.anchorNode,r=t.anchorOffset,i=t.focusNode,s=t.focusOffset,o=t.getRangeAt(0),u=o.toString().length,a=o.cloneRange();a.selectNodeContents(e),a.setEnd(o.startContainer,o.startOffset);var f=a.toString().length,l=f+u,c=document.createRange();c.setStart(n,r),c.setEnd(i,s);var h=c.collapsed;return c.detach(),{start:h?l:f,end:h?f:l}}function u(e,t){var n=document.selection.createRange().duplicate(),r,i;typeof t.end=="undefined"?(r=t.start,i=r):t.start>t.end?(r=t.end,i=t.start):(r=t.start,i=t.end),n.moveToElementText(e),n.moveStart("character",r),n.setEndPoint("EndToStart",n),n.moveEnd("character",i-r),n.select()}function a(e,t){var n=window.getSelection(),s=e[i()].length,o=Math.min(t.start,s),u=typeof t.end=="undefined"?o:Math.min(t.end,s);if(!n.extend&&o>u){var a=u;u=o,o=a}var f=r(e,o),l=r(e,u);if(f&&l){var c=document.createRange();c.setStart(f.node,f.offset),n.removeAllRanges(),o>u?(n.addRange(c),n.extend(l.node,l.offset)):(c.setEnd(l.node,l.offset),n.addRange(c)),c.detach()}}var r=e("./getNodeForCharacterOffset"),i=e("./getTextContentAccessor"),f={getOffsets:function(e){var t=document.selection?s:o;return t(e)},setOffsets:function(e,t){var n=document.selection?u:a;n(e,t)}};t.exports=f},{"./getNodeForCharacterOffset":106,"./getTextContentAccessor":108}],42:[function(e,t,n){var r=e("./AutoFocusMixin"),i=e("./DOMPropertyOperations"),s=e("./LinkedValueUtils"),o=e("./ReactBrowserComponentMixin"),u=e("./ReactCompositeComponent"),a=e("./ReactDOM"),f=e("./invariant"),l=e("./merge"),c=e("./warning"),h=a.textarea,p=u.createClass({displayName:"ReactDOMTextarea",mixins:[r,s.Mixin,o],getInitialState:function(){var e=this.props.defaultValue,t=this.props.children;t!=null&&(c(!1,"Use the `defaultValue` or `value` props instead of setting children on <textarea>."),f(e==null,"If you supply `defaultValue` on a <textarea>, do not pass children."),Array.isArray(t)&&(f(t.length<=1,"<textarea> can only have at most one child."),t=t[0]),e=""+t),e==null&&(e="");var n=s.getValue(this);return{initialValue:""+(n!=null?n:e),value:e}},shouldComponentUpdate:function(){return!this._isChanging},render:function(){var e=l(this.props),t=s.getValue(this);return f(e.dangerouslySetInnerHTML==null,"`dangerouslySetInnerHTML` does not make sense on <textarea>."),e.defaultValue=null,e.value=t!=null?t:this.state.value,e.onChange=this._handleChange,h(e,this.state.initialValue)},componentDidUpdate:function(e,t,n){var r=s.getValue(this);if(r!=null){var o=this.getDOMNode();i.setValueForProperty(o,"value",""+r)}},_handleChange:function(e){var t,n=s.getOnChange(this);return n&&(this._isChanging=!0,t=n.call(this,e),this._isChanging=!1),this.setState({value:e.target.value}),t}});t.exports=p},{"./AutoFocusMixin":1,"./DOMPropertyOperations":9,"./LinkedValueUtils":21,"./ReactBrowserComponentMixin":25,"./ReactCompositeComponent":29,"./ReactDOM":32,"./invariant":112,"./merge":121,"./warning":134}],43:[function(e,t,n){function l(){this.reinitializeTransaction()}var r=e("./ReactUpdates"),i=e("./Transaction"),s=e("./emptyFunction"),o=e("./mixInto"),u={initialize:s,close:function(){h.isBatchingUpdates=!1}},a={initialize:s,close:r.flushBatchedUpdates.bind(r)},f=[a,u];o(l,i.Mixin),o(l,{getTransactionWrappers:function(){return f}});var c=new l,h={isBatchingUpdates:!1,batchedUpdates:function(e,t){var n=h.isBatchingUpdates;h.isBatchingUpdates=!0,n?e(t):c.perform(e,null,t)}};t.exports=h},{"./ReactUpdates":71,"./Transaction":85,"./emptyFunction":96,"./mixInto":124}],44:[function(e,t,n){function O(){r.EventEmitter.injectTopLevelCallbackCreator(d),r.EventPluginHub.injectEventPluginOrder(f),r.EventPluginHub.injectInstanceHandle(x),r.EventPluginHub.injectMount(T),r.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:k,EnterLeaveEventPlugin:l,ChangeEventPlugin:o,CompositionEventPlugin:a,MobileSafariClickEventPlugin:c,SelectEventPlugin:N}),r.DOM.injectComponentClasses({button:m,form:g,img:y,input:b,option:w,select:E,textarea:S,html:A(v.html),head:A(v.head),title:A(v.title),body:A(v.body)}),r.CompositeComponent.injectMixin(h),r.DOMProperty.injectDOMPropertyConfig(s),r.Updates.injectBatchingStrategy(L),r.RootIndex.injectCreateReactRootIndex(i.canUseDOM?u.createReactRootIndex:C.createReactRootIndex),r.Component.injectEnvironment(p);var t=i.canUseDOM&&window.location.href||"";if(/[?&]react_perf\b/.test(t)){var n=e("./ReactDefaultPerf");n.start()}}var r=e("./ReactInjection"),i=e("./ExecutionEnvironment"),s=e("./DefaultDOMPropertyConfig"),o=e("./ChangeEventPlugin"),u=e("./ClientReactRootIndex"),a=e("./CompositionEventPlugin"),f=e("./DefaultEventPluginOrder"),l=e("./EnterLeaveEventPlugin"),c=e("./MobileSafariClickEventPlugin"),h=e("./ReactBrowserComponentMixin"),p=e("./ReactComponentBrowserEnvironment"),d=e("./ReactEventTopLevelCallback"),v=e("./ReactDOM"),m=e("./ReactDOMButton"),g=e("./ReactDOMForm"),y=e("./ReactDOMImg"),b=e("./ReactDOMInput"),w=e("./ReactDOMOption"),E=e("./ReactDOMSelect"),S=e("./ReactDOMTextarea"),x=e("./ReactInstanceHandles"),T=e("./ReactMount"),N=e("./SelectEventPlugin"),C=e("./ServerReactRootIndex"),k=e("./SimpleEventPlugin"),L=e("./ReactDefaultBatchingStrategy"),A=e("./createFullPageComponent");t.exports={inject:O}},{"./ChangeEventPlugin":4,"./ClientReactRootIndex":5,"./CompositionEventPlugin":6,"./DefaultDOMPropertyConfig":11,"./DefaultEventPluginOrder":12,"./EnterLeaveEventPlugin":13,"./ExecutionEnvironment":20,"./MobileSafariClickEventPlugin":22,"./ReactBrowserComponentMixin":25,"./ReactComponentBrowserEnvironment":28,"./ReactDOM":32,"./ReactDOMButton":33,"./ReactDOMForm":35,"./ReactDOMImg":37,"./ReactDOMInput":38,"./ReactDOMOption":39,"./ReactDOMSelect":40,"./ReactDOMTextarea":42,"./ReactDefaultBatchingStrategy":43,"./ReactDefaultPerf":45,"./ReactEventTopLevelCallback":50,"./ReactInjection":51,"./ReactInstanceHandles":53,"./ReactMount":55,"./SelectEventPlugin":72,"./ServerReactRootIndex":73,"./SimpleEventPlugin":74,"./createFullPageComponent":92}],45:[function(e,t,n){function a(e){return Math.floor(e*100)/100}var r=e("./DOMProperty"),i=e("./ReactDefaultPerfAnalysis"),s=e("./ReactMount"),o=e("./ReactPerf"),u=e("./performanceNow"),f={_allMeasurements:[],_injected:!1,start:function(){f._injected||o.injection.injectMeasure(f.measure),f._allMeasurements.length=0,o.enableMeasure=!0},stop:function(){o.enableMeasure=!1},getLastMeasurements:function(){return f._allMeasurements},printExclusive:function(e){e=e||f._allMeasurements;var t=i.getExclusiveSummary(e);console.table(t.map(function(e){return{"Component class name":e.componentName,"Total inclusive time (ms)":a(e.inclusive),"Total exclusive time (ms)":a(e.exclusive),"Exclusive time per instance (ms)":a(e.exclusive/e.count),Instances:e.count}})),console.log("Total time:",i.getTotalTime(e).toFixed(2)+" ms")},printInclusive:function(e){e=e||f._allMeasurements;var t=i.getInclusiveSummary(e);console.table(t.map(function(e){return{"Owner > component":e.componentName,"Inclusive time (ms)":a(e.time),Instances:e.count}})),console.log("Total time:",i.getTotalTime(e).toFixed(2)+" ms")},printWasted:function(e){e=e||f._allMeasurements;var t=i.getInclusiveSummary(e,!0);console.table(t.map(function(e){return{"Owner > component":e.componentName,"Wasted time (ms)":e.time,Instances:e.count}})),console.log("Total time:",i.getTotalTime(e).toFixed(2)+" ms")},printDOM:function(e){e=e||f._allMeasurements;var t=i.getDOMSummary(e);console.table(t.map(function(e){var t={};return t[r.ID_ATTRIBUTE_NAME]=e.id,t.type=e.type,t.args=JSON.stringify(e.args),t})),console.log("Total time:",i.getTotalTime(e).toFixed(2)+" ms")},_recordWrite:function(e,t,n,r){var i=f._allMeasurements[f._allMeasurements.length-1].writes;i[e]=i[e]||[],i[e].push({type:t,time:n,args:r})},measure:function(e,t,n){return function(){var r=Array.prototype.slice.call(arguments,0),i,o,a;if(t==="_renderNewRootComponent"||t==="flushBatchedUpdates")return f._allMeasurements.push({exclusive:{},inclusive:{},counts:{},writes:{},displayNames:{},totalTime:0}),a=u(),o=n.apply(this,r),f._allMeasurements[f._allMeasurements.length-1].totalTime=u()-a,o;if(e==="ReactDOMIDOperations"||e==="ReactComponentBrowserEnvironment"){a=u(),o=n.apply(this,r),i=u()-a;if(t==="mountImageIntoNode"){var l=s.getID(r[1]);f._recordWrite(l,t,i,r[0])}else t==="dangerouslyProcessChildrenUpdates"?r[0].forEach(function(e){var t={};e.fromIndex!==null&&(t.fromIndex=e.fromIndex),e.toIndex!==null&&(t.toIndex=e.toIndex),e.textContent!==null&&(t.textContent=e.textContent),e.markupIndex!==null&&(t.markup=r[1][e.markupIndex]),f._recordWrite(e.parentID,e.type,i,t)}):f._recordWrite(r[0],t,i,Array.prototype.slice.call(r,1));return o}if(e!=="ReactCompositeComponent"||t!=="mountComponent"&&t!=="updateComponent"&&t!=="_renderValidatedComponent")return n.apply(this,r);var c=t==="mountComponent"?r[0]:this._rootNodeID,h=t==="_renderValidatedComponent",p=f._allMeasurements[f._allMeasurements.length-1];h&&(p.counts[c]=p.counts[c]||0,p.counts[c]+=1),a=u(),o=n.apply(this,r),i=u()-a;var d=h?p.exclusive:p.inclusive;return d[c]=d[c]||0,d[c]+=i,p.displayNames[c]={current:this.constructor.displayName,owner:this._owner?this._owner.constructor.displayName:"<root>"},o}}};t.exports=f},{"./DOMProperty":8,"./ReactDefaultPerfAnalysis":46,"./ReactMount":55,"./ReactPerf":60,"./performanceNow":129}],46:[function(e,t,n){function o(e){var t=0;for(var n=0;n<e.length;n++){var r=e[n];t+=r.totalTime}return t}function u(e){var t=[];for(var n=0;n<e.length;n++){var r=e[n],i;for(i in r.writes)r.writes[i].forEach(function(e){t.push({id:i,type:s[e.type]||e.type,args:e.args})})}return t}function a(e){var t={},n;for(var s=0;s<e.length;s++){var o=e[s],u=r(o.exclusive,o.inclusive);for(var a in u)n=o.displayNames[a].current,t[n]=t[n]||{componentName:n,inclusive:0,exclusive:0,count:0},o.exclusive[a]&&(t[n].exclusive+=o.exclusive[a]),o.inclusive[a]&&(t[n].inclusive+=o.inclusive[a]),o.counts[a]&&(t[n].count+=o.counts[a])}var f=[];for(n in t)t[n].exclusive>=i&&f.push(t[n]);return f.sort(function(e,t){return t.exclusive-e.exclusive}),f}function f(e,t){var n={},s;for(var o=0;o<e.length;o++){var u=e[o],a=r(u.exclusive,u.inclusive),f;t&&(f=l(u));for(var c in a){if(t&&!f[c])continue;var h=u.displayNames[c];s=h.owner+" > "+h.current,n[s]=n[s]||{componentName:s,time:0,count:0},u.inclusive[c]&&(n[s].time+=u.inclusive[c]),u.counts[c]&&(n[s].count+=u.counts[c])}}var p=[];for(s in n)n[s].time>=i&&p.push(n[s]);return p.sort(function(e,t){return t.time-e.time}),p}function l(e){var t={},n=Object.keys(e.writes),i=r(e.exclusive,e.inclusive);for(var s in i){var o=!1;for(var u=0;u<n.length;u++)if(n[u].indexOf(s)===0){o=!0;break}!o&&e.counts[s]>0&&(t[s]=!0)}return t}var r=e("./merge"),i=1.2,s={mountImageIntoNode:"set innerHTML",INSERT_MARKUP:"set innerHTML",MOVE_EXISTING:"move",REMOVE_NODE:"remove",TEXT_CONTENT:"set textContent",updatePropertyByID:"update attribute",deletePropertyByID:"delete attribute",updateStylesByID:"update styles",updateInnerHTMLByID:"set innerHTML",dangerouslyReplaceNodeWithMarkupByID:"replace"},c={getExclusiveSummary:a,getInclusiveSummary:f,getDOMSummary:u,getTotalTime:o};t.exports=c},{"./merge":121}],47:[function(e,t,n){var r={guard:function(e,t){return e}};t.exports=r},{}],48:[function(e,t,n){function y(e){return e[g]==null&&(e[g]=v++,p[e[g]]={}),p[e[g]]}function b(e,t,n){i.listen(n,t,E.TopLevelCallbackCreator.createTopLevelCallback(e))}function w(e,t,n){i.capture(n,t,E.TopLevelCallbackCreator.createTopLevelCallback(e))}var r=e("./EventConstants"),i=e("./EventListener"),s=e("./EventPluginHub"),o=e("./EventPluginRegistry"),u=e("./ExecutionEnvironment"),a=e("./ReactEventEmitterMixin"),f=e("./ViewportMetrics"),l=e("./invariant"),c=e("./isEventSupported"),h=e("./merge"),p={},d=!1,v=0,m={topBlur:"blur",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topScroll:"scroll",topSelectionChange:"selectionchange",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topWheel:"wheel"},g="_reactListenersID"+String(Math.random()).slice(2),E=h(a,{TopLevelCallbackCreator:null,injection:{injectTopLevelCallbackCreator:function(e){E.TopLevelCallbackCreator=e}},setEnabled:function(e){l(u.canUseDOM,"setEnabled(...): Cannot toggle event listening in a Worker thread. This is likely a bug in the framework. Please report immediately."),E.TopLevelCallbackCreator&&E.TopLevelCallbackCreator.setEnabled(e)},isEnabled:function(){return!!E.TopLevelCallbackCreator&&!!E.TopLevelCallbackCreator.isEnabled()},listenTo:function(e,t){var n=t,i=y(n),s=o.registrationNameDependencies[e],u=r.topLevelTypes;for(var a=0,f=s.length;a<f;a++){var l=s[a];if(!i[l]){var h=u[l];h===u.topWheel?c("wheel")?b(u.topWheel,"wheel",n):c("mousewheel")?b(u.topWheel,"mousewheel",n):b(u.topWheel,"DOMMouseScroll",n):h===u.topScroll?c("scroll",!0)?w(u.topScroll,"scroll",n):b(u.topScroll,"scroll",window):h===u.topFocus||h===u.topBlur?(c("focus",!0)?(w(u.topFocus,"focus",n),w(u.topBlur,"blur",n)):c("focusin")&&(b(u.topFocus,"focusin",n),b(u.topBlur,"focusout",n)),i[u.topBlur]=!0,i[u.topFocus]=!0):m[l]&&b(h,m[l],n),i[l]=!0}}},ensureScrollValueMonitoring:function(){if(!d){var e=f.refreshScrollValues;i.listen(window,"scroll",e),i.listen(window,"resize",e),d=!0}},eventNameDispatchConfigs:s.eventNameDispatchConfigs,registrationNameModules:s.registrationNameModules,putListener:s.putListener,getListener:s.getListener,deleteListener:s.deleteListener,deleteAllListeners:s.deleteAllListeners,trapBubbledEvent:b,trapCapturedEvent:w});t.exports=E},{"./EventConstants":14,"./EventListener":15,"./EventPluginHub":16,"./EventPluginRegistry":17,"./ExecutionEnvironment":20,"./ReactEventEmitterMixin":49,"./ViewportMetrics":86,"./invariant":112,"./isEventSupported":113,"./merge":121}],49:[function(e,t,n){function s(e){r.enqueueEvents(e),r.processEventQueue()}var r=e("./EventPluginHub"),i=e("./ReactUpdates"),o={handleTopLevel:function(e,t,n,o){var u=r.extractEvents(e,t,n,o);i.batchedUpdates(s,u)}};t.exports=o},{"./EventPluginHub":16,"./ReactUpdates":71}],50:[function(e,t,n){function l(e){var t=o.getID(e),n=s.getReactRootIDFromNodeID(t),r=o.findReactContainerForID(n),i=o.getFirstReactDOM(r);return i}function c(e,t,n){var r=o.getFirstReactDOM(u(t))||window,s=r;while(s)n.ancestors.push(s),s=l(s);for(var a=0,f=n.ancestors.length;a<f;a++){r=n.ancestors[a];var c=o.getID(r)||"";i.handleTopLevel(e,r,c,t)}}function h(){this.ancestors=[]}var r=e("./PooledClass"),i=e("./ReactEventEmitter"),s=e("./ReactInstanceHandles"),o=e("./ReactMount"),u=e("./getEventTarget"),a=e("./mixInto"),f=!0;a(h,{destructor:function(){this.ancestors.length=0}}),r.addPoolingTo(h);var p={setEnabled:function(e){f=!!e},isEnabled:function(){return f},createTopLevelCallback:function(e){return function(t){if(!f)return;var n=h.getPooled();try{c(e,t,n)}finally{h.release(n)}}}};t.exports=p},{"./PooledClass":23,"./ReactEventEmitter":48,"./ReactInstanceHandles":53,"./ReactMount":55,"./getEventTarget":104,"./mixInto":124}],51:[function(e,t,n){var r=e("./DOMProperty"),i=e("./EventPluginHub"),s=e("./ReactComponent"),o=e("./ReactCompositeComponent"),u=e("./ReactDOM"),a=e("./ReactEventEmitter"),f=e("./ReactPerf"),l=e("./ReactRootIndex"),c=e("./ReactUpdates"),h={Component:s.injection,CompositeComponent:o.injection,DOMProperty:r.injection,EventPluginHub:i.injection,DOM:u.injection,EventEmitter:a.injection,Perf:f.injection,RootIndex:l.injection,Updates:c.injection};t.exports=h},{"./DOMProperty":8,"./EventPluginHub":16,"./ReactComponent":27,"./ReactCompositeComponent":29,"./ReactDOM":32,"./ReactEventEmitter":48,"./ReactPerf":60,"./ReactRootIndex":67,"./ReactUpdates":71}],52:[function(e,t,n){function u(e){return i(document.documentElement,e)}var r=e("./ReactDOMSelection"),i=e("./containsNode"),s=e("./focusNode"),o=e("./getActiveElement"),a={hasSelectionCapabilities:function(e){return e&&(e.nodeName==="INPUT"&&e.type==="text"||e.nodeName==="TEXTAREA"||e.contentEditable==="true")},getSelectionInformation:function(){var e=o();return{focusedElem:e,selectionRange:a.hasSelectionCapabilities(e)?a.getSelection(e):null}},restoreSelection:function(e){var t=o(),n=e.focusedElem,r=e.selectionRange;t!==n&&u(n)&&(a.hasSelectionCapabilities(n)&&a.setSelection(n,r),s(n))},getSelection:function(e){var t;if("selectionStart"in e)t={start:e.selectionStart,end:e.selectionEnd};else if(document.selection&&e.nodeName==="INPUT"){var n=document.selection.createRange();n.parentElement()===e&&(t={start:-n.moveStart("character",-e.value.length),end:-n.moveEnd("character",-e.value.length)})}else t=r.getOffsets(e);return t||{start:0,end:0}},setSelection:function(e,t){var n=t.start,i=t.end;typeof i=="undefined"&&(i=n);if("selectionStart"in e)e.selectionStart=n,e.selectionEnd=Math.min(i,e.value.length);else if(document.selection&&e.nodeName==="INPUT"){var s=e.createTextRange();s.collapse(!0),s.moveStart("character",n),s.moveEnd("character",i-n),s.select()}else r.setOffsets(e,t)}};t.exports=a},{"./ReactDOMSelection":41,"./containsNode":89,"./focusNode":100,"./getActiveElement":102}],53:[function(e,t,n){function a(e){return s+e.toString(36)}function f(e,t){return e.charAt(t)===s||t===e.length}function l(e){return e===""||e.charAt(0)===s&&e.charAt(e.length-1)!==s}function c(e,t){return t.indexOf(e)===0&&f(t,e.length)}function h(e){return e?e.substr(0,e.lastIndexOf(s)):""}function p(e,t){i(l(e)&&l(t),"getNextDescendantID(%s, %s): Received an invalid React DOM ID.",e,t),i(c(e,t),"getNextDescendantID(...): React has made an invalid assumption about the DOM hierarchy. Expected `%s` to be an ancestor of `%s`.",e,t);if(e===t)return e;var n=e.length+o;for(var r=n;r<t.length;r++)if(f(t,r))break;return t.substr(0,r)}function d(e,t){var n=Math.min(e.length,t.length);if(n===0)return"";var r=0;for(var s=0;s<=n;s++)if(f(e,s)&&f(t,s))r=s;else if(e.charAt(s)!==t.charAt(s))break;var o=e.substr(0,r);return i(l(o),"getFirstCommonAncestorID(%s, %s): Expected a valid React DOM ID: %s",e,t,o),o}function v(e,t,n,r,s,o){e=e||"",t=t||"",i(e!==t,"traverseParentPath(...): Cannot traverse from and to the same ID, `%s`.",e);var a=c(t,e);i(a||c(e,t),"traverseParentPath(%s, %s, ...): Cannot traverse from two IDs that do not have a parent path.",e,t);var f=0,l=a?h:p;for(var d=e;;d=l(d,t)){var v;(!s||d!==e)&&(!o||d!==t)&&(v=n(d,a,r));if(v===!1||d===t)break;i(f++<u,"traverseParentPath(%s, %s, ...): Detected an infinite loop while traversing the React DOM ID tree. This may be due to malformed IDs: %s",e,t)}}var r=e("./ReactRootIndex"),i=e("./invariant"),s=".",o=s.length,u=100,m={createReactRootID:function(){return a(r.createReactRootIndex())},createReactID:function(e,t){return e+t},getReactRootIDFromNodeID:function(e){if(e&&e.charAt(0)===s&&e.length>1){var t=e.indexOf(s,1);return t>-1?e.substr(0,t):e}return null},traverseEnterLeave:function(e,t,n,r,i){var s=d(e,t);s!==e&&v(e,s,n,r,!1,!0),s!==t&&v(s,t,n,i,!0,!1)},traverseTwoPhase:function(e,t,n){e&&(v("",e,t,n,!0,!1),v(e,"",t,n,!1,!0))},traverseAncestors:function(e,t,n){v("",e,t,n,!0,!1)},_getFirstCommonAncestorID:d,_getNextDescendantID:p,isAncestorIDOf:c,SEPARATOR:s};t.exports=m},{"./ReactRootIndex":67,"./invariant":112}],54:[function(e,t,n){var r=e("./adler32"),i={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(e){var t=r(e);return e.replace(">"," "+i.CHECKSUM_ATTR_NAME+'="'+t+'">')},canReuseMarkup:function(e,t){var n=t.getAttribute(i.CHECKSUM_ATTR_NAME);n=n&&parseInt(n,10);var s=r(e);return s===n}};t.exports=i},{"./adler32":88}],55:[function(e,t,n){function E(e){var t=a(e);return t&&M.getID(t)}function S(e){var t=x(e);if(t)if(d.hasOwnProperty(t)){var n=d[t];n!==e&&(l(!C(n,t),"ReactMount: Two valid but unequal nodes with the same `%s`: %s",p,t),d[t]=e)}else d[t]=e;return t}function x(e){return e&&e.getAttribute&&e.getAttribute(p)||""}function T(e,t){var n=x(e);n!==t&&delete d[n],e.setAttribute(p,t),d[t]=e}function N(e){if(!d.hasOwnProperty(e)||!C(d[e],e))d[e]=M.findReactNodeByID(e);return d[e]}function C(e,t){if(e){l(x(e)===t,"ReactMount: Unexpected modification of `%s`",p);var n=M.findReactContainerForID(t);if(n&&u(n,e))return!0}return!1}function k(e){delete d[e]}function A(e){var t=d[e];if(!t||!C(t,e))return!1;L=t}function O(e){L=null,s.traverseAncestors(e,A);var t=L;return L=null,t}var r=e("./DOMProperty"),i=e("./ReactEventEmitter"),s=e("./ReactInstanceHandles"),o=e("./ReactPerf"),u=e("./containsNode"),a=e("./getReactRootElementInContainer"),f=e("./instantiateReactComponent"),l=e("./invariant"),c=e("./shouldUpdateReactComponent"),h=s.SEPARATOR,p=r.ID_ATTRIBUTE_NAME,d={},v=1,m=9,g={},y={},b={},w=[],L=null,M={totalInstantiationTime:0,totalInjectionTime:0,useTouchEvents:!1,_instancesByReactRootID:g,scrollMonitor:function(e,t){t()},_updateRootComponent:function(e,t,n,r){var i=t.props;return M.scrollMonitor(n,function(){e.replaceProps(i,r)}),b[E(n)]=a(n),e},_registerComponent:function(e,t){l(t&&(t.nodeType===v||t.nodeType===m),"_registerComponent(...): Target container is not a DOM element."),i.ensureScrollValueMonitoring();var n=M.registerContainer(t);return g[n]=e,n},_renderNewRootComponent:o.measure("ReactMount","_renderNewRootComponent",function(e,t,n){var r=f(e),i=M._registerComponent(r,t);return r.mountComponentIntoNode(i,t,n),b[i]=a(t),r}),renderComponent:function(e,t,n){var r=g[E(t)];if(r){if(c(r,e))return M._updateRootComponent(r,e,t,n);M.unmountComponentAtNode(t)}var i=a(t),s=i&&M.isRenderedByReact(i),o=s&&!r,u=M._renderNewRootComponent(e,t,o);return n&&n.call(u),u},constructAndRenderComponent:function(e,t,n){return M.renderComponent(e(t),n)},constructAndRenderComponentByID:function(e,t,n){var r=document.getElementById(n);return l(r,'Tried to get element with id of "%s" but it is not present on the page.',n),M.constructAndRenderComponent(e,t,r)},registerContainer:function(e){var t=E(e);return t&&(t=s.getReactRootIDFromNodeID(t)),t||(t=s.createReactRootID()),y[t]=e,t},unmountComponentAtNode:function(e){var t=E(e),n=g[t];return n?(M.unmountComponentFromNode(n,e),delete g[t],delete y[t],delete b[t],!0):!1},unmountComponentFromNode:function(e,t){e.unmountComponent(),t.nodeType===m&&(t=t.documentElement);while(t.lastChild)t.removeChild(t.lastChild)},findReactContainerForID:function(e){var t=s.getReactRootIDFromNodeID(e),n=y[t],r=b[t];if(r&&r.parentNode!==n){l(x(r)===t,"ReactMount: Root element ID differed from reactRootID.");var i=n.firstChild;i&&t===x(i)?b[t]=i:console.warn("ReactMount: Root element has been removed from its original container. New container:",r.parentNode)}return n},findReactNodeByID:function(e){var t=M.findReactContainerForID(e);return M.findComponentRoot(t,e)},isRenderedByReact:function(e){if(e.nodeType!==1)return!1;var t=M.getID(e);return t?t.charAt(0)===h:!1},getFirstReactDOM:function(e){var t=e;while(t&&t.parentNode!==t){if(M.isRenderedByReact(t))return t;t=t.parentNode}return null},findComponentRoot:function(e,t){var n=w,r=0,i=O(t)||e;n[0]=i.firstChild,n.length=1;while(r<n.length){var o=n[r++],u;while(o){var a=M.getID(o);a?t===a?u=o:s.isAncestorIDOf(a,t)&&(n.length=r=0,n.push(o.firstChild)):n.push(o.firstChild),o=o.nextSibling}if(u)return n.length=0,u}n.length=0,l(!1,"findComponentRoot(..., %s): Unable to find element. This probably means the DOM was unexpectedly mutated (e.g., by the browser), usually due to forgetting a <tbody> when using tables or nesting <p> or <a> tags. Try inspecting the child nodes of the element with React ID `%s`.",t,M.getID(e))},getReactRootID:E,getID:S,setID:T,getNode:N,purgeID:k};t.exports=M},{"./DOMProperty":8,"./ReactEventEmitter":48,"./ReactInstanceHandles":53,"./ReactPerf":60,"./containsNode":89,"./getReactRootElementInContainer":107,"./instantiateReactComponent":111,"./invariant":112,"./shouldUpdateReactComponent":131}],56:[function(e,t,n){function s(e){this._queue=e||null}var r=e("./PooledClass"),i=e("./mixInto");i(s,{enqueue:function(e,t){this._queue=this._queue||[],this._queue.push({component:e,callback:t})},notifyAll:function(){var e=this._queue;if(e){this._queue=null;for(var t=0,n=e.length;t<n;t++){var r=e[t].component,i=e[t].callback;i.call(r)}e.length=0}},reset:function(){this._queue=null},destructor:function(){this.reset()}}),r.addPoolingTo(s),t.exports=s},{"./PooledClass":23,"./mixInto":124}],57:[function(e,t,n){function c(e,t,n){f.push({parentID:e,parentNode:null,type:i.INSERT_MARKUP,markupIndex:l.push(t)-1,textContent:null,fromIndex:null,toIndex:n})}function h(e,t,n){f.push({parentID:e,parentNode:null,type:i.MOVE_EXISTING,markupIndex:null,textContent:null,fromIndex:t,toIndex:n})}function p(e,t){f.push({parentID:e,parentNode:null,type:i.REMOVE_NODE,markupIndex:null,textContent:null,fromIndex:t,toIndex:null})}function d(e,t){f.push({parentID:e,parentNode:null,type:i.TEXT_CONTENT,markupIndex:null,textContent:t,fromIndex:null,toIndex:null})}function v(){f.length&&(r.BackendIDOperations.dangerouslyProcessChildrenUpdates(f,l),m())}function m(){f.length=0,l.length=0}var r=e("./ReactComponent"),i=e("./ReactMultiChildUpdateTypes"),s=e("./flattenChildren"),o=e("./instantiateReactComponent"),u=e("./shouldUpdateReactComponent"),a=0,f=[],l=[],g={Mixin:{mountChildren:function(e,t){var n=s(e),r=[],i=0;this._renderedChildren=n;for(var u in n){var a=n[u];if(n.hasOwnProperty(u)){var f=o(a);n[u]=f;var l=this._rootNodeID+u,c=f.mountComponent(l,t,this._mountDepth+1);f._mountIndex=i,r.push(c),i++}}return r},updateTextContent:function(e){a++;var t=!0;try{var n=this._renderedChildren;for(var r in n)n.hasOwnProperty(r)&&this._unmountChildByName(n[r],r);this.setTextContent(e),t=!1}finally{a--,a||(t?m():v())}},updateChildren:function(e,t){a++;var n=!0;try{this._updateChildren(e,t),n=!1}finally{a--,a||(n?m():v())}},_updateChildren:function(e,t){var n=s(e),r=this._renderedChildren;if(!n&&!r)return;var i,a=0,f=0;for(i in n){if(!n.hasOwnProperty(i))continue;var l=r&&r[i],c=n[i];if(u(l,c))this.moveChild(l,f,a),a=Math.max(l._mountIndex,a),l.receiveComponent(c,t),l._mountIndex=f;else{l&&(a=Math.max(l._mountIndex,a),this._unmountChildByName(l,i));var h=o(c);this._mountChildByNameAtIndex(h,i,f,t)}f++}for(i in r)r.hasOwnProperty(i)&&(!n||!n[i])&&this._unmountChildByName(r[i],i)},unmountChildren:function(){var e=this._renderedChildren;for(var t in e){var n=e[t];n.unmountComponent&&n.unmountComponent()}this._renderedChildren=null},moveChild:function(e,t,n){e._mountIndex<n&&h(this._rootNodeID,e._mountIndex,t)},createChild:function(e,t){c(this._rootNodeID,t,e._mountIndex)},removeChild:function(e){p(this._rootNodeID,e._mountIndex)},setTextContent:function(e){d(this._rootNodeID,e)},_mountChildByNameAtIndex:function(e,t,n,r){var i=this._rootNodeID+t,s=e.mountComponent(i,r,this._mountDepth+1);e._mountIndex=n,this.createChild(e,s),this._renderedChildren=this._renderedChildren||{},this._renderedChildren[t]=e},_unmountChildByName:function(e,t){r.isValidComponent(e)&&(this.removeChild(e),e._mountIndex=null,e.unmountComponent(),delete this._renderedChildren[t])}}};t.exports=g},{"./ReactComponent":27,"./ReactMultiChildUpdateTypes":58,"./flattenChildren":99,"./instantiateReactComponent":111,"./shouldUpdateReactComponent":131}],58:[function(e,t,n){var r=e("./keyMirror"),i=r({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,TEXT_CONTENT:null});t.exports=i},{"./keyMirror":118}],59:[function(e,t,n){var r=e("./emptyObject"),i=e("./invariant"),s={isValidOwner:function(e){return!!e&&typeof e.attachRef=="function"&&typeof e.detachRef=="function"},addComponentAsRefTo:function(e,t,n){i(s.isValidOwner(n),"addComponentAsRefTo(...): Only a ReactOwner can have refs. This usually means that you're trying to add a ref to a component that doesn't have an owner (that is, was not created inside of another component's `render` method). Try rendering this component inside of a new top-level component which will hold the ref."),n.attachRef(t,e)},removeComponentAsRefFrom:function(e,t,n){i(s.isValidOwner(n),"removeComponentAsRefFrom(...): Only a ReactOwner can have refs. This usually means that you're trying to remove a ref to a component that doesn't have an owner (that is, was not created inside of another component's `render` method). Try rendering this component inside of a new top-level component which will hold the ref."),n.refs[t]===e&&n.detachRef(t)},Mixin:{construct:function(){this.refs=r},attachRef:function(e,t){i(t.isOwnedBy(this),"attachRef(%s, ...): Only a component's owner can store a ref to it.",e);var n=this.refs===r?this.refs={}:this.refs;n[e]=t},detachRef:function(e){delete this.refs[e]}}};t.exports=s},{"./emptyObject":97,"./invariant":112}],60:[function(e,t,n){function i(e,t,n){return n}var r={enableMeasure:!1,storedMeasure:i,measure:function(e,t,n){var i=null;return function(){return r.enableMeasure?(i||(i=r.storedMeasure(e,t,n)),i.apply(this,arguments)):n.apply(this,arguments)}},injection:{injectMeasure:function(e){r.storedMeasure=e}}};t.exports=r},{}],61:[function(e,t,n){function u(e){return function(t,n,r){t.hasOwnProperty(n)?t[n]=e(t[n],r):t[n]=r}}var r=e("./emptyFunction"),i=e("./invariant"),s=e("./joinClasses"),o=e("./merge"),a={children:r,className:u(s),key:r,ref:r,style:u(o)},f={TransferStrategies:a,mergeProps:function(e,t){var n=o(e);for(var r in t){if(!t.hasOwnProperty(r))continue;var i=a[r];i&&a.hasOwnProperty(r)?i(n,r,t[r]):n.hasOwnProperty(r)||(n[r]=t[r])}return n},Mixin:{transferPropsTo:function(e){return i(e._owner===this,"%s: You can't call transferPropsTo() on a component that you don't own, %s. This usually means you are calling transferPropsTo() on a component passed in as props or children.",this.constructor.displayName,e.constructor.displayName),e.props=f.mergeProps(e.props,this.props),e}}};t.exports=f},{"./emptyFunction":96,"./invariant":112,"./joinClasses":117,"./merge":121}],62:[function(e,t,n){var r={};r={prop:"prop",context:"context",childContext:"child context"},t.exports=r},{}],63:[function(e,t,n){var r=e("./keyMirror"),i=r({prop:null,context:null,childContext:null});t.exports=i},{"./keyMirror":118}],64:[function(e,t,n){function f(e){switch(typeof e){case"number":case"string":return!0;case"object":if(Array.isArray(e))return e.every(f);if(r.isValidComponent(e))return!0;for(var t in e)if(!f(e[t]))return!1;return!0;default:return!1}}function l(e){var t=typeof e;return t==="object"&&Array.isArray(e)?"array":t}function c(){function e(e,t,n,r,i){return!0}return w(e)}function h(e){function t(t,n,r,o,u){var a=l(n),f=a===e;return t&&s(f,"Invalid %s `%s` of type `%s` supplied to `%s`, expected `%s`.",i[u],r,a,o,e),f}return w(t)}function p(e){function n(e,n,r,o,u){var a=t[n];return e&&s(a,"Invalid %s `%s` supplied to `%s`, expected one of %s.",i[u],r,o,JSON.stringify(Object.keys(t))),a}var t=o(e);return w(n)}function d(e){function t(t,n,r,o,u){var a=l(n),f=a==="object";if(f)for(var c in e){var h=e[c];if(h&&!h(n,c,o,u))return!1}return t&&s(f,"Invalid %s `%s` of type `%s` supplied to `%s`, expected `object`.",i[u],r,a,o),f}return w(t)}function v(e){function t(t,n,r,o,u){var f=n instanceof e;return t&&s(f,"Invalid %s `%s` supplied to `%s`, expected instance of `%s`.",i[u],r,o,e.name||a),f}return w(t)}function m(e){function t(t,n,r,o,u){var a=Array.isArray(n);if(a)for(var f=0;f<n.length;f++)if(!e(n,f,o,u))return!1;return t&&s(a,"Invalid %s `%s` supplied to `%s`, expected an array.",i[u],r,o),a}return w(t)}function g(){function e(e,t,n,r,o){var u=f(t);return e&&s(u,"Invalid %s `%s` supplied to `%s`, expected a renderable prop.",i[o],n,r),u}return w(e)}function y(){function e(e,t,n,o,u){var a=r.isValidComponent(t);return e&&s(a,"Invalid %s `%s` supplied to `%s`, expected a React component.",i[u],n,o),a}return w(e)}function b(e){return function(t,n,r,o){var u=!1;for(var f=0;f<e.length;f++){var l=e[f];typeof l.weak=="function"&&(l=l.weak);if(l(t,n,r,o)){u=!0;break}}return s(u,"Invalid %s `%s` supplied to `%s`.",i[o],n,r||a),u}}function w(e){function t(t,n,r,o,u,f){var l=r[o];if(l!=null)return e(n,l,o,u||a,f);var c=!t;return n&&s(c,"Required %s `%s` was not specified in `%s`.",i[f],o,u||a),c}var n=t.bind(null,!1,!0);return n.weak=t.bind(null,!1,!1),n.isRequired=t.bind(null,!0,!0),n.weak.isRequired=t.bind(null,!0,!1),n.isRequired.weak=n.weak.isRequired,n}var r=e("./ReactComponent"),i=e("./ReactPropTypeLocationNames"),s=e("./warning"),o=e("./createObjectFrom"),u={array:h("array"),bool:h("boolean"),func:h("function"),number:h("number"),object:h("object"),string:h("string"),shape:d,oneOf:p,oneOfType:b,arrayOf:m,instanceOf:v,renderable:g(),component:y(),any:c()},a="<<anonymous>>";t.exports=u},{"./ReactComponent":27,"./ReactPropTypeLocationNames":62,"./createObjectFrom":94,"./warning":134}],65:[function(e,t,n){function o(){this.listenersToPut=[]}var r=e("./PooledClass"),i=e("./ReactEventEmitter"),s=e("./mixInto");s(o,{enqueuePutListener:function(e,t,n){this.listenersToPut.push({rootNodeID:e,propKey:t,propValue:n})},putListeners:function(){for(var e=0;e<this.listenersToPut.length;e++){var t=this.listenersToPut[e];i.putListener(t.rootNodeID,t.propKey,t.propValue)}},reset:function(){this.listenersToPut.length=0},destructor:function(){this.reset()}}),r.addPoolingTo(o),t.exports=o},{"./PooledClass":23,"./ReactEventEmitter":48,"./mixInto":124}],66:[function(e,t,n){function v(){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=o.getPooled(null),this.putListenerQueue=u.getPooled()}var r=e("./PooledClass"),i=e("./ReactEventEmitter"),s=e("./ReactInputSelection"),o=e("./ReactMountReady"),u=e("./ReactPutListenerQueue"),a=e("./Transaction"),f=e("./mixInto"),l={initialize:s.getSelectionInformation,close:s.restoreSelection},c={initialize:function(){var e=i.isEnabled();return i.setEnabled(!1),e},close:function(e){i.setEnabled(e)}},h={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},p={initialize:function(){this.putListenerQueue.reset()},close:function(){this.putListenerQueue.putListeners()}},d=[p,l,c,h],m={getTransactionWrappers:function(){return d},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){o.release(this.reactMountReady),this.reactMountReady=null,u.release(this.putListenerQueue),this.putListenerQueue=null}};f(v,a.Mixin),f(v,m),r.addPoolingTo(v),t.exports=v},{"./PooledClass":23,"./ReactEventEmitter":48,"./ReactInputSelection":52,"./ReactMountReady":56,"./ReactPutListenerQueue":65,"./Transaction":85,"./mixInto":124}],67:[function(e,t,n){var r={injectCreateReactRootIndex:function(e){i.createReactRootIndex=e}},i={createReactRootIndex:null,injection:r};t.exports=i},{}],68:[function(e,t,n){function f(e){a(r.isValidComponent(e),"renderComponentToString(): You must pass a valid ReactComponent."),a(arguments.length!==2||typeof arguments[1]!="function","renderComponentToString(): This function became synchronous and now returns the generated markup. Please remove the second parameter.");var t;try{var n=i.createReactRootID();return t=o.getPooled(!1),t.perform(function(){var r=u(e),i=r.mountComponent(n,t,0);return s.addChecksumToMarkup(i)},null)}finally{o.release(t)}}function l(e){a(r.isValidComponent(e),"renderComponentToStaticMarkup(): You must pass a valid ReactComponent.");var t;try{var n=i.createReactRootID();return t=o.getPooled(!0),t.perform(function(){var r=u(e);return r.mountComponent(n,t,0)},null)}finally{o.release(t)}}var r=e("./ReactComponent"),i=e("./ReactInstanceHandles"),s=e("./ReactMarkupChecksum"),o=e("./ReactServerRenderingTransaction"),u=e("./instantiateReactComponent"),a=e("./invariant");t.exports={renderComponentToString:f,renderComponentToStaticMarkup:l}},{"./ReactComponent":27,"./ReactInstanceHandles":53,"./ReactMarkupChecksum":54,"./ReactServerRenderingTransaction":69,"./instantiateReactComponent":111,"./invariant":112}],69:[function(e,t,n){function h(e){this.reinitializeTransaction(),this.renderToStaticMarkup=e,this.reactMountReady=i.getPooled(null),this.putListenerQueue=s.getPooled()}var r=e("./PooledClass"),i=e("./ReactMountReady"),s=e("./ReactPutListenerQueue"),o=e("./Transaction"),u=e("./emptyFunction"),a=e("./mixInto"),f={initialize:function(){this.reactMountReady.reset()},close:u},l={initialize:function(){this.putListenerQueue.reset()},close:u},c=[l,f],p={getTransactionWrappers:function(){return c},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){i.release(this.reactMountReady),this.reactMountReady=null,s.release(this.putListenerQueue),this.putListenerQueue=null}};a(h,o.Mixin),a(h,p),r.addPoolingTo(h),t.exports=h},{"./PooledClass":23,"./ReactMountReady":56,"./ReactPutListenerQueue":65,"./Transaction":85,"./emptyFunction":96,"./mixInto":124}],70:[function(e,t,n){var r=e("./DOMPropertyOperations"),i=e("./ReactBrowserComponentMixin"),s=e("./ReactComponent"),o=e("./escapeTextForBrowser"),u=e("./mixInto"),a=function(e){this.construct({text:e})};a.ConvenienceConstructor=function(e){return new a(e.text)},u(a,s.Mixin),u(a,i),u(a,{mountComponent:function(e,t,n){s.Mixin.mountComponent.call(this,e,t,n);var i=o(this.props.text);return t.renderToStaticMarkup?i:"<span "+r.createMarkupForID(e)+">"+i+"</span>"},receiveComponent:function(e,t){var n=e.props;n.text!==this.props.text&&(this.props.text=n.text,s.BackendIDOperations.updateTextContentByID(this._rootNodeID,n.text))}}),a.type=a,a.prototype.type=a,t.exports=a},{"./DOMPropertyOperations":9,"./ReactBrowserComponentMixin":25,"./ReactComponent":27,"./escapeTextForBrowser":98,"./mixInto":124}],71:[function(e,t,n){function u(){i(o,"ReactUpdates: must inject a batching strategy")}function a(e,t){u(),o.batchedUpdates(e,t)}function f(e,t){return e._mountDepth-t._mountDepth}function l(){s.sort(f);for(var e=0;e<s.length;e++){var t=s[e];if(t.isMounted()){var n=t._pendingCallbacks;t._pendingCallbacks=null,t.performUpdateIfNecessary();if(n)for(var r=0;r<n.length;r++)n[r].call(t)}}}function c(){s.length=0}function p(e,t){i(!t||typeof t=="function","enqueueUpdate(...): You called `setProps`, `replaceProps`, `setState`, `replaceState`, or `forceUpdate` with a callback that isn't callable."),u();if(!o.isBatchingUpdates){e.performUpdateIfNecessary(),t&&t.call(e);return}s.push(e),t&&(e._pendingCallbacks?e._pendingCallbacks.push(t):e._pendingCallbacks=[t])}var r=e("./ReactPerf"),i=e("./invariant"),s=[],o=null,h=r.measure("ReactUpdates","flushBatchedUpdates",function(){try{l()}finally{c()}}),d={injectBatchingStrategy:function(e){i(e,"ReactUpdates: must provide a batching strategy"),i(typeof e.batchedUpdates=="function","ReactUpdates: must provide a batchedUpdates() function"),i(typeof e.isBatchingUpdates=="boolean","ReactUpdates: must provide an isBatchingUpdates boolean attribute"),o=e}},v={batchedUpdates:a,enqueueUpdate:p,flushBatchedUpdates:h,injection:d};t.exports=v},{"./ReactPerf":60,"./invariant":112}],72:[function(e,t,n){function g(e){if("selectionStart"in e&&s.hasSelectionCapabilities(e))return{start:e.selectionStart,end:e.selectionEnd};if(document.selection){var t=document.selection.createRange();return{parentElement:t.parentElement(),text:t.text,top:t.boundingTop,left:t.boundingLeft}}var n=window.getSelection();return{anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}}function y(e){if(m||p==null||p!=u())return;var t=g(p);if(!v||!l(v,t)){v=t;var n=o.getPooled(h.select,d,e);return n.type="select",n.target=p,i.accumulateTwoPhaseDispatches(n),n}}var r=e("./EventConstants"),i=e("./EventPropagators"),s=e("./ReactInputSelection"),o=e("./SyntheticEvent"),u=e("./getActiveElement"),a=e("./isTextInputElement"),f=e("./keyOf"),l=e("./shallowEqual"),c=r.topLevelTypes,h={select:{phasedRegistrationNames:{bubbled:f({onSelect:null}),captured:f({onSelectCapture:null})},dependencies:[c.topBlur,c.topContextMenu,c.topFocus,c.topKeyDown,c.topMouseDown,c.topMouseUp,c.topSelectionChange]}},p=null,d=null,v=null,m=!1,b={eventTypes:h,extractEvents:function(e,t,n,r){switch(e){case c.topFocus:if(a(t)||t.contentEditable==="true")p=t,d=n,v=null;break;case c.topBlur:p=null,d=null,v=null;break;case c.topMouseDown:m=!0;break;case c.topContextMenu:case c.topMouseUp:return m=!1,y(r);case c.topSelectionChange:case c.topKeyDown:case c.topKeyUp:return y(r)}}};t.exports=b},{"./EventConstants":14,"./EventPropagators":19,"./ReactInputSelection":52,"./SyntheticEvent":78,"./getActiveElement":102,"./isTextInputElement":115,"./keyOf":119,"./shallowEqual":130}],73:[function(e,t,n){var r=Math.pow(2,53),i={createReactRootIndex:function(){return Math.ceil(Math.random()*r)}};t.exports=i},{}],74:[function(e,t,n){var r=e("./EventConstants"),i=e("./EventPluginUtils"),s=e("./EventPropagators"),o=e("./SyntheticClipboardEvent"),u=e("./SyntheticEvent"),a=e("./SyntheticFocusEvent"),f=e("./SyntheticKeyboardEvent"),l=e("./SyntheticMouseEvent"),c=e("./SyntheticDragEvent"),h=e("./SyntheticTouchEvent"),p=e("./SyntheticUIEvent"),d=e("./SyntheticWheelEvent"),v=e("./invariant"),m=e("./keyOf"),g=r.topLevelTypes,y={blur:{phasedRegistrationNames:{bubbled:m({onBlur:!0}),captured:m({onBlurCapture:!0})}},click:{phasedRegistrationNames:{bubbled:m({onClick:!0}),captured:m({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:m({onContextMenu:!0}),captured:m({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:m({onCopy:!0}),captured:m({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:m({onCut:!0}),captured:m({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:m({onDoubleClick:!0}),captured:m({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:m({onDrag:!0}),captured:m({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:m({onDragEnd:!0}),captured:m({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:m({onDragEnter:!0}),captured:m({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:m({onDragExit:!0}),captured:m({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:m({onDragLeave:!0}),captured:m({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:m({onDragOver:!0}),captured:m({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:m({onDragStart:!0}),captured:m({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:m({onDrop:!0}),captured:m({onDropCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:m({onFocus:!0}),captured:m({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:m({onInput:!0}),captured:m({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:m({onKeyDown:!0}),captured:m({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:m({onKeyPress:!0}),captured:m({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:m({onKeyUp:!0}),captured:m({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:m({onLoad:!0}),captured:m({onLoadCapture:!0})}},error:{phasedRegistrationNames:{bubbled:m({onError:!0}),captured:m({onErrorCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:m({onMouseDown:!0}),captured:m({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:m({onMouseMove:!0}),captured:m({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:m({onMouseOut:!0}),captured:m({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:m({onMouseOver:!0}),captured:m({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:m({onMouseUp:!0}),captured:m({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:m({onPaste:!0}),captured:m({onPasteCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:m({onReset:!0}),captured:m({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:m({onScroll:!0}),captured:m({onScrollCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:m({onSubmit:!0}),captured:m({onSubmitCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:m({onTouchCancel:!0}),captured:m({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:m({onTouchEnd:!0}),captured:m({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:m({onTouchMove:!0}),captured:m({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:m({onTouchStart:!0}),captured:m({onTouchStartCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:m({onWheel:!0}),captured:m({onWheelCapture:!0})}}},b={topBlur:y.blur,topClick:y.click,topContextMenu:y.contextMenu,topCopy:y.copy,topCut:y.cut,topDoubleClick:y.doubleClick,topDrag:y.drag,topDragEnd:y.dragEnd,topDragEnter:y.dragEnter,topDragExit:y.dragExit,topDragLeave:y.dragLeave,topDragOver:y.dragOver,topDragStart:y.dragStart,topDrop:y.drop,topError:y.error,topFocus:y.focus,topInput:y.input,topKeyDown:y.keyDown,topKeyPress:y.keyPress,topKeyUp:y.keyUp,topLoad:y.load,topMouseDown:y.mouseDown,topMouseMove:y.mouseMove,topMouseOut:y.mouseOut,topMouseOver:y.mouseOver,topMouseUp:y.mouseUp,topPaste:y.paste,topReset:y.reset,topScroll:y.scroll,topSubmit:y.submit,topTouchCancel:y.touchCancel,topTouchEnd:y.touchEnd,topTouchMove:y.touchMove,topTouchStart:y.touchStart,topWheel:y.wheel};for(var w in b)b[w].dependencies=[w];var E={eventTypes:y,executeDispatch:function(e,t,n){var r=i.executeDispatch(e,t,n);r===!1&&(e.stopPropagation(),e.preventDefault())},extractEvents:function(e,t,n,r){var i=b[e];if(!i)return null;var m;switch(e){case g.topInput:case g.topLoad:case g.topError:case g.topReset:case g.topSubmit:m=u;break;case g.topKeyDown:case g.topKeyPress:case g.topKeyUp:m=f;break;case g.topBlur:case g.topFocus:m=a;break;case g.topClick:if(r.button===2)return null;case g.topContextMenu:case g.topDoubleClick:case g.topMouseDown:case g.topMouseMove:case g.topMouseOut:case g.topMouseOver:case g.topMouseUp:m=l;break;case g.topDrag:case g.topDragEnd:case g.topDragEnter:case g.topDragExit:case g.topDragLeave:case g.topDragOver:case g.topDragStart:case g.topDrop:m=c;break;case g.topTouchCancel:case g.topTouchEnd:case g.topTouchMove:case g.topTouchStart:m=h;break;case g.topScroll:m=p;break;case g.topWheel:m=d;break;case g.topCopy:case g.topCut:case g.topPaste:m=o}v(m,"SimpleEventPlugin: Unhandled event type, `%s`.",e);var y=m.getPooled(i,n,r);return s.accumulateTwoPhaseDispatches(y),y}};t.exports=E},{"./EventConstants":14,"./EventPluginUtils":18,"./EventPropagators":19,"./SyntheticClipboardEvent":75,"./SyntheticDragEvent":77,"./SyntheticEvent":78,"./SyntheticFocusEvent":79,"./SyntheticKeyboardEvent":80,"./SyntheticMouseEvent":81,"./SyntheticTouchEvent":82,"./SyntheticUIEvent":83,"./SyntheticWheelEvent":84,"./invariant":112,"./keyOf":119}],75:[function(e,t,n){function s(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticEvent"),i={clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}};r.augmentClass(s,i),t.exports=s},{"./SyntheticEvent":78}],76:[function(e,t,n){function s(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticEvent"),i={data:null};r.augmentClass(s,i),t.exports=s},{"./SyntheticEvent":78}],77:[function(e,t,n){function s(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticMouseEvent"),i={dataTransfer:null};r.augmentClass(s,i),t.exports=s},{"./SyntheticMouseEvent":81}],78:[function(e,t,n){function f(e,t,n){this.dispatchConfig=e,this.dispatchMarker=t,this.nativeEvent=n;var r=this.constructor.Interface;for(var s in r){if(!r.hasOwnProperty(s))continue;var o=r[s];o?this[s]=o(n):this[s]=n[s]}var u=n.defaultPrevented!=null?n.defaultPrevented:n.returnValue===!1;u?this.isDefaultPrevented=i.thatReturnsTrue:this.isDefaultPrevented=i.thatReturnsFalse,this.isPropagationStopped=i.thatReturnsFalse}var r=e("./PooledClass"),i=e("./emptyFunction"),s=e("./getEventTarget"),o=e("./merge"),u=e("./mergeInto"),a={type:null,target:s,currentTarget:i.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};u(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e.preventDefault?e.preventDefault():e.returnValue=!1,this.isDefaultPrevented=i.thatReturnsTrue},stopPropagation:function(){var e=this.nativeEvent;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.isPropagationStopped=i.thatReturnsTrue},persist:function(){this.isPersistent=i.thatReturnsTrue},isPersistent:i.thatReturnsFalse,destructor:function(){var e=this.constructor.Interface;for(var t in e)this[t]=null;this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),f.Interface=a,f.augmentClass=function(e,t){var n=this,i=Object.create(n.prototype);u(i,e.prototype),e.prototype=i,e.prototype.constructor=e,e.Interface=o(n.Interface,t),e.augmentClass=n.augmentClass,r.addPoolingTo(e,r.threeArgumentPooler)},r.addPoolingTo(f,r.threeArgumentPooler),t.exports=f},{"./PooledClass":23,"./emptyFunction":96,"./getEventTarget":104,"./merge":121,"./mergeInto":123}],79:[function(e,t,n){function s(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticUIEvent"),i={relatedTarget:null};r.augmentClass(s,i),t.exports=s},{"./SyntheticUIEvent":83}],80:[function(e,t,n){function o(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticUIEvent"),i=e("./getEventKey"),s={key:i,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,"char":null,charCode:null,keyCode:null,which:null};r.augmentClass(o,s),t.exports=o},{"./SyntheticUIEvent":83,"./getEventKey":103}],81:[function(e,t,n){function o(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticUIEvent"),i=e("./ViewportMetrics"),s={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,button:function(e){var t=e.button;return"which"in e?t:t===2?2:t===4?1:0},buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},pageX:function(e){return"pageX"in e?e.pageX:e.clientX+i.currentScrollLeft},pageY:function(e){return"pageY"in e?e.pageY:e.clientY+i.currentScrollTop}};r.augmentClass(o,s),t.exports=o},{"./SyntheticUIEvent":83,"./ViewportMetrics":86}],82:[function(e,t,n){function s(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticUIEvent"),i={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null};r.augmentClass(s,i),t.exports=s},{"./SyntheticUIEvent":83}],83:[function(e,t,n){function s(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticEvent"),i={view:null,detail:null};r.augmentClass(s,i),t.exports=s},{"./SyntheticEvent":78}],84:[function(e,t,n){function s(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticMouseEvent"),i={deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null};r.augmentClass(s,i),t.exports=s},{"./SyntheticMouseEvent":81}],85:[function(e,t,n){var r=e("./invariant"),i={reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this.timingMetrics||(this.timingMetrics={}),this.timingMetrics.methodInvocationTime=0,this.timingMetrics.wrapperInitTimes?this.timingMetrics.wrapperInitTimes.length=0:this.timingMetrics.wrapperInitTimes=[],this.timingMetrics.wrapperCloseTimes?this.timingMetrics.wrapperCloseTimes.length=0:this.timingMetrics.wrapperCloseTimes=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(e,t,n,i,s,o,u,a){r(!this.isInTransaction(),"Transaction.perform(...): Cannot initialize a transaction when there is already an outstanding transaction.");var f=Date.now(),l,c;try{this._isInTransaction=!0,l=!0,this.initializeAll(0),c=e.call(t,n,i,s,o,u,a),l=!1}finally{var h=Date.now();this.methodInvocationTime+=h-f;try{if(l)try{this.closeAll(0)}catch(p){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return c},initializeAll:function(e){var t=this.transactionWrappers,n=this.timingMetrics.wrapperInitTimes;for(var r=e;r<t.length;r++){var i=Date.now(),o=t[r];try{this.wrapperInitData[r]=s.OBSERVED_ERROR,this.wrapperInitData[r]=o.initialize?o.initialize.call(this):null}finally{var u=n[r],a=Date.now();n[r]=(u||0)+(a-i);if(this.wrapperInitData[r]===s.OBSERVED_ERROR)try{this.initializeAll(r+1)}catch(f){}}}},closeAll:function(e){r(this.isInTransaction(),"Transaction.closeAll(): Cannot close transaction when none are open.");var t=this.transactionWrappers,n=this.timingMetrics.wrapperCloseTimes;for(var i=e;i<t.length;i++){var o=t[i],u=Date.now(),a=this.wrapperInitData[i],f;try{f=!0,a!==s.OBSERVED_ERROR&&o.close&&o.close.call(this,a),f=!1}finally{var l=Date.now(),c=n[i];n[i]=(c||0)+(l-u);if(f)try{this.closeAll(i+1)}catch(h){}}}this.wrapperInitData.length=0}},s={Mixin:i,OBSERVED_ERROR:{}};t.exports=s},{"./invariant":112}],86:[function(e,t,n){var r=e("./getUnboundedScrollPosition"),i={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(){var e=r(window);i.currentScrollLeft=e.x,i.currentScrollTop=e.y}};t.exports=i},{"./getUnboundedScrollPosition":109}],87:[function(e,t,n){function i(e,t){r(t!=null,"accumulate(...): Accumulated items must be not be null or undefined.");if(e==null)return t;var n=Array.isArray(e),i=Array.isArray(t);return n?e.concat(t):i?[e].concat(t):[e,t]}var r=e("./invariant");t.exports=i},{"./invariant":112}],88:[function(e,t,n){function i(e){var t=1,n=0;for(var i=0;i<e.length;i++)t=(t+e.charCodeAt(i))%r,n=(n+t)%r;return t|n<<16}var r=65521;t.exports=i},{}],89:[function(e,t,n){function i(e,t){return!e||!t?!1:e===t?!0:r(e)?!1:r(t)?i(e,t.parentNode):e.contains?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1}var r=e("./isTextNode");t.exports=i},{"./isTextNode":116}],90:[function(e,t,n){function r(e,t,n,r,i,s,o){e=e||{};if(o)throw new Error("Too many arguments passed to copyProperties");var u=[t,n,r,i,s],a=0,f;while(u[a]){f=u[a++];for(var l in f)e[l]=f[l];f.hasOwnProperty&&f.hasOwnProperty("toString")&&typeof f.toString!="undefined"&&e.toString!==f.toString&&(e.toString=f.toString)}return e}t.exports=r},{}],91:[function(e,t,n){function i(e){return!!e&&(typeof e=="object"||typeof e=="function")&&"length"in e&&!("setInterval"in e)&&typeof e.nodeType!="number"&&(Array.isArray(e)||"callee"in e||"item"in e)}function s(e){return i(e)?Array.isArray(e)?e.slice():r(e):[e]}var r=e("./toArray");t.exports=s},{"./toArray":132}],92:[function(e,t,n){function s(e){var t=r.createClass({displayName:"ReactFullPageComponent"+(e.componentConstructor.displayName||""),componentWillUnmount:function(){i(!1,"%s tried to unmount. Because of cross-browser quirks it is impossible to unmount some top-level components (eg <html>, <head>, and <body>) reliably and efficiently. To fix this, have a single top-level component that never unmounts render these elements.",this.constructor.displayName)},render:function(){return this.transferPropsTo(e(null,this.props.children))}});return t}var r=e("./ReactCompositeComponent"),i=e("./invariant");t.exports=s},{"./ReactCompositeComponent":29,"./invariant":112}],93:[function(e,t,n){function f(e){var t=e.match(a);return t&&t[1].toLowerCase()}function l(e,t){var n=u;o(!!u,"createNodesFromMarkup dummy not initialized");var r=f(e),a=r&&s(r);if(a){n.innerHTML=a[1]+e+a[2];var l=a[0];while(l--)n=n.lastChild}else n.innerHTML=e;var c=n.getElementsByTagName("script");c.length&&(o(t,"createNodesFromMarkup(...): Unexpected <script> element rendered."),i(c).forEach(t));var h=i(n.childNodes);while(n.lastChild)n.removeChild(n.lastChild);return h}var r=e("./ExecutionEnvironment"),i=e("./createArrayFrom"),s=e("./getMarkupWrap"),o=e("./invariant"),u=r.canUseDOM?document.createElement("div"):null,a=/^\s*<(\w+)/;t.exports=l},{"./ExecutionEnvironment":20,"./createArrayFrom":91,"./getMarkupWrap":105,"./invariant":112}],94:[function(e,t,n){function r(e,t){if(!Array.isArray(e))throw new TypeError("Must pass an array of keys.");var n={},r=Array.isArray(t);typeof t=="undefined"&&(t=!0);for(var i=e.length;i--;)n[e[i]]=r?t[i]:t;return n}t.exports=r},{}],95:[function(e,t,n){function i(e,t){var n=t==null||typeof t=="boolean"||t==="";if(n)return"";var i=isNaN(t);return i||t===0||r.isUnitlessNumber[e]?""+t:t+"px"}var r=e("./CSSProperty");t.exports=i},{"./CSSProperty":2}],96:[function(e,t,n){function i(e){return function(){return e}}function s(){}var r=e("./copyProperties");r(s,{thatReturns:i,thatReturnsFalse:i(!1),thatReturnsTrue:i(!0),thatReturnsNull:i(null),thatReturnsThis:function(){return this},thatReturnsArgument:function(e){return e}}),t.exports=s},{"./copyProperties":90}],97:[function(e,t,n){var r={};Object.freeze(r),t.exports=r},{}],98:[function(e,t,n){function s(e){return r[e]}function o(e){return(""+e).replace(i,s)}var r={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},i=/[&><"'\/]/g;t.exports=o},{}],99:[function(e,t,n){function s(e,t,n){var i=e;r(!i.hasOwnProperty(n),"flattenChildren(...): Encountered two children with the same key, `%s`. Children keys must be unique.",n),t!=null&&(i[n]=t)}function o(e){if(e==null)return e;var t={};return i(e,s,t),t}var r=e("./invariant"),i=e("./traverseAllChildren");t.exports=o},{"./invariant":112,"./traverseAllChildren":133}],100:[function(e,t,n){function r(e){e.disabled||e.focus()}t.exports=r},{}],101:[function(e,t,n){var r=function(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)};t.exports=r},{}],102:[function(e,t,n){function r(){try{return document.activeElement||document.body}catch(e){return document.body}}t.exports=r},{}],103:[function(e,t,n){function s(e){return"key"in e?r[e.key]||e.key:i[e.which||e.keyCode]||"Unidentified"}var r={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};t.exports=s},{}],104:[function(e,t,n){function r(e){var t=e.target||e.srcElement||window;return t.nodeType===3?t.parentNode:t}t.exports=r},{}],105:[function(e,t,n){function h(e){return i(!!s,"Markup wrapping node not initialized"),c.hasOwnProperty(e)||(e="*"),o.hasOwnProperty(e)||(e==="*"?s.innerHTML="<link />":s.innerHTML="<"+e+"></"+e+">",o[e]=!s.firstChild),o[e]?c[e]:null}var r=e("./ExecutionEnvironment"),i=e("./invariant"),s=r.canUseDOM?document.createElement("div"):null,o={circle:!0,defs:!0,g:!0,line:!0,linearGradient:!0,path:!0,polygon:!0,polyline:!0,radialGradient:!0,rect:!0,stop:!0,text:!0},u=[1,'<select multiple="true">',"</select>"],a=[1,"<table>","</table>"],f=[3,"<table><tbody><tr>","</tr></tbody></table>"],l=[1,"<svg>","</svg>"],c={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:u,option:u,caption:a,colgroup:a,tbody:a,tfoot:a,thead:a,td:f,th:f,circle:l,defs:l,g:l,line:l,linearGradient:l,path:l,polygon:l,polyline:l,radialGradient:l,rect:l,stop:l,text:l};t.exports=h},{"./ExecutionEnvironment":20,"./invariant":112}],106:[function(e,t,n){function r(e){while(e&&e.firstChild)e=e.firstChild;return e}function i(e){while(e){if(e.nextSibling)return e.nextSibling;e=e.parentNode}}function s(e,t){var n=r(e),s=0,o=0;while(n){if(n.nodeType==3){o=s+n.textContent.length;if(s<=t&&o>=t)return{node:n,offset:t-s};s=o}n=r(i(n))}}t.exports=s},{}],107:[function(e,t,n){function i(e){return e?e.nodeType===r?e.documentElement:e.firstChild:null}var r=9;t.exports=i},{}],108:[function(e,t,n){function s(){return!i&&r.canUseDOM&&(i="textContent"in document.createElement("div")?"textContent":"innerText"),i}var r=e("./ExecutionEnvironment"),i=null;t.exports=s},{"./ExecutionEnvironment":20}],109:[function(e,t,n){function r(e){return e===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:e.scrollLeft,y:e.scrollTop}}t.exports=r},{}],110:[function(e,t,n){function i(e){return e.replace(r,"-$1").toLowerCase()}var r=/([A-Z])/g;t.exports=i},{}],111:[function(e,t,n){function i(e){return typeof e.constructor=="function"&&typeof e.constructor.prototype.construct=="function"&&typeof e.constructor.prototype.mountComponent=="function"&&typeof e.constructor.prototype.receiveComponent=="function"}function s(e){r(i(e),"Only React Components are valid for mounting.");var t=e.__realComponentInstance||e;return t._descriptor=e,t}var r=e("./warning");t.exports=s},{"./warning":134}],112:[function(e,t,n){var r=function(e){if(!e){var t=new Error("Minified exception occured; use the non-minified dev environment for the full error message and additional helpful warnings.");throw t.framesToPop=1,t}};r=function(e,t,n,r,i,s,o,u){if(t===undefined)throw new Error("invariant requires an error message argument");if(!e){var a=[n,r,i,s,o,u],f=0,l=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return a[f++]}));throw l.framesToPop=1,l}},t.exports=r},{}],113:[function(e,t,n){function s(e,t){if(!r.canUseDOM||t&&!("addEventListener"in document))return!1;var n="on"+e,s=n in document;if(!s){var o=document.createElement("div");o.setAttribute(n,"return;"),s=typeof o[n]=="function"}return!s&&i&&e==="wheel"&&(s=document.implementation.hasFeature("Events.wheel","3.0")),s}var r=e("./ExecutionEnvironment"),i;r.canUseDOM&&(i=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0),t.exports=s},{"./ExecutionEnvironment":20}],114:[function(e,t,n){function r(e){return!!e&&(typeof Node=="function"?e instanceof Node:typeof e=="object"&&typeof e.nodeType=="number"&&typeof e.nodeName=="string")}t.exports=r},{}],115:[function(e,t,n){function i(e){return e&&(e.nodeName==="INPUT"&&r[e.type]||e.nodeName==="TEXTAREA")}var r={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};t.exports=i},{}],116:[function(e,t,n){function i(e){return r(e)&&e.nodeType==3}var r=e("./isNode");t.exports=i},{"./isNode":114}],117:[function(e,t,n){function r(e){e||(e="");var t,n=arguments.length;if(n>1)for(var r=1;r<n;r++)t=arguments[r],t&&(e+=" "+t);return e}t.exports=r},{}],118:[function(e,t,n){var r=e("./invariant"),i=function(e){var t={},n;r(e instanceof Object&&!Array.isArray(e),"keyMirror(...): Argument must be an object.");for(n in e){if(!e.hasOwnProperty(n))continue;t[n]=n}return t};t.exports=i},{"./invariant":112}],119:[function(e,t,n){var r=function(e){var t;for(t in e){if(!e.hasOwnProperty(t))continue;return t}return null};t.exports=r},{}],120:[function(e,t,n){function r(e){var t={};return function(n){return t.hasOwnProperty(n)?t[n]:t[n]=e.call(this,n)}}t.exports=r},{}],121:[function(e,t,n){var r=e("./mergeInto"),i=function(e,t){var n={};return r(n,e),r(n,t),n};t.exports=i},{"./mergeInto":123}],122:[function(e,t,n){var r=e("./invariant"),i=e("./keyMirror"),s=36,o=function(e){return typeof e!="object"||e===null},u={MAX_MERGE_DEPTH:s,isTerminal:o,normalizeMergeArg:function(e){return e===undefined||e===null?{}:e},checkMergeArrayArgs:function(e,t){r(Array.isArray(e)&&Array.isArray(t),"Tried to merge arrays, instead got %s and %s.",e,t)},checkMergeObjectArgs:function(e,t){u.checkMergeObjectArg(e),u.checkMergeObjectArg(t)},checkMergeObjectArg:function(e){r(!o(e)&&!Array.isArray(e),"Tried to merge an object, instead got %s.",e)},checkMergeLevel:function(e){r(e<s,"Maximum deep merge depth exceeded. You may be attempting to merge circular structures in an unsupported way.")},checkArrayStrategy:function(e){r(e===undefined||e in u.ArrayStrategies,"You must provide an array strategy to deep merge functions to instruct the deep merge how to resolve merging two arrays.")},ArrayStrategies:i({Clobber:!0,IndexByIndex:!0})};t.exports=u},{"./invariant":112,"./keyMirror":118}],123:[function(e,t,n){function s(e,t){i(e);if(t!=null){i(t);for(var n in t){if(!t.hasOwnProperty(n))continue;e[n]=t[n]}}}var r=e("./mergeHelpers"),i=r.checkMergeObjectArg;t.exports=s},{"./mergeHelpers":122}],124:[function(e,t,n){var r=function(e,t){var n;for(n in t){if(!t.hasOwnProperty(n))continue;e.prototype[n]=t[n]}};t.exports=r},{}],125:[function(e,t,n){function i(e,t){r(e&&!/[^a-z0-9_]/.test(e),"You must provide an eventName using only the characters [a-z0-9_]")}var r=e("./invariant");t.exports=i},{"./invariant":112}],126:[function(e,t,n){function r(e,t,n){if(!e)return null;var r=0,i={};for(var s in e)e.hasOwnProperty(s)&&(i[s]=t.call(n,e[s],s,r++));return i}t.exports=r},{}],127:[function(e,t,n){function r(e,t,n){if(!e)return null;var r=0,i={};for(var s in e)e.hasOwnProperty(s)&&(i[s]=t.call(n,s,e[s],r++));return i}t.exports=r},{}],128:[function(e,t,n){function s(e){return i(r.isValidComponent(e),"onlyChild must be passed a children with exactly one child."),e}var r=e("./ReactComponent"),i=e("./invariant");t.exports=s},{"./ReactComponent":27,"./invariant":112}],129:[function(e,t,n){var r=e("./ExecutionEnvironment"),i=null;r.canUseDOM&&(i=window.performance||window.webkitPerformance);if(!i||!i.now)i=Date;var s=i.now.bind(i);t.exports=s},{"./ExecutionEnvironment":20}],130:[function(e,t,n){function r(e,t){if(e===t)return!0;var n;for(n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||e[n]!==t[n]))return!1;for(n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}t.exports=r},{}],131:[function(e,t,n){function r(e,t){if(e&&t&&e.constructor===t.constructor&&(e.props&&e.props.key)===(t.props&&t.props.key)){if(e._owner===t._owner)return!0;e.state&&console.warn("A recent change to React has been found to impact your code. A mounted component will now be unmounted and replaced by a component (of the same class) if their owners are different. Previously, ownership was not considered when updating.",e,t)}return!1}t.exports=r},{}],132:[function(e,t,n){function i(e){var t=e.length;r(!Array.isArray(e)&&(typeof e=="object"||typeof e=="function"),"toArray: Array-like object expected"),r(typeof t=="number","toArray: Object needs a length property"),r(t===0||t-1 in e,"toArray: Object should have keys for indices");if(e.hasOwnProperty)try{return Array.prototype.slice.call(e)}catch(n){}var i=Array(t);for(var s=0;s<t;s++)i[s]=e[s];return i}var r=e("./invariant");t.exports=i},{"./invariant":112}],133:[function(e,t,n){function l(e){return a[e]}function c(e,t){return e&&e.props&&e.props.key!=null?p(e.props.key):t.toString(36)}function h(e){return(""+e).replace(f,l)}function p(e){return"$"+h(e)}function v(e,t,n){e!==null&&e!==undefined&&d(e,"",0,t,n)}var r=e("./ReactInstanceHandles"),i=e("./ReactTextComponent"),s=e("./invariant"),o=r.SEPARATOR,u=":",a={"=":"=0",".":"=1",":":"=2"},f=/[=.:]/g,d=function(e,t,n,r,a){var f=0;if(Array.isArray(e))for(var l=0;l<e.length;l++){var h=e[l],v=t+(t?u:o)+c(h,l),m=n+f;f+=d(h,v,m,r,a)}else{var g=typeof e,y=t==="",b=y?o+c(e,0):t;if(e==null||g==="boolean")r(a,null,b,n),f=1;else if(e.type&&e.type.prototype&&e.type.prototype.mountComponentIntoNode)r(a,e,b,n),f=1;else if(g==="object"){s(!e||e.nodeType!==1,"traverseAllChildren(...): Encountered an invalid child; DOM elements are not valid children of React components.");for(var w in e)e.hasOwnProperty(w)&&(f+=d(e[w],t+(t?u:o)+p(w)+u+c(e[w],0),n+f,r,a))}else if(g==="string"){var E=new i(e);r(a,E,b,n),f+=1}else if(g==="number"){var S=new i(""+e);r(a,S,b,n),f+=1}}return f};t.exports=v},{"./ReactInstanceHandles":53,"./ReactTextComponent":70,"./invariant":112}],134:[function(e,t,n){var r=e("./emptyFunction"),i=r;i=function(e,t){var n=Array.prototype.slice.call(arguments,2);if(t===undefined)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(!e){var r=0;console.warn("Warning: "+t.replace(/%s/g,function(){return n[r++]}))}},t.exports=i},{"./emptyFunction":96}]},{},[24])(24)}),define("text",["module"],function(e){var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.12",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i&&i.isBuild&&!i.inlineText){r();return}d.isBuild=i&&i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){r&&r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status||0,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r&&r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("jsx",["JSXTransformer","text"],function(e,t){var n={},r={version:"0.2.1",load:function(r,i,s,o){var u=o.jsx&&o.jsx.fileExtension||".js",a=function(t){try{-1===t.indexOf("@jsx React.DOM")&&(t="/** @jsx React.DOM */\n"+t),t=e.transform(t).code}catch(i){s.error(i)}o.isBuild?n[r]=t:t+="\n//# sourceURL="+location.protocol+"//"+location.hostname+o.baseUrl+r+u,s.fromText(t)};t.load(r+u,i,a,o)},write:function(e,t,r){if(n.hasOwnProperty(t)){var i=n[t];r.asModule(t,i)}}};return r}),define("components/bootstrap/modal",["require","react","jquery"],function(e){var t=e("react"),n=e("jquery");return function(){var e=["handleShow","handleShown","handleHide","handleHidden"],r={handleShow:"show.bs.modal",handleShown:"shown.bs.modal",handleHide:"hide.bs.modal",handleHidden:"hidden.bs.modal"};return{propTypes:{handleShow:t.PropTypes.func,handleShown:t.PropTypes.func,handleHide:t.PropTypes.func,handleHidden:t.PropTypes.func,backdrop:t.PropTypes.bool,keyboard:t.PropTypes.bool,show:t.PropTypes.bool,remote:t.PropTypes.string},getDefaultProps:function(){return{backdrop:!0,keyboard:!0,show:!1,remote:"",handleHidden:function(){t.unmountComponentAtNode(n(this.getDOMNode()).parent().get(0))}.bind(this)}},componentWillMount:function(){n(".modal")&&n(".modal").modal("hide")},componentDidMount:function(){var t=n(this.getDOMNode()).modal({backdrop:this.props.backdrop,keyboard:this.props.keyboard,show:this.props.show,remote:this.props.remote});e.forEach(function(e){this[e]&&t.on(r[e],this[e]),this.props[e]&&t.on(r[e],this.props[e])}.bind(this))},componentWillUnmount:function(){var t=n(this.getDOMNode());e.forEach(function(e){this[e]&&t.off(r[e],this[e]),this.props[e]&&t.off(r[e],this.props[e])}.bind(this)),t.modal("hide")},hide:function(){n(this.getDOMNode()).modal("hide")},show:function(){n(this.getDOMNode()).modal("show")},toggle:function(){n(this.getDOMNode()).modal("toggle")},renderCloseButton:function(){return t.DOM.button({type:"button",className:"close",onClick:this.hide,dangerouslySetInnerHTML:{__html:"&times"}})}}}()}),define("components/popups/InfoModal",["require","react","jquery","jsx!components/bootstrap/modal"],function(e){var t=e("react");return $=e("jquery"),t.createClass({mixins:[e("jsx!components/bootstrap/modal")],getDefaultProps:function(){return{title:"Message",text:"",buttonLabel:"Ok",onClick:function(){}}},render:function(){return t.DOM.div({className:"modal fade",id:"infomodal"},t.DOM.div({className:"modal-dialog"},t.DOM.div({className:"modal-content"},t.DOM.div({className:"modal-header",id:"infomodal-header"},t.DOM.button({type:"button",className:"close","data-dismiss":"modal","aria-hidden":"true"},"×"),t.DOM.h3({id:"infomodal-title",className:"text-center"},this.props.title)),t.DOM.div({className:"modal-body"},t.DOM.p({id:"infomodal-text"},this.props.text)),t.DOM.div({className:"modal-footer",id:"infomodal-footer"},t.DOM.button({id:"infomodal-btn",className:"btn btn-warning","data-dismiss":"modal","aria-hidden":"true",onClick:this.props.onClick,dangerouslySetInnerHTML:{__html:this.props.buttonLabel}})))))}})}),define("components/popups/ErrorModal",["require","react","jquery","jsx!components/bootstrap/modal"],function(e){var t=e("react");return $=e("jquery"),t.createClass({mixins:[e("jsx!components/bootstrap/modal")],getDefaultProps:function(){return{title:"There was an error",text:"",code:"",source:"",exception:""}},shareTwitter:function(){GEPPETTO.Share.twitter("http://geppetto.org","Whoops, I broke Geppetto! @openworm help!")},render:function(){return t.DOM.div({className:"modal fade",id:"errormodal"},t.DOM.div({className:"modal-dialog"},t.DOM.div({className:"modal-content"},t.DOM.div({className:"modal-header",id:"errormodal-header"},t.DOM.button({type:"button",className:"close","data-dismiss":"modal","aria-hidden":"true"},"×"),t.DOM.h3({id:"errormodal-title",className:"text-center"},this.props.title)),t.DOM.div({className:"modal-body"},t.DOM.p({id:"errormodal-text"}),t.DOM.div({className:"panel panel-default"},t.DOM.div({className:"panel-heading"},t.DOM.h4({className:"panel-title"},t.DOM.a({id:"error_code","data-toggle":"collapse","data-parent":"#accordion",href:"#collapseOne"},"> Error Code: "+this.props.code))),t.DOM.div({id:"collapseOne",className:"panel-collapse collapse"},t.DOM.div({className:"panel-body"},t.DOM.p({id:"error_source"},this.props.source),t.DOM.p({id:"error_exception"},this.props.exception))))),t.DOM.div({className:"modal-footer",id:"errormodal-footer"},t.DOM.button({className:"btn btn-warning",onClick:this.shareTwitter,"aria-hidden":"true"},t.DOM.i({className:"icon-twitter"})," Shame on you"),t.DOM.a({className:"btn btn-warning",href:"https://github.com/openworm/org.geppetto/issues/new",target:"_blank","aria-hidden":"true"},t.DOM.i({className:"icon-bug"})," Open issue"),t.DOM.button({id:"errormodal-btn",className:"btn btn-info","data-dismiss":"modal","aria-hidden":"true"},"Close")))))}})}),define("GEPPETTO.FE",["require","react","jquery","jsx!components/popups/InfoModal","jsx!components/popups/ErrorModal"],function(e){return function(t){var n=e("react"),r=e("jquery"),i=e("jsx!components/popups/InfoModal"),s=e("jsx!components/popups/ErrorModal");t.FE={initialEvents:function(){t.Console.createConsole(),t.Vanilla.enableKeyboard(!1),r.fn.modal.Constructor.prototype.enforceFocus=function(){};var e=r("#share");e.click(function(){e.toggleClass("clicked");var n=e.hasClass("clicked")?"true":"false";return t.Console.executeCommand("G.showShareBar("+n+")"),!1})},postSocketConnection:function(){t.Vanilla.enableKeyboard(!0)},createContainer:function(){return r("#sim canvas").remove(),r("#sim").get(0)},SimulationReloaded:function(){t.WidgetsListener.update(t.WidgetsListener.WIDGET_EVENT_TYPE.DELETE)},update:function(e){e||(t.Console.debugLog(t.Resources.WEBGL_FAILED),t.FE.disableSimulationControls(),t.FE.infoDialog(t.Resources.WEBGL_FAILED,t.Resources.WEBGL_MESSAGE))},observersDialog:function(e,s){n.renderComponent(i({show:!0,keyboard:!1,title:e,txt:s,onClick:t.Main.observe,buttonLabel:'<i class="icon-eye-open "></i> Observe'}),document.getElementById("modal-region")),r("#welcomeMessageModal").css("opacity","0.0")},infoDialog:function(e,t){n.renderComponent(i({show:!0,keyboard:!1,title:e,text:t}),document.getElementById("modal-region"))},errorDialog:function(e,t,r,i,o){n.renderComponent(s({show:!0,keyboard:!1,title:e,text:t,code:r,source:i,exception:o}),document.getElementById("modal-region"))},observersAlert:function(e,t,n){r("#welcomeMessageModal").hasClass("in")&&r("#welcomeMessageModal").css("opacity","1.0"),r("#alertbox-text").html(t),r("#alertbox").show(),r("#infopopover").popover({title:e,content:n})},disableSimulationControls:function(){t.trigger("simulation:disable_all"),r("#consoleButton").attr("disabled","disabled"),r("#commandInputArea").attr("disabled","disabled"),document.removeEventListener("keydown",t.Vanilla.checkKeyboard)},fullSimulatorNotification:function(e,n){r("#capacityNotificationTitle").html(e+t.Resources.SIMULATOR_UNAVAILABLE),r("#queuePosition").html(n),r("#multiUserNotification").modal()}}}}),define("GEPPETTO.ScriptRunner",["require"],function(e){return function(e){var t=[],n=!1,r=!1,i=[],s=null,o=[];e.ScriptRunner={executeScriptCommands:function(t){r=!0;for(var i=0,s=t.length;i<s;i++){var u=t[i].toString().trim();if(u!=""){if(u.indexOf("G.wait")>-1){var a=u.match(/\((.*?)\)/),f=a[1];o=t.splice(i+1,t.length),e.G.wait(o,f);return}if(n)return;e.Console.executeCommand(u);var l=t.slice();o=l.splice(i+1,l.length-1)}}r=!1},runScript:function(t){e.ScriptRunner.addScriptMessageHandler();var n=t.split("\n");for(var r=0;r<n.length;r++){var i=n[r];i||n.splice(r,1)}e.ScriptRunner.executeScriptCommands(n)},addScriptMessageHandler:function(){s={onMessage:function(t){var r=i.indexOf(t.requestID);r>-1&&(i.splice(r,1),i.length<=0&&(n=!1,e.ScriptRunner.executeScriptCommands(o)))}},e.MessageSocket.addHandler(s)},waitingForServerResponse:function(e){n=!0,i.push(e)},isScriptRunning:function(){return r},fireScripts:function(n){if(n.length>1){var r=n[0].script;e.Console.executeCommand('G.runScript("'+r+'")');for(var i=1;i<n.length;i++)t.push(n[i].script)}else e.Console.executeCommand('G.runScript("'+n[0].script+'")')}}}}),window.CodeMirror=function(){function e(n,r){if(!(this instanceof e))return new e(n,r);this.options=r=r||{};for(var i in ns)!r.hasOwnProperty(i)&&ns.hasOwnProperty(i)&&(r[i]=ns[i]);h(r);var s="string"==typeof r.value?0:r.value.first,o=this.display=t(n,s);o.wrapper.CodeMirror=this,f(this),r.autofocus&&!Bi&&ht(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,draggingText:!1,highlight:new Wr},u(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");var a=r.value;"string"==typeof a&&(a=new ds(r.value,r.mode)),it(this,lr)(this,a),xi&&setTimeout(Zr(ct,this,!0),20),dt(this);var l;try{l=document.activeElement==o.input}catch(c){}l||r.autofocus&&!Bi?setTimeout(Zr(Ot,this),20):Mt(this),it(this,function(){for(var e in ts)ts.propertyIsEnumerable(e)&&ts[e](this,r[e],rs);for(var t=0;t<us.length;++t)us[t](this)})()}function t(e,t){var n={},r=n.input=ni("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none; font-size: 4px;");return Ci?r.style.width="1000px":r.setAttribute("wrap","off"),Hi&&(r.style.border="1px solid black"),r.setAttribute("autocorrect","off"),r.setAttribute("autocapitalize","off"),r.setAttribute("spellcheck","false"),n.inputDiv=ni("div",[r],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),n.scrollbarH=ni("div",[ni("div",null,null,"height: 1px")],"CodeMirror-hscrollbar"),n.scrollbarV=ni("div",[ni("div",null,null,"width: 1px")],"CodeMirror-vscrollbar"),n.scrollbarFiller=ni("div",null,"CodeMirror-scrollbar-filler"),n.gutterFiller=ni("div",null,"CodeMirror-gutter-filler"),n.lineDiv=ni("div",null,"CodeMirror-code"),n.selectionDiv=ni("div",null,null,"position: relative; z-index: 1"),n.cursor=ni("div"," ","CodeMirror-cursor"),n.otherCursor=ni("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"),n.measure=ni("div",null,"CodeMirror-measure"),n.lineSpace=ni("div",[n.measure,n.selectionDiv,n.lineDiv,n.cursor,n.otherCursor],null,"position: relative; outline: none"),n.mover=ni("div",[ni("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=ni("div",[n.mover],"CodeMirror-sizer"),n.heightForcer=ni("div",null,null,"position: absolute; height: "+bs+"px; width: 1px;"),n.gutters=ni("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=ni("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=ni("div",[n.inputDiv,n.scrollbarH,n.scrollbarV,n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),Ti&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),e.appendChild?e.appendChild(n.wrapper):e(n.wrapper),Hi&&(r.style.width="0px"),Ci||(n.scroller.draggable=!0),Mi?(n.inputDiv.style.height="1px",n.inputDiv.style.position="absolute"):Ti&&(n.scrollbarH.style.minWidth=n.scrollbarV.style.minWidth="18px"),n.viewOffset=n.lastSizeC=0,n.showingFrom=n.showingTo=t,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.prevInput="",n.alignWidgets=!1,n.pollingFast=!1,n.poll=new Wr,n.cachedCharWidth=n.cachedTextHeight=null,n.measureLineCache=[],n.measureLineCachePos=0,n.inaccurateSelection=!1,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n}function n(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),t.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),t.doc.frontier=t.doc.first,M(t,100),t.state.modeGen++,t.curOp&&ut(t)}function r(e){e.options.lineWrapping?(e.display.wrapper.className+=" CodeMirror-wrap",e.display.sizer.style.minWidth=""):(e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-wrap",""),c(e)),s(e),ut(e),W(e),setTimeout(function(){p(e)},100)}function i(e){var t=et(e.display),n=e.options.lineWrapping,r=n&&Math.max(5,e.display.scroller.clientWidth/tt(e.display)-3);return function(i){return In(e.doc,i)?0:n?(Math.ceil(i.text.length/r)||1)*t:t}}function s(e){var t=e.doc,n=i(e);t.iter(function(e){var t=n(e);t!=e.height&&dr(e,t)})}function o(e){var t=fs[e.options.keyMap],n=t.style;e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(n?" cm-keymap-"+n:""),e.state.disableInput=t.disableInput}function u(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),W(e)}function a(e){f(e),ut(e),setTimeout(function(){v(e)},20)}function f(e){var t=e.display.gutters,n=e.options.gutters;ri(t);for(var r=0;r<n.length;++r){var i=n[r],s=t.appendChild(ni("div",null,"CodeMirror-gutter "+i));"CodeMirror-linenumbers"==i&&(e.display.lineGutter=s,s.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=r?"":"none"}function l(e,t){if(0==t.height)return 0;for(var n,r=t.text.length,i=t;n=Bn(i);){var s=n.find();i=cr(e,s.from.line),r+=s.from.ch-s.to.ch}for(i=t;n=jn(i);){var s=n.find();r-=i.text.length-s.from.ch,i=cr(e,s.to.line),r+=i.text.length-s.to.ch}return r}function c(e){var t=e.display,n=e.doc;t.maxLine=cr(n,n.first),t.maxLineLength=l(n,t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var r=l(n,e);r>t.maxLineLength&&(t.maxLineLength=r,t.maxLine=e)})}function h(e){for(var t=!1,n=0;n<e.gutters.length;++n)"CodeMirror-linenumbers"==e.gutters[n]&&(e.lineNumbers?t=!0:e.gutters.splice(n--,1));!t&&e.lineNumbers&&e.gutters.push("CodeMirror-linenumbers")}function p(e){var t=e.display,n=e.doc.height,r=n+B(t);t.sizer.style.minHeight=t.heightForcer.style.top=r+"px",t.gutters.style.height=Math.max(r,t.scroller.clientHeight-bs)+"px";var i=Math.max(r,t.scroller.scrollHeight),s=t.scroller.scrollWidth>t.scroller.clientWidth+1,o=i>t.scroller.clientHeight+1;o?(t.scrollbarV.style.display="block",t.scrollbarV.style.bottom=s?ai(t.measure)+"px":"0",t.scrollbarV.firstChild.style.height=i-t.scroller.clientHeight+t.scrollbarV.clientHeight+"px"):t.scrollbarV.style.display="",s?(t.scrollbarH.style.display="block",t.scrollbarH.style.right=o?ai(t.measure)+"px":"0",t.scrollbarH.firstChild.style.width=t.scroller.scrollWidth-t.scroller.clientWidth+t.scrollbarH.clientWidth+"px"):t.scrollbarH.style.display="",s&&o?(t.scrollbarFiller.style.display="block",t.scrollbarFiller.style.height=t.scrollbarFiller.style.width=ai(t.measure)+"px"):t.scrollbarFiller.style.display="",s&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(t.gutterFiller.style.display="block",t.gutterFiller.style.height=ai(t.measure)+"px",t.gutterFiller.style.width=t.gutters.offsetWidth+"px"):t.gutterFiller.style.display="",_i&&0===ai(t.measure)&&(t.scrollbarV.style.minWidth=t.scrollbarH.style.minHeight=Di?"18px":"12px")}function d(e,t,n){var r=e.scroller.scrollTop,i=e.wrapper.clientHeight;"number"==typeof n?r=n:n&&(r=n.top,i=n.bottom-n.top),r=Math.floor(r-H(e));var s=Math.ceil(r+i);return{from:mr(t,r),to:mr(t,s)}}function v(e){var t=e.display;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var n=y(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,i=n+"px",s=t.lineDiv.firstChild;s;s=s.nextSibling)if(s.alignable)for(var o=0,u=s.alignable;o<u.length;++o)u[o].style.left=i;e.options.fixedGutter&&(t.gutters.style.left=n+r+"px")}}function m(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=g(e.options,t.first+t.size-1),r=e.display;if(n.length!=r.lineNumChars){var i=r.measure.appendChild(ni("div",[ni("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),s=i.firstChild.offsetWidth,o=i.offsetWidth-s;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(s,r.lineGutter.offsetWidth-o),r.lineNumWidth=r.lineNumInnerWidth+o,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",!0}return!1}function g(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function y(e){return oi(e.scroller).left-oi(e.sizer).left}function b(e,t,n){for(var r,i=e.display.showingFrom,s=e.display.showingTo,o=d(e.display,e.doc,n);w(e,t,o)&&(r=!0,k(e),p(e),n&&(n=Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,"number"==typeof n?n:n.top)),o=d(e.display,e.doc,n),!(o.from>=e.display.showingFrom&&o.to<=e.display.showingTo));)t=[];return r&&(qr(e,"update",e),(e.display.showingFrom!=i||e.display.showingTo!=s)&&qr(e,"viewportChange",e,e.display.showingFrom,e.display.showingTo)),r}function w(e,t,n){var r=e.display,i=e.doc;if(!r.wrapper.clientWidth)return r.showingFrom=r.showingTo=i.first,r.viewOffset=0,void 0;if(!(0==t.length&&n.from>r.showingFrom&&n.to<r.showingTo)){m(e)&&(t=[{from:i.first,to:i.first+i.size}]);var s=r.sizer.style.marginLeft=r.gutters.offsetWidth+"px";r.scrollbarH.style.left=e.options.fixedGutter?s:"0";var o=1/0;if(e.options.lineNumbers)for(var u=0;u<t.length;++u)if(t[u].diff){o=t[u].from;break}var a=i.first+i.size,f=Math.max(n.from-e.options.viewportMargin,i.first),l=Math.min(a,n.to+e.options.viewportMargin);if(r.showingFrom<f&&f-r.showingFrom<20&&(f=Math.max(i.first,r.showingFrom)),r.showingTo>l&&r.showingTo-l<20&&(l=Math.min(a,r.showingTo)),Vi)for(f=vr(Fn(i,cr(i,f)));a>l&&In(i,cr(i,l));)++l;var c=[{from:Math.max(r.showingFrom,i.first),to:Math.min(r.showingTo,a)}];if(c=c[0].from>=c[0].to?[]:S(c,t),Vi)for(var u=0;u<c.length;++u)for(var h,p=c[u];h=jn(cr(i,p.to-1));){var d=h.find().from.line;if(!(d>p.from)){c.splice(u--,1);break}p.to=d}for(var v=0,u=0;u<c.length;++u){var p=c[u];p.from<f&&(p.from=f),p.to>l&&(p.to=l),p.from>=p.to?c.splice(u--,1):v+=p.to-p.from}if(v==l-f&&f==r.showingFrom&&l==r.showingTo)return E(e),void 0;c.sort(function(e,t){return e.from-t.from});try{var g=document.activeElement}catch(y){}.7*(l-f)>v&&(r.lineDiv.style.display="none"),T(e,f,l,c,o),r.lineDiv.style.display="",g&&document.activeElement!=g&&g.offsetHeight&&g.focus();var b=f!=r.showingFrom||l!=r.showingTo||r.lastSizeC!=r.wrapper.clientHeight;b&&(r.lastSizeC=r.wrapper.clientHeight,M(e,400)),r.showingFrom=f,r.showingTo=l;for(var w,x=r.lineDiv.offsetTop,N=r.lineDiv.firstChild;N;N=N.nextSibling)if(N.lineObj){if(Ti){var C=N.offsetTop+N.offsetHeight;w=C-x,x=C}else{var k=oi(N);w=k.bottom-k.top}var L=N.lineObj.height-w;if(2>w&&(w=et(r)),L>.001||-0.001>L){dr(N.lineObj,w);var A=N.lineObj.widgets;if(A)for(var u=0;u<A.length;++u)A[u].height=A[u].node.offsetHeight}}return E(e),!0}}function E(e){var t=e.display.viewOffset=gr(e,cr(e.doc,e.display.showingFrom));e.display.mover.style.top=t+"px"}function S(e,t){for(var n=0,r=t.length||0;r>n;++n){for(var i=t[n],s=[],o=i.diff||0,u=0,a=e.length;a>u;++u){var f=e[u];i.to<=f.from&&i.diff?s.push({from:f.from+o,to:f.to+o}):i.to<=f.from||i.from>=f.to?s.push(f):(i.from>f.from&&s.push({from:f.from,to:i.from}),i.to<f.to&&s.push({from:i.to+o,to:f.to+o}))}e=s}return e}function x(e){for(var t=e.display,n={},r={},i=t.gutters.firstChild,s=0;i;i=i.nextSibling,++s)n[e.options.gutters[s]]=i.offsetLeft,r[e.options.gutters[s]]=i.offsetWidth;return{fixedPos:y(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function T(e,t,n,r,i){function s(t){var n=t.nextSibling;return Ci&&ji&&e.display.currentWheelTarget==t?(t.style.display="none",t.lineObj=null):t.parentNode.removeChild(t),n}var o=x(e),u=e.display,a=e.options.lineNumbers;r.length||Ci&&e.display.currentWheelTarget||ri(u.lineDiv);var f=u.lineDiv,l=f.firstChild,c=r.shift(),h=t;for(e.doc.iter(t,n,function(t){if(c&&c.to==h&&(c=r.shift()),In(e.doc,t)){if(0!=t.height&&dr(t,0),t.widgets&&l.previousSibling)for(var n=0;n<t.widgets.length;++n){var u=t.widgets[n];if(u.showIfHidden){var p=l.previousSibling;if(/pre/i.test(p.nodeName)){var d=ni("div",null,null,"position: relative");p.parentNode.replaceChild(d,p),d.appendChild(p),p=d}var v=p.appendChild(ni("div",[u.node],"CodeMirror-linewidget"));u.handleMouseEvents||(v.ignoreEvents=!0),C(u,v,p,o)}}}else if(c&&c.from<=h&&c.to>h){for(;l.lineObj!=t;)l=s(l);a&&h>=i&&l.lineNumber&&si(l.lineNumber,g(e.options,h)),l=l.nextSibling}else{if(t.widgets)for(var m,y=0,b=l;b&&20>y;++y,b=b.nextSibling)if(b.lineObj==t&&/div/i.test(b.nodeName)){m=b;break}var w=N(e,t,h,o,m);if(w!=m)f.insertBefore(w,l);else{for(;l!=m;)l=s(l);l=l.nextSibling}w.lineObj=t}++h});l;)l=s(l)}function N(e,t,n,r,i){var s,o=er(e,t),u=t.gutterMarkers,a=e.display;if(!(e.options.lineNumbers||u||t.bgClass||t.wrapClass||t.widgets))return o;if(i){i.alignable=null;for(var f,l=!0,c=0,h=null,p=i.firstChild;p;p=f)if(f=p.nextSibling,/\bCodeMirror-linewidget\b/.test(p.className)){for(var d=0,v=!0;d<t.widgets.length;++d){var m=t.widgets[d];if(m.above||(h=p,v=!1),m.node==p.firstChild){C(m,p,i,r),++c;break}}if(d==t.widgets.length){l=!1;break}}else i.removeChild(p);i.insertBefore(o,h),l&&c==t.widgets.length&&(s=i,i.className=t.wrapClass||"")}if(s||(s=ni("div",null,t.wrapClass,"position: relative"),s.appendChild(o)),t.bgClass&&s.insertBefore(ni("div",null,t.bgClass+" CodeMirror-linebackground"),s.firstChild),e.options.lineNumbers||u){var y=s.insertBefore(ni("div",null,null,"position: absolute; left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px"),s.firstChild);if(e.options.fixedGutter&&(s.alignable||(s.alignable=[])).push(y),!e.options.lineNumbers||u&&u["CodeMirror-linenumbers"]||(s.lineNumber=y.appendChild(ni("div",g(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+a.lineNumInnerWidth+"px"))),u)for(var b=0;b<e.options.gutters.length;++b){var w=e.options.gutters[b],E=u.hasOwnProperty(w)&&u[w];E&&y.appendChild(ni("div",[E],"CodeMirror-gutter-elt","left: "+r.gutterLeft[w]+"px; width: "+r.gutterWidth[w]+"px"))}}if(Ti&&(s.style.zIndex=2),t.widgets&&s!=i)for(var d=0,S=t.widgets;d<S.length;++d){var m=S[d],x=ni("div",[m.node],"CodeMirror-linewidget");m.handleMouseEvents||(x.ignoreEvents=!0),C(m,x,s,r),m.above?s.insertBefore(x,e.options.lineNumbers&&0!=t.height?y:o):s.appendChild(x),qr(m,"redraw")}return s}function C(e,t,n,r){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var i=r.wrapperWidth;t.style.left=r.fixedPos+"px",e.coverGutter||(i-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px"),t.style.width=i+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function k(e){var t=e.display,n=Wt(e.doc.sel.from,e.doc.sel.to);if(n||e.options.showCursorWhenSelecting?L(e):t.cursor.style.display=t.otherCursor.style.display="none",n?t.selectionDiv.style.display="none":A(e),e.options.moveInputWithCursor){var r=Q(e,e.doc.sel.head,"div"),i=oi(t.wrapper),s=oi(t.lineDiv);t.inputDiv.style.top=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+s.top-i.top))+"px",t.inputDiv.style.left=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+s.left-i.left))+"px"}}function L(e){var t=e.display,n=Q(e,e.doc.sel.head,"div");t.cursor.style.left=n.left+"px",t.cursor.style.top=n.top+"px",t.cursor.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",t.cursor.style.display="",n.other?(t.otherCursor.style.display="",t.otherCursor.style.left=n.other.left+"px",t.otherCursor.style.top=n.other.top+"px",t.otherCursor.style.height=.85*(n.other.bottom-n.other.top)+"px"):t.otherCursor.style.display="none"}function A(e){function t(e,t,n,r){0>t&&(t=0),o.appendChild(ni("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==n?u-e:n)+"px; height: "+(r-t)+"px"))}function n(n,r,s){function o(t,r){return K(e,zt(n,t),"div",c,r)}var f,l,c=cr(i,n),h=c.text.length;return li(yr(c),r||0,null==s?h:s,function(e,n,i){var c,p,d,v=o(e,"left");if(e==n)c=v,p=d=v.left;else{if(c=o(n-1,"right"),"rtl"==i){var m=v;v=c,c=m}p=v.left,d=c.right}null==r&&0==e&&(p=a),c.top-v.top>3&&(t(p,v.top,null,v.bottom),p=a,v.bottom<c.top&&t(p,v.bottom,null,c.top)),null==s&&n==h&&(d=u),(!f||v.top<f.top||v.top==f.top&&v.left<f.left)&&(f=v),(!l||c.bottom>l.bottom||c.bottom==l.bottom&&c.right>l.right)&&(l=c),a+1>p&&(p=a),t(p,c.top,d-p,c.bottom)}),{start:f,end:l}}var r=e.display,i=e.doc,s=e.doc.sel,o=document.createDocumentFragment(),u=r.lineSpace.offsetWidth,a=j(e.display);if(s.from.line==s.to.line)n(s.from.line,s.from.ch,s.to.ch);else{var f=cr(i,s.from.line),l=cr(i,s.to.line),c=Fn(i,f)==Fn(i,l),h=n(s.from.line,s.from.ch,c?f.text.length:null).end,p=n(s.to.line,c?0:null,s.to.ch).start;c&&(h.top<p.top-2?(t(h.right,h.top,null,h.bottom),t(a,p.top,p.left,p.bottom)):t(h.right,h.top,p.left-h.right,h.bottom)),h.bottom<p.top&&t(a,h.bottom,null,p.top)}ii(r.selectionDiv,o),r.selectionDiv.style.display=""}function O(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursor.style.visibility=t.otherCursor.style.visibility="",t.blinker=setInterval(function(){t.cursor.style.visibility=t.otherCursor.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate)}}function M(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.showingTo&&e.state.highlight.set(t,Zr(_,e))}function _(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.showingTo)){var n,r=+(new Date)+e.options.workTime,i=mn(t.mode,P(e,t.frontier)),s=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.showingTo+500),function(o){if(t.frontier>=e.display.showingFrom){var u=o.styles;o.styles=Qn(e,o,i);for(var a=!u||u.length!=o.styles.length,f=0;!a&&f<u.length;++f)a=u[f]!=o.styles[f];a&&(n&&n.end==t.frontier?n.end++:s.push(n={start:t.frontier,end:t.frontier+1})),o.stateAfter=mn(t.mode,i)}else Yn(e,o,i),o.stateAfter=0==t.frontier%5?mn(t.mode,i):null;return++t.frontier,+(new Date)>r?(M(e,e.options.workDelay),!0):void 0}),s.length&&it(e,function(){for(var e=0;e<s.length;++e)ut(this,s[e].start,s[e].end)})()}}function D(e,t,n){for(var r,i,s=e.doc,o=t,u=t-100;o>u;--o){if(o<=s.first)return s.first;var a=cr(s,o-1);if(a.stateAfter&&(!n||o<=s.frontier))return o;var f=Xr(a.text,null,e.options.tabSize);(null==i||r>f)&&(i=o-1,r=f)}return i}function P(e,t,n){var r=e.doc,i=e.display;if(!r.mode.startState)return!0;var s=D(e,t,n),o=s>r.first&&cr(r,s-1).stateAfter;return o=o?mn(r.mode,o):gn(r.mode),r.iter(s,t,function(n){Yn(e,n,o);var u=s==t-1||0==s%5||s>=i.showingFrom&&s<i.showingTo;n.stateAfter=u?mn(r.mode,o):null,++s}),o}function H(e){return e.lineSpace.offsetTop}function B(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function j(e){var t=ii(e.measure,ni("pre",null,null,"text-align: left")).appendChild(ni("span","x"));return t.offsetLeft}function F(e,t,n,r,i){var s=-1;r=r||R(e,t);for(var o=n;;o+=s){var u=r[o];if(u)break;0>s&&0==o&&(s=1)}var a=(n>o||"right"==i)&&null!=u.topRight;return{left:n>o?u.right:u.left,right:o>n?u.left:u.right,top:a?u.topRight:u.top,bottom:a?u.bottomRight:u.bottom}}function I(e,t){for(var n=e.display.measureLineCache,r=0;r<n.length;++r){var i=n[r];if(i.text==t.text&&i.markedSpans==t.markedSpans&&e.display.scroller.clientWidth==i.width&&i.classes==t.textClass+"|"+t.bgClass+"|"+t.wrapClass)return i}}function q(e,t){var n=I(e,t);n&&(n.text=n.measure=n.markedSpans=null)}function R(e,t){var n=I(e,t);if(n)return n.measure;var r=U(e,t),i=e.display.measureLineCache,s={text:t.text,width:e.display.scroller.clientWidth,markedSpans:t.markedSpans,measure:r,classes:t.textClass+"|"+t.bgClass+"|"+t.wrapClass};return 16==i.length?i[++e.display.measureLineCachePos%16]=s:i.push(s),r}function U(e,t){function n(e,t){t>m&&(t=m),0>e&&(e=0);for(var n=0;n<d.length;n+=2){var r=d[n],i=d[n+1];if(!(r>t||e>i)&&(e>=r&&i>=t||r>=e&&t>=i||Math.min(t,i)-Math.max(e,r)>=t-e>>1))return d[n]=Math.min(e,r),d[n+1]=Math.max(t,i),n}return d.push(e,t),n}var r=e.display,i=Yr(t.text.length),s=er(e,t,i);if(xi&&!Ti&&!e.options.lineWrapping&&s.childNodes.length>100){for(var o=document.createDocumentFragment(),u=10,a=s.childNodes.length,f=0,l=Math.ceil(a/u);l>f;++f){for(var c=ni("div",null,null,"display: inline-block"),h=0;u>h&&a;++h)c.appendChild(s.firstChild),--a;o.appendChild(c)}s.appendChild(o)}ii(r.measure,s);var p=oi(r.lineDiv),d=[],v=Yr(t.text.length),m=s.offsetHeight;Ni&&r.measure.first!=s&&ii(r.measure,s);for(var g,f=0;f<i.length;++f)if(g=i[f]){var y,b=g;if(/\bCodeMirror-widget\b/.test(g.className)&&g.getClientRects){1==g.firstChild.nodeType&&(b=g.firstChild);var w=b.getClientRects(),E=w[0],S=w[w.length-1];if(w.length>1){var x=n(E.top-p.top,E.bottom-p.top),T=n(S.top-p.top,S.bottom-p.top);v[f]={left:E.left-p.left,right:S.right-p.left,top:x,topRight:T};continue}}y=oi(b);var N=n(y.top-p.top,y.bottom-p.top),C=y.right;g.measureRight&&(C=oi(g.measureRight).left),v[f]={left:y.left-p.left,right:C-p.left,top:N}}for(var g,f=0;f<v.length;++f)if(g=v[f]){var k=g.top,L=g.topRight;g.top=d[k],g.bottom=d[k+1],null!=L&&(g.topRight=d[L],g.bottomRight=d[L+1])}return v}function z(e,t){var n=!1;if(t.markedSpans)for(var r=0;r<t.markedSpans;++r){var i=t.markedSpans[r];!i.collapsed||null!=i.to&&i.to!=t.text.length||(n=!0)}var s=!n&&I(e,t);if(s)return F(e,t,t.text.length,s.measure,"right").right;var o=er(e,t),u=o.appendChild(fi(e.display.measure));return ii(e.display.measure,o),oi(u).right-oi(e.display.lineDiv).left}function W(e){e.display.measureLineCache.length=e.display.measureLineCachePos=0,e.display.cachedCharWidth=e.display.cachedTextHeight=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function X(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function V(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function $(e,t,n,r){if(t.widgets)for(var i=0;i<t.widgets.length;++i)if(t.widgets[i].above){var s=Wn(t.widgets[i]);n.top+=s,n.bottom+=s}if("line"==r)return n;r||(r="local");var o=gr(e,t);if("local"==r?o+=H(e.display):o-=e.display.viewOffset,"page"==r||"window"==r){var u=oi(e.display.lineSpace);o+=u.top+("window"==r?0:V());var a=u.left+("window"==r?0:X());n.left+=a,n.right+=a}return n.top+=o,n.bottom+=o,n}function J(e,t,n){if("div"==n)return t;var r=t.left,i=t.top;if("page"==n)r-=X(),i-=V();else if("local"==n||!n){var s=oi(e.display.sizer);r+=s.left,i+=s.top}var o=oi(e.display.lineSpace);return{left:r-o.left,top:i-o.top}}function K(e,t,n,r,i){return r||(r=cr(e.doc,t.line)),$(e,r,F(e,r,t.ch,null,i),n)}function Q(e,t,n,r,i){function s(t,s){var o=F(e,r,t,i,s?"right":"left");return s?o.left=o.right:o.right=o.left,$(e,r,o,n)}function o(e,t){var n=u[t],r=n.level%2;return e==ci(n)&&t&&n.level<u[t-1].level?(n=u[--t],e=hi(n)-(n.level%2?0:1),r=!0):e==hi(n)&&t<u.length-1&&n.level<u[t+1].level&&(n=u[++t],e=ci(n)-n.level%2,r=!1),r&&e==n.to&&e>n.from?s(e-1):s(e,r)}r=r||cr(e.doc,t.line),i||(i=R(e,r));var u=yr(r),a=t.ch;if(!u)return s(a);var f=yi(u,a),l=o(a,f);return null!=Ms&&(l.other=o(a,Ms)),l}function G(e,t,n,r){var i=new zt(e,t);return i.xRel=r,n&&(i.outside=!0),i}function Y(e,t,n){var r=e.doc;if(n+=e.display.viewOffset,0>n)return G(r.first,0,!0,-1);var i=mr(r,n),s=r.first+r.size-1;if(i>s)return G(r.first+r.size-1,cr(r,s).text.length,!0,1);for(0>t&&(t=0);;){var o=cr(r,i),u=Z(e,o,i,t,n),a=jn(o),f=a&&a.find();if(!a||!(u.ch>f.from.ch||u.ch==f.from.ch&&u.xRel>0))return u;i=f.to.line}}function Z(e,t,n,r,i){function s(r){var i=Q(e,zt(n,r),"line",t,f);return u=!0,o>i.bottom?i.left-a:o<i.top?i.left+a:(u=!1,i.left)}var o=i-gr(e,t),u=!1,a=2*e.display.wrapper.clientWidth,f=R(e,t),l=yr(t),c=t.text.length,h=pi(t),p=di(t),d=s(h),v=u,m=s(p),g=u;if(r>m)return G(n,p,g,1);for(;;){if(l?p==h||p==wi(t,h,1):1>=p-h){for(var y=d>r||m-r>=r-d?h:p,b=r-(y==h?d:m);xs.test(t.text.charAt(y));)++y;var w=G(n,y,y==h?v:g,0>b?-1:b?1:0);return w}var E=Math.ceil(c/2),S=h+E;if(l){S=h;for(var x=0;E>x;++x)S=wi(t,S,1)}var T=s(S);T>r?(p=S,m=T,(g=u)&&(m+=1e3),c=E):(h=S,d=T,v=u,c-=E)}}function et(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==qi){qi=ni("pre");for(var t=0;49>t;++t)qi.appendChild(document.createTextNode("x")),qi.appendChild(ni("br"));qi.appendChild(document.createTextNode("x"))}ii(e.measure,qi);var n=qi.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),ri(e.measure),n||1}function tt(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=ni("span","x"),n=ni("pre",[t]);ii(e.measure,n);var r=t.offsetWidth;return r>2&&(e.cachedCharWidth=r),r||10}function nt(e){e.curOp={changes:[],updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,cursorActivity:!1,updateMaxLine:!1,updateScrollPos:!1,id:++$i},ys++||(gs=[])}function rt(e){var t=e.curOp,n=e.doc,r=e.display;if(e.curOp=null,t.updateMaxLine&&c(e),r.maxLineChanged&&!e.options.lineWrapping&&r.maxLine){var i=z(e,r.maxLine);r.sizer.style.minWidth=Math.max(0,i+3+bs)+"px",r.maxLineChanged=!1;var s=Math.max(0,r.sizer.offsetLeft+r.sizer.offsetWidth-r.scroller.clientWidth);s<n.scrollLeft&&!t.updateScrollPos&&St(e,Math.min(r.scroller.scrollLeft,s),!0)}var o,u;if(t.updateScrollPos)o=t.updateScrollPos;else if(t.selectionChanged&&r.scroller.clientHeight){var a=Q(e,n.sel.head);o=on(e,a.left,a.top,a.left,a.bottom)}(t.changes.length||o&&null!=o.scrollTop)&&(u=b(e,t.changes,o&&o.scrollTop),e.display.scroller.offsetHeight&&(e.doc.scrollTop=e.display.scroller.scrollTop)),!u&&t.selectionChanged&&k(e),t.updateScrollPos?(r.scroller.scrollTop=r.scrollbarV.scrollTop=n.scrollTop=o.scrollTop,r.scroller.scrollLeft=r.scrollbarH.scrollLeft=n.scrollLeft=o.scrollLeft,v(e),t.scrollToPos&&rn(e,Jt(e.doc,t.scrollToPos),t.scrollToPosMargin)):o&&nn(e),t.selectionChanged&&O(e),e.state.focused&&t.updateInput&&ct(e,t.userSelChange);var f=t.maybeHiddenMarkers,l=t.maybeUnhiddenMarkers;if(f)for(var h=0;h<f.length;++h)f[h].lines.length||Ir(f[h],"hide");if(l)for(var h=0;h<l.length;++h)l[h].lines.length&&Ir(l[h],"unhide");var p;if(--ys||(p=gs,gs=null),t.textChanged&&Ir(e,"change",e,t.textChanged),t.cursorActivity&&Ir(e,"cursorActivity",e),p)for(var h=0;h<p.length;++h)p[h]()}function it(e,t){return function(){var n=e||this,r=!n.curOp;r&&nt(n);try{var i=t.apply(n,arguments)}finally{r&&rt(n)}return i}}function st(e){return function(){var t,n=this.cm&&!this.cm.curOp;n&&nt(this.cm);try{t=e.apply(this,arguments)}finally{n&&rt(this.cm)}return t}}function ot(e,t){var n,r=!e.curOp;r&&nt(e);try{n=t()}finally{r&&rt(e)}return n}function ut(e,t,n,r){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),e.curOp.changes.push({from:t,to:n,diff:r})}function at(e){e.display.pollingFast||e.display.poll.set(e.options.pollInterval,function(){lt(e),e.state.focused&&at(e)})}function ft(e){function t(){var r=lt(e);r||n?(e.display.pollingFast=!1,at(e)):(n=!0,e.display.poll.set(60,t))}var n=!1;e.display.pollingFast=!0,e.display.poll.set(20,t)}function lt(e){var t=e.display.input,n=e.display.prevInput,r=e.doc,i=r.sel;if(!e.state.focused||Ls(t)||pt(e)||e.state.disableInput)return!1;var s=t.value;if(s==n&&Wt(i.from,i.to))return!1;if(xi&&!Ni&&e.display.inputHasSelection===s)return ct(e,!0),!1;var o=!e.curOp;o&&nt(e),i.shift=!1;for(var u=0,a=Math.min(n.length,s.length);a>u&&n.charCodeAt(u)==s.charCodeAt(u);)++u;var f=i.from,l=i.to;u<n.length?f=zt(f.line,f.ch-(n.length-u)):e.state.overwrite&&Wt(f,l)&&!e.state.pasteIncoming&&(l=zt(l.line,Math.min(cr(r,l.line).text.length,l.ch+(s.length-u))));var c=e.curOp.updateInput,h={from:f,to:l,text:ks(s.slice(u)),origin:e.state.pasteIncoming?"paste":"+input"};return Bt(e.doc,h,"end"),e.curOp.updateInput=c,qr(e,"inputRead",e,h),s.length>1e3||s.indexOf("\n")>-1?t.value=e.display.prevInput="":e.display.prevInput=s,o&&rt(e),e.state.pasteIncoming=!1,!0}function ct(e,t){var n,r,i=e.doc;if(Wt(i.sel.from,i.sel.to))t&&(e.display.prevInput=e.display.input.value="",xi&&!Ni&&(e.display.inputHasSelection=null));else{e.display.prevInput="",n=As&&(i.sel.to.line-i.sel.from.line>100||(r=e.getSelection()).length>1e3);var s=n?"-":r||e.getSelection();e.display.input.value=s,e.state.focused&&Jr(e.display.input),xi&&!Ni&&(e.display.inputHasSelection=s)}e.display.inaccurateSelection=n}function ht(e){"nocursor"==e.options.readOnly||Bi&&document.activeElement==e.display.input||e.display.input.focus()}function pt(e){return e.options.readOnly||e.doc.cantEdit}function dt(e){function t(){e.state.focused&&setTimeout(Zr(ht,e),0)}function n(){null==u&&(u=setTimeout(function(){u=null,o.cachedCharWidth=o.cachedTextHeight=Ns=null,W(e),ot(e,Zr(ut,e))},100))}function r(){for(var e=o.wrapper.parentNode;e&&e!=document.body;e=e.parentNode);e?setTimeout(r,5e3):Fr(window,"resize",n)}function i(t){Rr(e,t)||e.options.onDragEvent&&e.options.onDragEvent(e,Or(t))||Pr(t)}function s(){o.inaccurateSelection&&(o.prevInput="",o.inaccurateSelection=!1,o.input.value=e.getSelection(),Jr(o.input))}var o=e.display;jr(o.scroller,"mousedown",it(e,gt)),xi?jr(o.scroller,"dblclick",it(e,function(t){if(!Rr(e,t)){var n=mt(e,t);if(n&&!yt(e,t)&&!vt(e.display,t)){Mr(t);var r=pn(cr(e.doc,n.line).text,n);Gt(e.doc,r.from,r.to)}}})):jr(o.scroller,"dblclick",function(t){Rr(e,t)||Mr(t)}),jr(o.lineSpace,"selectstart",function(e){vt(o,e)||Mr(e)}),Wi||jr(o.scroller,"contextmenu",function(t){_t(e,t)}),jr(o.scroller,"scroll",function(){o.scroller.clientHeight&&(Et(e,o.scroller.scrollTop),St(e,o.scroller.scrollLeft,!0),Ir(e,"scroll",e))}),jr(o.scrollbarV,"scroll",function(){o.scroller.clientHeight&&Et(e,o.scrollbarV.scrollTop)}),jr(o.scrollbarH,"scroll",function(){o.scroller.clientHeight&&St(e,o.scrollbarH.scrollLeft)}),jr(o.scroller,"mousewheel",function(t){xt(e,t)}),jr(o.scroller,"DOMMouseScroll",function(t){xt(e,t)}),jr(o.scrollbarH,"mousedown",t),jr(o.scrollbarV,"mousedown",t),jr(o.wrapper,"scroll",function(){o.wrapper.scrollTop=o.wrapper.scrollLeft=0});var u;jr(window,"resize",n),setTimeout(r,5e3),jr(o.input,"keyup",it(e,function(t){Rr(e,t)||e.options.onKeyEvent&&e.options.onKeyEvent(e,Or(t))||16==t.keyCode&&(e.doc.sel.shift=!1)})),jr(o.input,"input",Zr(ft,e)),jr(o.input,"keydown",it(e,Lt)),jr(o.input,"keypress",it(e,At)),jr(o.input,"focus",Zr(Ot,e)),jr(o.input,"blur",Zr(Mt,e)),e.options.dragDrop&&(jr(o.scroller,"dragstart",function(t){wt(e,t)}),jr(o.scroller,"dragenter",i),jr(o.scroller,"dragover",i),jr(o.scroller,"drop",it(e,bt))),jr(o.scroller,"paste",function(t){vt(o,t)||(ht(e),ft(e))}),jr(o.input,"paste",function(){e.state.pasteIncoming=!0,ft(e)}),jr(o.input,"cut",s),jr(o.input,"copy",s),Mi&&jr(o.sizer,"mouseup",function(){document.activeElement==o.input&&o.input.blur(),ht(e)})}function vt(e,t){for(var n=Hr(t);n!=e.wrapper;n=n.parentNode)if(!n||n.ignoreEvents||n.parentNode==e.sizer&&n!=e.mover)return!0}function mt(e,t,n){var r=e.display;if(!n){var i=Hr(t);if(i==r.scrollbarH||i==r.scrollbarH.firstChild||i==r.scrollbarV||i==r.scrollbarV.firstChild||i==r.scrollbarFiller||i==r.gutterFiller)return null}var s,o,u=oi(r.lineSpace);try{s=t.clientX,o=t.clientY}catch(t){return null}return Y(e,s-u.left,o-u.top)}function gt(e){function t(e){if(!Wt(g,e)){if(g=e,"single"==l)return Gt(i.doc,Jt(o,a),e),void 0;if(v=Jt(o,v),m=Jt(o,m),"double"==l){var t=pn(cr(o,e.line).text,e);Xt(e,v)?Gt(i.doc,t.from,m):Gt(i.doc,v,t.to)}else"triple"==l&&(Xt(e,v)?Gt(i.doc,m,Jt(o,zt(e.line,0))):Gt(i.doc,v,Jt(o,zt(e.line+1,0))))}}function n(e){var r=++b,u=mt(i,e,!0);if(u)if(Wt(u,h)){var a=e.clientY<y.top?-20:e.clientY>y.bottom?20:0;a&&setTimeout(it(i,function(){b==r&&(s.scroller.scrollTop+=a,n(e))}),50)}else{i.state.focused||Ot(i),h=u,t(u);var f=d(s,o);(u.line>=f.to||u.line<f.from)&&setTimeout(it(i,function(){b==r&&n(e)}),150)}}function r(e){b=1/0,Mr(e),ht(i),Fr(document,"mousemove",w),Fr(document,"mouseup",E)}if(!Rr(this,e)){var i=this,s=i.display,o=i.doc,u=o.sel;if(u.shift=e.shiftKey,vt(s,e))return Ci||(s.scroller.draggable=!1,setTimeout(function(){s.scroller.draggable=!0},100)),void 0;if(!yt(i,e)){var a=mt(i,e);switch(Br(e)){case 3:return Wi&&_t.call(i,i,e),void 0;case 2:return a&&Gt(i.doc,a),setTimeout(Zr(ht,i),20),Mr(e),void 0}if(!a)return Hr(e)==s.scroller&&Mr(e),void 0;i.state.focused||Ot(i);var f=+(new Date),l="single";if(Ui&&Ui.time>f-400&&Wt(Ui.pos,a))l="triple",Mr(e),setTimeout(Zr(ht,i),20),dn(i,a.line);else if(Ri&&Ri.time>f-400&&Wt(Ri.pos,a)){l="double",Ui={time:f,pos:a},Mr(e);var c=pn(cr(o,a.line).text,a);Gt(i.doc,c.from,c.to)}else Ri={time:f,pos:a};var h=a;if(i.options.dragDrop&&Ts&&!pt(i)&&!Wt(u.from,u.to)&&!Xt(a,u.from)&&!Xt(u.to,a)&&"single"==l){var p=it(i,function(t){Ci&&(s.scroller.draggable=!1),i.state.draggingText=!1,Fr(document,"mouseup",p),Fr(s.scroller,"drop",p),Math.abs(e.clientX-t.clientX)+Math.abs(e.clientY-t.clientY)<10&&(Mr(t),Gt(i.doc,a),ht(i))});return Ci&&(s.scroller.draggable=!0),i.state.draggingText=p,s.scroller.dragDrop&&s.scroller.dragDrop(),jr(document,"mouseup",p),jr(s.scroller,"drop",p),void 0}Mr(e),"single"==l&&Gt(i.doc,Jt(o,a));var v=u.from,m=u.to,g=a,y=oi(s.wrapper),b=0,w=it(i,function(e){xi||Br(e)?n(e):r(e)}),E=it(i,r);jr(document,"mousemove",w),jr(document,"mouseup",E)}}}function yt(e,t){var n=e.display;try{var r=t.clientX,i=t.clientY}catch(t){return!1}if(r>=Math.floor(oi(n.gutters).right))return!1;if(Mr(t),!zr(e,"gutterClick"))return!0;var s=oi(n.lineDiv);if(i>s.bottom)return!0;i-=s.top-n.viewOffset;for(var o=0;o<e.options.gutters.length;++o){var u=n.gutters.childNodes[o];if(u&&oi(u).right>=r){var a=mr(e.doc,i),f=e.options.gutters[o];qr(e,"gutterClick",e,a,f,t);break}}return!0}function bt(e){var t=this;if(!(Rr(t,e)||vt(t.display,e)||t.options.onDragEvent&&t.options.onDragEvent(t,Or(e)))){Mr(e),xi&&(Ji=+(new Date));var n=mt(t,e,!0),r=e.dataTransfer.files;if(n&&!pt(t))if(r&&r.length&&window.FileReader&&window.File)for(var i=r.length,s=Array(i),o=0,u=function(e,r){var u=new FileReader;u.onload=function(){s[r]=u.result,++o==i&&(n=Jt(t.doc,n),Bt(t.doc,{from:n,to:n,text:ks(s.join("\n")),origin:"paste"},"around"))},u.readAsText(e)},a=0;i>a;++a)u(r[a],a);else{if(t.state.draggingText&&!Xt(n,t.doc.sel.from)&&!Xt(t.doc.sel.to,n))return t.state.draggingText(e),setTimeout(Zr(ht,t),20),void 0;try{var s=e.dataTransfer.getData("Text");if(s){var f=t.doc.sel.from,l=t.doc.sel.to;Zt(t.doc,n,n),t.state.draggingText&&Ut(t.doc,"",f,l,"paste"),t.replaceSelection(s,null,"paste"),ht(t),Ot(t)}}catch(e){}}}}function wt(e,t){if(xi&&(!e.state.draggingText||+(new Date)-Ji<100))return Pr(t),void 0;if(!Rr(e,t)&&!vt(e.display,t)){var n=e.getSelection();if(t.dataTransfer.setData("Text",n),t.dataTransfer.setDragImage&&!Oi){var r=ni("img",null,null,"position: fixed; left: 0; top: 0;");Ai&&(r.width=r.height=1,e.display.wrapper.appendChild(r),r._top=r.offsetTop),t.dataTransfer.setDragImage(r,0,0),Ai&&r.parentNode.removeChild(r)}}}function Et(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,Si||b(e,[],t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbarV.scrollTop!=t&&(e.display.scrollbarV.scrollTop=t),Si&&b(e,[]),M(e,100))}function St(e,t,n){(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,v(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbarH.scrollLeft!=t&&(e.display.scrollbarH.scrollLeft=t))}function xt(e,t){var n=t.wheelDeltaX,r=t.wheelDeltaY;null==n&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(n=t.detail),null==r&&t.detail&&t.axis==t.VERTICAL_AXIS?r=t.detail:null==r&&(r=t.wheelDelta);var i=e.display,s=i.scroller;if(n&&s.scrollWidth>s.clientWidth||r&&s.scrollHeight>s.clientHeight){if(r&&ji&&Ci)for(var o=t.target;o!=s;o=o.parentNode)if(o.lineObj){e.display.currentWheelTarget=o;break}if(n&&!Si&&!Ai&&null!=Qi)return r&&Et(e,Math.max(0,Math.min(s.scrollTop+r*Qi,s.scrollHeight-s.clientHeight))),St(e,Math.max(0,Math.min(s.scrollLeft+n*Qi,s.scrollWidth-s.clientWidth))),Mr(t),i.wheelStartX=null,void 0;if(r&&null!=Qi){var u=r*Qi,a=e.doc.scrollTop,f=a+i.wrapper.clientHeight;0>u?a=Math.max(0,a+u-50):f=Math.min(e.doc.height,f+u+50),b(e,[],{top:a,bottom:f})}20>Ki&&(null==i.wheelStartX?(i.wheelStartX=s.scrollLeft,i.wheelStartY=s.scrollTop,i.wheelDX=n,i.wheelDY=r,setTimeout(function(){if(null!=i.wheelStartX){var e=s.scrollLeft-i.wheelStartX,t=s.scrollTop-i.wheelStartY,n=t&&i.wheelDY&&t/i.wheelDY||e&&i.wheelDX&&e/i.wheelDX;i.wheelStartX=i.wheelStartY=null,n&&(Qi=(Qi*Ki+n)/(Ki+1),++Ki)}},200)):(i.wheelDX+=n,i.wheelDY+=r))}}function Tt(e,t,n){if("string"==typeof t&&(t=as[t],!t))return!1;e.display.pollingFast&&lt(e)&&(e.display.pollingFast=!1);var r=e.doc,i=r.sel.shift,s=!1;try{pt(e)&&(e.state.suppressEdits=!0),n&&(r.sel.shift=!1),s=t(e)!=ws}finally{r.sel.shift=i,e.state.suppressEdits=!1}return s}function Nt(e){var t=e.state.keyMaps.slice(0);return e.options.extraKeys&&t.push(e.options.extraKeys),t.push(e.options.keyMap),t}function Ct(e,t){var n=yn(e.options.keyMap),r=n.auto;clearTimeout(Gi),r&&!wn(t)&&(Gi=setTimeout(function(){yn(e.options.keyMap)==n&&(e.options.keyMap=r.call?r.call(null,e):r,o(e))},50));var i=En(t,!0),s=!1;if(!i)return!1;var u=Nt(e);return s=t.shiftKey?bn("Shift-"+i,u,function(t){return Tt(e,t,!0)})||bn(i,u,function(t){return("string"==typeof t?/^go[A-Z]/.test(t):t.motion)?Tt(e,t):void 0}):bn(i,u,function(t){return Tt(e,t)}),s&&(Mr(t),O(e),Ni&&(t.oldKeyCode=t.keyCode,t.keyCode=0),qr(e,"keyHandled",e,i,t)),s}function kt(e,t,n){var r=bn("'"+n+"'",Nt(e),function(t){return Tt(e,t,!0)});return r&&(Mr(t),O(e),qr(e,"keyHandled",e,"'"+n+"'",t)),r}function Lt(e){var t=this;if(t.state.focused||Ot(t),xi&&27==e.keyCode&&(e.returnValue=!1),!(Rr(t,e)||t.options.onKeyEvent&&t.options.onKeyEvent(t,Or(e)))){var n=e.keyCode;t.doc.sel.shift=16==n||e.shiftKey;var r=Ct(t,e);Ai&&(Zi=r?n:null,!r&&88==n&&!As&&(ji?e.metaKey:e.ctrlKey)&&t.replaceSelection(""))}}function At(e){var t=this;if(!(Rr(t,e)||t.options.onKeyEvent&&t.options.onKeyEvent(t,Or(e)))){var n=e.keyCode,r=e.charCode;if(Ai&&n==Zi)return Zi=null,Mr(e),void 0;if(!(Ai&&(!e.which||e.which<10)||Mi)||!Ct(t,e)){var i=String.fromCharCode(null==r?n:r);this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!pt(this)&&this.doc.mode.electricChars.indexOf(i)>-1&&setTimeout(it(t,function(){fn(t,t.doc.sel.to.line,"smart")}),75),kt(t,e,i)||(xi&&!Ni&&(t.display.inputHasSelection=null),ft(t))}}}function Ot(e){"nocursor"!=e.options.readOnly&&(e.state.focused||(Ir(e,"focus",e),e.state.focused=!0,-1==e.display.wrapper.className.search(/\bCodeMirror-focused\b/)&&(e.display.wrapper.className+=" CodeMirror-focused"),ct(e,!0)),at(e),O(e))}function Mt(e){e.state.focused&&(Ir(e,"blur",e),e.state.focused=!1,e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-focused","")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.doc.sel.shift=!1)},150)}function _t(e,t){function n(){if(null!=i.input.selectionStart){var e=i.input.value=" "+(Wt(s.from,s.to)?"":i.input.value);i.prevInput=" ",i.input.selectionStart=1,i.input.selectionEnd=e.length}}function r(){if(i.inputDiv.style.position="relative",i.input.style.cssText=a,Ni&&(i.scrollbarV.scrollTop=i.scroller.scrollTop=u),at(e),null!=i.input.selectionStart){(!xi||Ni)&&n(),clearTimeout(Yi);var t=0,r=function(){" "==i.prevInput&&0==i.input.selectionStart?it(e,as.selectAll)(e):t++<10?Yi=setTimeout(r,500):ct(e)};Yi=setTimeout(r,200)}}var i=e.display,s=e.doc.sel;if(!vt(i,t)){var o=mt(e,t),u=i.scroller.scrollTop;if(o&&!Ai){(Wt(s.from,s.to)||Xt(o,s.from)||!Xt(o,s.to))&&it(e,Zt)(e.doc,o,o);var a=i.input.style.cssText;if(i.inputDiv.style.position="absolute",i.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(t.clientY-5)+"px; left: "+(t.clientX-5)+"px; z-index: 1000; background: white; outline: none;"+"border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);",ht(e),ct(e,!0),Wt(s.from,s.to)&&(i.input.value=i.prevInput=" "),xi&&!Ni&&n(),Wi){Pr(t);var f=function(){Fr(window,"mouseup",f),setTimeout(r,20)};jr(window,"mouseup",f)}else setTimeout(r,50)}}}function Dt(e,t,n){if(!Xt(t.from,n))return Jt(e,n);var r=t.text.length-1-(t.to.line-t.from.line);if(n.line>t.to.line+r){var i=n.line-r,s=e.first+e.size-1;return i>s?zt(s,cr(e,s).text.length):Kt(n,cr(e,i).text.length)}if(n.line==t.to.line+r)return Kt(n,$r(t.text).length+(1==t.text.length?t.from.ch:0)+cr(e,t.to.line).text.length-t.to.ch);var o=n.line-t.from.line;return Kt(n,t.text[o].length+(o?0:t.from.ch))}function Pt(e,t,n){if(n&&"object"==typeof n)return{anchor:Dt(e,t,n.anchor),head:Dt(e,t,n.head)};if("start"==n)return{anchor:t.from,head:t.from};var r=es(t);if("around"==n)return{anchor:t.from,head:r};if("end"==n)return{anchor:r,head:r};var i=function(e){if(Xt(e,t.from))return e;if(!Xt(t.to,e))return r;var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=r.ch-t.to.ch),zt(n,i)};return{anchor:i(e.sel.anchor),head:i(e.sel.head)}}function Ht(e,t,n){var r={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return n&&(r.update=function(t,n,r,i){t&&(this.from=Jt(e,t)),n&&(this.to=Jt(e,n)),r&&(this.text=r),void 0!==i&&(this.origin=i)}),Ir(e,"beforeChange",e,r),e.cm&&Ir(e.cm,"beforeChange",e.cm,r),r.canceled?null:{from:r.from,to:r.to,text:r.text,origin:r.origin}}function Bt(e,t,n,r){if(e.cm){if(!e.cm.curOp)return it(e.cm,Bt)(e,t,n,r);if(e.cm.state.suppressEdits)return}if(!(zr(e,"beforeChange")||e.cm&&zr(e.cm,"beforeChange"))||(t=Ht(e,t,!0))){var i=Xi&&!r&&Pn(e,t.from,t.to);if(i){for(var s=i.length-1;s>=1;--s)jt(e,{from:i[s].from,to:i[s].to,text:[""]});i.length&&jt(e,{from:i[0].from,to:i[0].to,text:t.text},n)}else jt(e,t,n)}}function jt(e,t,n){var r=Pt(e,t,n);Sr(e,t,r,e.cm?e.cm.curOp.id:0/0),qt(e,t,r,_n(e,t));var i=[];fr(e,function(e,n){n||-1!=Kr(i,e.history)||(Lr(e.history,t),i.push(e.history)),qt(e,t,null,_n(e,t))})}function Ft(e,t){if(!e.cm||!e.cm.state.suppressEdits){var n=e.history,r=("undo"==t?n.done:n.undone).pop();if(r){var i={changes:[],anchorBefore:r.anchorAfter,headBefore:r.headAfter,anchorAfter:r.anchorBefore,headAfter:r.headBefore,generation:n.generation};("undo"==t?n.undone:n.done).push(i),n.generation=r.generation||++n.maxGeneration;for(var s=zr(e,"beforeChange")||e.cm&&zr(e.cm,"beforeChange"),o=r.changes.length-1;o>=0;--o){var u=r.changes[o];if(u.origin=t,s&&!Ht(e,u,!1))return("undo"==t?n.done:n.undone).length=0,void 0;i.changes.push(Er(e,u));var a=o?Pt(e,u,null):{anchor:r.anchorBefore,head:r.headBefore};qt(e,u,a,Dn(e,u));var f=[];fr(e,function(e,t){t||-1!=Kr(f,e.history)||(Lr(e.history,u),f.push(e.history)),qt(e,u,null,Dn(e,u))})}}}}function It(e,t){function n(e){return zt(e.line+t,e.ch)}e.first+=t,e.cm&&ut(e.cm,e.first,e.first,t),e.sel.head=n(e.sel.head),e.sel.anchor=n(e.sel.anchor),e.sel.from=n(e.sel.from),e.sel.to=n(e.sel.to)}function qt(e,t,n,r){if(e.cm&&!e.cm.curOp)return it(e.cm,qt)(e,t,n,r);if(t.to.line<e.first)return It(e,t.text.length-1-(t.to.line-t.from.line)),void 0;if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);It(e,i),t={from:zt(e.first,0),to:zt(t.to.line+i,t.to.ch),text:[$r(t.text)],origin:t.origin}}var s=e.lastLine();t.to.line>s&&(t={from:t.from,to:zt(s,cr(e,s).text.length),text:[t.text[0]],origin:t.origin}),t.removed=hr(e,t.from,t.to),n||(n=Pt(e,t,null)),e.cm?Rt(e.cm,t,r,n):or(e,t,r,n)}}function Rt(e,t,n,r){var s=e.doc,o=e.display,u=t.from,a=t.to,f=!1,c=u.line;e.options.lineWrapping||(c=vr(Fn(s,cr(s,u.line))),s.iter(c,a.line+1,function(e){return e==o.maxLine?(f=!0,!0):void 0})),Xt(s.sel.head,t.from)||Xt(t.to,s.sel.head)||(e.curOp.cursorActivity=!0),or(s,t,n,r,i(e)),e.options.lineWrapping||(s.iter(c,u.line+t.text.length,function(e){var t=l(s,e);t>o.maxLineLength&&(o.maxLine=e,o.maxLineLength=t,o.maxLineChanged=!0,f=!1)}),f&&(e.curOp.updateMaxLine=!0)),s.frontier=Math.min(s.frontier,u.line),M(e,400);var h=t.text.length-(a.line-u.line)-1;if(ut(e,u.line,a.line+1,h),zr(e,"change")){var p={from:u,to:a,text:t.text,removed:t.removed,origin:t.origin};if(e.curOp.textChanged){for(var d=e.curOp.textChanged;d.next;d=d.next);d.next=p}else e.curOp.textChanged=p}}function Ut(e,t,n,r,i){if(r||(r=n),Xt(r,n)){var s=r;r=n,n=s}"string"==typeof t&&(t=ks(t)),Bt(e,{from:n,to:r,text:t,origin:i},null)}function zt(e,t){return this instanceof zt?(this.line=e,this.ch=t,void 0):new zt(e,t)}function Wt(e,t){return e.line==t.line&&e.ch==t.ch}function Xt(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function Vt(e){return zt(e.line,e.ch)}function $t(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function Jt(e,t){if(t.line<e.first)return zt(e.first,0);var n=e.first+e.size-1;return t.line>n?zt(n,cr(e,n).text.length):Kt(t,cr(e,t.line).text.length)}function Kt(e,t){var n=e.ch;return null==n||n>t?zt(e.line,t):0>n?zt(e.line,0):e}function Qt(e,t){return t>=e.first&&t<e.first+e.size}function Gt(e,t,n,r){if(e.sel.shift||e.sel.extend){var i=e.sel.anchor;if(n){var s=Xt(t,i);s!=Xt(n,i)?(i=t,t=n):s!=Xt(t,n)&&(t=n)}Zt(e,i,t,r)}else Zt(e,t,n||t,r);e.cm&&(e.cm.curOp.userSelChange=!0)}function Yt(e,t,n){var r={anchor:t,head:n};return Ir(e,"beforeSelectionChange",e,r),e.cm&&Ir(e.cm,"beforeSelectionChange",e.cm,r),r.anchor=Jt(e,r.anchor),r.head=Jt(e,r.head),r}function Zt(e,t,n,r,i){if(!i&&zr(e,"beforeSelectionChange")||e.cm&&zr(e.cm,"beforeSelectionChange")){var s=Yt(e,t,n);n=s.head,t=s.anchor}var o=e.sel;if(o.goalColumn=null,(i||!Wt(t,o.anchor))&&(t=tn(e,t,r,"push"!=i)),(i||!Wt(n,o.head))&&(n=tn(e,n,r,"push"!=i)),!Wt(o.anchor,t)||!Wt(o.head,n)){o.anchor=t,o.head=n;var u=Xt(n,t);o.from=u?n:t,o.to=u?t:n,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=e.cm.curOp.cursorActivity=!0),qr(e,"cursorActivity",e)}}function en(e){Zt(e.doc,e.doc.sel.from,e.doc.sel.to,null,"push")}function tn(e,t,n,r){var i=!1,s=t,o=n||1;e.cantEdit=!1;e:for(;;){var u=cr(e,s.line);if(u.markedSpans)for(var a=0;a<u.markedSpans.length;++a){var f=u.markedSpans[a],l=f.marker;if((null==f.from||(l.inclusiveLeft?f.from<=s.ch:f.from<s.ch))&&(null==f.to||(l.inclusiveRight?f.to>=s.ch:f.to>s.ch))){if(r&&(Ir(l,"beforeCursorEnter"),l.explicitlyCleared)){if(u.markedSpans){--a;continue}break}if(!l.atomic)continue;var c=l.find()[0>o?"from":"to"];if(Wt(c,s)&&(c.ch+=o,c.ch<0?c=c.line>e.first?Jt(e,zt(c.line-1)):null:c.ch>u.text.length&&(c=c.line<e.first+e.size-1?zt(c.line+1,0):null),!c)){if(i)return r?(e.cantEdit=!0,zt(e.first,0)):tn(e,t,n,!0);i=!0,c=t,o=-o}s=c;continue e}}return s}}function nn(e){var t=rn(e,e.doc.sel.head,e.options.cursorScrollMargin);if(e.state.focused){var n=e.display,r=oi(n.sizer),i=null;if(t.top+r.top<0?i=!0:t.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1),null!=i&&!Pi){var s="none"==n.cursor.style.display;s&&(n.cursor.style.display="",n.cursor.style.left=t.left+"px",n.cursor.style.top=t.top-n.viewOffset+"px"),n.cursor.scrollIntoView(i),s&&(n.cursor.style.display="none")}}}function rn(e,t,n){for(null==n&&(n=0);;){var r=!1,i=Q(e,t),s=on(e,i.left,i.top-n,i.left,i.bottom+n),o=e.doc.scrollTop,u=e.doc.scrollLeft;if(null!=s.scrollTop&&(Et(e,s.scrollTop),Math.abs(e.doc.scrollTop-o)>1&&(r=!0)),null!=s.scrollLeft&&(St(e,s.scrollLeft),Math.abs(e.doc.scrollLeft-u)>1&&(r=!0)),!r)return i}}function sn(e,t,n,r,i){var s=on(e,t,n,r,i);null!=s.scrollTop&&Et(e,s.scrollTop),null!=s.scrollLeft&&St(e,s.scrollLeft)}function on(e,t,n,r,i){var s=e.display,o=et(e.display);0>n&&(n=0);var u=s.scroller.clientHeight-bs,a=s.scroller.scrollTop,f={},l=e.doc.height+B(s),c=o>n,h=i>l-o;if(a>n)f.scrollTop=c?0:n;else if(i>a+u){var p=Math.min(n,(h?l:i)-u);p!=a&&(f.scrollTop=p)}var d=s.scroller.clientWidth-bs,v=s.scroller.scrollLeft;t+=s.gutters.offsetWidth,r+=s.gutters.offsetWidth;var m=s.gutters.offsetWidth,g=m+10>t;return v+m>t||g?(g&&(t=0),f.scrollLeft=Math.max(0,t-10-m)):r>d+v-3&&(f.scrollLeft=r+10-d),f}function un(e,t,n){e.curOp.updateScrollPos={scrollLeft:null==t?e.doc.scrollLeft:t,scrollTop:null==n?e.doc.scrollTop:n}}function an(e,t,n){var r=e.curOp.updateScrollPos||(e.curOp.updateScrollPos={scrollLeft:e.doc.scrollLeft,scrollTop:e.doc.scrollTop}),i=e.display.scroller;r.scrollTop=Math.max(0,Math.min(i.scrollHeight-i.clientHeight,r.scrollTop+n)),r.scrollLeft=Math.max(0,Math.min(i.scrollWidth-i.clientWidth,r.scrollLeft+t))}function fn(e,t,n,r){var i=e.doc;if(null==n&&(n="add"),"smart"==n)if(e.doc.mode.indent)var s=P(e,t);else n="prev";var o,u=e.options.tabSize,a=cr(i,t),f=Xr(a.text,null,u),l=a.text.match(/^\s*/)[0];if("smart"==n&&(o=e.doc.mode.indent(s,a.text.slice(l.length),a.text),o==ws)){if(!r)return;n="prev"}"prev"==n?o=t>i.first?Xr(cr(i,t-1).text,null,u):0:"add"==n?o=f+e.options.indentUnit:"subtract"==n?o=f-e.options.indentUnit:"number"==typeof n&&(o=f+n),o=Math.max(0,o);var c="",h=0;if(e.options.indentWithTabs)for(var p=Math.floor(o/u);p;--p)h+=u,c+="	";o>h&&(c+=Vr(o-h)),c!=l&&Ut(e.doc,c,zt(t,0),zt(t,l.length),"+input"),a.stateAfter=null}function ln(e,t,n){var r=t,i=t,s=e.doc;return"number"==typeof t?i=cr(s,$t(s,t)):r=vr(t),null==r?null:n(i,r)?(ut(e,r,r+1),i):null}function cn(e,t,n,r,i){function s(){var t=u+n;return t<e.first||t>=e.first+e.size?c=!1:(u=t,l=cr(e,t))}function o(e){var t=(i?wi:Ei)(l,a,n,!0);if(null==t){if(e||!s())return c=!1;a=i?(0>n?di:pi)(l):0>n?l.text.length:0}else a=t;return!0}var u=t.line,a=t.ch,f=n,l=cr(e,u),c=!0;if("char"==r)o();else if("column"==r)o(!0);else if("word"==r||"group"==r)for(var h=null,p="group"==r,d=!0;!(0>n)||o(!d);d=!1){var v=l.text.charAt(a)||"\n",m=ei(v)?"w":p?/\s/.test(v)?null:"p":null;if(h&&h!=m){0>n&&(n=1,o());break}if(m&&(h=m),n>0&&!o(!d))break}var g=tn(e,zt(u,a),f,!0);return c||(g.hitSide=!0),g}function hn(e,t,n,r){var i,s=e.doc,o=t.left;if("page"==r){var u=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);i=t.top+n*(u-(0>n?1.5:.5)*et(e.display))}else"line"==r&&(i=n>0?t.bottom+3:t.top-3);for(;;){var a=Y(e,o,i);if(!a.outside)break;if(0>n?0>=i:i>=s.height){a.hitSide=!0;break}i+=5*n}return a}function pn(e,t){var n=t.ch,r=t.ch;if(e){t.xRel<0||r==e.length?--n:++r;for(var i=e.charAt(n),s=ei(i)?ei:/\s/.test(i)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!ei(e)};n>0&&s(e.charAt(n-1));)--n;for(;r<e.length&&s(e.charAt(r));)++r}return{from:zt(t.line,n),to:zt(t.line,r)}}function dn(e,t){Gt(e.doc,zt(t,0),Jt(e.doc,zt(t+1,0)))}function vn(t,n,r,i){e.defaults[t]=n,r&&(ts[t]=i?function(e,t,n){n!=rs&&r(e,t,n)}:r)}function mn(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var n={};for(var r in t){var i=t[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n}function gn(e,t,n){return e.startState?e.startState(t,n):!0}function yn(e){return"string"==typeof e?fs[e]:e}function bn(e,t,n){function r(t){t=yn(t);var i=t[e];if(i===!1)return"stop";if(null!=i&&n(i))return!0;if(t.nofallthrough)return"stop";var s=t.fallthrough;if(null==s)return!1;if("[object Array]"!=Object.prototype.toString.call(s))return r(s);for(var o=0,u=s.length;u>o;++o){var a=r(s[o]);if(a)return a}return!1}for(var i=0;i<t.length;++i){var s=r(t[i]);if(s)return"stop"!=s}}function wn(e){var t=Os[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t}function En(e,t){if(Ai&&34==e.keyCode&&e["char"])return!1;var n=Os[e.keyCode];return null==n||e.altGraphKey?!1:(e.altKey&&(n="Alt-"+n),(zi?e.metaKey:e.ctrlKey)&&(n="Ctrl-"+n),(zi?e.ctrlKey:e.metaKey)&&(n="Cmd-"+n),!t&&e.shiftKey&&(n="Shift-"+n),n)}function Sn(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0}function xn(e,t){this.lines=[],this.type=t,this.doc=e}function Tn(e,t,n,r,i){if(r&&r.shared)return Cn(e,t,n,r,i);if(e.cm&&!e.cm.curOp)return it(e.cm,Tn)(e,t,n,r,i);var s=new xn(e,i);if("range"==i&&!Xt(t,n))return s;r&&Gr(r,s),s.replacedWith&&(s.collapsed=!0,s.replacedWith=ni("span",[s.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||(s.replacedWith.ignoreEvents=!0)),s.collapsed&&(Vi=!0),s.addToHistory&&Sr(e,{from:t,to:n,origin:"markText"},{head:e.sel.head,anchor:e.sel.anchor},0/0);var o,u,a,f=t.line,l=0,c=e.cm;if(e.iter(f,n.line+1,function(r){c&&s.collapsed&&!c.options.lineWrapping&&Fn(e,r)==c.display.maxLine&&(a=!0);var i={from:null,to:null,marker:s};l+=r.text.length,f==t.line&&(i.from=t.ch,l-=t.ch),f==n.line&&(i.to=n.ch,l-=r.text.length-n.ch),s.collapsed&&(f==n.line&&(u=Hn(r,n.ch)),f==t.line?o=Hn(r,t.ch):dr(r,0)),An(r,i),++f}),s.collapsed&&e.iter(t.line,n.line+1,function(t){In(e,t)&&dr(t,0)}),s.clearOnEnter&&jr(s,"beforeCursorEnter",function(){s.clear()}),s.readOnly&&(Xi=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),s.collapsed){if(o!=u)throw new Error("Inserting collapsed marker overlapping an existing one");s.size=l,s.atomic=!0}return c&&(a&&(c.curOp.updateMaxLine=!0),(s.className||s.startStyle||s.endStyle||s.collapsed)&&ut(c,t.line,n.line+1),s.atomic&&en(c)),s}function Nn(e,t){this.markers=e,this.primary=t;for(var n=0,r=this;n<e.length;++n)e[n].parent=this,jr(e[n],"clear",function(){r.clear()})}function Cn(e,t,n,r,i){r=Gr(r),r.shared=!1;var s=[Tn(e,t,n,r,i)],o=s[0],u=r.replacedWith;return fr(e,function(e){u&&(r.replacedWith=u.cloneNode(!0)),s.push(Tn(e,Jt(e,t),Jt(e,n),r,i));for(var a=0;a<e.linked.length;++a)if(e.linked[a].isParent)return;o=$r(s)}),new Nn(s,o)}function kn(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function Ln(e,t){for(var n,r=0;r<e.length;++r)e[r]!=t&&(n||(n=[])).push(e[r]);return n}function An(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function On(e,t,n){if(e)for(var r,i=0;i<e.length;++i){var s=e[i],o=s.marker,u=null==s.from||(o.inclusiveLeft?s.from<=t:s.from<t);if(u||"bookmark"==o.type&&s.from==t&&(!n||!s.marker.insertLeft)){var a=null==s.to||(o.inclusiveRight?s.to>=t:s.to>t);(r||(r=[])).push({from:s.from,to:a?null:s.to,marker:o})}}return r}function Mn(e,t,n){if(e)for(var r,i=0;i<e.length;++i){var s=e[i],o=s.marker,u=null==s.to||(o.inclusiveRight?s.to>=t:s.to>t);if(u||"bookmark"==o.type&&s.from==t&&(!n||s.marker.insertLeft)){var a=null==s.from||(o.inclusiveLeft?s.from<=t:s.from<t);(r||(r=[])).push({from:a?null:s.from-t,to:null==s.to?null:s.to-t,marker:o})}}return r}function _n(e,t){var n=Qt(e,t.from.line)&&cr(e,t.from.line).markedSpans,r=Qt(e,t.to.line)&&cr(e,t.to.line).markedSpans;if(!n&&!r)return null;var i=t.from.ch,s=t.to.ch,o=Wt(t.from,t.to),u=On(n,i,o),a=Mn(r,s,o),f=1==t.text.length,l=$r(t.text).length+(f?i:0);if(u)for(var c=0;c<u.length;++c){var h=u[c];if(null==h.to){var p=kn(a,h.marker);p?f&&(h.to=null==p.to?null:p.to+l):h.to=i}}if(a)for(var c=0;c<a.length;++c){var h=a[c];if(null!=h.to&&(h.to+=l),null==h.from){var p=kn(u,h.marker);p||(h.from=l,f&&(u||(u=[])).push(h))}else h.from+=l,f&&(u||(u=[])).push(h)}if(f&&u){for(var c=0;c<u.length;++c)null!=u[c].from&&u[c].from==u[c].to&&"bookmark"!=u[c].marker.type&&u.splice(c--,1);u.length||(u=null)}var d=[u];if(!f){var v,m=t.text.length-2;if(m>0&&u)for(var c=0;c<u.length;++c)null==u[c].to&&(v||(v=[])).push({from:null,to:null,marker:u[c].marker});for(var c=0;m>c;++c)d.push(v);d.push(a)}return d}function Dn(e,t){var n=Tr(e,t),r=_n(e,t);if(!n)return r;if(!r)return n;for(var i=0;i<n.length;++i){var s=n[i],o=r[i];if(s&&o)e:for(var u=0;u<o.length;++u){for(var a=o[u],f=0;f<s.length;++f)if(s[f].marker==a.marker)continue e;s.push(a)}else o&&(n[i]=o)}return n}function Pn(e,t,n){var r=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||r&&-1!=Kr(r,n)||(r||(r=[])).push(n)}}),!r)return null;for(var i=[{from:t,to:n}],s=0;s<r.length;++s)for(var o=r[s],u=o.find(),a=0;a<i.length;++a){var f=i[a];if(!Xt(f.to,u.from)&&!Xt(u.to,f.from)){var l=[a,1];(Xt(f.from,u.from)||!o.inclusiveLeft&&Wt(f.from,u.from))&&l.push({from:f.from,to:u.from}),(Xt(u.to,f.to)||!o.inclusiveRight&&Wt(f.to,u.to))&&l.push({from:u.to,to:f.to}),i.splice.apply(i,l),a+=l.length-1}}return i}function Hn(e,t){var n,r=Vi&&e.markedSpans;if(r)for(var i,s=0;s<r.length;++s)i=r[s],i.marker.collapsed&&(null==i.from||i.from<t)&&(null==i.to||i.to>t)&&(!n||n.width<i.marker.width)&&(n=i.marker);return n}function Bn(e){return Hn(e,-1)}function jn(e){return Hn(e,e.text.length+1)}function Fn(e,t){for(var n;n=Bn(t);)t=cr(e,n.find().from.line);return t}function In(e,t){var n=Vi&&t.markedSpans;if(n)for(var r,i=0;i<n.length;++i)if(r=n[i],r.marker.collapsed){if(null==r.from)return!0;if(!r.marker.replacedWith&&0==r.from&&r.marker.inclusiveLeft&&qn(e,t,r))return!0}}function qn(e,t,n){if(null==n.to){var r=n.marker.find().to,i=cr(e,r.line);return qn(e,i,kn(i.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var s,o=0;o<t.markedSpans.length;++o)if(s=t.markedSpans[o],s.marker.collapsed&&!s.marker.replacedWith&&s.from==n.to&&(s.marker.inclusiveLeft||n.marker.inclusiveRight)&&qn(e,t,s))return!0}function Rn(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function Un(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function zn(e){return function(){var t=!this.cm.curOp;t&&nt(this.cm);try{var n=e.apply(this,arguments)}finally{t&&rt(this.cm)}return n}}function Wn(e){return null!=e.height?e.height:(e.node.parentNode&&1==e.node.parentNode.nodeType||ii(e.cm.display.measure,ni("div",[e.node],null,"position: relative")),e.height=e.node.offsetHeight)}function Xn(e,t,n,r){var i=new ls(e,n,r);return i.noHScroll&&(e.display.alignWidgets=!0),ln(e,t,function(t){if((t.widgets||(t.widgets=[])).push(i),i.line=t,!In(e.doc,t)||i.showIfHidden){var n=gr(e,t)<e.display.scroller.scrollTop;dr(t,t.height+Wn(i)),n&&an(e,0,i.height)}return!0}),i}function Vn(e,t,n){var r={text:e};return Un(r,t),r.height=n?n(r):1,r}function $n(e,t,n,r){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),Rn(e),Un(e,n);var i=r?r(e):1;i!=e.height&&dr(e,i)}function Jn(e){e.parent=null,Rn(e)}function Kn(e,t,n,r,i){var s=n.flattenSpans;null==s&&(s=e.options.flattenSpans);var o,u=0,a=null,f=new Sn(t,e.options.tabSize);for(""==t&&n.blankLine&&n.blankLine(r);!f.eol();)f.pos>e.options.maxHighlightLength?(s=!1,f.pos=Math.min(t.length,f.start+5e4),o=null):o=n.token(f,r),s&&a==o||(u<f.start&&i(f.start,a),u=f.start,a=o),f.start=f.pos;u<f.pos&&i(f.pos,a)}function Qn(e,t,n){var r=[e.state.modeGen];Kn(e,t.text,e.doc.mode,n,function(e,t){r.push(e,t)});for(var i=0;i<e.state.overlays.length;++i){var s=e.state.overlays[i],o=1,u=0;Kn(e,t.text,s.mode,!0,function(e,t){for(var n=o;e>u;){var i=r[o];i>e&&r.splice(o,1,e,r[o+1],i),o+=2,u=Math.min(e,i)}if(t)if(s.opaque)r.splice(n,o-n,e,t),o=n+2;else for(;o>n;n+=2){var a=r[n+1];r[n+1]=a?a+" "+t:t}})}return r}function Gn(e,t){return t.styles&&t.styles[0]==e.state.modeGen||(t.styles=Qn(e,t,t.stateAfter=P(e,vr(t)))),t.styles}function Yn(e,t,n){var r=e.doc.mode,i=new Sn(t.text,e.options.tabSize);for(""==t.text&&r.blankLine&&r.blankLine(n);!i.eol()&&i.pos<=e.options.maxHighlightLength;)r.token(i,n),i.start=i.pos}function Zn(e){return e?cs[e]||(cs[e]="cm-"+e.replace(/ +/g," cm-")):null}function er(e,t,n){for(var r,i=t,s=!0;r=Bn(i);)i=cr(e.doc,r.find().from.line);var o={pre:ni("pre"),col:0,pos:0,display:!n,measure:null,measuredSomething:!1,cm:e};i.textClass&&(o.pre.className=i.textClass);do{i.text&&(s=!1),o.measure=i==t&&n,o.pos=0,o.addToken=o.measure?nr:tr,(xi||Ci)&&e.getOption("lineWrapping")&&(o.addToken=rr(o.addToken));var u=sr(i,o,Gn(e,i));n&&i==t&&!o.measuredSomething&&(n[0]=o.pre.appendChild(fi(e.display.measure)),o.measuredSomething=!0),u&&(i=cr(e.doc,u.to.line))}while(u);!n||o.measuredSomething||n[0]||(n[0]=o.pre.appendChild(s?ni("span"," "):fi(e.display.measure))),o.pre.firstChild||In(e.doc,t)||o.pre.appendChild(document.createTextNode(" "));var a;if(n&&xi&&(a=yr(i))){var f=a.length-1;a[f].from==a[f].to&&--f;var l=a[f],c=a[f-1];if(l.from+1==l.to&&c&&l.level<c.level){var h=n[o.pos-1];h&&h.parentNode.insertBefore(h.measureRight=fi(e.display.measure),h.nextSibling)}}return Ir(e,"renderLine",e,t,o.pre),o.pre}function tr(e,t,n,r,i){if(t){if(hs.test(t))for(var s=document.createDocumentFragment(),o=0;;){hs.lastIndex=o;var u=hs.exec(t),a=u?u.index-o:t.length-o;if(a&&(s.appendChild(document.createTextNode(t.slice(o,o+a))),e.col+=a),!u)break;if(o+=a+1,"	"==u[0]){var f=e.cm.options.tabSize,l=f-e.col%f;s.appendChild(ni("span",Vr(l),"cm-tab")),e.col+=l}else{var c=ni("span","•","cm-invalidchar");c.title="\\u"+u[0].charCodeAt(0).toString(16),s.appendChild(c),e.col+=1}}else{e.col+=t.length;var s=document.createTextNode(t)}if(n||r||i||e.measure){var h=n||"";return r&&(h+=r),i&&(h+=i),e.pre.appendChild(ni("span",[s],h))}e.pre.appendChild(s)}}function nr(e,t,n,r,i){for(var s=e.cm.options.lineWrapping,o=0;o<t.length;++o){var u=t.charAt(o),a=0==o;u>="?"&&"?">u&&o<t.length-1?(u=t.slice(o,o+2),++o):o&&s&&ui(t,o)&&e.pre.appendChild(ni("wbr"));var f=e.measure[e.pos]=tr(e,u,n,a&&r,o==t.length-1&&i);xi&&s&&" "==u&&o&&!/\s/.test(t.charAt(o-1))&&o<t.length-1&&!/\s/.test(t.charAt(o+1))&&(f.style.whiteSpace="normal"),e.pos+=u.length}t.length&&(e.measuredSomething=!0)}function rr(e){function t(e){for(var t=" ",n=0;n<e.length-2;++n)t+=n%2?" ":" ";return t+=" "}return function(n,r,i,s,o){return e(n,r.replace(/ {3,}/,t),i,s,o)}}function ir(e,t,n){n&&(e.display||(n=n.cloneNode(!0)),e.measure&&(e.measure[e.pos]=t?n:e.pre.appendChild(fi(e.cm.display.measure)),e.measuredSomething=!0),e.pre.appendChild(n)),e.pos+=t}function sr(e,t,n){var r=e.markedSpans,i=e.text,s=0;if(r)for(var o,u,a,f,l,c=i.length,h=0,p=1,d="",v=0;;){if(v==h){u=a=f="",l=null,v=1/0;for(var m=null,g=0;g<r.length;++g){var y=r[g],b=y.marker;y.from<=h&&(null==y.to||y.to>h)?(null!=y.to&&v>y.to&&(v=y.to,a=""),b.className&&(u+=" "+b.className),b.startStyle&&y.from==h&&(f+=" "+b.startStyle),b.endStyle&&y.to==v&&(a+=" "+b.endStyle),b.collapsed&&(!l||l.marker.size<b.size)&&(l=y)):y.from>h&&v>y.from&&(v=y.from),"bookmark"==b.type&&y.from==h&&b.replacedWith&&(m=b.replacedWith)}if(l&&(l.from||0)==h&&(ir(t,(null==l.to?c:l.to)-h,null!=l.from&&l.marker.replacedWith),null==l.to))return l.marker.find();m&&!l&&ir(t,0,m)}if(h>=c)break;for(var w=Math.min(c,v);;){if(d){var E=h+d.length;if(!l){var S=E>w?d.slice(0,w-h):d;t.addToken(t,S,o?o+u:u,f,h+S.length==v?a:"")}if(E>=w){d=d.slice(w-h),h=w;break}h=E,f=""}d=i.slice(s,s=n[p++]),o=Zn(n[p++])}}else for(var p=1;p<n.length;p+=2)t.addToken(t,i.slice(s,s=n[p]),Zn(n[p+1]))}function or(e,t,n,r,i){function s(e){return n?n[e]:null}function o(e,n,r){$n(e,n,r,i),qr(e,"change",e,t)}var u=t.from,a=t.to,f=t.text,l=cr(e,u.line),c=cr(e,a.line),h=$r(f),p=s(f.length-1),d=a.line-u.line;if(0==u.ch&&0==a.ch&&""==h){for(var v=0,m=f.length-1,g=[];m>v;++v)g.push(Vn(f[v],s(v),i));o(c,c.text,p),d&&e.remove(u.line,d),g.length&&e.insert(u.line,g)}else if(l==c)if(1==f.length)o(l,l.text.slice(0,u.ch)+h+l.text.slice(a.ch),p);else{for(var g=[],v=1,m=f.length-1;m>v;++v)g.push(Vn(f[v],s(v),i));g.push(Vn(h+l.text.slice(a.ch),p,i)),o(l,l.text.slice(0,u.ch)+f[0],s(0)),e.insert(u.line+1,g)}else if(1==f.length)o(l,l.text.slice(0,u.ch)+f[0]+c.text.slice(a.ch),s(0)),e.remove(u.line+1,d);else{o(l,l.text.slice(0,u.ch)+f[0],s(0)),o(c,h+c.text.slice(a.ch),p);for(var v=1,m=f.length-1,g=[];m>v;++v)g.push(Vn(f[v],s(v),i));d>1&&e.remove(u.line+1,d-1),e.insert(u.line+1,g)}qr(e,"change",e,t),Zt(e,r.anchor,r.head,null,!0)}function ur(e){this.lines=e,this.parent=null;for(var t=0,n=e.length,r=0;n>t;++t)e[t].parent=this,r+=e[t].height;this.height=r}function ar(e){this.children=e;for(var t=0,n=0,r=0,i=e.length;i>r;++r){var s=e[r];t+=s.chunkSize(),n+=s.height,s.parent=this}this.size=t,this.height=n,this.parent=null}function fr(e,t,n){function r(e,i,s){if(e.linked)for(var o=0;o<e.linked.length;++o){var u=e.linked[o];if(u.doc!=i){var a=s&&u.sharedHist;(!n||a)&&(t(u.doc,a),r(u.doc,e,a))}}}r(e,null,!0)}function lr(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,s(e),n(e),e.options.lineWrapping||c(e),e.options.mode=t.modeOption,ut(e)}function cr(e,t){for(t-=e.first;!e.lines;)for(var n=0;;++n){var r=e.children[n],i=r.chunkSize();if(i>t){e=r;break}t-=i}return e.lines[t]}function hr(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,function(e){var s=e.text;i==n.line&&(s=s.slice(0,n.ch)),i==t.line&&(s=s.slice(t.ch)),r.push(s),++i}),r}function pr(e,t,n){var r=[];return e.iter(t,n,function(e){r.push(e.text)}),r}function dr(e,t){for(var n=t-e.height,r=e;r;r=r.parent)r.height+=n}function vr(e){if(null==e.parent)return null;for(var t=e.parent,n=Kr(t.lines,e),r=t.parent;r;t=r,r=r.parent)for(var i=0;r.children[i]!=t;++i)n+=r.children[i].chunkSize();return n+t.first}function mr(e,t){var n=e.first;e:do{for(var r=0,i=e.children.length;i>r;++r){var s=e.children[r],o=s.height;if(o>t){e=s;continue e}t-=o,n+=s.chunkSize()}return n}while(!e.lines);for(var r=0,i=e.lines.length;i>r;++r){var u=e.lines[r],a=u.height;if(a>t)break;t-=a}return n+r}function gr(e,t){t=Fn(e.doc,t);for(var n=0,r=t.parent,i=0;i<r.lines.length;++i){var s=r.lines[i];if(s==t)break;n+=s.height}for(var o=r.parent;o;r=o,o=r.parent)for(var i=0;i<o.children.length;++i){var u=o.children[i];if(u==r)break;n+=u.height}return n}function yr(e){var t=e.order;return null==t&&(t=e.order=_s(e.text)),t}function br(e){return{done:[],undone:[],undoDepth:1/0,lastTime:0,lastOp:null,lastOrigin:null,generation:e||1,maxGeneration:e||1}}function wr(e,t,n,r){var i=t["spans_"+e.id],s=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,r),function(n){n.markedSpans&&((i||(i=t["spans_"+e.id]={}))[s]=n.markedSpans),++s})}function Er(e,t){var n={from:t.from,to:es(t),text:hr(e,t.from,t.to)};return wr(e,n,t.from.line,t.to.line+1),fr(e,function(e){wr(e,n,t.from.line,t.to.line+1)},!0),n}function Sr(e,t,n,r){var i=e.history;i.undone.length=0;var s=+(new Date),o=$r(i.done);if(o&&(i.lastOp==r||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&i.lastTime>s-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))){var u=$r(o.changes);Wt(t.from,t.to)&&Wt(t.from,u.to)?u.to=es(t):o.changes.push(Er(e,t)),o.anchorAfter=n.anchor,o.headAfter=n.head}else for(o={changes:[Er(e,t)],generation:i.generation,anchorBefore:e.sel.anchor,headBefore:e.sel.head,anchorAfter:n.anchor,headAfter:n.head},i.done.push(o),i.generation=++i.maxGeneration;i.done.length>i.undoDepth;)i.done.shift();i.lastTime=s,i.lastOp=r,i.lastOrigin=t.origin}function xr(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function Tr(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var r=0,i=[];r<t.text.length;++r)i.push(xr(n[r]));return i}function Nr(e,t){for(var n=0,r=[];n<e.length;++n){var i=e[n],s=i.changes,o=[];r.push({changes:o,anchorBefore:i.anchorBefore,headBefore:i.headBefore,anchorAfter:i.anchorAfter,headAfter:i.headAfter});for(var u=0;u<s.length;++u){var a,f=s[u];if(o.push({from:f.from,to:f.to,text:f.text}),t)for(var l in f)(a=l.match(/^spans_(\d+)$/))&&Kr(t,Number(a[1]))>-1&&($r(o)[l]=f[l],delete f[l])}}return r}function Cr(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function kr(e,t,n,r){for(var i=0;i<e.length;++i){for(var s=e[i],o=!0,u=0;u<s.changes.length;++u){var a=s.changes[u];if(s.copied||(a.from=Vt(a.from),a.to=Vt(a.to)),n<a.from.line)a.from.line+=r,a.to.line+=r;else if(t<=a.to.line){o=!1;break}}s.copied||(s.anchorBefore=Vt(s.anchorBefore),s.headBefore=Vt(s.headBefore),s.anchorAfter=Vt(s.anchorAfter),s.readAfter=Vt(s.headAfter),s.copied=!0),o?(Cr(s.anchorBefore),Cr(s.headBefore),Cr(s.anchorAfter),Cr(s.headAfter)):(e.splice(0,i+1),i=0)}}function Lr(e,t){var n=t.from.line,r=t.to.line,i=t.text.length-(r-n)-1;kr(e.done,n,r,i),kr(e.undone,n,r,i)}function Ar(){Pr(this)}function Or(e){return e.stop||(e.stop=Ar),e}function Mr(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function _r(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Dr(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function Pr(e){Mr(e),_r(e)}function Hr(e){return e.target||e.srcElement}function Br(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),ji&&e.ctrlKey&&1==t&&(t=3),t}function jr(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var r=e._handlers||(e._handlers={}),i=r[t]||(r[t]=[]);i.push(n)}}function Fr(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var r=e._handlers&&e._handlers[t];if(!r)return;for(var i=0;i<r.length;++i)if(r[i]==n){r.splice(i,1);break}}}function Ir(e,t){var n=e._handlers&&e._handlers[t];if(n)for(var r=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,r)}function qr(e,t){function n(e){return function(){e.apply(null,i)}}var r=e._handlers&&e._handlers[t];if(r){var i=Array.prototype.slice.call(arguments,2);gs||(++ys,gs=[],setTimeout(Ur,0));for(var s=0;s<r.length;++s)gs.push(n(r[s]))}}function Rr(e,t){return Ir(e,t.type,e,t),Dr(t)}function Ur(){--ys;var e=gs;gs=null;for(var t=0;t<e.length;++t)e[t]()}function zr(e,t){var n=e._handlers&&e._handlers[t];return n&&n.length>0}function Wr(){this.id=null}function Xr(e,t,n,r,i){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var s=r||0,o=i||0;t>s;++s)"	"==e.charAt(s)?o+=n-o%n:++o;return o}function Vr(e){for(;Es.length<=e;)Es.push($r(Es)+" ");return Es[e]}function $r(e){return e[e.length-1]}function Jr(e){if(Hi)e.selectionStart=0,e.selectionEnd=e.value.length;else try{e.select()}catch(t){}}function Kr(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;r>n;++n)if(e[n]==t)return n;return-1}function Qr(e,t){function n(){}n.prototype=e;var r=new n;return t&&Gr(t,r),r}function Gr(e,t){t||(t={});for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function Yr(e){for(var t=[],n=0;e>n;++n)t.push(void 0);return t}function Zr(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function ei(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Ss.test(e))}function ti(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function ni(e,t,n,r){var i=document.createElement(e);if(n&&(i.className=n),r&&(i.style.cssText=r),"string"==typeof t)si(i,t);else if(t)for(var s=0;s<t.length;++s)i.appendChild(t[s]);return i}function ri(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function ii(e,t){return ri(e).appendChild(t)}function si(e,t){Ni?(e.innerHTML="",e.appendChild(document.createTextNode(t))):e.textContent=t}function oi(e){return e.getBoundingClientRect()}function ui(){return!1}function ai(e){if(null!=Ns)return Ns;var t=ni("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return ii(e,t),t.offsetWidth&&(Ns=t.offsetHeight-t.clientHeight),Ns||0}function fi(e){if(null==Cs){var t=ni("span","​");ii(e,ni("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Cs=t.offsetWidth<=1&&t.offsetHeight>2&&!Ti)}return Cs?ni("span","​"):ni("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")}function li(e,t,n,r){if(!e)return r(t,n,"ltr");for(var i=0;i<e.length;++i){var s=e[i];(s.from<n&&s.to>t||t==n&&s.to==t)&&r(Math.max(s.from,t),Math.min(s.to,n),1==s.level?"rtl":"ltr")}}function ci(e){return e.level%2?e.to:e.from}function hi(e){return e.level%2?e.from:e.to}function pi(e){var t=yr(e);return t?ci(t[0]):0}function di(e){var t=yr(e);return t?hi($r(t)):e.text.length}function vi(e,t){var n=cr(e.doc,t),r=Fn(e.doc,n);r!=n&&(t=vr(r));var i=yr(r),s=i?i[0].level%2?di(r):pi(r):0;return zt(t,s)}function mi(e,t){for(var n,r;n=jn(r=cr(e.doc,t));)t=n.find().to.line;var i=yr(r),s=i?i[0].level%2?pi(r):di(r):r.text.length;return zt(t,s)}function gi(e,t,n){var r=e[0].level;return t==r?!0:n==r?!1:n>t}function yi(e,t){for(var n,r=0;r<e.length;++r){var i=e[r];if(i.from<t&&i.to>t)return Ms=null,r;if(i.from==t||i.to==t){if(null!=n)return gi(e,i.level,e[n].level)?(Ms=n,r):(Ms=r,n);n=r}}return Ms=null,n}function bi(e,t,n,r){if(!r)return t+n;do t+=n;while(t>0&&xs.test(e.text.charAt(t)));return t}function wi(e,t,n,r){var i=yr(e);if(!i)return Ei(e,t,n,r);for(var s=yi(i,t),o=i[s],u=bi(e,t,o.level%2?-n:n,r);;){if(u>o.from&&u<o.to)return u;if(u==o.from||u==o.to)return yi(i,u)==s?u:(o=i[s+=n],n>0==o.level%2?o.to:o.from);if(o=i[s+=n],!o)return null;u=n>0==o.level%2?bi(e,o.to,-1,r):bi(e,o.from,1,r)}}function Ei(e,t,n,r){var i=t+n;if(r)for(;i>0&&xs.test(e.text.charAt(i));)i+=n;return 0>i||i>e.text.length?null:i}var Si=/gecko\/\d/i.test(navigator.userAgent),xi=/MSIE \d/.test(navigator.userAgent),Ti=xi&&(null==document.documentMode||document.documentMode<8),Ni=xi&&(null==document.documentMode||document.documentMode<9),Ci=/WebKit\//.test(navigator.userAgent),ki=Ci&&/Qt\/\d+\.\d+/.test(navigator.userAgent),Li=/Chrome\//.test(navigator.userAgent),Ai=/Opera\//.test(navigator.userAgent),Oi=/Apple Computer/.test(navigator.vendor),Mi=/KHTML\//.test(navigator.userAgent),_i=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),Di=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),Pi=/PhantomJS/.test(navigator.userAgent),Hi=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),Bi=Hi||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),ji=Hi||/Mac/.test(navigator.platform),Fi=/windows/i.test(navigator.platform),Ii=Ai&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);Ii&&(Ii=Number(Ii[1]));var qi,Ri,Ui,zi=ji&&(ki||Ai&&(null==Ii||12.11>Ii)),Wi=Si||xi&&!Ni,Xi=!1,Vi=!1,$i=0,Ji=0,Ki=0,Qi=null;xi?Qi=-0.53:Si?Qi=15:Li?Qi=-0.7:Oi&&(Qi=-1/3);var Gi,Yi,Zi=null,es=e.changeEnd=function(e){return e.text?zt(e.from.line+e.text.length-1,$r(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};e.Pos=zt,e.prototype={constructor:e,focus:function(){window.focus(),ht(this),Ot(this),ft(this)},setOption:function(e,t){var n=this.options,r=n[e];(n[e]!=t||"mode"==e)&&(n[e]=t,ts.hasOwnProperty(e)&&it(this,ts[e])(this,t,r))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](e)},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(("string"==typeof e?t[n].name:t[n])==e)return t.splice(n,1),!0},addOverlay:it(null,function(t,n){var r=t.token?t:e.getMode(this.options,t);if(r.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:r,modeSpec:t,opaque:n&&n.opaque}),this.state.modeGen++,ut(this)}),removeOverlay:it(null,function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var r=t[n].modeSpec;if(r==e||"string"==typeof e&&r.name==e)return t.splice(n,1),this.state.modeGen++,ut(this),void 0}}),indentLine:it(null,function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),Qt(this.doc,e)&&fn(this,e,t,n)}),indentSelection:it(null,function(e){var t=this.doc.sel;if(Wt(t.from,t.to))return fn(this,t.from.line,e);for(var n=t.to.line-(t.to.ch?0:1),r=t.from.line;n>=r;++r)fn(this,r,e)}),getTokenAt:function(e,t){var n=this.doc;e=Jt(n,e);for(var r=P(this,e.line,t),i=this.doc.mode,s=cr(n,e.line),o=new Sn(s.text,this.options.tabSize);o.pos<e.ch&&!o.eol();){o.start=o.pos;var u=i.token(o,r)}return{start:o.start,end:o.pos,string:o.current(),className:u||null,type:u||null,state:r}},getTokenTypeAt:function(e){e=Jt(this.doc,e);for(var t=Gn(this,cr(this.doc,e.line)),n=0,r=(t.length-1)/2,i=e.ch;;){var s=n+r>>1;if((s?t[2*s-1]:0)>=i)r=s;else{if(!(t[2*s+1]<i))return t[2*s+2];n=s+1}}},getStateAfter:function(e,t){var n=this.doc;return e=$t(n,null==e?n.first+n.size-1:e),P(this,e+1,t)},cursorCoords:function(e,t){var n,r=this.doc.sel;return n=null==e?r.head:"object"==typeof e?Jt(this.doc,e):e?r.from:r.to,Q(this,n,t||"page")},charCoords:function(e,t){return K(this,Jt(this.doc,e),t||"page")},coordsChar:function(e,t){return e=J(this,e,t||"page"),Y(this,e.left,e.top)},lineAtHeight:function(e,t){return e=J(this,{top:e,left:0},t||"page").top,mr(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var n=!1,r=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>r&&(e=r,n=!0);var i=cr(this.doc,e);return $(this,cr(this.doc,e),{top:0,left:0},t||"page").top+(n?i.height:0)},defaultTextHeight:function(){return et(this.display)},defaultCharWidth:function(){return tt(this.display)},setGutterMarker:it(null,function(e,t,n){return ln(this,e,function(e){var r=e.gutterMarkers||(e.gutterMarkers={});return r[t]=n,!n&&ti(r)&&(e.gutterMarkers=null),!0})}),clearGutter:it(null,function(e){var t=this,n=t.doc,r=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,ut(t,r,r+1),ti(n.gutterMarkers)&&(n.gutterMarkers=null)),++r})}),addLineClass:it(null,function(e,t,n){return ln(this,e,function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"wrapClass";if(e[r]){if((new RegExp("(?:^|\\s)"+n+"(?:$|\\s)")).test(e[r]))return!1;e[r]+=" "+n}else e[r]=n;return!0})}),removeLineClass:it(null,function(e,t,n){return ln(this,e,function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"wrapClass",i=e[r];if(!i)return!1;if(null==n)e[r]=null;else{var s=i.match(new RegExp("(?:^|\\s+)"+n+"(?:$|\\s+)"));if(!s)return!1;var o=s.index+s[0].length;e[r]=i.slice(0,s.index)+(s.index&&o!=i.length?" ":"")+i.slice(o)||null}return!0})}),addLineWidget:it(null,function(e,t,n){return Xn(this,e,t,n)}),removeLineWidget:function(e){e.clear()},lineInfo:function(e){if("number"==typeof e){if(!Qt(this.doc,e))return null;var t=e;if(e=cr(this.doc,e),!e)return null}else{var t=vr(e);if(null==t)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(e,t,n,r,i){var s=this.display;e=Q(this,Jt(this.doc,e));var o=e.bottom,u=e.left;if(t.style.position="absolute",s.sizer.appendChild(t),"over"==r)o=e.top;else if("above"==r||"near"==r){var a=Math.max(s.wrapper.clientHeight,this.doc.height),f=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth);("above"==r||e.bottom+t.offsetHeight>a)&&e.top>t.offsetHeight?o=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=a&&(o=e.bottom),u+t.offsetWidth>f&&(u=f-t.offsetWidth)}t.style.top=o+"px",t.style.left=t.style.right="","right"==i?(u=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?u=0:"middle"==i&&(u=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=u+"px"),n&&sn(this,u,o,u+t.offsetWidth,o+t.offsetHeight)},triggerOnKeyDown:it(null,Lt),execCommand:function(e){return as[e](this)},findPosH:function(e,t,n,r){var i=1;0>t&&(i=-1,t=-t);for(var s=0,o=Jt(this.doc,e);t>s&&(o=cn(this.doc,o,i,n,r),!o.hitSide);++s);return o},moveH:it(null,function(e,t){var n,r=this.doc.sel;n=r.shift||r.extend||Wt(r.from,r.to)?cn(this.doc,r.head,e,t,this.options.rtlMoveVisually):0>e?r.from:r.to,Gt(this.doc,n,n,e)}),deleteH:it(null,function(e,t){var n=this.doc.sel;Wt(n.from,n.to)?Ut(this.doc,"",n.from,cn(this.doc,n.head,e,t,!1),"+delete"):Ut(this.doc,"",n.from,n.to,"+delete"),this.curOp.userSelChange=!0}),findPosV:function(e,t,n,r){var i=1,s=r;0>t&&(i=-1,t=-t);for(var o=0,u=Jt(this.doc,e);t>o;++o){var a=Q(this,u,"div");if(null==s?s=a.left:a.left=s,u=hn(this,a,i,n),u.hitSide)break}return u},moveV:it(null,function(e,t){var n=this.doc.sel,r=Q(this,n.head,"div");null!=n.goalColumn&&(r.left=n.goalColumn);var i=hn(this,r,e,t);"page"==t&&an(this,0,K(this,i,"div").top-r.top),Gt(this.doc,i,i,e),n.goalColumn=r.left}),toggleOverwrite:function(e){(null==e||e!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?this.display.cursor.className+=" CodeMirror-overwrite":this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite",""))},hasFocus:function(){return this.state.focused},scrollTo:it(null,function(e,t){un(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller,t=bs;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-t,width:e.scrollWidth-t,clientHeight:e.clientHeight-t,clientWidth:e.clientWidth-t}},scrollIntoView:it(null,function(e,t){"number"==typeof e&&(e=zt(e,0)),t||(t=0);var n=e;e&&null==e.line||(this.curOp.scrollToPos=e?Jt(this.doc,e):this.doc.sel.head,this.curOp.scrollToPosMargin=t,n=Q(this,this.curOp.scrollToPos));var r=on(this,n.left,n.top-t,n.right,n.bottom+t);un(this,r.scrollLeft,r.scrollTop)}),setSize:function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}null!=e&&(this.display.wrapper.style.width=n(e)),null!=t&&(this.display.wrapper.style.height=n(t)),this.refresh()},on:function(e,t){jr(this,e,t)},off:function(e,t){Fr(this,e,t)},operation:function(e){return ot(this,e)},refresh:it(null,function(){W(this),un(this,this.doc.scrollLeft,this.doc.scrollTop),ut(this)}),swapDoc:it(null,function(e){var t=this.doc;return t.cm=null,lr(this,e),W(this),ct(this,!0),un(this,e.scrollLeft,e.scrollTop),t}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};var ts=e.optionHandlers={},ns=e.defaults={},rs=e.Init={toString:function(){return"CodeMirror.Init"}};vn("value","",function(e,t){e.setValue(t)},!0),vn("mode",null,function(e,t){e.doc.modeOption=t,n(e)},!0),vn("indentUnit",2,n,!0),vn("indentWithTabs",!1),vn("smartIndent",!0),vn("tabSize",4,function(e){n(e),W(e),ut(e)},!0),vn("electricChars",!0),vn("rtlMoveVisually",!Fi),vn("theme","default",function(e){u(e),a(e)},!0),vn("keyMap","default",o),vn("extraKeys",null),vn("onKeyEvent",null),vn("onDragEvent",null),vn("lineWrapping",!1,r,!0),vn("gutters",[],function(e){h(e.options),a(e)},!0),vn("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?y(e.display)+"px":"0",e.refresh()},!0),vn("coverGutterNextToScrollbar",!1,p,!0),vn("lineNumbers",!1,function(e){h(e.options),a(e)},!0),vn("firstLineNumber",1,a,!0),vn("lineNumberFormatter",function(e){return e},a,!0),vn("showCursorWhenSelecting",!1,k,!0),vn("readOnly",!1,function(e,t){"nocursor"==t?(Mt(e),e.display.input.blur()):t||ct(e,!0)}),vn("dragDrop",!0),vn("cursorBlinkRate",530),vn("cursorScrollMargin",0),vn("cursorHeight",1),vn("workTime",100),vn("workDelay",100),vn("flattenSpans",!0),vn("pollInterval",100),vn("undoDepth",40,function(e,t){e.doc.history.undoDepth=t}),vn("historyEventDelay",500),vn("viewportMargin",10,function(e){e.refresh()},!0),vn("maxHighlightLength",1e4,function(e){n(e),e.refresh()},!0),vn("moveInputWithCursor",!0,function(e,t){t||(e.display.inputDiv.style.top=e.display.inputDiv.style.left=0)}),vn("tabindex",null,function(e,t){e.display.input.tabIndex=t||""}),vn("autofocus",null);var is=e.modes={},ss=e.mimeModes={};e.defineMode=function(t,n){if(e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2){n.dependencies=[];for(var r=2;r<arguments.length;++r)n.dependencies.push(arguments[r])}is[t]=n},e.defineMIME=function(e,t){ss[e]=t},e.resolveMode=function(t){if("string"==typeof t&&ss.hasOwnProperty(t))t=ss[t];else if(t&&"string"==typeof t.name&&ss.hasOwnProperty(t.name)){var n=ss[t.name];t=Qr(n,t),t.name=n.name}else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,n){n=e.resolveMode(n);var r=is[n.name];if(!r)return e.getMode(t,"text/plain");var i=r(t,n);if(os.hasOwnProperty(n.name)){var s=os[n.name];for(var o in s)s.hasOwnProperty(o)&&(i.hasOwnProperty(o)&&(i["_"+o]=i[o]),i[o]=s[o])}return i.name=n.name,i},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var os=e.modeExtensions={};e.extendMode=function(e,t){var n=os.hasOwnProperty(e)?os[e]:os[e]={};Gr(t,n)},e.defineExtension=function(t,n){e.prototype[t]=n},e.defineDocExtension=function(e,t){ds.prototype[e]=t},e.defineOption=vn;var us=[];e.defineInitHook=function(e){us.push(e)},e.copyState=mn,e.startState=gn,e.innerMode=function(e,t){for(;e.innerMode;){var n=e.innerMode(t);t=n.state,e=n.mode}return n||{mode:e,state:t}};var as=e.commands={selectAll:function(e){e.setSelection(zt(e.firstLine(),0),zt(e.lastLine()))},killLine:function(e){var t=e.getCursor(!0),n=e.getCursor(!1),r=!Wt(t,n);r||e.getLine(t.line).length!=t.ch?e.replaceRange("",t,r?n:zt(t.line),"+delete"):e.replaceRange("",t,zt(t.line+1,0),"+delete")},deleteLine:function(e){var t=e.getCursor().line;e.replaceRange("",zt(t,0),zt(t),"+delete")},delLineLeft:function(e){var t=e.getCursor();e.replaceRange("",zt(t.line,0),t,"+delete")},undo:function(e){e.undo()},redo:function(e){e.redo()},goDocStart:function(e){e.extendSelection(zt(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(zt(e.lastLine()))},goLineStart:function(e){e.extendSelection(vi(e,e.getCursor().line))},goLineStartSmart:function(e){var t=e.getCursor(),n=vi(e,t.line),r=e.getLineHandle(n.line),i=yr(r);if(i&&0!=i[0].level)e.extendSelection(n);else{var s=Math.max(0,r.text.search(/\S/)),o=t.line==n.line&&t.ch<=s&&t.ch;e.extendSelection(zt(n.line,o?0:s))}},goLineEnd:function(e){e.extendSelection(mi(e,e.getCursor().line))},goLineRight:function(e){var t=e.charCoords(e.getCursor(),"div").top+5;e.extendSelection(e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:t},"div"))},goLineLeft:function(e){var t=e.charCoords(e.getCursor(),"div").top+5;e.extendSelection(e.coordsChar({left:0,top:t},"div"))},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	","end","+input")},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.replaceSelection("	","end","+input")},transposeChars:function(e){var t=e.getCursor(),n=e.getLine(t.line);t.ch>0&&t.ch<n.length-1&&e.replaceRange(n.charAt(t.ch)+n.charAt(t.ch-1),zt(t.line,t.ch-1),zt(t.line,t.ch+1))},newlineAndIndent:function(e){it(e,function(){e.replaceSelection("\n","end","+input"),e.indentLine(e.getCursor().line,null,!0)})()},toggleOverwrite:function(e){e.toggleOverwrite()}},fs=e.keyMap={};fs.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},fs.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},fs.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft",fallthrough:["basic","emacsy"]},fs["default"]=ji?fs.macDefault:fs.pcDefault,fs.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},e.lookupKey=bn,e.isModifierKey=wn,e.keyName=En,e.fromTextArea=function(t,n){function r(){t.value=f.getValue()}if(n||(n={}),n.value=t.value,!n.tabindex&&t.tabindex&&(n.tabindex=t.tabindex),!n.placeholder&&t.placeholder&&(n.placeholder=t.placeholder),null==n.autofocus){var i=document.body;try{i=document.activeElement}catch(s){}n.autofocus=i==t||null!=t.getAttribute("autofocus")&&i==document.body}if(t.form&&(jr(t.form,"submit",r),!n.leaveSubmitMethodAlone)){var o=t.form,u=o.submit;try{var a=o.submit=function(){r(),o.submit=u,o.submit(),o.submit=a}}catch(s){}}t.style.display="none";var f=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},n);return f.save=r,f.getTextArea=function(){return t},f.toTextArea=function(){r(),t.parentNode.removeChild(f.getWrapperElement()),t.style.display="",t.form&&(Fr(t.form,"submit",r),"function"==typeof t.form.submit&&(t.form.submit=u))},f},Sn.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var n=t==e;else var n=t&&(e.test?e.test(t):e(t));return n?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Xr(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue},indentation:function(){return Xr(this.string,null,this.tabSize)},match:function(e,t,n){if("string"!=typeof e){var r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}var i=function(e){return n?e.toLowerCase():e},s=this.string.substr(this.pos,e.length);return i(s)==i(e)?(t!==!1&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)}},e.StringStream=Sn,e.TextMarker=xn,xn.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;t&&nt(e);for(var n=null,r=null,i=0;i<this.lines.length;++i){var s=this.lines[i],o=kn(s.markedSpans,this);null!=o.to&&(r=vr(s)),s.markedSpans=Ln(s.markedSpans,o),null!=o.from?n=vr(s):this.collapsed&&!In(this.doc,s)&&e&&dr(s,et(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var i=0;i<this.lines.length;++i){var u=Fn(e.doc,this.lines[i]),a=l(e.doc,u);a>e.display.maxLineLength&&(e.display.maxLine=u,e.display.maxLineLength=a,e.display.maxLineChanged=!0)}null!=n&&e&&ut(e,n,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&en(e)),t&&rt(e),qr(this,"clear")}},xn.prototype.find=function(){for(var e,t,n=0;n<this.lines.length;++n){var r=this.lines[n],i=kn(r.markedSpans,this);if(null!=i.from||null!=i.to){var s=vr(r);null!=i.from&&(e=zt(s,i.from)),null!=i.to&&(t=zt(s,i.to))}}return"bookmark"==this.type?e:e&&{from:e,to:t}},xn.prototype.changed=function(){var e=this.find(),t=this.doc.cm;if(e&&t){var n=cr(this.doc,e.from.line);if(q(t,n),e.from.line>=t.display.showingFrom&&e.from.line<t.display.showingTo){for(var r=t.display.lineDiv.firstChild;r;r=r.nextSibling)if(r.lineObj==n){r.offsetHeight!=n.height&&dr(n,r.offsetHeight);break}ot(t,function(){t.curOp.selectionChanged=!0})}}},xn.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=Kr(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},xn.prototype.detachLine=function(e){if(this.lines.splice(Kr(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},e.SharedTextMarker=Nn,Nn.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();qr(this,"clear")}},Nn.prototype.find=function(){return this.primary.find()};var ls=e.LineWidget=function(e,t,n){for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.cm=e,this.node=t};ls.prototype.clear=zn(function(){var e=this.line.widgets,t=vr(this.line);if(null!=t&&e){for(var n=0;n<e.length;++n)e[n]==this&&e.splice(n--,1);e.length||(this.line.widgets=null),dr(this.line,Math.max(0,this.line.height-Wn(this))),ut(this.cm,t,t+1)}}),ls.prototype.changed=zn(function(){var e=this.height;this.height=null;var t=Wn(this)-e;if(t){dr(this.line,this.line.height+t);var n=vr(this.line);ut(this.cm,n,n+1)}});var cs={},hs=/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\uFEFF]/g;ur.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,r=e+t;r>n;++n){var i=this.lines[n];this.height-=i.height,Jn(i),qr(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.splice.apply(e,[e.length,0].concat(this.lines))},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0,i=t.length;i>r;++r)t[r].parent=this},iterN:function(e,t,n){for(var r=e+t;r>e;++e)if(n(this.lines[e]))return!0}},ar.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var r=this.children[n],i=r.chunkSize();if(i>e){var s=Math.min(t,i-e),o=r.height;if(r.removeInner(e,s),this.height-=o-r.height,i==s&&(this.children.splice(n--,1),r.parent=null),0==(t-=s))break;e=0}else e-=i}if(this.size-t<25){var u=[];this.collapse(u),this.children=[new ur(u)],this.children[0].parent=this}},collapse:function(e){for(var t=0,n=this.children.length;n>t;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var r=0,i=this.children.length;i>r;++r){var s=this.children[r],o=s.chunkSize();if(o>=e){if(s.insertInner(e,t,n),s.lines&&s.lines.length>50){for(;s.lines.length>50;){var u=s.lines.splice(s.lines.length-25,25),a=new ur(u);s.height-=a.height,this.children.splice(r+1,0,a),a.parent=this}this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new ar(t);if(e.parent){e.size-=n.size,e.height-=n.height;var r=Kr(e.parent.children,e);e.parent.children.splice(r+1,0,n)}else{var i=new ar(e.children);i.parent=e,e.children=[i,n],e=i}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var r=0,i=this.children.length;i>r;++r){var s=this.children[r],o=s.chunkSize();if(o>e){var u=Math.min(t,o-e);if(s.iterN(e,u,n))return!0;if(0==(t-=u))break;e=0}else e-=o}}};var ps=0,ds=e.Doc=function(e,t,n){if(!(this instanceof ds))return new ds(e,t,n);null==n&&(n=0),ar.call(this,[new ur([Vn("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.history=br(),this.cleanGeneration=1,this.frontier=n;var r=zt(n,0);this.sel={from:r,to:r,head:r,anchor:r,shift:!1,extend:!1,goalColumn:null},this.id=++ps,this.modeOption=t,"string"==typeof e&&(e=ks(e)),or(this,{from:r,to:r,text:e},null,{head:r,anchor:r})};ds.prototype=Qr(ar.prototype,{constructor:ds,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,r=0,i=t.length;i>r;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=pr(this,this.first,this.first+this.size);return e===!1?t:t.join(e||"\n")},setValue:function(e){var t=zt(this.first,0),n=this.first+this.size-1;Bt(this,{from:t,to:zt(n,cr(this,n).text.length),text:ks(e),origin:"setValue"},{head:t,anchor:t},!0)},replaceRange:function(e,t,n,r){t=Jt(this,t),n=n?Jt(this,n):t,Ut(this,e,t,n,r)},getRange:function(e,t,n){var r=hr(this,Jt(this,e),Jt(this,t));return n===!1?r:r.join(n||"\n")},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},setLine:function(e,t){Qt(this,e)&&Ut(this,t,zt(e,0),Jt(this,zt(e)))},removeLine:function(e){e?Ut(this,"",Jt(this,zt(e-1)),Jt(this,zt(e))):Ut(this,"",zt(0,0),Jt(this,zt(1,0)))},getLineHandle:function(e){return Qt(this,e)?cr(this,e):void 0},getLineNumber:function(e){return vr(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return Jt(this,e)},getCursor:function(e){var t,n=this.sel;return t=null==e||"head"==e?n.head:"anchor"==e?n.anchor:"end"==e||e===!1?n.to:n.from,Vt(t)},somethingSelected:function(){return!Wt(this.sel.head,this.sel.anchor)},setCursor:st(function(e,t,n){var r=Jt(this,"number"==typeof e?zt(e,t||0):e);n?Gt(this,r):Zt(this,r,r)}),setSelection:st(function(e,t){Zt(this,Jt(this,e),Jt(this,t||e))}),extendSelection:st(function(e,t){Gt(this,Jt(this,e),t&&Jt(this,t))}),getSelection:function(e){return this.getRange(this.sel.from,this.sel.to,e)},replaceSelection:function(e,t,n){Bt(this,{from:this.sel.from,to:this.sel.to,text:ks(e),origin:n},t||"around")},undo:st(function(){Ft(this,"undo")}),redo:st(function(){Ft(this,"redo")}),setExtending:function(e){this.sel.extend=e},historySize:function(){var e=this.history;return{undo:e.done.length,redo:e.undone.length}},clearHistory:function(){this.history=br(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration()},changeGeneration:function(){return this.history.lastOp=this.history.lastOrigin=null,this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Nr(this.history.done),undone:Nr(this.history.undone)}},setHistory:function(e){var t=this.history=br(this.history.maxGeneration);t.done=e.done.slice(0),t.undone=e.undone.slice(0)},markText:function(e,t,n){return Tn(this,Jt(this,e),Jt(this,t),n,"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft};return e=Jt(this,e),Tn(this,e,e,n,"bookmark")},findMarksAt:function(e){e=Jt(this,e);var t=[],n=cr(this,e.line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var r=0;r<n.length;++r)null!=n[r].from&&e.push(n[r].marker)}),e},posFromIndex:function(e){var t,n=this.first;return this.iter(function(r){var i=r.text.length+1;return i>e?(t=e,!0):(e-=i,++n,void 0)}),Jt(this,zt(n,t))},indexFromPos:function(e){e=Jt(this,e);var t=e.ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new ds(pr(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:!1,goalColumn:this.sel.goalColumn},e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var r=new ds(pr(this,t,n),e.mode||this.modeOption,t);return e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],r},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var n=0;n<this.linked.length;++n){var r=this.linked[n];if(r.doc==t){this.linked.splice(n,1),t.unlinkDoc(this);break}}if(t.history==this.history){var i=[t.id];fr(t,function(e){i.push(e.id)},!0),t.history=br(),t.history.done=Nr(this.history.done,i),t.history.undone=Nr(this.history.undone,i)}},iterLinkedDocs:function(e){fr(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),ds.prototype.eachLine=ds.prototype.iter;var vs="iter insert remove copy getEditor".split(" ");for(var ms in ds.prototype)ds.prototype.hasOwnProperty(ms)&&Kr(vs,ms)<0&&(e.prototype[ms]=function(e){return function(){return e.apply(this.doc,arguments)}}(ds.prototype[ms]));e.e_stop=Pr,e.e_preventDefault=Mr,e.e_stopPropagation=_r;var gs,ys=0;e.on=jr,e.off=Fr,e.signal=Ir;var bs=30,ws=e.Pass={toString:function(){return"CodeMirror.Pass"}};Wr.prototype={set:function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)}},e.countColumn=Xr;var Es=[""],Ss=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,xs=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\uA670-\uA672\uA674-\uA67D\uA69F\udc00-\udfff]/;e.replaceGetRect=function(e){oi=e};var Ts=function(){if(Ni)return!1;var e=ni("div");return"draggable"in e||"dragDrop"in e}();Si?ui=function(e,t){return 36==e.charCodeAt(t-1)&&39==e.charCodeAt(t)}:Oi&&!/Version\/([6-9]|\d\d)\b/.test(navigator.userAgent)?ui=function(e,t){return/\-[^ \-?]|\?[^ !\'\"\),.\-\/:;\?\]\}]/.test(e.slice(t-1,t+1))}:Ci&&(ui=function(e,t){return t>1&&45==e.charCodeAt(t-1)&&/\w/.test(e.charAt(t-2))&&/[^\-?\.]/.test(e.charAt(t))?!0:/[~!#%&*)=+}\]|\"\.>,:;][({[<]|-[^\-?\.\u2010-\u201f\u2026]|\?[\w~`@#$%\^&*(_=+{[|><]|\u2026[\w~`@#$%\^&*(_=+{[><]/.test(e.slice(t-1,t+1))});var Ns,Cs,ks=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],r=e.length;r>=t;){var i=e.indexOf("\n",t);-1==i&&(i=e.length);var s=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),o=s.indexOf("\r");-1!=o?(n.push(s.slice(0,o)),t+=o+1):(n.push(s),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)};e.splitLines=ks;var Ls=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return t&&t.parentElement()==e?0!=t.compareEndPoints("StartToEnd",t):!1},As=function(){var e=ni("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),Os={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};e.keyNames=Os,function(){for(var e=0;10>e;e++)Os[e+48]=String(e);for(var e=65;90>=e;e++)Os[e]=String.fromCharCode(e);for(var e=1;12>=e;e++)Os[e+111]=Os[e+63235]="F"+e}();var Ms,_s=function(){function e(e){return 255>=e?t.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1791>=e?n.charAt(e-1536):e>=1792&&2220>=e?"r":"L"}var t="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,s=/[LRr]/,o=/[Lb1n]/,u=/[1n]/,a="L";return function(t){if(!r.test(t))return!1;for(var n,f=t.length,l=[],c=0;f>c;++c)l.push(n=e(t.charCodeAt(c)));for(var c=0,h=a;f>c;++c){var n=l[c];"m"==n?l[c]=h:h=n}for(var c=0,p=a;f>c;++c){var n=l[c];"1"==n&&"r"==p?l[c]="n":s.test(n)&&(p=n,"r"==n&&(l[c]="R"))}for(var c=1,h=l[0];f-1>c;++c){var n=l[c];"+"==n&&"1"==h&&"1"==l[c+1]?l[c]="1":","!=n||h!=l[c+1]||"1"!=h&&"n"!=h||(l[c]=h),h=n}for(var c=0;f>c;++c){var n=l[c];if(","==n)l[c]="N";else if("%"==n){for(var d=c+1;f>d&&"%"==l[d];++d);for(var v=c&&"!"==l[c-1]||f-1>d&&"1"==l[d]?"1":"N",m=c;d>m;++m)l[m]=v;c=d-1}}for(var c=0,p=a;f>c;++c){var n=l[c];"L"==p&&"1"==n?l[c]="L":s.test(n)&&(p=n)}for(var c=0;f>c;++c)if(i.test(l[c])){for(var d=c+1;f>d&&i.test(l[d]);++d);for(var g="L"==(c?l[c-1]:a),y="L"==(f-1>d?l[d]:a),v=g||y?"L":"R",m=c;d>m;++m)l[m]=v;c=d-1}for(var b,w=[],c=0;f>c;)if(o.test(l[c])){var E=c;for(++c;f>c&&o.test(l[c]);++c);w.push({from:E,to:c,level:0})}else{var S=c,x=w.length;for(++c;f>c&&"L"!=l[c];++c);for(var m=S;c>m;)if(u.test(l[m])){m>S&&w.splice(x,0,{from:S,to:m,level:1});var T=m;for(++m;c>m&&u.test(l[m]);++m);w.splice(x,0,{from:T,to:m,level:2}),S=m}else++m;c>S&&w.splice(x,0,{from:S,to:c,level:1})}return 1==w[0].level&&(b=t.match(/^\s+/))&&(w[0].from=b[0].length,w.unshift({from:0,to:b[0].length,level:0})),1==$r(w).level&&(b=t.match(/\s+$/))&&($r(w).to-=b[0].length,w.push({from:f-b[0].length,to:f,level:0})),w[0].level!=$r(w).level&&w.push({from:f,to:f,level:w[0].level}),w}}();return e.version="3.14.0",e}(),define("codemirror",function(){}),define("GEPPETTO.JSEditor",["require","jquery","codemirror"],function(e){return function(t){function s(){i.focus();var e=i.lineCount(),t=i.getTextArea().value.length;i.setSelection({line:0,ch:0},{line:e,ch:t})}var n=e("jquery"),r=!1,i=null;e("codemirror"),CodeMirror.on(window,"resize",function(){var e=document.body.getElementsByClassName("CodeMirror-fullscreen")[0];if(!e)return;e.CodeMirror.getWrapperElement().style.height=t.winHeight()+"px"}),t.JSEditor={loadEditor:function(){t.JSEditor.createJSEditor()},createJSEditor:function(){n("#javascriptCode").removeClass("javascriptCode_loading"),i=CodeMirror.fromTextArea(document.getElementById("javascriptCode"),{mode:"javascript",lineNumbers:!0,matchBrackets:!0,continueComments:"Enter",theme:"lesser-dark",autofocus:!0,extraKeys:{F11:function(e){t.JSEditor.setFullScreen(e,!t.JSEditor.isFullScreen(e))},Esc:function(e){t.JSEditor.isFullScreen(e)&&t.JSEditor.setFullScreen(e,!1)},"Ctrl-Q":"toggleComment"}}),n("#javascriptFullscreen").click(function(){cm=i,t.JSEditor.setFullScreen(cm,!t.JSEditor.isFullScreen(cm))})},loadCode:function(e){i.setValue(e),s()},getEditedSimulation:function(){return i.getValue()},setEditing:function(e){r=e},isEditing:function(){return r},isFullScreen:function(e){return/\bCodeMirror-fullscreen\b/.test(e.getWrapperElement().className)},winHeight:function(){return window.innerHeight||(document.documentElement||document.body).clientHeight},setFullScreen:function(e,n){var r=e.getWrapperElement();n?(r.className+=" CodeMirror-fullscreen",r.style.height=t.winHeight()+"px",document.documentElement.style.overflow="hidden",e.focus()):(r.className=r.className.replace(" CodeMirror-fullscreen",""),r.style.height="",document.documentElement.style.overflow="",e.focus()),e.refresh()}}}}),define("GEPPETTO.Console",["require","jquery"],function(e){var t;return function(n){function a(){var e=n.Console.availableTags();r("#commandInputArea").bind("keydown",function(e){e.keyCode===r.ui.keyCode.TAB&&r(this).data("ui-autocomplete").menu.active&&e.preventDefault()}).autocomplete({minLength:0,source:function(t,n){var i=r.map(e,function(e){if(e.toUpperCase().indexOf(t.term.toUpperCase())===0)return e});n(i)},focus:function(){return!1},open:function(e,t){var n=r(this).data("uiAutocomplete").menu.element[0].children,i=n[0],s=r("#commandInputArea"),o=s.val(),u=r(i).text(),a=n.length;if(u.toLowerCase().indexOf(o.toLowerCase())===0)if(a==1)s.val()!==u&&(s.val(u),s[0].selectionStart=o.length,s[0].selectionEnd=u.length);else if(s.val()!==""){var f=[];for(var l=0;l<a;l++)f[l]=r(n[l]).text();var c=f.slice(0).sort(),h=c[0],p=c[c.length-1],l=0;if(h!=p){while(h.charAt(l)==p.charAt(l))++l;mostCommon=h.substring(0,l)}else mostCommon=h;s.val().indexOf(mostCommon)==-1&&(s.val(mostCommon),s[0].selectionStart=o.length,s[0].selectionEnd=mostCommon.length)}}})}var r=e("jquery"),i=[],s=[],o={},u;r(document).ready(function(){u=["constructor()","initialize(options)","on(t,e,i)","once(t,e,r)","off(t,e,r)","trigger(t)","stopListening(t,e,r)","listenTo(e,r,s)","listenToOnce(e,r,s)","bind(t,e,i)","unbind(t,e,r)","$(t)","initialize()","remove()","setElement(t,i)","delegateEvents(t)","undelegateEvents()","_ensureElement()","constructor(a,c)","on(a,c,d)","off(a,c,d)","get(a)","set(a,c,d)","_set(a,c)","_setAttr(c={})","_bubbleEvent(a,c,d)","_isEventAvailable(a,c)","_setupParents(a,c)","_createCollection(a,c)","_processPendingEvents()","_transformRelatedModel(a,c)","_transformCollectionType(a,c,d)","trigger(a)","toJSON(a)","clone(a)","cleanup(a)","render()","getState(tree,state)","destroy(a)","_getAttr(a)","on(t,e,i)","once(t,e,r)","off(t,e,r)","trigger(t)","stopListening(t,e,r)","listenTo(e,r,s)","listenToOnce(e,r,s)","bind(t,e,i)","unbind(t,e,r)","initialize()","toJSON(t)","sync()","get(t)","escape(t)","has(t)","set(t,e,r)","unset(t,e)","clear(t)","hasChanged(t)","changedAttributes(t)","previous(t)","previousAttributes()","fetch(t)","save(t,e,r)","destroy(t)","url()","parse(t,e)","clone()","isNew()","isValid(t)","_validate(t,e)","keys()","values()","pairs()","invert()","pick()","omit()"],r("#consoleButton").click(function(){n.Console.toggleConsole()})}),n.Console={visible:!1,help:function(){var e=n.Console.getHelpObjectsMap(),t="";for(var r in e)t+="\n\n"+e[r];return t},toggleConsole:function(){var e=r("#console").css("display")==="none"?"true":"false";n.Console.executeCommand("G.showConsole("+e+")")},showConsole:function(e){if(e){if(!this.visible){r("#console").slideToggle(200),r("#commandInputArea").focus();var t=r("#footer").css("bottom");t!="-10px"&&r("#footer").css("bottom","-10px")}}else r("#footer").height(""),r("#console").slideToggle(200);this.visible=e},createConsole:function(){var e=r("#console");t=new n.Sandbox.View({el:e,model:new n.Sandbox.Model,resultPrefix:"  => ",tabCharacter:"	",placeholder:"// type a javascript command and hit enter (help() for info)"}),e.resizable({handles:"n",minHeight:100,autoHide:!0,maxHeight:400,resize:function(t,n){n.size.height>r("#footerHeader").height()*.75&&(r("#console").height(r("#footerHeader").height()*.75),t.preventDefault()),e.get(0).style.top="0px"}.bind(this)}),r(window).resize(function(){r("#console").height()>r("#footerHeader").height()*.75}),a(),r("#commandInputArea").focus(function(){r(".ui-menu").remove()});var i=setInterval(function(){n.MessageSocket.isReady()==1&&(n.MessageSocket.send("geppetto_version",null),clearInterval(i))},100);return t},consoleHistory:function(){return n.Console.getConsole().model.get("history")},getConsole:function(){return t==null&&n.Console.createConsole(),t},isConsoleVisible:function(){return this.visible},debugLog:function(e){n.G.isDebugOn()&&n.Console.getConsole().debugLog(e)},log:function(e){n.Console.getConsole().showMessage(e)},executeCommand:function(e){n.Console.getConsole().executeCommand(e);var t=e.substring(0,e.indexOf("(")),r=e.substring(e.indexOf("(")+1,e.lastIndexOf(")"));n.trackActivity("Console",t,r)},availableCommands:function(){if(i.length==0){var e="\n",t=n.Console.getHelpObjectsMap();for(var r in t)e+="\n"+t[r];var s=e.split("\n"),o=0;for(var u=0;u<s.length;u++){var a=s[u].trim();if(a.substring(0,2)=="--"){var f=a.substring(3,a.length);i[o]=f,o++}}}return i},addTag:function(e){s[s.length]=e},availableTags:function(){return s.length==0&&(s=s.concat(n.Console.availableCommands())),s},getObjectCommands:function(e){return n.Console.getHelpObjectsMap()[e]},getHelpObjectsMap:function(){return jQuery.isEmptyObject(o)&&(o={G:n.G.help(),Simulation:n.Simulation.help()}),o},updateTags:function(e,t){var n=["constructor()","initialize(options)"],r=s.length,i=t.__proto__;for(var o in i)if(typeof i[o]=="function"&&i.hasOwnProperty(o)){var u=i[o].toString(),a=u.match(/\(.*?\)/)[0].replace(/[()]/gi,"").replace(/\s/gi,"").split(","),f=e+"."+o+"("+a+")",l=!0;for(var c=0;c<n.length;c++)f.indexOf(n[c])!=-1&&(l=!1);l&&(s[r]=f,r++)}},updateCommands:function(e,t,o){var a=[];r.ajax({async:!1,type:"GET",url:e,dataType:"text",success:function(e){var t=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;a=e.match(t)}});var f=o+n.Resources.COMMANDS,l=i.length,c=s.length,h=t.__proto__;for(var p in h)if(typeof h[p]=="function"&&h.hasOwnProperty(p)){var d=h[p].toString(),v=d.match(/\(.*?\)/)[0].replace(/[()]/gi,"").replace(/\s/gi,"").split(","),m=o+"."+p+"("+v+")",g=!0;for(var y=0;y<u.length;y++)m.indexOf(u[y])!=-1&&(g=!1);if(g){i[l]=m,l++,s[c]=m,c++;var b="";for(var w=0;w<a.length;w++){var E=a[w].toString();if(E.indexOf(p)!=-1){var S=E.replace(/\*/g,"").split("\n");S.splice(0,1),S.splice(S.length-1,1);for(var x=0;x<S.length;x++){var T=S[x].trim();T!=""&&T.indexOf("@name")==-1&&(b+="         "+T+"\n")}}}f+="      -- "+m+"\n"+b+"\n"}}n.Console.getHelpObjectsMap()[o]=f.substring(0,f.length-2),h.__proto__!=null&&n.Console.updateCommands(e,h,o)},removeCommands:function(e){n.Console.removeAutocompleteCommands(e),delete n.Console.getHelpObjectsMap()[e]},removeAutocompleteCommands:function(e){for(var t=0;t<i.length;t++)i[t].indexOf(e+".")!==-1&&(i.splice(t,1),t--);for(var t=0;t<s.length;t++)s[t].indexOf(e+".")!==-1&&(s.splice(t,1),t--)}}}}),define("GEPPETTO.Utility",["require","jquery"],function(e){return function(t){var n=e("jquery");t.Utility={extractCommandsFromFile:function(e,r,i){var s=i+t.Resources.COMMANDS,o=[];n.ajax({async:!1,type:"GET",url:e,dataType:"text",success:function(e){var t=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;o=e.match(t)}});for(var u in r)if(typeof r[u]=="function"){var a=r[u].toString(),f=a.match(/\(.*?\)/)[0].replace(/[()]/gi,"").replace(/\s/gi,"").split(","),l=i+"."+u+"("+f+")",c="";for(var h=0;h<o.length;h++){var p=o[h].toString();if(p.indexOf(l)!=-1){var d=p.replace(/\*/g,"").split("\n");d.splice(0,1),d.splice(d.length-1,1);for(var v=0;v<d.length;v++){var m=d[v].trim();if(m!=""){m.indexOf("@name")==-1&&(c+="         "+m+"\n");if(m.indexOf("@returns")!=-1){var g=m.match(/\{.*?\}/);g!=null&&g[0]=="{String}"&&f!=""&&(l=l.replace("(",'("'),l=l.replace(")",'")'))}}}}}s+="      -- "+l+"\n"+c+"\n"}return s.substring(0,s.length-2)},formatmodeltree:function(e,n,r){var i=r;for(var s in e)if(typeof e[s]=="object"&&e[s]!=null&&s!="attributes"){var o=e[s]._metaType;if(o=="CompositeNode"){var u="   ↪";for(var a=0;a<n;a++)u=" "+u;i=i+u+s+"- ["+o+"]\n",i=t.Utility.formatmodeltree(e[s],n+1,i)}else if(o=="FunctionNode"||o=="ParameterNode"||o=="ParameterSpecificationNode"||o=="DynamicsSpecificationNode"){var u="   ↪";for(var a=0;a<n;a++)u=" "+u;i=i+u+s+"- ["+o+"]\n"}}return i},formatsimulationtree:function(e,n,r){var i=r;for(var s in e)if(typeof e[s]=="object"&&e[s]!=null&&s!="attributes"){var o=e[s]._metaType;if(e[s]instanceof Array){var u=e[s];for(var a in u)i=this.formatsimulationtree(u[a],n+1,i)}else if(o=="CompositeNode"){var f="   ↪";for(var l=0;l<n;l++)f=" "+f;i=i+f+s+"\n",i=t.Utility.formatsimulationtree(e[s],n+2,i)}else if(o=="ParameterNode"||o=="VariableNode"){var f="   ↪";for(var l=0;l<n;l++)f=" "+f;i=i+f+s+" : "+o+"\n"}}return i},formatVisualizationTree:function(e,n,r){var i=r;for(var s in e)if(typeof e[s]=="object"&&e[s]!=null&&s!="attributes"){var o=e[s]._metaType;if(e[s]instanceof Array){var u=e[s];for(var a in u)i=this.formatVisualizationTree(u[a],n+1,i)}else if(o=="CompositeNode"){var f="   ↪";for(var l=0;l<n;l++)f=" "+f;i=i+f+s+"\n",i=t.Utility.formatVisualizationTree(e[s],n+2,i)}else if(o=="SphereNode"||o=="CylinderNode"||o=="ParticleNode"){var f="   ↪";for(var l=0;l<n;l++)f=" "+f;i=i+f+s+" : "+o+"\n"}}return i},formatSelection:function(e,t,n){for(var r in e){var i=e[r];i.selected==1&&(t=t+n+i.id+"\n",n="      ↪")}return t.lastIndexOf("\n")>0&&(t=t.substring(0,t.lastIndexOf("\n"))),t.replace(/"/g,"")},formatEntitiesTree:function(e,t,n){for(var r in e){var i=e[r];t=t+n+i.id+" [Entity]\n";for(var s in i.aspects){var o=i.aspects[s],u="         ↪";t=t+u+o.id+" [Aspect]\n"}n="      ↪"}return t.lastIndexOf("\n")>0&&(t=t.substring(0,t.lastIndexOf("\n"))),t.replace(/"/g,"")},deepFind:function(e,t){var n=t.split("."),r=e,i;for(i=0;i<n.length;++i){var s=n[i].match(/[^[\]]+(?=])/g);if(s==null){if(r[n[i]]==undefined)return undefined;r=r[n[i]]}else{var o=s[0].replace(/[\[\]']+/g,""),u=n[i].replace(/ *\[[^]]*\] */g,"");if(r[u][parseInt(o)]==undefined)return undefined;r=r[u][parseInt(o)]}}return r}}}}),define("GEPPETTO.Share",["require"],function(e){return function(e){e.Share={visible:!1,facebook:function(e,t,n,r){var i="http://www.facebook.com/sharer.php?s=100";i+="&p[title]="+encodeURIComponent(t),i+="&p[summary]="+encodeURIComponent(r),i+="&p[url]="+encodeURIComponent(e),i+="&p[images][0]="+encodeURIComponent(n),this.popup(i)},twitter:function(e,t){var n="http://twitter.com/share?";n+="text="+encodeURIComponent(t),n+="&url="+encodeURIComponent(e),n+="&counturl="+encodeURIComponent(e),this.popup(n)},popup:function(e){window.open(e,"","toolbar=0,status=0,width=626, height=436")},setVisible:function(e){this.visible=e},isVisible:function(){return this.visible}}}}),define("GEPPETTO.MenuManager",["require"],function(e){return function(e){var t={};e.MenuManager={registerNewCommandProvider:function(e,n){for(var r in e)nodeType=e[r],commandsItem=[],nodeType in t&&(commandsItem=t[nodeType]),commandsItem.push(n),t[nodeType]=commandsItem},getCommandsProvidersFor:function(e){var n=[];return e in t&&(n=t[e]),n}}}}),define("websocket-handlers/GEPPETTO.MessageSocket",["require"],function(e){return function(e){function i(e,t,n){typeof n=="string"||n instanceof String||(n=JSON.stringify(n));var r={requestID:e,type:t,data:n};return JSON.stringify(r)}var t=[],n=null,r=0;e.MessageSocket={socket:null,connect:function(n){if("WebSocket"in window)e.MessageSocket.socket=new WebSocket(n);else{if(!("MozWebSocket"in window)){e.Console.debugLog(e.Resources.WEBSOCKET_NOT_SUPPORTED);return}e.MessageSocket.socket=new MozWebSocket(n)}e.MessageSocket.socket.onopen=function(){e.FE.postSocketConnection(),e.Console.debugLog(e.Resources.WEBSOCKET_OPENED),t.push(e.SimulationHandler),t.push(e.GlobalHandler)},e.MessageSocket.socket.onclose=function(){e.Console.debugLog(e.Resources.WEBSOCKET_CLOSED)},e.MessageSocket.socket.onmessage=function(e){var n=JSON.parse(e.data);for(var r=0,i=t.length;r<i;r++)t[r].onMessage(n)},e.MessageSocket.socket.onerror=function(t){var n=e.Resources.SERVER_CONNECTION_ERROR;e.FE.infoDialog(e.Resources.WEBSOCKET_CONNECTION_ERROR,n)}},send:function(t,n){var r=this.createRequestID();e.ScriptRunner.isScriptRunning()&&e.ScriptRunner.waitingForServerResponse(r),e.MessageSocket.socket.send(i(r,t,n))},isReady:function(){return e.MessageSocket.socket.readyState},close:function(){e.MessageSocket.socket.close(),t=[]},addHandler:function(e){t.push(e)},removeHandler:function(e){var n=t.indexOf(e);n>-1&&t.splice(n,1)},clearHandlers:function(){t=[]},setClientID:function(e){n=e},createRequestID:function(){return n+"-"+r++}}}}),define("websocket-handlers/GEPPETTO.GlobalHandler",["require","jquery"],function(e){return function(t){var n=e("jquery"),r={CLIENT_ID:"client_id",RELOAD_CANVAS:"reload_canvas",ERROR_LOADING_SIM:"error_loading_simulation",ERROR:"generic_error",GEPPETTO_VERSION:"geppetto_version",OBSERVER_MODE:"observer_mode_alert",READ_URL_PARAMS:"read_url_parameters",RUN_SCRIPT:"run_script",SERVER_AVAILABLE:"server_available",SERVER_UNAVAILABLE:"server_unavailable"},i={};i[r.CLIENT_ID]=function(e){t.MessageSocket.setClientID(e.clientID)},i[r.RELOAD_CANVAS]=function(){t.Console.debugLog(t.Resources.CLEAR_CANVAS);var e=t.init(t.FE.createContainer());t.FE.update(e)},i[r.ERROR_LOADING_SIM]=function(e){t.trigger("geppetto:error",e.message),t.FE.infoDialog(t.Resources.INVALID_SIMULATION_FILE,e.message)},i[r.ERROR]=function(e){var n=JSON.parse(e.message).message,r=JSON.parse(e.message).error_code,i=JSON.parse(e.message).source,s=JSON.parse(e.message).exception;t.trigger("geppetto:error",n),t.FE.errorDialog(t.Resources.ERROR,n,r,i,s)},i[r.GEPPETTO_VERSION]=function(e){var n=e.geppetto_version,r=t.Resources.GEPPETTO_VERSION_HOLDER.replace("$1",n);t.Console.log(r)},i[r.OBSERVER_MODE]=function(e){t.FE.observersAlert(t.Resources.OBSERVING_MODE,e.alertMessage,e.popoverMessage)},i[r.RUN_SCRIPT]=function(e){t.ScriptRunner.runScript(e.run_script)},i[r.SERVER_AVAILABLE]=function(e){t.FE.infoDialog(t.Resources.SERVER_AVAILABLE,e.message)},i[r.SERVER_UNAVAILABLE]=function(e){t.trigger("geppetto:error",e.message),t.FE.observersDialog(t.Resources.SERVER_UNAVAILABLE,e.message)},t.GlobalHandler={onMessage:function(e){i.hasOwnProperty(e.type)&&i[e.type](JSON.parse(e.data))}},t.GlobalHandler.MESSAGE_TYPE=r}}),define("websocket-handlers/GEPPETTO.SimulationHandler",["require"],function(e){function t(e,n){var r=null;for(var i=0;i<e.length;i++){var s=e[i].name;if(e[i].aspect!="aspect"){var o=null;typeof e[i].size!="undefined"&&(o=e[i].size);var u=o!=null?"["+o+"]":"",a="   ↪";for(var f=0;f<n;f++)a=a.replace("↪"," ")+"   ↪ ";r=a+s+u;if(typeof e[i].type.variables=="undefined"){var l=e[i].type.type;r+=":"+l}GEPPETTO.Console.log(r),typeof e[i].type.variables!="undefined"&&t(e[i].type.variables,n+1)}else r=s,GEPPETTO.Console.log(r)}}return function(e){var n=function(t){t&&(e.Simulation.time=t.value+t.unit)},r={LOAD_MODEL:"load_model",SCENE_UPDATE:"scene_update",SIMULATION_CONFIGURATION:"simulation_configuration",SIMULATION_LOADED:"simulation_loaded",SIMULATION_STARTED:"simulation_started",SIMULATION_PAUSED:"simulation_paused",SIMULATION_STOPPED:"simulation_stopped",LIST_WATCH_VARS:"list_watch_vars",LIST_FORCE_VARS:"list_force_vars",GET_WATCH_LISTS:"get_watch_lists",SIMULATOR_FULL:"simulator_full",SET_WATCH_VARS:"set_watch_vars",START_WATCH:"start_watch",STOP_WATCH:"stop_watch",CLEAR_WATCH:"clear_watch",FIRE_SIM_SCRIPTS:"fire_sim_scripts",SIMULATION_OVER:"simulation_over",GET_MODEL_TREE:"get_model_tree"},i={};i[r.LOAD_MODEL]=function(t){e.Console.debugLog(e.Resources.LOADING_MODEL);var n=JSON.parse(t.update).scene;e.RuntimeTreeFactory.createRuntimeTree(n),e.Simulation.setSimulationLoaded(),e.trigger("simulation:modelloaded"),e.populateScene(e.Simulation.runTimeTree)},i[r.SCENE_UPDATE]=function(t){var r=JSON.parse(t.update).scene;n(r.time),e.RuntimeTreeFactory.updateRuntimeTree(r),e.Simulation.status!=e.Simulation.StatusEnum.STOPPED&&e.isCanvasCreated()&&(e.isScenePopulated()?e.updateScene(e.Simulation.runTimeTree):e.populateScene(e.Simulation.runTimeTree)),e.RuntimeTreeFactory.resetSubtreesDirtyFlag(e.Simulation.runTimeTree)},i[r.SIMULATION_CONFIGURATION]=function(t){e.trigger("simulation:configloaded",t.configuration)},i[r.SIMULATION_LOADED]=function(){e.trigger("simulation:loaded")},i[r.FIRE_SIM_SCRIPTS]=function(t){var n=JSON.parse(t.get_scripts).scripts;jQuery.isEmptyObject(n)||e.ScriptRunner.fireScripts(n)},i[r.SIMULATION_STARTED]=function(t){var r=JSON.parse(t.update).scene;n(r.time),e.RuntimeTreeFactory.updateRuntimeTree(r),e.Simulation.status!=e.Simulation.StatusEnum.STOPPED&&e.isCanvasCreated()&&(e.isScenePopulated()?e.updateScene(e.Simulation.runTimeTree):e.populateScene(e.Simulation.runTimeTree)),e.RuntimeTreeFactory.resetSubtreesDirtyFlag(e.Simulation.runTimeTree),e.trigger("simulation:started")},i[r.SIMULATION_STOPPED]=function(){e.trigger("simulation:stopped")},i[r.SIMULATION_PAUSED]=function(){e.trigger("simulation:paused")},i[r.LIST_WATCH_VARS]=function(n){e.Console.debugLog(e.Resources.LISTING_WATCH_VARS),t(JSON.parse(n.list_watch_vars).variables,0)},i[r.LIST_FORCE_VARS]=function(n){e.Console.debugLog(e.Resources.LISTING_FORCE_VARS),t(JSON.parse(n.list_force_vars).variables,0)},i[r.GET_WATCH_LISTS]=function(t){e.Console.debugLog(e.Resources.LISTING_FORCE_VARS),e.Console.log(t.get_watch_lists)},i[r.SIMULATOR_FULL]=function(t){var n=JSON.parse(t.simulatorFull),r=n.simulatorName,i=n.queuePosition;e.FE.disableSimulationControls(),e.FE.fullSimulatorNotification(r,i)},i[r.SET_WATCH_VARS]=function(t){var n=JSON.parse(t.get_watch_lists)[0].variablePaths,r=e.Simulation.simulationStates.length;for(var i in n)e.Simulation.simulationStates[r]=n[i],r++},i[r.SIMULATION_OVER]=function(){e.FE.updateStopEvent()},i[r.GET_MODEL_TREE]=function(t){var n=JSON.parse(t.get_model_tree),r=n.aspectInstancePath,i=n.modelTree;e.RuntimeTreeFactory.createAspectModelTree(r,i.ModelTree)},e.SimulationHandler={onMessage:function(e){i.hasOwnProperty(e.type)&&i[e.type](JSON.parse(e.data))}},e.SimulationHandler.MESSAGE_TYPE=r}}),define("geppetto-objects/Simulation",["require"],function(e){return function(e){function n(t,n,r,i){return e.Simulation.isLoaded()?(e.MessageSocket.send(t,i),e.Console.debugLog(r),n):e.Resources.SIMULATION_NOT_LOADED_ERROR}var t=!1;e.Simulation={simulationStates:[],status:0,simulationURL:"",watchTree:null,time:null,timestep:null,listeners:[],simState:null,loading:!1,loadingTimer:null,runTimeTree:{},StatusEnum:{INIT:0,LOADED:1,STARTED:2,PAUSED:3,STOPPED:4},getTime:function(){return"Current simulation time: "+this.time},start:function(){return this.isLoaded()?(e.MessageSocket.send("start",null),this.status==this.StatusEnum.STOPPED&&e.WidgetsListener.update(e.WidgetsListener.WIDGET_EVENT_TYPE.RESET_DATA),this.status=this.StatusEnum.STARTED,e.Console.debugLog(e.Resources.MESSAGE_OUTBOUND_START),e.Resources.SIMULATION_STARTED):e.Resources.UNABLE_TO_START_SIMULATION},pause:function(){return this.status==this.StatusEnum.STARTED?(e.MessageSocket.send("pause",null),this.status=this.StatusEnum.PAUSED,e.Console.debugLog(e.Resources.MESSAGE_OUTBOUND_PAUSE),e.Resources.SIMULATION_PAUSED):e.Resources.UNABLE_TO_PAUSE_SIMULATION},stop:function(){return this.status==this.StatusEnum.PAUSED||this.status==this.StatusEnum.STARTED?(e.MessageSocket.send("stop",null),this.status=this.StatusEnum.STOPPED,e.Console.debugLog(e.Resources.MESSAGE_OUTBOUND_STOP),e.Resources.SIMULATION_STOP):this.status==this.StatusEnum.LOADED?e.Resources.SIMULATION_NOT_RUNNING:this.status==this.StatusEnum.STOPPED?e.Resources.SIMULATION_ALREADY_STOPPED:e.Resources.SIMULATION_NOT_LOADED},load:function(n){(this.status==this.StatusEnum.STARTED||this.status==this.StatusEnum.PAUSED)&&this.stop();for(var r in this.runTimeTree)e.Console.removeCommands(r);this.runTimeTree={},this.simulationURL=n,this.listeners=[];var i=e.Resources.LOADING_SIMULATION;if(n!=null&&n!=""){var s=e.init(e.FE.createContainer());e.FE.update(s),s&&(this.status==this.StatusEnum.INIT&&e.animate(),e.MessageSocket.send("init_url",n),t=!0,e.Console.debugLog(e.Resources.MESSAGE_OUTBOUND_LOAD),e.FE.SimulationReloaded())}else i=e.Resources.SIMULATION_UNSPECIFIED;return this.simulationStates=[],this.loading=!0,e.trigger("simulation:show_spinner"),i},loadFromContent:function(t){(this.status==this.StatusEnum.STARTED||this.status==this.StatusEnum.PAUSED)&&this.stop();for(var n in this.runTimeTree)e.Console.removeCommands(n);this.runTimeTree={},this.listeners=[];var r=e.init(e.FE.createContainer());return e.FE.update(r),r&&(e.Simulation.status==e.Simulation.StatusEnum.INIT&&e.animate(),e.MessageSocket.send("init_sim",t),e.Console.debugLog(e.Resources.LOADING_FROM_CONTENT),e.FE.SimulationReloaded()),this.loading=!0,e.trigger("simulation:show_spinner"),e.Resources.LOADING_SIMULATION},isLoaded:function(){return this.status!=this.StatusEnum.INIT},isStarted:function(){return this.status==this.StatusEnum.STARTED},isLoading:function(){return t},addTransferFunction:function(e,t,n){console.log(this.getWatchTree())},listWatchableVariables:function(){return this.isLoaded()?(e.MessageSocket.send("list_watch_vars",null),e.Console.debugLog(e.Resources.MESSAGE_OUTBOUND_LIST_WATCH),e.Resources.SIMULATION_VARS_LIST):e.Resources.SIMULATION_NOT_LOADED_ERROR},listForceableVariables:function(){return this.isLoaded()?(e.MessageSocket.send("list_force_vars",null),e.Console.debugLog(e.Resources.MESSAGE_OUTBOUND_LIST_FORCE),e.Resources.SIMULATION_VARS_LIST):e.Resources.SIMULATION_NOT_LOADED_ERROR},addWatchLists:function(t){return n("set_watch",e.Resources.SIMULATION_SET_WATCH,e.Resources.MESSAGE_OUTBOUND_SET_WATCH,t),e.Resources.SIMULATION_SET_WATCH},getWatchLists:function(){return n("get_watch",e.Resources.SIMULATION_GET_WATCH,e.Resources.MESSAGE_OUTBOUND_GET_WATCH,null),e.Resources.SIMULATION_GET_WATCH},startWatch:function(){return n("start_watch",e.Resources.SIMULATION_START_WATCH,e.Resources.MESSAGE_OUTBOUND_START_WATCH,null),e.Resources.SIMULATION_START_WATCH},stopWatch:function(){return n("stop_watch",e.Resources.SIMULATION_STOP_WATCH,e.Resources.MESSAGE_OUTBOUND_STOP_WATCH,null),e.Resources.SIMULATION_STOP_WATCH},clearWatchLists:function(){return n("clear_watch",e.Resources.SIMULATION_CLEAR_WATCH,e.Resources.MESSAGE_OUTBOUND_CLEAR_WATCH,null),e.Simulation.simulationStates=[],e.Resources.SIMULATION_CLEAR_WATCH},getWatchTree:function(){var t=e.Resources.WATCHED_SIMULATION_STATES+"";for(var n in e.Simulation.simulationStates)t+="\n      -- "+e.Simulation.simulationStates[n]+"\n";return this.watchTree==null?e.Resources.EMPTY_WATCH_TREE:t},selectEntity:function(t){var n=e.Resources.CANT_FIND_ENTITY;return t.select()?n=e.Resources.SELECTING_ENTITY+t.instancePath+".":n=e.Resources.ENTITY_ALREADY_SELECTED+t.instancePath+".",n},unselectEntity:function(t){var n=e.Resources.CANT_FIND_ENTITY;return t.unselect()?n=e.Resources.UNSELECTING_ENTITY+t.instancePath+".":n=e.Resources.ENTITY_NOT_SELECTED+t.instancePath+".",n},getSelection:function(){var e=new Array;for(var t in this.runTimeTree)this.runTimeTree[t].selected&&(e[e.length]=this.runTimeTree[t]);return e},help:function(){return e.Utility.extractCommandsFromFile("js/geppetto-objects/Simulation.js",e.Simulation,"Simulation")},getSimulationStatus:function(){return this.status},setSimulationLoaded:function(){this.status=e.Simulation.StatusEnum.LOADED,t=!1,this.loading=!1,this.simulationStates=[]},getEntities:function(){var t="",n="↪";return e.Utility.formatEntitiesTree(this.runTimeTree,t,n)},addBrightnessFunction:function(t,n,r){this.listeners[n.getInstancePath()]=function(n){e.lightUpEntity(t.getInstancePath(),r?r(n.value):n.value)}},clearBrightnessFunctions:function(e){this.listeners[e.getId()]=null}}}}),define("components/popups/ClipboardModal",["require","react","jquery","jsx!components/bootstrap/modal"],function(e){var t=e("react");return $=e("jquery"),t.createClass({mixins:[e("jsx!components/bootstrap/modal")],getDefaultProps:function(){return{title:"Message",text:"",buttonLabel:"Ok",onClick:function(){}}},render:function(){return t.DOM.div({className:"modal fade",id:"javascriptEditor"},t.DOM.div({className:"modal-dialog"},t.DOM.div({className:"modal-content"},t.DOM.div({className:"modal-header",id:"infomodal-header"},t.DOM.button({type:"button",className:"close","data-dismiss":"modal","aria-hidden":"true"},"×"),t.DOM.h3({id:"jsEditor-title",className:"text-center"},this.props.title)),t.DOM.div({className:"modal-body"},t.DOM.div({"class":"controls"},t.DOM.textarea({id:"javascriptCode",name:"javascriptCode",className:"javascriptCode_loading"}),t.DOM.button({id:"javascriptFullscreen",type:"button",className:"button icon-fullscreen"}))),t.DOM.div({className:"modal-footer",id:"infomodal-footer"},t.DOM.button({id:"jsEditor-btn",className:"btn btn-warning","data-dismiss":"modal","aria-hidden":"true",dangerouslySetInnerHTML:{__html:this.props.buttonLabel}})))))}})}),define("geppetto-objects/G",["require","jquery","react","jsx!components/popups/ClipboardModal"],function(e){return function(t){var n=!1,r=e("jquery"),i=e("react"),s=e("jsx!components/popups/ClipboardModal");t.G={addWidget:function(e){var n=t.WidgetFactory.addWidget(e);return n.getName()+t.Resources.WIDGET_CREATED},availableWidgets:function(){return t.Widgets},clear:function(){return t.Console.getConsole().clear(),t.Resources.CLEAR_HISTORY},copyHistoryToClipboard:function(){var e="",n=t.Console.consoleHistory();if(!n||!n.length)return t.Resources.EMPTY_CONSOLE_HISTORY;for(var o=0;o<n.length;o++){var u=n[o];if(u.command){var a=u.command.trim();a.indexOf(";")==-1&&(a+=";"),e+=a,o!=n.length-1&&(e+="\n")}}if(e){var f=t.Resources.COPY_TO_CLIPBOARD_WINDOWS;return navigator.userAgent.match(/(Mac|iPhone|iPod|iPad)/i)&&(f=t.Resources.COPY_TO_CLIPBOARD_MAC),i.renderComponent(s({show:!0,keyboard:!1,title:f}),document.getElementById("modal-region")),r("#javascriptEditor").on("shown.bs.modal",function(){r("#javascriptEditor").hasClass("in")&&(t.JSEditor.loadEditor(),t.JSEditor.loadCode(e))}),t.Resources.COPY_CONSOLE_HISTORY}return""},debug:function(e){return n=e,e?(t.showStats(),t.Resources.DEBUG_ON):(t.hideStats(),t.Resources.DEBUG_OFF)},getCurrentSimulation:function(){return t.Simulation.isLoaded()?JSON.stringify(t.Simulation):t.Resources.NO_SIMULATION_TO_GET},help:function(){return t.Utility.extractCommandsFromFile("js/geppetto-objects/G.js",t.G,"G")},removeWidget:function(e){return t.WidgetFactory.removeWidget(e)},runScript:function(e){return t.MessageSocket.send("run_script",e),t.Resources.RUNNING_SCRIPT},showConsole:function(e){var n;return e?n=t.Resources.SHOW_CONSOLE:n=t.Resources.HIDE_CONSOLE,t.Console.showConsole(e),n},showShareBar:function(e){var n;return e?(n=t.Resources.SHOW_SHAREBAR,t.Share.isVisible()?n=t.Resources.SHAREBAR_ALREADY_VISIBLE:(r("#geppetto-share").toggleClass("clicked"),r("#geppetto-share").slideToggle(),t.Share.setVisible(e))):(n=t.Resources.SHOW_SHAREBAR,t.Share.isVisible()?(r("#geppetto-share").toggleClass("clicked"),r("#geppetto-share").slideToggle(),t.Share.setVisible(e)):n=t.Resources.SHAREBAR_ALREADY_HIDDEN),n},showHelpWindow:function(e){var n;if(e)t.trigger("simulation:show_helpwindow"),n=t.Resources.SHOW_HELP_WINDOW;else{var i=r("#help-modal").hasClass("in");i?(t.trigger("simulation:hide_helpwindow"),n=t.Resources.HIDE_HELP_WINDOW,r("#help-modal").modal("hide")):n=t.Resources.HELP_ALREADY_HIDDEN}return n},shareOnTwitter:function(){var e="http://geppetto.org";return t.Simulation.isLoaded()&&(e="http://live.geppeto.org//?sim="+t.Simulation.simulationURL),t.Share.twitter(e,"Check out Geppetto, the opensource simulation platform powering OpenWorm!"),t.Resources.SHARE_ON_TWITTER},shareOnFacebook:function(){var e="http://geppetto.org";return t.Simulation.isLoaded()&&(e="http://live.geppeto.org/?sim="+t.Simulation.simulationURL),t.Share.facebook(e,"Check out Geppetto, the opensource simulation platform powering OpenWorm!","http://www.geppetto.org/images/sph9.png",""),t.Resources.SHARE_ON_FACEBOOK},showPopup:function(e,n,r){var i=t.WidgetFactory.addWidget(t.Widgets.POPUP);i.setPosition(e,n),i.setMessage(r),i.show()},wait:function(){return t.Resources.INVALID_WAIT_USE},wait:function(e,n){return setTimeout(function(){t.ScriptRunner.executeScriptCommands(e)},n),t.Resources.WAITING},isDebugOn:function(){return n},resetCamera:function(){return t.resetCamera(),t.Resources.CAMERA_RESET},incrementCameraPan:function(e,n){return t.incrementCameraPan(e,n),t.Resources.CAMERA_PAN_INCREMENT},incrementCameraRotate:function(e,n,r){return t.incrementCameraRotate(e,n,r),t.Resources.CAMERA_ROTATE_INCREMENT},incrementCameraZoom:function(e){return t.incrementCameraZoom(e),t.Resources.CAMERA_ZOOM_INCREMENT}}}}),define("GEPPETTO.Main",["require","jquery","react","jsx!components/popups/InfoModal"],function(e){return function(t){var n=e("jquery"),r=e("react"),i=e("jsx!components/popups/InfoModal");t.Main={StatusEnum:{DEFAULT:0,CONTROLLING:1,OBSERVING:2},idleTime:0,disconnected:!1,status:0,simulationFileTemplate:"resources/template.xml",getVisitorStatus:function(){return this.status},init:function(){t.MessageSocket.connect("ws://"+window.location.host+"/org.geppetto.frontend/GeppettoServlet"),t.Simulation.status=t.Simulation.StatusEnum.INIT,t.Console.debugLog(t.Resources.GEPPETTO_INITIALIZED)},idleCheck:function(){var e=2,s=4;if(!t.Main.disconnected){t.Main.idleTime=t.Main.idleTime+1,t.Main.idleTime>e&&(r.renderComponent(i({show:!0,keyboard:!1}),document.getElementById("modal-region")),n("#infomodal-title").html("Zzz"),n("#infomodal-text").html(t.Resources.IDLE_MESSAGE),n("#infomodal-btn").html("Yes"),n("#infomodal-btn").html("Yes").click(function(){n("#infomodal").modal("hide"),t.Main.idleTime=0,n("#infomodal-btn").unbind("click"),t.Simulation.isLoading()&&t.trigger("simulation:show_spinner")}));if(t.Main.idleTime>s){r.renderComponent(i({show:!0,keyboard:!1,title:"",text:t.Resources.DISCONNECT_MESSAGE}),document.getElementById("modal-region")),n("#infomodal-footer").remove(),n("#infomodal-header").remove(),t.Main.idleTime=0,t.Main.disconnected=!0,t.FE.disableSimulationControls(),t.MessageSocket.send("idle_user",null);var o=t.init(t.FE.createContainer());t.FE.update(o)}}},observe:function(){var e=t.init(t.FE.createContainer());e&&(t.animate(),t.MessageSocket.send("observe",null),t.Console.debugLog(t.Resources.SIMULATION_OBSERVED)),t.FE.update(e)}},n(document).ready(function(){var e=t.webGLAvailable();if(!e)t.FE.update(!1);else{t.FE.initialEvents(),setInterval(t.Main.idleCheck,6e4);var r=n(this);r.mousemove(function(e){t.Main.idleTime=0}),r.keypress(function(e){t.Main.idleTime=0});var e=t.init(t.FE.createContainer());t.Main.init()}})}}),define("widgets/WidgetFactory",["require"],function(e){return function(e){e.Widgets={PLOT:0,POPUP:1,SCATTER3D:2,TREEVISUALISERDAT:3,TREEVISUALISERD3:4},e.WidgetFactory={addWidget:function(t){var n=null;switch(t){case e.Widgets.PLOT:n=e.PlotsController.addPlotWidget();break;case e.Widgets.POPUP:n=e.PopupsController.addPopupWidget();break;case e.Widgets.SCATTER3D:n=e.Scatter3dController.addScatter3dWidget();break;case e.Widgets.TREEVISUALISERDAT:n=e.TreeVisualiserControllerDAT.addTreeVisualiserDATWidget();break;case e.Widgets.TREEVISUALISERD3:n=e.TreeVisualiserControllerD3.addTreeVisualiserD3Widget();break;default:}return n},removeWidget:function(t){switch(t){case e.Widgets.PLOT:return e.PlotsController.removePlotWidgets(),e.Resources.REMOVE_PLOT_WIDGETS;case e.Widgets.POPUP:return e.PlotsController.removePopupWidgets(),e.Resources.REMOVE_POPUP_WIDGETS;case e.Widgets.SCATTER3D:return e.Scatter3dController.removeScatter3dWidgets(),e.Resources.REMOVE_SCATTER3D_WIDGETS;case e.Widgets.TREEVISUALISERDAT:return e.TreeVisualiserController.removeTreeVisualiserDATWidgets(),e.Resources.REMOVE_TREEVISUALISERDAT_WIDGETS;case e.Widgets.TREEVISUALISERD3:return e.TreeVisualiserController.removeTreeVisualiserD3Widgets(),e.Resources.REMOVE_TREEVISUALISERD3_WIDGETS;default:return e.Resources.NON_EXISTENT_WIDGETS}}}}}),define("widgets/WidgetsListener",["require","jquery"],function(e){var t=e("jquery");return function(e){e.WidgetsListener={WIDGET_EVENT_TYPE:{DELETE:"delete",UPDATE:"update",RESET_DATA:"reset",SELECTION_CHANGED:"selection_changed"},_subscribers:[],subscribe:function(n,r){var i=!0;for(var s=0,o=this._subscribers.length;s<o;s++)this._subscribers[s]===n&&(i=!1);i&&(this._subscribers.push(n),e.Console.debugLog("added new observer")),t("#"+r).on("remove",function(){e.Console.removeCommands(r);var t=n.getWidgets();for(var i in t)if(t[i].getId()==this.id){t.splice(i,1);break}}),t("#"+r).on("dialogresizestop",function(t,n){var i=n.size.height,s=n.size.width;e.Console.executeCommand(r+".setSize("+i+","+s+")");var o=n.position.left,u=n.position.top;window[r].setPosition(o,u)}),t("#"+r).on("dialogdragstop",function(t,n){var i=n.position.left,s=n.position.top;e.Console.executeCommand(r+".setPosition("+i+","+s+")")}),t("#"+r).bind("dialogclose",function(t){e.Console.executeCommand(r+".destroy()")})},unsubscribe:function(t){for(var n=0,r=this._subscribers.length;n<r;n++)if(this._subscribers[n]===t)return this._subscribers.splice(n,1),e.Console.log("removed existing observer"),!0;return!1},update:function(e){for(var t=0,n=this._subscribers.length;t<n;t++)this._subscribers[t].update(e)}}}}),define("widgets/WidgetUtility",function(){}),define("widgets/ContextMenu",["require"],function(e){return function(e){var t={},n=Backbone.Model.extend({defaults:{position:"Not specified",label:"Not specified",action:"Not specified",icon:"Not specified",option:"Not specified"},initialize:function(e){typeof e.groups!="undefined"&&this.set("groups",new s(e.groups))}}),r=Backbone.Collection.extend({model:n,comparator:"position"}),i=Backbone.Model.extend({defaults:{position:"Not specified",items:new r},initialize:function(e){this.set("items",new r(e))}}),s=Backbone.Collection.extend({model:i}),o=Backbone.Model.extend({model:s,initialize:function(e){this.set("groups",new s(e.groups))}}),u=Backbone.View.extend({template:_.template($("#tplContextMenuItems").html()),events:{click:"testing"},testing:function(e){console.log("taka")},initialize:function(e){this.items=e.items},render:function(){this.$el.append(this.template(this.items.toJSON())),t[this.$el.find("li").attr("id")]={action:this.items.get("action"),option:this.items.get("option")};if(this.items.has("groups")){var e=this.$el.find("li");this.items.get("groups").each(function(t){var n=new a({model:t});e.append(n.render().el.childNodes)})}else this.$el.find("li").addClass("contextMenuLink");return this}}),a=Backbone.View.extend({initialize:function(e){this.group=e.model},render:function(){this.$el.html("<ul></ul>");var e=this.$el.find("ul");return this.group.get("items").each(function(t){var n=new u({items:t});e.append(n.render().el.childNodes)}),this}});e.ContextMenuView=Backbone.View.extend({className:"contextMenuView",template:_.template($("#tplContextMenu").html()),parentSelector:"body",events:{"click .contextMenuLink":"manageMenuClickEvent"},manageMenuClickEvent:function(t){var n=$(t.target).attr("id"),r=this.registeredItems[n];e.Console.executeCommand(r.action+"("+this.data.getInstancePath()+")",r.option)},render:function(){this.$el.html(this.template());var e=this.$el;this.model.get("groups").each(function(t){var n=new a({model:t});e.append(n.render().el.childNodes)});var t=this.top,n=t+this.$el.height()>$(this.parentSelector).height();n&&(t-=this.$el.height());var r=this.left,i=r+this.$el.width()>$(this.parentSelector).width();return i&&(r-=this.$el.width()),this.$el.show().offset({top:this.top,left:this.left}),this},initialize:function(){this,t={},this.$el.appendTo(this.parentSelector);var e=this;$(this.parentSelector).on("click",function(){e.$el.hide()})},show:function(e){if(e.top===undefined||e.left===undefined)throw"ContextMenu must be shown with top/left coordinates.";if(e.groups===undefined)throw"ContextMenu needs ContextMenuGroups to be shown.";this.top=e.top,this.left=e.left,this.model=new o({groups:e.groups}),this.registeredItems=t,this.data=e.data,this.render()}})}}),define("widgets/Widget",["require","backbone","jquery"],function(e){var t=e("backbone"),n=e("jquery");return{Model:t.Model.extend({}),View:t.View.extend({id:null,dialog:null,visible:!0,size:{height:300,width:350},position:{left:"50%",top:"50%"},initialize:function(e){this.id=e.id,this.name=e.name,this.visible=e.visible,this.contextMenu=new GEPPETTO.ContextMenuView},destroy:function(){return n("#"+this.id).remove(),this.name+" destroyed"},hide:function(){return n("#"+this.id).dialog("close"),this.visible=!1,"Hiding "+this.name+" widget"},show:function(){return n("#"+this.id).dialog("open"),this.visible=!0,n(".ui-dialog-titlebar-close").blur(),"Showing "+this.name+" widget"},getName:function(){return this.name},setName:function(e){return this.name=e,n("#"+this.id).dialog("option","title",this.name),"Widget has been renamed to "+this.name},setPosition:function(e,t){return this.position.left=e,this.position.top=t,n("#"+this.id).dialog("option","position",[this.position.left,this.position.top]),this.name+" Widget's position has been updated"},setSize:function(e,t){return this.size.height=e,this.size.width=t,n("#"+this.id).dialog({height:this.size.height,width:this.size.width}),this.name+" Widget has been resized"},getPosition:function(){return this.position},getSize:function(){return this.size},getId:function(){return this.id},isVisible:function(){return this.visible},getState:function(e,t){var n=t.split("."),r=e,i;for(i=0;i<n.length;++i){var s=n[i].match(/[^[\]]+(?=])/g);if(s==null){if(r[n[i]]==undefined)return undefined;r=r[n[i]]}else{var o=s[0].replace(/[\[\]']+/g,""),u=n[i].replace(/ *\[[^]]*\] */g,"");if(r[u][parseInt(o)]==undefined)return undefined;r=r[u][parseInt(o)]}}return r},showContextMenu:function(e,t){var n=GEPPETTO.MenuManager.getCommandsProvidersFor(t._metaType);if(n.length>0){var r=[];for(var i=0;i<n.length;i++)r=r.concat(n[i](t));this.contextMenu.show({top:e.pageY,left:e.pageX+1,groups:r,data:t})}return e!=null&&e.preventDefault(),!1},render:function(){this.dialog=n("<div id="+this.id+" class='dialog' title='"+this.name+" Widget'></div>").dialog({resizable:!0,draggable:!0,top:10,height:300,width:350,close:function(e,t){e.originalEvent&&n(e.originalEvent.target).closest(".ui-dialog-titlebar-close").length&&n("#"+this.id).remove()}}),this.$el=n("#"+this.id),n(".ui-dialog-titlebar-close").blur()}})}}),define("widgets/plot/Plot",["require","widgets/Widget","jquery"],function(e){var t=e("widgets/Widget"),n=e("jquery");return t.View.extend({plot:null,datasets:[],limit:20,options:null,xaxisLabel:null,yaxisLabel:null,labelsUpdated:!1,labelsMap:{},defaultPlotOptions:{series:{shadowSize:0},yaxis:{min:-0.1,max:1},xaxis:{min:0,max:20,show:!1},grid:{margin:{left:15,bottom:15}}},initialize:function(e){this.id=e.id,this.name=e.name,this.visible=e.visible,this.datasets=[],this.options=this.defaultPlotOptions,this.render(),this.dialog.append("<div class='plot' id='"+this.id+"'></div>"),n.widget.bridge("uitooltip",n.ui.tooltip),n(".legendLabel").tooltip()},plotData:function(e,t){t!=null&&(this.options=t,this.options.xaxis.max>this.limit&&(this.limit=this.options.xaxis.max));var r=this.labelsMap;this.options.legend={labelFormatter:function(e,t){var n=e.split("."),i=n[0]+"."+n[1]+"....."+n[n.length-1];return r[e]={label:i},'<div class="legendLabel" id="'+e+'" title="'+e+'">'+i+"</div>"}};if(e!=null)if(e instanceof Array)this.datasets.push({data:e});else{var i=e.getValue(),s=e.getInstancePath();this.datasets.push({label:s,variable:e,data:[[0,i]]})}var o=n("#"+this.id);return this.plot==null?(this.plot=n.plot(o,this.datasets,this.options),o.resize()):this.plot=n.plot(o,this.datasets,this.options),n.widget.bridge("uitooltip",n.ui.tooltip),n(".legendLabel").tooltip(),"Line plot added to widget"},plotXYData:function(e,t,r){r!=null&&(this.options=r,this.options.xaxis.max>this.limit&&(this.limit=this.options.xaxis.max));if(newDataX.name!=null&&newDataY.name!=null){for(var i in this.datasets)if(newDataX.name+"/"+newDataY.name==this.datasets[i].label)return this.name+" widget is already plotting object "+newDataX.name+"/"+newDataY.name;this.datasets.push({label:newDataX.name+"/"+newDataY.name,data:[[newDataX.value,newDataY.value]]})}else this.datasets.push({label:"",data:newDataX}),this.datasets.push({label:"",data:newDataY});var s=n("#"+this.id);return this.plot==null?(this.plot=n.plot(s,this.datasets,this.options),s.resize()):this.plot=n.plot(s,this.datasets,this.options),"Line plot added to widget"},removeDataSet:function(e){if(e!=null){for(var t=0;t<this.datasets.length;t++)e.getInstancePath()==this.datasets[t].label&&this.datasets.splice(t,1);var n=[];for(var r=0;r<this.datasets.length;r++)n.push(this.datasets[r]);this.plot.setData(n),this.plot.setupGrid(),this.plot.draw()}this.datasets.length==0&&this.resetPlot()},updateDataSet:function(){for(var e in this.datasets){var t=this.datasets[e].variable.getValue();if(!this.labelsUpdated){var n=this.datasets[e].variable.getUnit();if(n!=null){var r=n,i="";this.setAxisLabel(r,i),this.labelsUpdated=!0}}var s=this.datasets[e].data,o=!1;s.length>this.limit&&(s.splice(0,1),o=!0),s.push([s.length,t]);if(o){var u=[];for(var a=0,f=s.length;a<f;a++){var l=s[a][1];u.push([a,l])}this.datasets[e].data=u}else this.datasets[e].data=s}this.plot!=null&&(this.plot.setData(this.datasets),this.plot.draw())},plotDataFunction:function(e,t,n){},resetPlot:function(){if(this.plot!=null){this.datasets=[],this.options=this.defaultPlotOptions;var e=n("#"+this.id);this.plot=n.plot(e,this.datasets,this.options)}},setOptions:function(e){this.options=e,this.options.xaxis!=null&&this.options.xaxis.max>this.limit&&(this.limit=this.options.xaxis.max),this.plot=n.plot(n("#"+this.id),this.datasets,this.options)},setLegend:function(e,t){var r=this.labelsMap;this.options.legend={labelFormatter:function(n,i){var s;return e.getInstancePath()!=n?s=r[n].label:(s=t,r[n].label=s),'<div class="legendLabel" id="'+n+'" title="'+n+'">'+s+"</div>"}},this.plot=n.plot(n("#"+this.id),this.datasets,this.options),n.widget.bridge("uitooltip",n.ui.tooltip),n(".legendLabel").tooltip()},getDataSets:function(){return this.datasets},cleanDataSets:function(){for(var e=0;e<this.datasets.length;e++)this.datasets[e].data=[[]]},setAxisLabel:function(e,t){this.options.yaxis.axisLabel=e,this.plot=n.plot(n("#"+this.id),this.datasets,this.options)}})}),define("widgets/plot/controllers/PlotsController",["require","widgets/plot/Plot"],function(e){return function(t){var n=e("widgets/plot/Plot"),r=new Array,i=!1;t.PlotsController={registerHandler:function(e){t.WidgetsListener.subscribe(t.PlotsController,e)},getWidgets:function(){return r},addPlotWidget:function(){var e=r.length+1,i="Plot"+e,s=i,o=window[i]=new n({id:s,name:i,visible:!0});return o.help=function(){return t.Console.getObjectCommands(s)},r.push(o),this.registerHandler(s),t.Console.updateCommands("js/widgets/plot/Plot.js",o,s),o},removePlotWidgets:function(){for(var e=0;e<r.length;e++){var n=r[e];t.Console.removeCommands(n.getId()),n.destroy(),e--}r=new Array},toggle:function(){if(r.length==0)t.Console.executeCommand("G.addWidget(GEPPETTO.Widgets.PLOT)");else if(r.length>0){i=!i;for(var e in r){var n=r[e];i?n.hide():n.show()}}},update:function(e){if(e==t.WidgetsListener.WIDGET_EVENT_TYPE.DELETE)this.removePlotWidgets();else if(e==t.WidgetsListener.WIDGET_EVENT_TYPE.RESET_DATA)for(var n=0;n<r.length;n++){var i=r[n];i.cleanDataSets()}else if(e==t.WidgetsListener.WIDGET_EVENT_TYPE.UPDATE)for(var n=0;n<r.length;n++){var i=r[n];i.updateDataSet()}}}}}),require.config({paths:{flot:"widgets/plot/vendor/jquery.flot.min"},shim:{"widgets/plot/vendor/jquery.flot.resize.min":["flot"],"widgets/plot/vendor/jquery.flot.axislabels.min":["flot"]}});var libraries=[];libraries.push("flot"),libraries.push("widgets/plot/vendor/jquery.flot.resize.min"),libraries.push("widgets/plot/vendor/jquery.flot.axislabels.min"),require(libraries,function(e){loadCss("js/widgets/plot/Plot.css")}),define("widgets/plot/config",["require","widgets/plot/controllers/PlotsController"],function(e){return function(t){e("widgets/plot/controllers/PlotsController")(t)}}),define("widgets/popup/Popup",["require","widgets/Widget","jquery"],function(e){var t=e("widgets/Widget"),n=e("jquery");return t.View.extend({initialize:function(e){this.id=e.id,this.name=e.name,this.visible=e.visible,this.render(),this.setSize(100,300),n("#"+this.id).addClass("popup")},setMessage:function(e){return n("#"+this.id).html(e),"Setting new Message for "+this.id}})}),define("widgets/popup/controllers/PopupController",["require","widgets/popup/Popup"],function(e){return function(t){var n=e("widgets/popup/Popup"),r=new Array;t.PopupsController={registerHandler:function(e){t.WidgetsListener.subscribe(t.PopupsController,e)},getWidgets:function(){return r},addPopupWidget:function(){var e=r.length+1,i="Popup"+e,s=i,o=window[i]=new n({id:s,name:i,visible:!0});return o.help=function(){return t.Console.getObjectCommands(s)},r.push(o),this.registerHandler(s),t.Console.updateCommands("js/widgets/popup/Popup.js",o,s),o},removePopupWidgets:function(){for(var e=0;e<r.length;e++){var t=r[e];t.destroy()}r=new Array},update:function(e){e==t.WidgetsListener.WIDGET_EVENT_TYPE.DELETE&&this.removePopupWidgets()}}}}),define("widgets/popup/config",["require","widgets/popup/controllers/PopupController"],function(e){return function(t){e("widgets/popup/controllers/PopupController")(t),loadCss("js/widgets/popup/Popup.css")}}),define("widgets/scatter3d/Scatter3d",["require","widgets/Widget","jquery"],function(e){var t=e("widgets/Widget"),n=e("jquery");return t.View.extend({datasets:[],options:null,numberPoints:0,scene:null,renderer:null,camera:null,controls:null,axisHelper:{},scatter3dHolder:{},defaultScatter3dOptions:{axis:!0,axisColours:[{r:248,g:102,b:8},{r:177,g:255,b:86},{r:134,g:197,b:255}],grid:!1,legend:!0,clearColor:3880245,nearClipPlane:1,farClipPlane:1e4,fov:45,cameraPositionZ:10,colours:[15581760,11524344,13323083,5089101,9715949],limit:400,plotEachN:null,normalizeData:!1},initialize:function(e){this.id=e.id,this.name=e.name,this.visible=e.visible,this.datasets=[],this.options=this.defaultScatter3dOptions,this.render(),this.scatter3dHolder=n("#"+this.id),this.renderer=new THREE.WebGLRenderer({antialias:!1}),this.renderer.setSize(this.scatter3dHolder.width(),this.scatter3dHolder.height()),this.scatter3dHolder.append(this.renderer.domElement),this.renderer.clear(),this.initializeCamera(),this.renderer.setClearColor(this.options.clearColor,1),this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement),this.controls.parentWidget=this,this.controls.addEventListener("change",function(){this.parentWidget&&this.parentWidget.render3DPlot()}),this.scene=new THREE.Scene,this.helpers(),this.scatter3dHolder.on("resize",this,function(e){WIDTH=e.data.scatter3dHolder.width(),HEIGHT=e.data.scatter3dHolder.height(),e.data.renderer.setSize(WIDTH,HEIGHT),e.data.camera.aspect=WIDTH/HEIGHT,e.data.camera.updateProjectionMatrix(),e.stopPropagation()}),this.controls.update(),this.render3DPlot()},initializeCamera:function(){var e=this.options.fov,t=this.renderer.domElement.width,n=this.renderer.domElement.height,r=t/n,i=this.options.nearClipPlane,s=this.options.farClipPlane;this.camera=new THREE.PerspectiveCamera(e,r,i,s),this.camera.position.z=this.options.cameraPositionZ},helpers:function(){if(this.options.axis){var e=new THREE.Color("rgb("+this.options.axisColours[0].r+","+this.options.axisColours[0].g+","+this.options.axisColours[0].b+")"),t=new THREE.Color("rgb("+this.options.axisColours[1].r+","+this.options.axisColours[1].g+","+this.options.axisColours[1].b+")"),n=new THREE.Color("rgb("+this.options.axisColours[2].r+","+this.options.axisColours[2].g+","+this.options.axisColours[2].b+")");this.axisHelper=new THREE.AxisHelper(50,e,t,n),this.scene.add(this.axisHelper)}if(this.options.grid){var r=new THREE.GridHelper(50,10);r.position.set(50,0,50),this.scene.add(r);var i=new THREE.GridHelper(50,10);i.position.set(50,50,0),i.rotation.x=Math.PI/2,this.scene.add(i);var s=new THREE.GridHelper(50,10);s.position.set(0,50,50),s.rotation.z=Math.PI/2,this.scene.add(s)}},paintLegend:function(){n("#legendBox").length>0?n("#legendBox").empty():this.scatter3dHolder.append("<div id='legendBox' title='Legend Box'></div>");for(var e in this.datasets){var t=this.datasets[e].data;n("#legendBox").append("<div id='datasetLegend"+e+"' class='datasetLegend'><div class='legendColor' style='background: #"+this.options.colours[e].toString(16)+";'></div></div>"),n("#datasetLegend"+e).append("<div id='datasetLegendText"+e+"' class='datasetLegendText'></div>");for(var r in t)n("#datasetLegendText"+e).append("<span style='color:RGB("+this.options.axisColours[r].r+","+this.options.axisColours[r].g+","+this.options.axisColours[r].b+")'>"+t[r].label+"</span>"),r!=t.length-1&&n("#datasetLegendText"+e).append("<br>")}},plotData:function(e,t){t!=null&&n.extend(this.options,t);if(e!=null&&e instanceof Array){if((typeof e[0]=="string"||e[0]instanceof String)&&(typeof e[1]=="string"||e[1]instanceof String)&&(typeof e[2]=="string"||e[2]instanceof String)){dataset={curves:[],data:[],lineBasicMaterial:new THREE.LineBasicMaterial({linewidth:4,color:this.options.colours[this.datasets.length]})};for(var r in e)dataset.data.push({label:e[r],values:[]});this.datasets.push(dataset)}else for(var r in e)this.datasets.push({label:"",values:e[r]});this.options.axis&&this.options.legend===!0&&this.paintLegend()}return"Lines or variables to scatter added to widget"},removeDataSet:function(e){if(e!=null){for(var t in this.datasets[e].curves)this.scene.remove(this.datasets[e].curves[t]);this.datasets.splice(e,1)}this.datasets.length==0?this.resetScatter3d():this.render3DPlot()},updateDataSet:function(){if(this.options.plotEachN==null||!(this.numberPoints++%this.options.plotEachN))for(var e in this.datasets){var t=!1,n=this.datasets[e].data,r=new Array(3),i="",s=new Array(3);for(var o in n)i=n[o].label,r[o]=this.getState(GEPPETTO.Simulation.runTimeTree,i),s=n[o].values,s.length>this.options.limit&&(s.splice(0,1),t=!0),s.push(r[o].value),this.datasets[e].data[o].values=s;if(this.scene!=null&&this.datasets[e].data[0].values.length>1){t&&(this.scene.remove(this.datasets[e].curves[0]),this.datasets[e].curves.splice(0,1));var u=[],a={};if(this.options.normalizeData){for(var f=0;f<3;f++){var l=this.datasets[e].data[f].values.reduce(function(e,t){return e+t});u[f]=l/this.datasets[e].data[f].values.length}a=this.paintThreeLine([(this.datasets[e].data[0].values[this.datasets[e].data[0].values.length-2]-u[0])/this.datasets[e].data[0].values.length,(this.datasets[e].data[0].values[this.datasets[e].data[0].values.length-1]-u[0])/this.datasets[e].data[0].values.length],[(this.datasets[e].data[1].values[this.datasets[e].data[1].values.length-2]-u[1])/this.datasets[e].data[1].values.length,(this.datasets[e].data[1].values[this.datasets[e].data[1].values.length-1]-u[1])/this.datasets[e].data[1].values.length],[(this.datasets[e].data[2].values[this.datasets[e].data[2].values.length-2]-u[2])/this.datasets[e].data[2].values.length,(this.datasets[e].data[2].values[this.datasets[e].data[2].values.length-1]-u[2])/this.datasets[e].data[2].values.length],this.datasets[e].lineBasicMaterial)}else a=this.paintThreeLine([this.datasets[e].data[0].values[this.datasets[e].data[0].values.length-2],this.datasets[e].data[0].values[this.datasets[e].data[0].values.length-1]],[this.datasets[e].data[1].values[this.datasets[e].data[1].values.length-2],this.datasets[e].data[1].values[this.datasets[e].data[1].values.length-1]],[this.datasets[e].data[2].values[this.datasets[e].data[2].values.length-2],this.datasets[e].data[2].values[this.datasets[e].data[2].values.length-1]],this.datasets[e].lineBasicMaterial);this.datasets[e].curves.push(a),this.scene.add(a),this.render3DPlot()}}},paintThreeLine:function(e,t,n,r){var i=new THREE.Geometry,s=i.vertices;for(var o in e)s.push(new THREE.Vector3(e[o],t[o],n[o]));var u=new THREE.Line(i,r);return u},plotXYZData:function(e,t,n,r){r!=null&&(this.options=r),dataset={curves:[],data:[],lineBasicMaterial:new THREE.LineBasicMaterial({color:this.options.colours[this.datasets.length]})},e.name!=null&&t.name!=null&&n.name!=null?dataset.data.push({label:e.name,values:e.value},{label:t.name,values:t.value},{label:n.name,values:n.value}):dataset.data.push({label:"",values:e},{label:"",values:t},{label:"",values:n}),this.datasets.push(dataset),line=this.paintThreeLine(dataset.data[0].values,dataset.data[1].values,dataset.data[2].values,dataset.lineBasicMaterial),dataset.curves.push(line),this.scene.add(line),this.render3DPlot()},scatter3dDataFunction:function(e,t,n){},resetScatter3d:function(){this.datasets=[],this.options=this.defaultScatter3dOptions,this.paintLegend(),this.renderer.clear(),this.scene=new THREE.Scene,this.helpers(),this.render3DPlot()},getDataSets:function(){return this.datasets},setAxisLabel:function(e,t,n,r){typeof r=="undefined"&&(r=0),this.datasets[r].data[0].label=e,this.datasets[r].data[1].label=t,this.datasets[r].data[2].label=n,this.paintLegend()},render3DPlot:function(){this.renderer.render(this.scene,this.camera)}})}),define("widgets/scatter3d/controllers/Scatter3dController",["require","widgets/scatter3d/Scatter3d"],function(e){return function(t){var n=e("widgets/scatter3d/Scatter3d"),r=new Array,i=!1;t.Scatter3dController={registerHandler:function(e){t.WidgetsListener.subscribe(t.Scatter3dController,e)},getWidgets:function(){return r},addScatter3dWidget:function(){var e=r.length+1,i="Scatter3d"+e,s=i,o=window[i]=new n({id:s,name:i,visible:!0});return o.help=function(){return t.Console.getObjectCommands(s)},r.push(o),this.registerHandler(s),t.Console.updateCommands("js/widgets/scatter3d/Scatter3d.js",o,s),o},removeScatter3dWidgets:function(){for(var e=0;e<r.length;e++){var t=r[e];t.destroy()}r=new Array},toggle:function(){if(r.length==0)t.Console.executeCommand("G.addWidget(GEPPETTO.Widgets.SCATTER3D)");else if(r.length>0){i=!i;for(var e in r){var n=r[e];i?n.hide():n.show()}}},update:function(e){if(e==t.WidgetsListener.WIDGET_EVENT_TYPE.DELETE)this.removeScatter3dWidgets();else if(e==t.WidgetsListener.WIDGET_EVENT_TYPE.UPDATE)for(var n=0;n<r.length;n++){var i=r[n];i.updateDataSet()}}}}}),require.config({paths:{threelib:"widgets/scatter3d/vendor/three.min"},shim:{"widgets/scatter3d/vendor/OrbitControls":["threelib"],"widgets/scatter3d/vendor/helvetiker_regular.typeface":["threelib"]}});var reqs=[];reqs.push("threelib"),reqs.push("widgets/scatter3d/vendor/OrbitControls"),reqs.push("widgets/scatter3d/vendor/helvetiker_regular.typeface"),require(reqs,function(e){loadCss("js/widgets/scatter3d/Scatter3d.css")}),define("widgets/scatter3d/config",["require","widgets/scatter3d/controllers/Scatter3dController"],function(e){return function(t){e("widgets/scatter3d/controllers/Scatter3dController")(t)}}),function(e,t){if("function"==typeof define&&define.amd)define("backbone-associations",["underscore","backbone"],function(n,r){return t(e,r,n)});else if("undefined"!=typeof exports){var n=require("underscore"),r=require("backbone");t(e,r,n),"undefined"!=typeof module&&module.exports&&(module.exports=r),exports=r}else t(e,e.Backbone,e._)}(this,function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d={};r=t.Model,i=t.Collection,s=r.prototype,u=i.prototype,o=t.Events,t.Associations={VERSION:"0.6.2"},t.Associations.scopes=[];var v=function(){return c},m=function(e){if(!n.isString(e)||1>n.size(e))e=".";c=e,f=RegExp("[\\"+c+"\\[\\]]+","g"),l=RegExp("[^\\"+c+"\\[\\]]+","g")};try{Object.defineProperty(t.Associations,"SEPARATOR",{enumerable:!0,get:v,set:m})}catch(g){}t.Associations.Many=t.Many="Many",t.Associations.One=t.One="One",t.Associations.Self=t.Self="Self",t.Associations.SEPARATOR=".",t.Associations.getSeparator=v,t.Associations.setSeparator=m,t.Associations.EVENTS_BUBBLE=!0,t.Associations.EVENTS_WILDCARD=!0,t.Associations.EVENTS_NC=!1,m(),a=t.AssociatedModel=t.Associations.AssociatedModel=r.extend({relations:void 0,_proxyCalls:void 0,constructor:function(e,t){t&&t.__parents__&&(this.parents=[t.__parents__]),r.apply(this,arguments)},on:function(e,r,i){var s=o.on.apply(this,arguments);if(t.Associations.EVENTS_NC)return s;var u=/\s+/;return n.isString(e)&&e&&!u.test(e)&&r&&(u=b(e))&&(d[u]="undefined"==typeof d[u]?1:d[u]+1),s},off:function(e,r,i){if(t.Associations.EVENTS_NC)return o.off.apply(this,arguments);var s=/\s+/,u=this._events,a={},f=u?n.keys(u):[],l=!e&&!r&&!i,c=n.isString(e)&&!s.test(e);if(l||c)for(var s=0,h=f.length;s<h;s++)a[f[s]]=u[f[s]]?u[f[s]].length:0;var p=o.off.apply(this,arguments);if(l||c){s=0;for(h=f.length;s<h;s++)(l=b(f[s]))&&(d[l]=u[f[s]]?d[l]-(a[f[s]]-u[f[s]].length):d[l]-a[f[s]])}return p},get:function(e){var t=this.__attributes__,n=s.get.call(this,e),t=t?S(n)?n:t[e]:n;return S(t)?t:this._getAttr.apply(this,arguments)},set:function(e,t,r){var i;return n.isObject(e)||null==e?(i=e,r=t):(i={},i[e]=t),e=this._set(i,r),this._processPendingEvents(),e},_set:function(e,t){var i,s,o,u,a=this;if(!e)return this;this.__attributes__=e;for(i in e)if(s||(s={}),i.match(f)){var l=y(i);u=n.initial(l),l=l[l.length-1],u=this.get(u),u instanceof r&&(u=s[u.cid]||(s[u.cid]={model:u,data:{}}),u.data[l]=e[i])}else u=s[this.cid]||(s[this.cid]={model:this,data:{}}),u.data[i]=e[i];if(s)for(o in s)u=s[o],this._setAttr.call(u.model,u.data,t)||(a=!1);else a=this._setAttr.call(this,e,t);return delete this.__attributes__,a},_setAttr:function(o,u){var a;u||(u={});if(u.unset)for(a in o)o[a]=void 0;return this.parents=this.parents||[],this.relations&&n.each(this.relations,function(s){var a=s.key,f=s.scope||e,l=this._transformRelatedModel(s,o),c=this._transformCollectionType(s,l,o),h=n.isString(s.map)?w(s.map,f):s.map,p=this.attributes[a],d=p&&p.idAttribute,v,m,g=!1;v=s.options?n.extend({},s.options,u):u;if(o[a]){f=n.result(o,a),f=h?h.call(this,f,c?c:l):f;if(S(f))if(s.type===t.Many)p?(p._deferEvents=!0,p[v.reset?"reset":"set"](f instanceof i?f.models:f,v),l=p):(g=!0,f instanceof i?l=f:(l=this._createCollection(c||i,s.collectionOptions||(l?{model:l}:{})),l[v.reset?"reset":"set"](f,v)));else{if(s.type!==t.One)throw Error("type attribute must be specified and have the values Backbone.One or Backbone.Many");s=f instanceof r?f.attributes.hasOwnProperty(d):f.hasOwnProperty(d),c=f instanceof r?f.attributes[d]:f[d],p&&s&&p.attributes[d]===c?(p._deferEvents=!0,p._set(f instanceof r?f.attributes:f,v),l=p):(g=!0,f instanceof r?l=f:(v.__parents__=this,l=new l(f,v),delete v.__parents__))}else l=f;m=o[a]=l;if(g||m&&!m._proxyCallback)m._proxyCallback||(m._proxyCallback=function(){return t.Associations.EVENTS_BUBBLE&&this._bubbleEvent.call(this,a,m,arguments)}),m.on("all",m._proxyCallback,this)}o.hasOwnProperty(a)&&this._setupParents(o[a],this.attributes[a])},this),s.set.call(this,o,u)},_bubbleEvent:function(e,n,s){var o=s[0].split(":"),u=o[0],a="nested-change"==s[0],f="change"===u,l=s[1],v=-1,m=n._proxyCalls,o=o[1],g=!o||-1==o.indexOf(c),y;if(!a&&(g&&(p=b(s[0])||e),t.Associations.EVENTS_NC||d[p]))return t.Associations.EVENTS_WILDCARD&&/\[\*\]/g.test(o)?this:(n instanceof i&&(f||o)&&(v=n.indexOf(h||l)),this instanceof r&&(h=this),o=e+(-1!==v&&(f||o)?"["+v+"]":"")+(o?c+o:""),t.Associations.EVENTS_WILDCARD&&(y=o.replace(/\[\d+\]/g,"[*]")),a=[],a.push.apply(a,s),a[0]=u+":"+o,t.Associations.EVENTS_WILDCARD&&o!==y&&(a[0]=a[0]+" "+u+":"+y),m=n._proxyCalls=m||{},this._isEventAvailable.call(this,m,o)?this:(m[o]=!0,f&&(this._previousAttributes[e]=n._previousAttributes,this.changed[e]=n),this.trigger.apply(this,a),t.Associations.EVENTS_NC&&f&&this.get(o)!=s[2]&&(e=["nested-change",o,s[1]],s[2]&&e.push(s[2]),this.trigger.apply(this,e)),m&&o&&delete m[o],h=void 0,this))},_isEventAvailable:function(e,t){return n.find(e,function(e,n){return-1!==t.indexOf(n,t.length-n.length)})},_setupParents:function(e,t){e&&(e.parents=e.parents||[],-1==n.indexOf(e.parents,this)&&e.parents.push(this)),t&&0<t.parents.length&&t!=e&&(t.parents=n.difference(t.parents,[this]),t._proxyCallback&&t.off("all",t._proxyCallback,this))},_createCollection:function(e,t){var t=n.defaults(t,{model:e.model}),r=new e([],n.isFunction(t)?t.call(this):t);return r.parents=[this],r},_processPendingEvents:function(){this._processedEvents||(this._processedEvents=!0,this._deferEvents=!1,n.each(this._pendingEvents,function(e){e.c.trigger.apply(e.c,e.a)}),this._pendingEvents=[],n.each(this.relations,function(e){(e=this.attributes[e.key])&&e._processPendingEvents&&e._processPendingEvents()},this),delete this._processedEvents)},_transformRelatedModel:function(i,s){var o=i.relatedModel,u=i.scope||e;o&&!(o.prototype instanceof r)&&(o=n.isFunction(o)?o.call(this,i,s):o),o&&n.isString(o)&&(o=o===t.Self?this.constructor:w(o,u));if(i.type===t.One){if(!o)throw Error("specify a relatedModel for Backbone.One type");if(!(o.prototype instanceof t.Model))throw Error("specify an AssociatedModel or Backbone.Model for Backbone.One type")}return o},_transformCollectionType:function(s,o,u){var a=s.collectionType,f=s.scope||e;if(a&&n.isFunction(a)&&a.prototype instanceof r)throw Error("type is of Backbone.Model. Specify derivatives of Backbone.Collection");a&&!(a.prototype instanceof i)&&(a=n.isFunction(a)?a.call(this,s,u):a),a&&n.isString(a)&&(a=w(a,f));if(a&&!a.prototype instanceof i)throw Error("collectionType must inherit from Backbone.Collection");if(s.type===t.Many&&!o&&!a)throw Error("specify either a relatedModel or collectionType");return a},trigger:function(e){this._deferEvents?(this._pendingEvents=this._pendingEvents||[],this._pendingEvents.push({c:this,a:arguments})):s.trigger.apply(this,arguments)},toJSON:function(e){var t={},r;return t[this.idAttribute]=this.id,this.visited||(this.visited=!0,t=s.toJSON.apply(this,arguments),e&&e.serialize_keys&&(t=n.pick(t,e.serialize_keys)),this.relations&&n.each(this.relations,function(i){var s=i.key,o=i.remoteKey,u=this.attributes[s],a=!i.isTransient,i=i.serialize||[],f=n.clone(e);delete t[s],a&&(i.length&&(f?f.serialize_keys=i:f={serialize_keys:i}),r=u&&u.toJSON?u.toJSON(f):u,t[o||s]=n.isArray(r)?n.compact(r):r)},this),delete this.visited),t},clone:function(e){return new this.constructor(this.toJSON(e))},cleanup:function(e){e=e||{},n.each(this.relations,function(e){if(e=this.attributes[e.key])e._proxyCallback&&e.off("all",e._proxyCallback,this),e.parents=n.difference(e.parents,[this])},this),!e.listen&&this.off()},destroy:function(e){var e=e?n.clone(e):{},e=n.defaults(e,{remove_references:!0,listen:!0}),t=this;if(e.remove_references&&e.wait){var r=e.success;e.success=function(n){r&&r(t,n,e),t.cleanup(e)}}var i=s.destroy.apply(this,[e]);return e.remove_references&&!e.wait&&t.cleanup(e),i},_getAttr:function(e){var t=this,r=this.__attributes__,e=y(e),s,o;if(!(1>n.size(e))){for(o=0;o<e.length;o++){s=e[o];if(!t)break;t=t instanceof i?isNaN(s)?void 0:t.at(s):r?S(t.attributes[s])?t.attributes[s]:r[s]:t.attributes[s]}return t}}});var y=function(e){return""===e?[""]:n.isString(e)?e.match(l):e||[]},b=function(e){return e?(e=e.split(":"),1<e.length?(e=e[e.length-1],e=e.split(c),1<e.length?e[e.length-1].split("[")[0]:e[0].split("[")[0]):""):e},w=function(e,r){var i,s=[r];s.push.apply(s,t.Associations.scopes);for(var o,u=0,a=s.length;u<a;++u)if(o=s[u])if(i=n.reduce(e.split(c),function(e,t){return e[t]},o))break;return i},E=function(e,t,r){var i,s;return n.find(e,function(e){if(i=n.find(e.relations,function(n){return e.get(n.key)===t},this))return s=e,!0},this),i&&i.map?i.map.call(s,r,t):r},S=function(e){return!n.isUndefined(e)&&!n.isNull(e)},x={};return n.each(["set","remove","reset"],function(e){x[e]=i.prototype[e],u[e]=function(t,n){return this.model.prototype instanceof a&&this.parents&&(arguments[0]=E(this.parents,this,t)),x[e].apply(this,arguments)}}),x.trigger=u.trigger,u.trigger=function(e){this._deferEvents?(this._pendingEvents=this._pendingEvents||[],this._pendingEvents.push({c:this,a:arguments})):x.trigger.apply(this,arguments)},u._processPendingEvents=a.prototype._processPendingEvents,u.on=a.prototype.on,u.off=a.prototype.off,t}),define("nodes/Node",["jquery","underscore","backbone","backbone-associations"],function(e){return{Model:Backbone.AssociatedModel.extend({name:"",instancePath:"",id:"",_metaType:"",getInstancePath:function(){return this.instancePath},getName:function(){return this.name},setName:function(e){this.name=e},getId:function(){return this.id}})}}),define("widgets/treevisualiser/TreeVisualiser",["require","widgets/Widget","nodes/Node"],function(e){var t=e("widgets/Widget"),n=e("nodes/Node");return{TreeVisualiser:t.View.extend({datasets:[],initialize:function(e){t.View.prototype.initialize.call(this,e),this.datasets=[],this.render(),this.setSize(e.width,e.height)},setData:function(e,t,n){t!=null&&$.extend(this.options,t);if(e!=null){var n=this.createDataset();return n.variableToDisplay=e,n.data=e,n}return null},getDatasets:function(){return this.datasets},createDataset:function(){return{variableToDisplay:"",data:{},isDisplayed:!1}}})}}),define("widgets/treevisualiser/treevisualiserdat/TreeVisualiserDAT",["require","widgets/treevisualiser/TreeVisualiser","jquery"],function(require){var TreeVisualiser=require("widgets/treevisualiser/TreeVisualiser"),$=require("jquery");return TreeVisualiser.TreeVisualiser.extend({defaultTreeVisualiserOptions:{width:"auto",autoPlace:!1},initialize:function(e){TreeVisualiser.TreeVisualiser.prototype.initialize.call(this,e),this.options=this.defaultTreeVisualiserOptions,this.gui=new dat.GUI({width:this.options.width,autoPlace:this.options.autoPlace}),this.dialog.append(this.gui.domElement)},events:{"contextmenu .title":"manageRightClickEvent"},manageRightClickEvent:function(event){var ascendantsElements=$(event.target).parentsUntil("#"+this.id,".folder").get().reverse(),nodeString="";for(var ascendantsElementKey in ascendantsElements){var label=$(ascendantsElements[ascendantsElementKey]).find(".title").first().html();nodeString+=label+"."}nodeString=nodeString.substring(0,nodeString.length-1);var node=eval(nodeString);this.showContextMenu(event,node)},setData:function(e,t){return dataset=TreeVisualiser.TreeVisualiser.prototype.setData.call(this,e,t),dataset.valueDict={},this.prepareTree(this.gui,dataset.data),dataset.isDisplayed=!0,this.datasets.push(dataset),"Metadata or variables to display added to tree visualiser"},prepareTree:function(e,t){if(t._metaType!=null){t.getName()===undefined?label=t.getId():label=t.getName();if(t._metaType=="VariableNode"|t._metaType=="DynamicsSpecificationNode"|t._metaType=="ParameterSpecificationNode")dataset.isDisplayed?dataset.valueDict[t.instancePath][label]=t.getValue()+" "+(t.getUnit()!=null&&t.getUnit()!="null"?" "+t.getUnit():""):(dataset.valueDict[t.instancePath]={},dataset.valueDict[t.instancePath][label]=t.getValue()+" "+(t.getUnit()!=null&&t.getUnit()!="null"?" "+t.getUnit():""),dataset.valueDict[t.instancePath].controller=e.add(dataset.valueDict[t.instancePath],t.getName()).listen());else{dataset.isDisplayed||(parentFolder=e.addFolder(label));var n=t.getChildren().models;if(n.length>0){var r=parentFolder;for(var i in n)this.prepareTree(r,n[i])}}}},updateData:function(){for(var e in this.datasets)dataset=this.datasets[e],dataset.variableToDisplay!=null&&this.prepareTree(this.gui,dataset.data)}})}),define("widgets/treevisualiser/treevisualiserdat/controllers/TreeVisualiserControllerDAT",["require","widgets/treevisualiser/treevisualiserdat/TreeVisualiserDAT"],function(e){return function(t){var n=e("widgets/treevisualiser/treevisualiserdat/TreeVisualiserDAT"),r=new Array;t.TreeVisualiserControllerDAT={registerHandler:function(e){t.WidgetsListener.subscribe(t.TreeVisualiserControllerDAT,e)},getWidgets:function(){return r},addTreeVisualiserDATWidget:function(){var e=r.length+1,i="TreeVisualiserDAT"+e,s=i,o=window[i]=new n({id:s,name:i,visible:!1,width:260,height:350});return o.help=function(){return t.Utility.getObjectCommands(s)},r.push(o),this.registerHandler(s),t.Console.updateCommands("js/widgets/treevisualiser/treevisualiserdat/TreeVisualiserDAT.js",o,s),o},removeTreeVisualiserDATWidgets:function(){for(var e=0;e<r.length;e++){var t=r[e];t.destroy(),e++}r=new Array},update:function(e){if(e==t.WidgetsListener.WIDGET_EVENT_TYPE.DELETE)this.removeTreeVisualiserDATWidgets();else if(e==t.WidgetsListener.WIDGET_EVENT_TYPE.UPDATE)for(var n=0;n<r.length;n++){var i=r[n];i.updateData()}},getCommands:function(e){var n=[{label:"Open with DAT Widget",action:"GEPPETTO.TreeVisualiserControllerDAT.actionMenu"}],r=t.TreeVisualiserControllerDAT.getWidgets();if(r.length>0){var i=[{label:"Add to DAT Widget",position:0}],s=[];for(var o in r){var u=r[o];s=s.concat([{label:"Add to "+u.name,action:u.id+".setData",position:o}])}i[0].groups=[s],n=n.concat(i)}var a=[n];return a},actionMenu:function(e){tv=t.TreeVisualiserControllerDAT.addTreeVisualiserDATWidget(),tv.setData(e)}}}});var reqs=[];reqs.push("widgets/treevisualiser/treevisualiserdat/vendor/dat.gui.min"),require(reqs,function(e){loadCss("js/widgets/treevisualiser/treevisualiserdat/TreeVisualiserDAT.css")}),define("widgets/treevisualiser/treevisualiserdat/config",["require","widgets/treevisualiser/treevisualiserdat/controllers/TreeVisualiserControllerDAT"],function(e){return function(t){e("widgets/treevisualiser/treevisualiserdat/controllers/TreeVisualiserControllerDAT")(t),t.MenuManager.registerNewCommandProvider(["EntityNode","AspectNode","AspectSubTreeNode","CompositeNode","DynamicsSpecificationNode","FunctionNode","ParameterNode","ParameterSpecificationNode","VariableNode"],t.TreeVisualiserControllerDAT.getCommands)}}),define("widgets/treevisualiser/treevisualiserd3/TreeVisualiserD3",["require","widgets/treevisualiser/TreeVisualiser","jquery"],function(e){var t=e("widgets/treevisualiser/TreeVisualiser"),n=e("jquery");return t.TreeVisualiser.extend({defaultTreeVisualiserOptions:{width:460,height:460},initialize:function(e){t.TreeVisualiser.prototype.initialize.call(this,e),this.options=this.defaultTreeVisualiserOptions,this.treeVisualiserD3Container=n("#"+this.id),this.treeVisualiserD3Container.on("dialogresizestop",function(e,t){var r=window[this.id].datasets;for(var i in r){var s=n(this).innerWidth()-20,o=n(this).innerHeight()-20;r[i].svg.attr("width",s).attr("height",o),r[i].force.size([s,o]).resume()}e.stopPropagation()})},setData:function(e,n){return dataset=t.TreeVisualiser.prototype.setData.call(this,e,n),dataset.links=[],dataset.nodes={},dataset.svg=null,dataset.force=null,this.datasets.push(dataset),this.prepareTree("",dataset.data,dataset),this.paintTree(),"Metadata or variables to display added to tree visualiser"},prepareTree:function(e,t,n){nodeName=t.instancePath;if(nodeName!=null){t.getName()===undefined?label=t.getId():label=t.getName();if(t._metaType!="VariableNode"&t._metaType!="DynamicsSpecificationNode"&t._metaType!="ParameterSpecificationNode"){n.nodes[nodeName]={name:label,variable:t};if(e!=""){var r={};r.source=n.nodes[e],r.target=n.nodes[nodeName],r.type="suit",n.links.push(r)}var i=t.getChildren().models;if(i.length>0){var s=nodeName;for(var o in i)this.prepareTree(s,i[o],n)}}else{n.nodes[nodeName]={name:label+"="+t.getValue()+(t.getUnit()!=null&&t.getUnit()!="null"?" "+t.getUnit():""),variable:t};if(e!=""){var r={};r.source=n.nodes[e],r.target=n.nodes[nodeName],r.type="suit",n.links.push(r)}}}},updateData:function(){for(var e in this.datasets){dataset=this.datasets[e];if(dataset.variableToDisplay!=null){dataset.links=[],dataset.nodes={},this.prepareTree("",dataset.data,dataset);var t=dataset.force.nodes();n.extend(!0,t,d3.values(dataset.nodes)),dataset.svg.selectAll("text").data(t).text(function(e){return e.name})}}},paintTree:function(){for(var e in this.datasets){dataset=this.datasets[e];if(dataset.nodes!={}&&dataset.links!=[]&&!dataset.isDisplayed){dataset.isDisplayed=!0;var t=this.treeVisualiserD3Container.innerWidth()-20,n=this.treeVisualiserD3Container.innerHeight()-20;dataset.force=d3.layout.force().nodes(d3.values(dataset.nodes)).links(dataset.links).size([t,n]).linkDistance(60).charge(-300).on("tick",o).start(),dataset.svg=d3.select("#"+this.id).append("svg").attr("width",t).attr("height",n).on("contextmenu",function(e){return function(t,n){d3_target=d3.select(d3.event.target),typeof d3_target.datum()!="undefined"&&e.showContextMenu(d3.event,d3_target.datum().variable)}}(this)),dataset.svg.append("defs").selectAll("marker").data(["suit","licensing","resolved"]).enter().append("marker").attr("id",function(e){return e}).attr("viewBox","0 -5 10 10").attr("refX",15).attr("refY",-1.5).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5");var r=dataset.svg.append("g").selectAll("path").data(dataset.force.links()).enter().append("path").attr("class",function(e){return"link "+e.type}).attr("marker-end",function(e){return"url(#"+e.type+")"}),i=dataset.svg.append("g").selectAll("circle").data(dataset.force.nodes()).enter().append("circle").attr("r",6).call(dataset.force.drag),s=dataset.svg.append("g").selectAll("text").data(dataset.force.nodes()).enter().append("text").attr("x",8).attr("y",".31em").text(function(e){return e.name});function o(){r.attr("d",u),i.attr("transform",a),s.attr("transform",a)}function u(e){var t=e.target.x-e.source.x,n=e.target.y-e.source.y,r=Math.sqrt(t*t+n*n);return"M"+e.source.x+","+e.source.y+"A"+r+","+r+" 0 0,1 "+e.target.x+","+e.target.y}function a(e){return"translate("+e.x+","+e.y+")"}}}}})}),define("widgets/treevisualiser/treevisualiserd3/controllers/TreeVisualiserControllerD3",["require","widgets/treevisualiser/treevisualiserd3/TreeVisualiserD3"],function(e){return function(t){var n=e("widgets/treevisualiser/treevisualiserd3/TreeVisualiserD3"),r=new Array;t.TreeVisualiserControllerD3={registerHandler:function(e){t.WidgetsListener.subscribe(t.TreeVisualiserControllerD3,e)},getWidgets:function(){return r},addTreeVisualiserD3Widget:function(){var e=r.length+1,i="TreeVisualiserD3"+e,s=i,o=window[i]=new n({id:s,name:i,visible:!1,width:500,height:500});return o.help=function(){return t.Utility.getObjectCommands(s)},r.push(o),this.registerHandler(s),t.Console.updateCommands("js/widgets/treevisualiser/treevisualiserd3/TreeVisualiserD3.js",o,s),o},removeTreeVisualiserD3Widgets:function(){for(var e=0;e<r.length;e++){var t=r[e];t.destroy(),e++}r=new Array},update:function(e){if(e==t.WidgetsListener.WIDGET_EVENT_TYPE.DELETE)this.removeTreeVisualiserD3Widgets();else if(e==t.WidgetsListener.WIDGET_EVENT_TYPE.UPDATE)for(var n=0;n<r.length;n++){var i=r[n];i.updateData()}},getCommands:function(e){var n=[{label:"Open with D3 Widget",action:"GEPPETTO.TreeVisualiserControllerD3.actionMenu"}],r=t.TreeVisualiserControllerD3.getWidgets();if(r.length>0){var i=[{label:"Add to D3 Widget",position:0}],s=[];for(var o in r){var u=r[o];s=s.concat([{label:"Add to "+u.name,action:u.id+".setData",position:o}])}i[0].groups=[s],n=n.concat(i)}var a=[n];return a},actionMenu:function(e){tv=t.TreeVisualiserControllerD3.addTreeVisualiserD3Widget(),tv.setData(e)}}}}),require.config({paths:{d3:"widgets/treevisualiser/treevisualiserd3/vendor/d3.min"}});var reqs=[];reqs.push("d3"),define("d3.global",["d3"],function(e){d3=e}),require(reqs,function(e){window.d3=e,loadCss("js/widgets/treevisualiser/treevisualiserd3/TreeVisualiserD3.css")}),define("widgets/treevisualiser/treevisualiserd3/config",["require","widgets/treevisualiser/treevisualiserd3/controllers/TreeVisualiserControllerD3"],function(e){return function(t){e("widgets/treevisualiser/treevisualiserd3/controllers/TreeVisualiserControllerD3")(t),t.MenuManager.registerNewCommandProvider(["EntityNode","AspectNode","AspectSubTreeNode","CompositeNode","DynamicsSpecificationNode","FunctionNode","ParameterNode","ParameterSpecificationNode","VariableNode"],t.TreeVisualiserControllerD3.getCommands)}}),define("widgets/includeWidget",["require","widgets/WidgetFactory","widgets/WidgetsListener","widgets/WidgetUtility","widgets/ContextMenu","widgets/plot/config","widgets/popup/config","widgets/scatter3d/config","widgets/treevisualiser/treevisualiserdat/config","widgets/treevisualiser/treevisualiserd3/config"],function(e){return function(t){e("widgets/WidgetFactory")(t),e("widgets/WidgetsListener")(t),e("widgets/WidgetUtility"),e("widgets/ContextMenu")(t),e("widgets/plot/config")(t),e("widgets/popup/config")(t),e("widgets/scatter3d/config")(t),e("widgets/treevisualiser/treevisualiserdat/config")(t),e("widgets/treevisualiser/treevisualiserd3/config")(t),loadCss("js/widgets/Widget.css")}}),define("nodes/AspectSubTreeNode",["require","nodes/Node","jquery"],function(e){var t=e("nodes/Node"),n=e("jquery");return t.Model.extend({relations:[{type:Backbone.Many,key:"children",relatedModel:t}],defaults:{children:[]},type:"",modified:!1,_metaType:"AspectSubTreeNode",initialize:function(e){this.id=e.id,this.instancePath=e.instancePath,this.name=e.name,this.type=e.type,this.modified=e.modified},getChildren:function(){var e=this.get("children");return e},print:function(){if(this.getChildren().length==0){if(this.type=="SimulationTree")return GEPPETTO.Resources.NO_SIMULATION_TREE;if(this.type=="VisualizationTree"){var e=GEPPETTO.Utility.formatVisualizationTree(this.content,3,"");return e=e.substring(0,e.lastIndexOf("\n")),e.replace(/"/g,""),GEPPETTO.Resources.RETRIEVING_VISUALIZATION_TREE+"\n"+e}if(this.type=="ModelTree")return GEPPETTO.Resources.EMPTY_MODEL_TREE}else{if(this.type=="SimulationTree"){var e=GEPPETTO.Utility.formatsimulationtree(this,3,"");return e=e.substring(0,e.lastIndexOf("\n")),e.replace(/"/g,""),GEPPETTO.Resources.RETRIEVING_SIMULATION_TREE+"\n"+e}if(this.type=="VisualizationTree"){var e=GEPPETTO.Utility.formatVisualizationTree(this,3,"");return e=e.substring(0,e.lastIndexOf("\n")),e.replace(/"/g,""),GEPPETTO.Resources.RETRIEVING_VISUALIZATION_TREE+"\n"+e}if(this.type=="ModelTree"){var e=GEPPETTO.Utility.formatmodeltree(this,3,"");return e=e.substring(0,e.lastIndexOf("\n")),e.replace(/"/g,""),GEPPETTO.Resources.RETRIEVING_MODEL_TREE+"\n"+e}}}})}),define("nodes/AspectNode",["require","nodes/Node","nodes/AspectSubTreeNode","jquery"],function(e){var t=e("nodes/Node"),n=e("nodes/AspectSubTreeNode"),r=e("jquery");return t.Model.extend({relations:[{type:Backbone.Many,key:"children",relatedModel:n}],defaults:{children:[]},modelInterpreterName:"",simulatorName:"",modelURL:"",selected:!1,ModelTree:{},VisualizationTree:{},SimulationTree:{},_metaType:"AspectNode",parentEntity:null,initialize:function(e){this.id=e.id,this.modelInterpreterName=e.modelInterpreter,this.simulatorName=e.simulator,this.modelURL=e.model,this.instancePath=e.instancePath,this.name=e.name},hide:function(){var e;return GEPPETTO.hideAspect(this.instancePath)?e=GEPPETTO.Resources.HIDE_ASPECT+this.instancePath:e=GEPPETTO.Resources.ASPECT_ALREADY_HIDDING,this.visible=!1,e},show:function(){var e;return GEPPETTO.showAspect(this.instancePath)?e=GEPPETTO.Resources.SHOW_ASPECT+this.instancePath:e=GEPPETTO.Resources.ASPECT_ALREADY_VISIBLE,this.visible=!0,e},unselect:function(){var e;return GEPPETTO.unselectAspect(this.instancePath)?(e=GEPPETTO.Resources.UNSELECTING_ASPECT+this.instancePath,this.selected=!1,this.parentEntity.selected=!1,GEPPETTO.WidgetsListener.update(GEPPETTO.WidgetsListener.WIDGET_EVENT_TYPE.SELECTION_CHANGED)):e=GEPPETTO.Resources.ASPECT_NOT_SELECTED,e},select:function(){var e;return GEPPETTO.selectAspect(this.instancePath)?(e=GEPPETTO.Resources.SELECTING_ASPECT+this.instancePath,this.selected=!0,this.parentEntity.selected=!0,GEPPETTO.WidgetsListener.update(GEPPETTO.WidgetsListener.WIDGET_EVENT_TYPE.SELECTION_CHANGED)):e=GEPPETTO.Resources.ASPECT_ALREADY_SELECTED,e},getId:function(){return this.id},getModelInterpreterName:function(){return this.modelInterpreterName},getSimulatorName:function(){return this.simulatorName},getModelURL:function(){return this.modelURL},getModelTree:function(){return this.ModelTree.getChildren().length==0?(GEPPETTO.MessageSocket.send("get_model_tree",this.instancePath),GEPPETTO.Resources.RETRIEVING_MODEL_TREE):this.ModelTree},getSimulationTree:function(){return this.SimulationTree},getVisualizationTree:function(){return this.VisualizationTree},getParentEntity:function(){return this.parentEntity},setParentEntity:function(e){this.parentEntity=e},print:function(){var e="Name : "+this.name+"\n"+"      Id: "+this.id+"\n"+"      InstancePath : "+this.instancePath+"\n"+"      SubTree : ModelTree \n"+"      SubTree : VisualizationTree \n"+"      SubTree : SimulationTree \n";return e},getChildren:function(){var e=new Backbone.Collection;return e.add(this.ModelTree),e.add(this.SimulationTree),e.add(this.VisualizationTree),e}})}),define("nodes/EntityNode",["require","nodes/Node","nodes/AspectNode","jquery"],function(e){var t=e("nodes/Node"),n=e("nodes/AspectNode"),r=e("jquery");return t.Model.extend({relations:[{type:Backbone.Many,key:"aspects",relatedModel:n},{type:Backbone.Many,key:"entities",relatedModel:Backbone.Self}],defaults:{aspects:[],entities:[]},children:[],position:null,selected:!1,visible:!0,_metaType:"EntityNode",initialize:function(e){this.id=e.id,this.name=e.name,this.position=e.position,this.instancePath=e.instancePath,this.aspects=this.get("aspects").models},hide:function(){var e;return GEPPETTO.hideEntity(this.instancePath)?e=GEPPETTO.Resources.HIDE_ENTITY+this.instancePath:e=GEPPETTO.Resources.ENTITY_ALREADY_HIDDING,this.visible=!1,e},show:function(){var e;return GEPPETTO.showEntity(this.instancePath)?(e=GEPPETTO.Resources.SHOW_ENTITY+this.instancePath,this.visible=!0):e=GEPPETTO.Resources.ENTITY_ALREADY_VISIBLE,e},unselect:function(){var e;return GEPPETTO.unselectEntity(this.instancePath)?(e=GEPPETTO.Resources.UNSELECTING_ENTITY+this.instancePath,this.selected=!1,GEPPETTO.WidgetsListener.update(GEPPETTO.WidgetsListener.WIDGET_EVENT_TYPE.SELECTION_CHANGED)):e=GEPPETTO.Resources.ENTITY_NOT_SELECTED,e},select:function(){var e;return GEPPETTO.selectEntity(this.instancePath)?(e=GEPPETTO.Resources.SELECTING_ENTITY+this.instancePath,this.selected=!0,GEPPETTO.WidgetsListener.update(GEPPETTO.WidgetsListener.WIDGET_EVENT_TYPE.SELECTION_CHANGED)):e=GEPPETTO.Resources.ENTITY_ALREADY_SELECTED,e},getAspects:function(){var e=this.get("aspects");return e},getEntities:function(){var e=this.get("entities");return e},getChildren:function(){var e=this.get("entities"),t=this.get("aspects");return e.add(t.toJSON())},print:function(){var e="Name : "+this.name+"\n"+"      Id: "+this.id+"\n"+"      InstancePath : "+this.instancePath+"\n";for(var t in this.entities)e=e+"      "+"Entity: "+this.entities[t].instancePath;for(var t in this.aspects)e=e+"      "+"Aspect: "+this.aspects[t].instancePath;return e},getChildren:function(){var e=new Backbone.Collection;return e.add(this.get("aspects").models),e.add(this.get("entities").models),e}})}),define("nodes/CompositeNode",["require","nodes/Node","jquery"],function(e){var t=e("nodes/Node"),n=e("jquery");return t.Model.extend({relations:[{type:Backbone.Many,key:"children",relatedModel:t}],defaults:{children:[]},_metaType:"CompositeVariableNode",initialize:function(e){this.id=e.id,this.name=e.name,this.instancePath=e.instancePath,this._metaType=e._metaType},getChildren:function(){var e=this.get("children");return e},print:function(){var e="Name : "+this.name+"\n"+"    Id: "+this.id+"\n"+"    InstancePath : "+this.instancePath+"\n"+"    Children : \n";for(var t=0;t<this.getChildren().length;t++){var n=this.getChildren().at(t);e=e+"      "+n._metaType+": "+n.id+"\n"}return e}})}),define("nodes/ParameterNode",["require","nodes/Node","jquery"],function(e){var t=e("nodes/Node"),n=e("jquery");return t.Model.extend({properties:{},_metaType:"ParameterNode",initialize:function(e){this.properties=e.properties,this.name=e.name,this.id=e.id,this.instancePath=e.instancePath},getProperties:function(){return this.properties},print:function(){return"Name : "+this.name+"\n"+"    Id: "+this.id+"\n"+"    InstancePath : "+this.instancePath+"\n"+"    Properties : "+this.properties+"\n"}})}),define("nodes/ParameterSpecificationNode",["require","nodes/Node","jquery"],function(e){var t=e("nodes/Node"),n=e("jquery");return t.Model.extend({unit:"",value:"",scalingFactor:"",_metaType:"ParameterSpecificationNode",initialize:function(e){this.name=e.name,this.id=e.id,this.unit=e.unit,this.instancePath=e.instancePath,this.value=e.value,this.scalingFactor=e.scalingFactor},getUnit:function(){return this.unit},getValue:function(){return this.value},getScalingFactor:function(){return this.scalingFactor},print:function(){return"Name : "+this.name+"\n"+"    Id: "+this.id+"\n"+"    InstancePath : "+this.instancePath+"\n"+"    Value : "+this.value+"\n"+"    Unit : "+this.unit+"\n"+"    ScalingFactor : "+this.scalingFactor+"\n"}})}),define("nodes/FunctionNode",["require","nodes/Node","jquery"],function(e){var t=e("nodes/Node"),n=e("jquery");return t.Model.extend({arguments:"",expression:"",initialize:function(e){this.name=e.name,this.id=e.id,this.instancePath=e.instancePath,this.arguments=e.arguments,this.expression=e.expression},getArguments:function(){return this.arguments},getExpression:function(){return this.expression},print:function(){return"Name : "+this.name+"\n"+"    Id: "+this.id+"\n"+"    InstancePath : "+this.instancePath+"\n"+"    Arguments : "+this.arguments+"\n"+"    Expression : "+this.expression+"\n"}})}),define("nodes/DynamicsSpecificationNode",["require","nodes/Node","nodes/FunctionNode","jquery"],function(e){var t=e("nodes/Node"),n=e("nodes/FunctionNode"),r=e("jquery");return t.Model.extend({relations:[{type:Backbone.One,key:"dynamics",relatedModel:n}],defaults:{dynamics:{}},unit:"",value:"",scalingFactor:"",dynamics:null,_metaType:"",initialize:function(e){this.unit=e.unit,this.value=e.value,this.scalingFactor=e.scalingFactor,this.dynamics=e.dynamics,this.name=e.name,this.id=e.id,this.instancePath=e.instancePath,this._metaType=e._metaType},getUnit:function(){return this.unit},getValue:function(){return this.value},getScalingFactor:function(){return this.scalingFactor},getDynamics:function(){return this.get("dynamics")},print:function(){return"Name : "+this.name+"\n"+"    Id: "+this.id+"\n"+"    InstancePath : "+this.instancePath+"\n"+"    Value : "+this.value+"\n"+"    Unit : "+this.unit+"\n"+"    ScalingFactor : "+this.scalingFactor+"\n"+"    Dynamics : "+this.dynamics+"\n"}})}),define("nodes/VariableNode",["require","nodes/Node","jquery"],function(e){var t=e("nodes/Node"),n=e("jquery");return t.Model.extend({unit:"",value:"",scalingFactor:"",_metaType:"VariableNode",initialize:function(e){this.name=e.name,this.id=e.id,this.instancePath=e.instancePath,this.unit=e.unit,this.value=e.value,this.scalingFactor=e.scalingFactor},getUnit:function(){return this.unit},getValue:function(){return this.value},getScalingFactor:function(){return this.scalingFactor},print:function(){return"Name : "+this.name+"\n"+"    Id: "+this.id+"\n"+"    InstancePath : "+this.instancePath+"\n"+"    Value : "+this.value+"\n"+"    Unit : "+this.unit+"\n"+"    ScalingFactor : "+this.scalingFactor+"\n"}})}),define("nodes/RuntimeTreeFactory",["require","nodes/AspectNode","nodes/AspectNode","nodes/EntityNode","nodes/AspectSubTreeNode","nodes/CompositeNode","nodes/ParameterNode","nodes/ParameterSpecificationNode","nodes/DynamicsSpecificationNode","nodes/FunctionNode","nodes/VariableNode"],function(e){return function(t){var n=e("nodes/AspectNode"),n=e("nodes/AspectNode"),r=e("nodes/EntityNode"),i=e("nodes/AspectSubTreeNode"),s=e("nodes/CompositeNode"),o=e("nodes/ParameterNode"),u=e("nodes/ParameterSpecificationNode"),a=e("nodes/DynamicsSpecificationNode"),f=e("nodes/FunctionNode"),l=e("nodes/VariableNode");t.RuntimeTreeFactory={createRuntimeTree:function(e){for(var n in e){var r=e[n];if(r._metaType==t.Resources.ENTITY_NODE){var i=t.RuntimeTreeFactory.createEntityNode(r);t.Console.updateCommands("js/nodes/EntityNode.js",i,n),t.Simulation.runTimeTree[n]=i,this.traverseEntities(r,i,t.Simulation.runTimeTree[n])}}},traverseEntities:function(e,n,r){for(var i in e){var s=e[i];if(s._metaType==t.Resources.ENTITY_NODE){var o=t.RuntimeTreeFactory.createEntityNode(s);t.Console.updateTags(o.instancePath,o),r[i]=o,n.get("entities").add(o),this.traverseEntities(s)}}},updateRuntimeTree:function(e){for(var n in e){var r=e[n];if(r._metaType==t.Resources.ENTITY_NODE&&t.Simulation.runTimeTree.hasOwnProperty(n)){var i=t.Simulation.runTimeTree[n];for(var s in r){var o=r[s];if(o._metaType==t.Resources.ASPECT_NODE)for(var u in i.aspects){var a=i.aspects[u];a.instancePath==o.instancePath&&(o.VisualizationTree!=undefined&&o.VisualizationTree.modified&&(a.VisualizationTree.content=o.VisualizationTree,a.VisualizationTree.modified=!0),o.SimulationTree!=undefined&&o.SimulationTree.modified&&(this.updateAspectSimulationTree(a.instancePath,o.SimulationTree),a.SimulationTree!=undefined&&(a.SimulationTree.modified=!0)),o.ModelTree!=undefined&&o.ModelTree.modified)}}}}this.updateWidgets()},resetSubtreesDirtyFlag:function(e){for(var n in e){var r=e[n];if(r._metaType==t.Resources.ENTITY_NODE&&t.Simulation.runTimeTree.hasOwnProperty(n)){var i=t.Simulation.runTimeTree[n],s=r.getChildren();for(var o in s){var u=s[o];if(u._metaType==t.Resources.ASPECT_NODE)for(var a in i.aspects){var f=i.aspects[a];f.instancePath==u.instancePath&&(f.VisualizationTree.modified=!1,f.SimulationTree.modified=!1,f.ModelTree.modified=!1)}}}}},updateAspectSimulationTree:function(e,n){var r=t.Utility.deepFind(t.Simulation.runTimeTree,e);if(jQuery.isEmptyObject(r.SimulationTree)){var s=e+".SimulationTree",o=new i({name:"SimulationTree",instancePath:s,type:"SimulationTree",_metaType:t.Resources.ASPECT_SUBTREE_NODE,modified:!0});this.createSimulationTree(o,n),r.SimulationTree=o,r.get("children").add(o),t.Console.updateTags(o.instancePath,o)}else for(var u in t.Simulation.simulationStates){var a=t.Simulation.simulationStates[u],f=t.Utility.deepFind(t.Simulation.runTimeTree,a);a=a.replace(r.instancePath+".SimulationTree.","");var l=t.Utility.deepFind(n,a);f.value=l.value}},updateWidgets:function(){t.WidgetsListener.update(t.WidgetsListener.WIDGET_EVENT_TYPE.UPDATE);for(var e in t.Simulation.listeners){var n=t.Utility.deepFind(t.Simulation.runTimeTree,e);t.Simulation.listeners[e](n)}},createAspectModelTree:function(e,n){var r=t.Utility.deepFind(t.Simulation.runTimeTree,e);this.modelJSONToNodes(r.ModelTree,n),r.ModelTree.modified=!0;if(r.ModelTree.getChildren().length==0){var i="    ";t.Console.log(i+t.Resources.EMPTY_MODEL_TREE)}else t.Console.executeCommand(r.ModelTree.instancePath+".print()"),r.ModelTree.print()},modelJSONToNodes:function(e,n){for(var r in n)if(typeof n[r]=="object"){var i=n[r]._metaType;if(n[r]instanceof Array){var o=n[r];e[r]=[];var u=new s({id:r,name:r,_metaType:t.Resources.COMPOSITE_NODE});e.get("children").add(u);for(var a in o){e[r][a]={};var f=this.modelJSONNodes(u,o[a]);e[r][a]=f}}if(i==t.Resources.COMPOSITE_NODE){var l=this.createCompositeNode(n[r]);(e._metaType==t.Resources.COMPOSITE_NODE||e._metaType==t.Resources.ASPECT_SUBTREE_NODE)&&e.get("children").add(l),e[r]=l,this.modelJSONToNodes(e[r],n[r])}else if(i==t.Resources.FUNCTION_NODE){var c=this.createFunctionNode(n[r]);(e._metaType==t.Resources.COMPOSITE_NODE||e._metaType==t.Resources.ASPECT_SUBTREE_NODE)&&e.get("children").add(c),e[r]=c}else if(i==t.Resources.DYNAMICS_NODE){var h=this.createDynamicsSpecificationNode(n[r]);(e._metaType==t.Resources.COMPOSITE_NODE||e._metaType==t.Resources.ASPECT_SUBTREE_NODE)&&e.get("children").add(h),e[r]=h}else if(i==t.Resources.PARAMETER_SPEC_NODE){var p=this.createParameterSpecificationNode(n[r]);(e._metaType==t.Resources.COMPOSITE_NODE||e._metaType==t.Resources.ASPECT_SUBTREE_NODE)&&e.get("children").add(p),e[r]=p}}return e},createSimulationTree:function(e,n){for(var r in n)if(typeof n[r]=="object"){var i=n[r]._metaType;if(n[r]instanceof Array){var o=n[r];e[r]=[];var u=new s({id:r,name:r,instancePath:n.instancePath+"."+r,_metaType:t.Resources.COMPOSITE_NODE});e.get("children").add(u);for(var a=0;a<o.length;a++){e[r][a]={};var f=this.createSimulationTree(u,o[a]);f.getChildren().length>0&&(f.instancePath=u.instancePath+"["+a+"]",e[r][a]=f)}}else if(i==t.Resources.COMPOSITE_NODE){var l=this.createCompositeNode(n[r]);this.createSimulationTree(l,n[r]),(e._metaType==t.Resources.COMPOSITE_NODE||e._metaType==t.Resources.ASPECT_SUBTREE_NODE)&&e.get("children").add(l),e[r]=l}else if(i==t.Resources.VARIABLE_NODE){var l=this.createVariableNode(n[r]);(e._metaType==t.Resources.COMPOSITE_NODE||e._metaType==t.Resources.ASPECT_SUBTREE_NODE)&&e.get("children").add(l),e[r]=l}else if(i==t.Resources.PARAMETER_NODE){var l=this.createParameterNode(n[r]);(e._metaType==t.Resources.COMPOSITE_NODE||e._metaType==t.Resources.ASPECT_SUBTREE_NODE)&&e.get("children").add(l),e[r]=l}}return e},createEntityNode:function(e){var n=window[e.id]=new r({id:e.id,name:e.id,instancePath:e.instancePath,position:e.position});t.Console.addTag(e.instancePath);for(var i in e){var s=e[i];if(s._metaType==t.Resources.ASPECT_NODE){var o=t.RuntimeTreeFactory.createAspectNode(s);n[i]=o,n.get("aspects").add(o),o.setParentEntity(n)}}return n},createAspectNode:function(e){var r=window[e.id]=new n({id:e.id,modelInterpreter:e.modelInterpreter,name:e.id,simulator:e.simulator,model:e.model,instancePath:e.instancePath});t.Console.updateTags(e.instancePath,r),t.Console.addTag(e.instancePath);for(var i in e){var s=e[i];if(s._metaType==t.Resources.ASPECT_SUBTREE_NODE)if(s.type=="VisualizationTree"){var o=this.createAspectSubTreeNode(s);r.VisualizationTree=o,r.get("children").add(o),r.VisualizationTree.content=s}else if(s.type=="SimulationTree")r.SimulationTree={};else if(s.type=="ModelTree"){var o=this.createAspectSubTreeNode(s);r.ModelTree=o,r.get("children").add(o)}}return r},createAspectSubTreeNode:function(e){var n=new i({name:e.type,type:e.type,id:e.id,instancePath:e.instancePath,_metaType:t.Resources.ASPECT_SUBTREE_NODE,modified:e.modified});return t.Console.updateTags(e.instancePath,n),t.Console.addTag(e.instancePath),n},createCompositeNode:function(e){var n=new s({id:e.id,name:e.id,instancePath:e.instancePath,_metaType:t.Resources.COMPOSITE_NODE});return t.Console.updateTags(e.instancePath,n),t.Console.addTag(e.instancePath),n},createFunctionNode:function(e){var n=new f({id:e.id,name:e.id,expression:e.expression,arguments:e.arguments,instancePath:e.instancePath,_metaType:t.Resources.FUNCTION_NODE});return t.Console.updateTags(e.instancePath,n),t.Console.addTag(e.instancePath),n},createDynamicsSpecificationNode:function(e){var n=new a({id:e.id,name:e.id,value:e.value,unit:e.unit,scalingFactor:e.scalingFactor,instancePath:e.instancePath,_metaType:t.Resources.DYNAMICS_NODE}),r=new f({expression:e._function.expression,instancePath:e.instancePath,arguments:e._function.arguments});return n.set("dynamics",r),t.Console.updateTags(e.instancePath,n),t.Console.addTag(e.instancePath),n},createParameterSpecificationNode:function(e){var n=new u({id:e.id,name:e.id,value:e.value,unit:e.unit,scalingFactor:e.scalingFactor,instancePath:e.instancePath,_metaType:t.Resources.PARAMETER_SPEC_NODE});return t.Console.updateTags(e.instancePath,n),t.Console.addTag(e.instancePath),n},createParameterNode:function(e){var n=new o({id:e.ide,name:e.id,instancePath:e.instancePath,properties:options.properties,_metaType:t.Resources.PARAMETER_NODE});return t.Console.updateTags(e.instancePath,n),t.Console.addTag(e.instancePath),n},createVariableNode:function(e){var n=new l({id:e.id,name:e.id,value:e.value,unit:e.unit,scalingFactor:e.scalingFactor,instancePath:e.instancePath,_metaType:t.Resources.VARIABLE_NODE});return t.Console.updateTags(e.instancePath,n),t.Console.addTag(e.instancePath),n}}}}),define("geppetto",["require","jquery","underscore","backbone","vendor/Detector","three","vendor/THREEx.KeyboardState","vendor/ColladaLoader","vendor/OBJLoader","SandboxConsole","GEPPETTO.Resources","GEPPETTO.Init","GEPPETTO.Vanilla","GEPPETTO.FE","GEPPETTO.ScriptRunner","GEPPETTO.JSEditor","GEPPETTO.Console","GEPPETTO.Utility","GEPPETTO.Share","GEPPETTO.MenuManager","websocket-handlers/GEPPETTO.MessageSocket","websocket-handlers/GEPPETTO.GlobalHandler","websocket-handlers/GEPPETTO.SimulationHandler","geppetto-objects/Simulation","geppetto-objects/G","GEPPETTO.Main","widgets/includeWidget","nodes/RuntimeTreeFactory"],function(e){var t=e("jquery"),n=e("underscore"),r=e("backbone");e("vendor/Detector"),e("three"),e("vendor/THREEx.KeyboardState"),e("vendor/ColladaLoader"),e("vendor/OBJLoader");var i,s={init:function(e){return Detector.webgl?(i=s.Init.initialize(e),!0):(Detector.addGetWebGLMessage(),!1)},webGLAvailable:function(){return Detector.webgl?!0:(Detector.addGetWebGLMessage(),!1)},updateScene:function(e){i.needsUpdate=!0;if(i.needsUpdate){var t=e;for(var n in t){var r=t[n];for(var o in r.aspects){var u=r.aspects[o],a=u.VisualizationTree;if(a.modified)for(var f in a.content){var l=a.content[f];if(l!=null&&typeof l=="object"){var c=l._metaType;if(c=="CompositeNode")for(var h in l){var p=l[h],d=p._metaType;(d=="ParticleNode"||c=="SphereNode"||c=="CylinderNode")&&s.updateGeometry(u.instancePath,p)}else(c=="ParticleNode"||c=="SphereNode"||c=="CylinderNode")&&s.updateGeometry(u.instancePath,l)}}var v=i.visualModelMap[u.instancePath];v&&v instanceof THREE.ParticleSystem&&(v.geometry.verticesNeedUpdate=!0)}}i.needsUpdate=!1}i.customUpdate!=null&&s.customUpdate()},updateGeometry:function(e,t){var n=i.visualModelMap[e+"."+t.id];n&&(n instanceof THREE.Vector3?(n.x=t.position.x,n.y=t.position.y,n.z=t.position.z):n.position.set(t.position.x,t.position.y,t.position.z))},getCylinder:function(e,t,n,r,i){var s=new THREE.Vector3;s.subVectors(t,e);var o=s.length(),u=new THREE.Vector3;u.addVectors(e,t),u.multiplyScalar(.5);var a=new THREE.CylinderGeometry(n,r,o,6,1,!1);a.applyMatrix((new THREE.Matrix4).makeRotationX(Math.PI/2));var f=new THREE.Mesh(a,i);f.lookAt(s);var l=u.length();return u.transformDirection(f.matrix),u.multiplyScalar(l),f.position.add(u),f},lightUpEntity:function(e,t){t<0&&(t=0),t>1&&(t=1);var n=function(e){return{r:parseInt(e.substr(2,2),16),g:parseInt(e.substr(4,2),16),b:parseInt(e.substr(6,2),16)}},r=function(e){return Math.floor(e+(255-e)*t).toString(16)},i=s.getThreeObjectFromEntityId(e);if(i!=null){var o=n(i.material.originalColor);i.material.color.setHex("0x"+r(o.r)+r(o.g)+r(o.b))}},populateScene:function(e){for(var t in e)s.loadEntity(e[t],null);s.calculateSceneCenter(i.scene),s.updateCamera()},loadEntity:function(e,t,n){var r=n,o=e.aspects,u=e.getEntities(),a=e.position;t==null?i.entities[e.instancePath]={}:t[e.id]={};for(var f in o){var l=o[f],c=s.getThreeObjectFromVisualizationTree(l,!0,r);for(var h in c){var p=c[h];p.name=l.instancePath,i.scene.add(p),a!=null&&(p.position=new THREE.Vector3(a.x,a.y,a.z)),i.aspects[p.eid]=p,i.aspects[p.eid].visible=!0,i.aspects[p.eid].selected=!1,i.aspects[p.eid].type="Aspect",t!=null?(t[e.id].selected=!1,t[e.id].type="Entity",t[e.id].eid=e.instancePath,t[e.id][l.id]=i.aspects[p.eid],t[e.id][l.id].selected=!1):(i.entities[e.instancePath].selected=!1,i.entities[e.instancePath].type="Entity",i.entities[e.instancePath][l.id]=i.aspects[p.eid],i.entities[e.instancePath][l.id].selected=!1)}}for(var d=0;d<u.length;d++)t!=null?s.loadEntity(u.at(d),t[e.id],r):s.loadEntity(u.at(d),i.entities[e.instancePath],r)},getMeshPhongMaterial:function(){var e=new THREE.MeshPhongMaterial({opacity:1,ambient:7829367,shininess:2,shading:THREE.SmoothShading});return e.originalColor="0x"+(16777216+Math.random()*16777215).toString(16).substr(1,6),e.color.setHex(e.originalColor),e},getThreeObjectFromVisualizationTree:function(e,t,n){var r=new THREE.Geometry,i=n==undefined?s.getMeshPhongMaterial():n,o=[],u=e.VisualizationTree.content;for(var a in u){node=u[a];if(node!=null&&typeof node=="object"){var f=node._metaType;if(f=="CompositeNode"){var l=node[Object.keys(node)[0]],c=l._metaType;if(c=="ParticleNode"){t=!1;var h=s.createParticleSystem(e.instancePath,node);o.push(h)}else if(c=="ColladaNode")o.push(s.getThreeObjectFromJSONGeometry(e.instancePath,node[d]));else if(c=="OBJNode")o.push(s.getThreeObjectFromJSONGeometry(e.instancePath,node[d]));else if(c=="CylinderNode"||c=="SphereNode"){t||(r=new THREE.Geometry);for(var p in node){var d=node[p];if(typeof d=="object"){var v=s.getThreeObjectFromJSONGeometry(e.instancePath,d,i);THREE.GeometryUtils.merge(r,v),v.geometry.dispose()}}t||(h=new THREE.Mesh(r,i),h.eid=e.instancePath,h.geometry.dynamic=!1,o.push(h))}}else if(f=="ParticleNode"){var h=s.createParticleSystem(e.instancePath,u);o.push(h)}else if(f=="ColladaNode")o.push(s.getThreeObjectFromJSONGeometry(e.instancePath,node));else if(f=="OBJNode")o.push(s.getThreeObjectFromJSONGeometry(e.instancePath,node));else if(f=="CylinderNode"||f=="SphereNode"){t||(r=new THREE.Geometry);if(typeof node=="object"){var v=s.getThreeObjectFromJSONGeometry(e.instancePath,node,i);THREE.GeometryUtils.merge(r,v),v.geometry.dispose()}t||(h=new THREE.Mesh(r,i),h.eid=e.instancePath,h.geometry.dynamic=!1,o.push(h))}}}return t&&(h=new THREE.Mesh(r,i),h.eid=e.instancePath,h.geometry.dynamic=!1,o.push(h)),o},createParticleSystem:function(e,t){var n=new THREE.Geometry,r=new THREE.ParticleBasicMaterial({size:5,map:THREE.ImageUtils.loadTexture("images/particle.png"),blending:THREE.AdditiveBlending,depthTest:!1,transparent:!0});r.color=new THREE.Color(16777215),THREE.ColorConverter.setHSV(r.color,Math.random(),1,1),r.originalColor=r.color.getHexString();for(var o in t)if(t[o]._metaType=="ParticleNode"){var u=s.getThreeObjectFromJSONGeometry(e,t[o],r);n.vertices.push(u)}var a=new THREE.ParticleSystem(n,r);return a.eid=e,a.sortParticles=!0,i.visualModelMap[e]=a,a},calculateSceneCenter:function(e){var t=null,n=null;e.traverse(function(e){if(e instanceof THREE.Mesh||e instanceof THREE.ParticleSystem)e.geometry.computeBoundingBox(),t==null&&n==null?(t=e.geometry.boundingBox.min,n=e.geometry.boundingBox.max):(t.x=Math.min(t.x,e.geometry.boundingBox.min.x),t.y=Math.min(t.y,e.geometry.boundingBox.min.y),t.z=Math.min(t.z,e.geometry.boundingBox.min.z),n.x=Math.max(n.x,e.geometry.boundingBox.max.x),n.y=Math.max(n.y,e.geometry.boundingBox.max.y),n.z=Math.max(n.z,e.geometry.boundingBox.max.z))}),i.sceneCenter.x=(n.x+t.x)*.5,i.sceneCenter.y=(n.y+t.y)*.5,i.sceneCenter.z=(n.z+t.z)*.5;var r=new THREE.Vector3;r=r.subVectors(n,t);var s=r.length()*.5,o=s/Math.tan(Math.PI/180*i.camera.fov*.25),u=new THREE.Vector3(0,0,1);u.multiplyScalar(o),i.cameraPosition=new THREE.Vector3,i.cameraPosition.addVectors(i.sceneCenter,u)},updateCamera:function(){i.camera.rotationAutoUpdate=!1,i.camera.position.set(i.cameraPosition.x,i.cameraPosition.y,i.cameraPosition.z),i.camera.lookAt(i.sceneCenter),i.camera.up=new THREE.Vector3(0,1,0),i.camera.rotationAutoUpdate=!0,i.controls.target=i.sceneCenter},isScenePopulated:function(){return!n.isEmpty(i.visualModelMap)},isCanvasCreated:function(){return i.canvasCreated},getThreeObjectFromJSONGeometry:function(e,t,n){var r=null;switch(t._metaType){case"ParticleNode":r=new THREE.Vector3,r.x=t.position.x,r.y=t.position.y,r.z=t.position.z;break;case"CylinderNode":var o=new THREE.Vector3(t.distal.x,t.distal.y,t.distal.z),u=new THREE.Vector3(t.position.x,t.position.y,t.position.z);r=s.getCylinder(u,o,t.radiusTop,t.radiusBottom,n);break;case"SphereNode":r=new THREE.Mesh(new THREE.SphereGeometry(t.radius,20,20),n),r.position.set(t.position.x,t.position.y,t.position.z);break;case"ColladaNode":var a=new THREE.ColladaLoader;a.options.convertUpAxis=!0;var f=new DOMParser,l=f.parseFromString(t.model.data,"application/xml");a.parse(l,function(e){r=e.scene});break;case"OBJNode":var c=new THREE.LoadingManager;c.onProgress=function(e,t,n){console.log(e,t,n)};var a=new THREE.OBJLoader(c);r=a.parse(t.model.data)}return r.visible=!0,i.visualModelMap[e+"."+t.id]=r,r},setupStats:function(){t("#stats").length==0&&i!=null&&(i.stats=new Stats,i.stats.domElement.style.float="right",i.stats.domElement.style.position="absolute",i.stats.domElement.style.bottom="0px",i.stats.domElement.style.right="0px",i.stats.domElement.style.zIndex=100,t("#footerHeader").append(i.stats.domElement))},showStats:function(){t("#stats").length==0?s.setupStats():t("#stats").show()},hideStats:function(){t("#stats").hide()},setupGUI:function(){var e=!n.isEmpty(i.metadata);!i.gui&&e&&(i.gui=new dat.GUI({width:400}),s.addGUIControls(i.gui,i.metadata));for(f in i.gui.__folders)i.gui.__folders[f].open()},addGUIControls:function(e,t){t.hasOwnProperty("ID")&&e.add(t,"ID").listen();for(var n in t)if(n!="ID")if(typeof t[n]=="object"){var r=e.addFolder(n);s.addGUIControls(r,t[n])}else e.add(t,n).listen()},setupAxis:function(){i.scene.add(new THREE.AxisHelper(200))},render:function(){i.renderer.render(i.scene,i.camera)},getIntersectedObjects:function(){var e=new THREE.Vector3(i.mouse.x,i.mouse.y,1);i.projector.unprojectVector(e,i.camera);var t=new THREE.Raycaster(i.camera.position,e.sub(i.camera.position).normalize()),n=[];return i.scene.traverse(function(e){e.visible&&n.push(e)}),t.intersectObjects(n)},isKeyPressed:function(e){return i.keyboard.pressed(e)},getNewId:function(){return i.idCounter++},showMetadataForEntity:function(e){i.gui&&(i.gui.domElement.parentNode.removeChild(i.gui.domElement),i.gui=null),i.metadata=i.runtimetree[e].metadata,i.metadata.ID=i.runtimetree[e].id,s.setupGUI()},animate:function(){i.debugUpdate=i.needsUpdate,s.Simulation.getSimulationStatus()==2&&i.debugUpdate&&s.log(s.Resources.UPDATE_FRAME_STARTING),i.controls.update(),requestAnimationFrame(s.animate);if(i.rotationMode){var e=(new Date).getTime()*5e-4;i.camera.position.x=Math.floor(Math.cos(e)*200),i.camera.position.z=Math.floor(Math.sin(e)*200)}s.render(),i.stats&&i.stats.update(),s.Simulation.getSimulationStatus()==2&&i.debugUpdate&&s.log(s.Resources.UPDATE_FRAME_END)},enterRotationMode:function(e){i.rotationMode=!0,e&&i.camera.lookAt(e)},exitRotationMode:function(){i.rotationMode=!1},getThreeObjectFromEntityId:function(e){var t=null;return i.scene.traverse(function(n){n.hasOwnProperty("eid")&&n.eid==e&&(t=n)}),t},unSelectAll:function(){for(var e in i.entities){var t=i.entities[e];for(var n in t)t[n].selected==1&&(t.selected=!1,s.unselectAspect(t[n].eid))}},selectEntity:function(e){var t=s.Utility.deepFind(i.entities,e),n=!1;for(var r in t){var o=t[r];o.type=="Entity"?s.selectEntity(o.eid):o.type=="Aspect"&&(n=s.selectAspect(o.eid))}return n},unselectEntity:function(e){var t=s.Utility.deepFind(i.entities,e),n=!1;for(var r in t){var o=t[r];o.type=="Entity"?s.unselectEntity(o.eid):o.type=="Aspect"&&(n=s.unselectAspect(o.eid))}return n},showEntity:function(e){var t=!1,n=s.Utility.deepFind(i.entities,e);for(var r in n){var o=n[r];o.type=="Entity"?s.showEntity(o.eid):o.type=="Aspect"&&(t=s.showAspect(o.eid))}return t},hideEntity:function(e){var t=s.Utility.deepFind(i.entities,e),n=!1;for(var r in t){var o=t[r];typeof o=="object"&&(o.type=="Entity"?s.hideEntity(o.eid):o.type=="Aspect"&&(n=s.hideAspect(o.eid)))}return n},zoomToEntity:function(e){var t=null;for(var n in i.entities)n==e&&(t=i.entities[n]);t!=null&&(s.calculateSceneCenter(t),s.updateCamera())},selectAspect:function(e){for(var t in i.aspects)if(t==e&&i.aspects[t].selected==0)return i.aspects[t].material.color.setHex(16777011),i.aspects[t].selected=!0,!0;return!1},unselectAspect:function(e){for(var t in i.aspects)if(t==e&&i.aspects[t].selected==1)return i.aspects[t].material.color.setHex(Math.random()*16777215),i.aspects[t].selected=!1,!0;return!1},showAspect:function(e){for(var t in i.aspects)if(t==e)return i.aspects[t].visible==1?!1:(i.aspects[t].visible=!0,!0);return!1},hideAspect:function(e){for(var t in i.aspects)if(t==e)return i.aspects[t].visible==0?!1:(i.aspects[t].visible=!1,!0);return!1},zoomToAspect:function(e){var t;for(var n in i.aspects)instancepath==n&&(t=i.aspects[n]);t!=null&&(s.calculateSceneCenter(t),s.updateCamera())},resetCamera:function(){s.calculateSceneCenter(i.scene),s.updateCamera()},incrementCameraPan:function(e,t){i.controls.incrementPanEnd(e,t)},incrementCameraRotate:function(e,t,n){i.controls.incrementRotationEnd(e,t,n)},incrementCameraZoom:function(e){i.controls.incrementZoomEnd(e)},log:function(e){if(i.debug){var t=new Date,n=t.getHours(),r=t.getMinutes(),s=t.getSeconds(),o=t.getMilliseconds();console.log(n+":"+r+":"+s+":"+o+" - "+e,"")}},trackActivity:function(e,t,n,r,i){typeof _gaq!="undefined"&&_gaq.push(["_trackEvent",e,t,n,r,i])},winHeight:function(){return window.innerHeight||(document.documentElement||document.body).clientHeight}};return n.extend(s,r.Events),e("SandboxConsole")(s),e("GEPPETTO.Resources")(s),e("GEPPETTO.Init")(s),e("GEPPETTO.Vanilla")(s),e("GEPPETTO.FE")(s),e("GEPPETTO.ScriptRunner")(s),e("GEPPETTO.JSEditor")(s),e("GEPPETTO.Console")(s),e("GEPPETTO.Utility")(s),e("GEPPETTO.Share")(s),e("GEPPETTO.MenuManager")(s),e("websocket-handlers/GEPPETTO.MessageSocket")(s),e("websocket-handlers/GEPPETTO.GlobalHandler")(s),e("websocket-handlers/GEPPETTO.SimulationHandler")(s),e("geppetto-objects/Simulation")(s),e("geppetto-objects/G")(s),e("GEPPETTO.Main")(s),e("widgets/includeWidget")(s),e("nodes/RuntimeTreeFactory")(s),s}),define("mixins/Events",["require","underscore"],function(e){var t=e("underscore");return{eventHash:[],componentWillUnmount:function(){t.each(this.eventHash,function(e){e.target.off(e.event,e.callback)})},listenTo:function(e,t,n){e.on(t,n),this.eventHash.push({target:e,event:t,callback:n})}}}),define("components/simulationcontrols/LoadingSpinner",["require","react","geppetto","jsx!components/bootstrap/modal","jsx!mixins/Events"],function(e){var t=e("react"),n=e("geppetto");return t.createClass({mixins:[e("jsx!components/bootstrap/modal"),e("jsx!mixins/Events")],getDefaultProps:function(){return{text:"Loading Simulation"}},componentDidMount:function(){this.listenTo(n,"simulation:loaded",this.hide),this.listenTo(n,"simulation:modelloaded",this.hide),this.listenTo(n,"geppetto:error",this.hide),setTimeout(function(){n.Simulation.loading&&this.isMounted()&&this.setProps({text:"Loading is taking longer than usual, either a big simulation is being loaded or bandwidth is limited"})}.bind(this),2e4)},render:function(){return t.DOM.div({className:"modal fade",id:"loading-spinner"},t.DOM.div({className:"spinner-backdrop"},t.DOM.div({className:"spinner-container"},t.DOM.div({className:"asterisk icon-spin"}),t.DOM.p({id:"loadingmodaltext",className:"orange"},this.props.text))))}})}),define("mixins/TutorialMixin",["require","react","geppetto","jquery"],function(e){var t=e("react"),n=e("geppetto"),r=e("jquery");return{getDefaultProps:function(){return{popoverTitle:this.popoverTitle||"Button",popoverContent:this.popoverContent||"...",template:this.popoverTemplate||'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}},destroyPopover:function(){r(this.getDOMNode()).popover("destroy")},showPopover:function(){r(this.getDOMNode()).popover({title:this.props.popoverTitle,content:this.props.popoverContent,placement:"auto top",template:this.props.template}).popover("show"),r(this.getDOMNode()).on("hidden.bs.popover",function(){r(this.getDOMNode()).popover("destroy")}.bind(this))}}}),define("components/bootstrap/button",["require","react","mixins/TutorialMixin"],function(e){var t=e("react");return t.createClass({mixins:[e("mixins/TutorialMixin")],displayName:"Button",getDefaultProps:function(){return{disabled:!1,className:""}},render:function(){return t.DOM.button({type:"button",className:"btn "+this.props.className,"data-toggle":this.props["data-toggle"],onClick:this.props.onClick,disabled:this.props.disabled},t.DOM.i({className:this.props.icon}," "+this.props.children))}})}),define("components/tutorial/IntroModal",["require","react","jquery","../bootstrap/button","geppetto","jsx!components/bootstrap/modal"],function(e){var t=e("react"),n=e("jquery"),r=e("../bootstrap/button"),i=e("geppetto");return t.createClass({mixins:[e("jsx!components/bootstrap/modal")],dontShowNextTime:function(e){n.cookie("geppetto_hideWelcomeMessage",!0)},startTutorial:function(){i.trigger("start:tutorial"),i.tutorialEnabled=!0,this.hide()},skipTutorial:function(){this.hide()},render:function(){return t.DOM.div({className:"modal fade lead pagination-centered welcome-modal","data-backdrop":"static","data-keyboard":"false"},t.DOM.div({className:"modal-dialog"},t.DOM.div({className:"modal-content"},t.DOM.div({className:"modal-body container"},t.DOM.div({className:"message-container row"},t.DOM.strong(null,"Welcome to geppetto! "),"geppetto is an open-source platform built by engineers, scientists, and other hackers to simulate complex biological systems and their surrounding environment. This is an ",t.DOM.strong(null,"early access")," development release.",t.DOM.br(null),t.DOM.div({className:"small-text"},"We worked hard to bring you the best possible alpha release but geppetto is still very much a platform under development. In fact, we reckon this only represents about 20% of what you can expect in the end. We hope you'll enjoy it."),r({className:"btn btn-success welcomeButton","data-dismiss":"modal",icon:"icon-comment",onClick:this.startTutorial},"Start Tutorial"),r({className:"btn btn-success welcomeButton","data-dismiss":"modal",icon:"icon-step-forward",onClick:this.skipTutorial},"Skip Tutorial"),t.DOM.div({className:"row disable-welcome"},t.DOM.span(null,t.DOM.input({id:"welcomeMsgCookie",type:"checkbox",onChange:this.dontShowNextTime})," Don't show next time I visit Geppetto")))))))}})}),define("components/utils",["require"],function(e){function t(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return n==null?"":decodeURIComponent(n[1].replace(/\+/g," "))}return{getQueryStringParameter:t}}),define("components/simulationcontrols/XMLEditor",["require","react","codemirror"],function(e){var t=e("react");return e("codemirror"),t.createClass({showFullscreen:function(){this.setFullScreen(!0)},setFullScreen:function(e){var t=this.xmlEditor.getWrapperElement();e?($(".modal-dialog").addClass("fullscreen"),t.className+=" CodeMirror-fullscreen",t.style.height=GEPPETTO.winHeight()+"px",document.documentElement.style.overflow="hidden"):($(".modal-dialog").removeClass("fullscreen"),t.className=t.className.replace(" CodeMirror-fullscreen",""),t.style.height="",document.documentElement.style.overflow=""),this.xmlEditor.focus(),setTimeout(function(){this.xmlEditor.refresh()}.bind(this),20)},isFullScreen:function(e){return/\bCodeMirror-fullscreen\b/.test(this.xmlEditor.getWrapperElement().className)},componentDidUpdate:function(){if(this.xmlEditor&&this.xmlEditor.getValue()!=this.props.simulationXML){this.xmlEditor.setValue(this.props.simulationXML);var e=this.xmlEditor.lineCount(),t=this.xmlEditor.getTextArea().value.length}CodeMirror.on(window,"resize",function(){var e=document.body.getElementsByClassName("CodeMirror-fullscreen")[0];e&&(e.CodeMirror.getWrapperElement().style.height=GEPPETTO.winHeight()+"px")}),this.xmlEditor.autoFormatRange({line:0,ch:0},{line:e,ch:t})},componentDidMount:function(){var e=this;this.xmlEditor=CodeMirror.fromTextArea($("#xmlCodeEditor").get(0),{mode:"xml",lineNumbers:!0,theme:"lesser-dark",extraKeys:{F11:function(){e.setFullScreen(!e.isFullScreen())},Esc:function(){e.isFullScreen()&&e.setFullScreen(!1)}}}),this.xmlEditor.setValue(this.props.simulationXML);var t=function(t){e.props.onChangeXML(t.getValue())};this.xmlEditor.on("change",t)},render:function(){return t.DOM.div({className:"form-group"},t.DOM.label({htmlFor:"modelCustom",className:"col-sm-2 control-label"},"Custom"),t.DOM.div({className:"col-sm-10"},t.DOM.textarea({id:"xmlCodeEditor",className:"form-control",placeholder:""})),t.DOM.i({className:"icon-fullscreen expand-editor pull-right",onClick:this.showFullscreen}))}})}),define("components/simulationcontrols/LoadSimulationModal",["require","react","jquery","jsx!./XMLEditor","geppetto","jsx!components/bootstrap/modal","jsx!mixins/Events"],function(e){var t=e("react"),n=e("jquery"),r=e("jsx!./XMLEditor"),i=e("geppetto");return t.createClass({mixins:[e("jsx!components/bootstrap/modal"),e("jsx!mixins/Events")],getInitialState:function(){return{loadFromURL:!0,disableLoad:!0}},onClickUrl:function(){this.setState({loadFromURL:!0})},onClickCustom:function(){this.setState({loadFromURL:!1})},loadSimulation:function(){if(this.state.loadFromURL)i.Console.executeCommand('Simulation.load("'+this.state.simulationUrl+'")');else{var e=this.state.simulationXML.replace(/\s+/g," ");i.Console.executeCommand("Simulation.loadFromContent('"+e+"')")}},loadSimulationTemplate:function(){var e=this;n.ajax({type:"GET",url:"resources/template.xml",dataType:"xml",success:function(t){e.setState({simulationXML:(new XMLSerializer).serializeToString(t)})}})},setSimulationXML:function(e){this.setState({simulationXML:e})},loadSimulationURL:function(e){i.MessageSocket.send("sim",e)},componentDidMount:function(){this.state.simulationXML||(this.setState({disableLoad:!0}),this.loadSimulationTemplate()),this.listenTo(i,"simulation:configloaded",this.setSimulationXML),this.listenTo(n(this.getDOMNode()),"shown.bs.modal",function(){i.tutorialEnabled&&!i.tutorialLoadingStep&&n(".select-model").popover({content:"You can load a sample simulation from the list available. Alternatively, you can enter the URL of your own simulation in the input field above. Open the dropdown list and select the third simulation. Then press continue to go to the next step",placement:"auto bottom"}).popover("show")}),n(this.getDOMNode()).keypress(function(e){e.which==13&&(e.preventDefault(),this.loadSimulation())}.bind(this))},onSelectSimulationUrl:function(e){var t=e.target.value;t&&(this.loadSimulationURL(t),i.tutorialEnabled&&!i.tutorialLoadingStep&&(n(".load-sim-button").popover({title:"Load Simulation",content:"Use the Load button to load the simulation. Click the button now to continue with tutorial."}).popover("show"),i.tutorialLoadingStep=!0)),this.setState({disableLoad:!t,simulationUrl:t})},onChangeXML:function(e){this.setState({disableLoad:!e,simulationXML:e})},render:function(){return t.DOM.div({className:"modal fade",id:"loading-modal"},t.DOM.div({className:"modal-dialog"},t.DOM.div({className:"modal-content"},t.DOM.div({className:"modal-header"},t.DOM.strong(null,"Load Simulation"),this.renderCloseButton()),t.DOM.div({className:"modal-body"},t.DOM.form({className:"form-horizontal",role:"form"},t.DOM.div({className:"form-group"},t.DOM.div({className:"col-sm-2"}),t.DOM.div({className:"col-sm-10"},t.DOM.div({className:"btn-group"},t.DOM.button({ref:"selectUrlBtn",type:"button",className:this.state.loadFromURL?"btn btn-default active":"btn btn-default",onClick:this.onClickUrl},"URL"),t.DOM.button({ref:"selectCustomBtn",type:"button",className:this.state.loadFromURL?"btn btn-default":"btn btn-default active",onClick:this.onClickCustom},"Custom")),t.DOM.a({className:"icon-question-sign",href:"http://docs.geppetto.org/en/latest/simtutorial.html",target:"_blank"}))),this.state.loadFromURL?t.DOM.div({className:"form-group"},t.DOM.label({htmlFor:"modelUrl",className:"col-sm-2 control-label"},"URL"),t.DOM.div({className:"col-sm-10"},t.DOM.input({type:"text",className:"form-control",id:"modelUrl",value:this.state.simulationUrl,onChange:this.onSelectSimulationUrl,placeholder:"Paste URL of the simulation file..."}))):r({simulationXML:this.state.simulationXML,update:!0,onChangeXML:this.onChangeXML}),t.DOM.div({className:"form-group"},t.DOM.label({htmlFor:"selectSample",className:"col-sm-2 control-label"},"Sample"),t.DOM.div({className:"col-sm-10"},t.DOM.select({className:"form-control select-model",onChange:this.onSelectSimulationUrl},t.DOM.option({value:""},"Select Simulation from list..."),t.DOM.option({value:"https://raw.github.com/openworm/org.geppetto.samples/master/LEMS/SingleComponentHH/GEPPETTO.xml"},"LEMS Sample Hodgkin-Huxley Neuron"),t.DOM.option({value:"https://raw.github.com/openworm/org.geppetto.samples/master/SPH/LiquidSmall/GEPPETTO.xml"},"PCISPH Small Liquid Scene"),t.DOM.option({value:"https://raw.github.com/openworm/org.geppetto.samples/master/SPH/ElasticSmall/GEPPETTO.xml"},"PCISPH Small Elastic Scene"),"//Matteo: I had to remove the Hindmarsh Rose example as opposite to commenting it out as comments were ignored for some reason and it was still showing",t.DOM.option({value:"https://raw.githubusercontent.com/openworm/org.geppetto.samples/master/LEMS/C302/GEPPETTO.xml"},"C302 Experimental network of integrate and fire neurons"),t.DOM.option({value:"https://raw.github.com/openworm/org.geppetto.samples/master/NeuroML/Purkinje/GEPPETTO.xml"},"NeuroML Purkinje Cell (No Simulation)"),t.DOM.option({value:"https://raw.github.com/openworm/org.geppetto.samples/master/NeuroML/PVDR/GEPPETTO.xml"},"NeuroML C.elegans PVDR Neuron (No Simulation)"),t.DOM.option({value:"https://raw.github.com/openworm/org.geppetto.samples/master/obj/Eyewire/GEPPETTO.xml"},"EyeWire Ganglion Cell (No Simulation)")))))),t.DOM.div({className:"modal-footer"},t.DOM.button({type:"button",className:"btn",onClick:this.hide},"Cancel"),t.DOM.button({type:"submit",className:"btn btn-warning load-sim-button",disabled:this.state.disableLoad,onClick:this.loadSimulation},"Load")))))}})}),define("mixins/Button",["require","react"],function(e){var t=e("react");return{displayName:"Button",render:function(){return t.DOM.button({type:"button",className:"btn "+this.props.className,"data-toggle":this.props["data-toggle"],onClick:this.props.onClick,disabled:this.props.disabled},t.DOM.i({className:this.props.icon}," "+this.props.label))}}}),define("components/simulationcontrols/buttons/LoadButton",["require","react","geppetto","jsx!components/simulationcontrols/LoadSimulationModal","mixins/TutorialMixin","mixins/Button"],function(e){var t=e("react"),n=e("geppetto"),r=e("jsx!components/simulationcontrols/LoadSimulationModal");return t.createClass({mixins:[e("mixins/TutorialMixin"),e("mixins/Button")],popoverTitle:"Load a Simulation",popoverContent:"Use this button to load an existing simulation or enter the URL to your own simulation. Click this button to continue with tutorial.",onClick:function(){t.renderComponent(r({show:!0,keyboard:!1}),document.getElementById("modal-region"))},componentDidMount:function(){n.on("start:tutorial",this.showPopover)},getDefaultProps:function(){return{label:"Load Simulation",className:"pull-right",icon:"icon-folder-open-alt",onClick:this.onClick}}})}),define("components/simulationcontrols/buttons/StartButton",["require","react","geppetto","mixins/TutorialMixin","mixins/Button"],function(e){var t=e("react"),n=e("geppetto");return t.createClass({mixins:[e("mixins/TutorialMixin"),e("mixins/Button")],popoverTitle:"Start Simulation",popoverContent:"Once you have loaded a simulation, it's time to see it in action by pressing Start. Click it now to see the simulation in action",onClick:function(){n.Console.executeCommand("Simulation.start()")},componentDidMount:function(){n.on("start:tutorial",function(){n.once("simulation:modelloaded",function(){n.tutorialEnabled&&this.showPopover}.bind(this))}.bind(this))},getDefaultProps:function(){return{label:"Start",className:"pull-right",icon:"icon-play",onClick:this.onClick}}})}),define("components/simulationcontrols/buttons/PauseButton",["require","react","geppetto","mixins/TutorialMixin","mixins/Button"],function(e){var t=e("react"),n=e("geppetto");return t.createClass({mixins:[e("mixins/TutorialMixin"),e("mixins/Button")],onClick:function(){n.Console.executeCommand("Simulation.pause()")},componentDidMount:function(){n.tutorialEnabled&&n.once("simulation:started",this.showPopover)},getDefaultProps:function(){return{label:"Pause",className:"pull-right",icon:"icon-pause",onClick:this.onClick}}})}),define("components/simulationcontrols/buttons/StopButton",["require","react","geppetto","mixins/TutorialMixin","mixins/Button"],function(e){var t=e("react"),n=e("geppetto");return t.createClass({mixins:[e("mixins/TutorialMixin"),e("mixins/Button")],onClick:function(){n.Console.executeCommand("Simulation.stop()")},componentDidMount:function(){n.tutorialEnabled&&n.once("simulation:paused",this.showPopover)},getDefaultProps:function(){return{label:"Stop",className:"pull-right",icon:"icon-stop",onClick:this.onClick}}})}),define("components/help/HelpModal",["require","react","../bootstrap/button","geppetto","jsx!components/bootstrap/modal"],function(e){var t=e("react"),n=e("../bootstrap/button"),r=e("geppetto");return t.createClass({mixins:[e("jsx!components/bootstrap/modal")],startTutorial:function(){r.trigger("start:tutorial"),r.tutorialEnabled=!0,this.hide()},render:function(){return t.DOM.div({className:"modal fade",id:"help-modal"},t.DOM.div({className:"modal-dialog"},t.DOM.div({className:"modal-content"},t.DOM.div({className:"modal-header"},n({type:"button",className:"btn btn-info pull-left",icon:"icon-play",onClick:this.startTutorial},"Start Tutorial "),t.DOM.a({className:"btn btn-info pull-right",icon:"icon-file-text",href:"http://docs.geppetto.org",target:"_blank"},"Docs "),t.DOM.h4({className:"modal-title pagination-centered"},"Quick Help")),t.DOM.div({className:"modal-body"},t.DOM.h4(null,"Navigation Controls"),t.DOM.h5(null,"Rotation"),t.DOM.p(null,"Left click and drag with the mouse to rotate."),t.DOM.h5(null,"Pan"),t.DOM.p(null,"Right click and drag with the mouse to pan."),t.DOM.h5(null,"Zoom"),t.DOM.p(null,"Wheel click and move your mouse up and down to zoom in and out. In addition, you can use the buttons in the upper left corner. The Home button resets the view."),t.DOM.h4(null,"Shortcuts List"),t.DOM.p(null,"Press",t.DOM.a({className:"btn btn-default"},"Ctrl"),t.DOM.a({className:"btn btn-default"},"Alt"),t.DOM.a({className:"btn btn-default"},"J"),"to toggle the Javascript Console"),t.DOM.p(null,"Press",t.DOM.a({className:"btn btn-default"},"Ctrl"),t.DOM.a({className:"btn btn-default"},"Alt"),t.DOM.a({className:"btn btn-default"},"P"),"to bring up a plotting widget"),t.DOM.h4(null,"Geppetto Console"),t.DOM.p(null,"The console provides a way to interact with Geppetto without having to use the UI controls. Through the console, the user can control the org.geppetto.simulation and use the other features available."),t.DOM.h5(null,"Commands"),t.DOM.p(null,"Open the console and type help() in it to view list of available commands, a description on how to use each one of them is also provided."),t.DOM.h5(null,"Autocompletion"),t.DOM.p(null,"Console autcompletes a command once you start typing. Pressing double",t.DOM.a({className:"btn btn-default"},"Tab"),"provides list of available commands that match the entered input."),t.DOM.h4(null,"Loading a Simulation"),t.DOM.h5(null,"Using Controls"),t.DOM.p(null,"Use the",t.DOM.a({className:"btn btn-default"},"Load Simulation"),"button in the top right corner to load a org.geppetto.simulation. A drop down menu with org.geppetto.simulation samples that are ready to load is available. The contents of the org.geppetto.simulation file can be seen by selecting the Custom option after selecting or entering a org.geppetto.simulation. Using this feature, the contents of the org.geppetto.simulation file can be modified prior to loading."),t.DOM.h5(null,"Using console"),t.DOM.p(null,"Simulations can be loaded via console using commands",t.DOM.a({className:"label label-default"},"Simulation.load(simulationURL)"),"and",t.DOM.a({className:"label label-default"},"Simulation.loadFromContent(simulationContent)")),t.DOM.h5(null,"Passing a parameter via URL"),t.DOM.p(null,'A org.geppetto.simulation can be specified as a paramater in the Geppetto URL. This will automatically load the org.geppetto.simulation when Geppetto is launched. To use this feature add the query string paramater "sim=simulationURL", where simulationURL corresponds to the location of the org.geppetto.simulation you want to load.')),t.DOM.div({className:"modal-footer"},t.DOM.button({type:"button",className:"btn btn-warning","data-dismiss":"modal"},"Close")))))}})}),define("components/simulationcontrols/buttons/HelpButton",["require","react","geppetto","jquery","jsx!components/help/HelpModal","mixins/Button"],function(e){var t=e("react"),n=e("geppetto");return $=e("jquery"),HelpModal=e("jsx!components/help/HelpModal"),t.createClass({mixins:[e("mixins/Button")],onClick:function(){n.Console.executeCommand("G.showHelpWindow(true)")},componentDidMount:function(){n.on("simulation:show_helpwindow",function(){t.renderComponent(HelpModal({show:!0}),document.getElementById("modal-region")),$("#help-modal").css("margin-right","-20px"),$("#help-modal").css("max-height",$(window).height()*.7),$("#help-modal .modal-body").css("max-height",$(window).height()*.5)}),n.on("simulation:hide_helpwindow",function(){t.renderComponent(LoadingSpinner({show:!0,keyboard:!1}),$("#modal-region").get(0))})},getDefaultProps:function(){return{label:"Help",className:"pull-right btn-info help-button",icon:"icon-info-sign",onClick:this.onClick}}})}),define("components/simulationcontrols/SimulationControls",["require","react","./buttons/LoadButton","./buttons/StartButton","./buttons/PauseButton","./buttons/StopButton","./buttons/HelpButton","geppetto"],function(e){var t=e("react"),n=e("./buttons/LoadButton"),r=e("./buttons/StartButton"),i=e("./buttons/PauseButton"),s=e("./buttons/StopButton"),o=e("./buttons/HelpButton"),u=e("geppetto"),a=t.createClass({displayName:"Controls",getInitialState:function(){return{disableLoad:!1,disableStart:!0,disablePause:!0,disableStop:!0}},componentDidMount:function(){var e=this;u.on("simulation:modelloaded",function(){e.setState({disableStart:!1,disablePause:!0,disableStop:!0})}),u.on("simulation:started",function(){e.setState({disableStart:!0,disablePause:!1,disableStop:!1})}),u.on("simulation:paused",function(){e.setState({disableStart:!1,disablePause:!0,disableStop:!1})}),u.on("simulation:stopped",function(){e.setState({disableStart:!1,disablePause:!0,disableStop:!0})}),u.on("simulation:disable_all",function(){e.setState({disableLoad:!0,disableStart:!0,disablePause:!0,disableStop:!0})})},render:function(){return t.DOM.div({className:"simulation-controls"},o({disabled:!1}),s({disabled:this.state.disableStop}),i({disabled:this.state.disablePause}),r({disabled:this.state.disableStart}),n({disabled:this.state.disableLoad}))}});t.renderComponent(a({},""),document.getElementById("sim-toolbar"));var f=u.webGLAvailable();f||u.trigger("simulation:disable_all")}),define("components/cameracontrols/CameraControls",["require","react","geppetto","mixins/TutorialMixin"],function(e){var t=e("react"),n=e("geppetto"),r=t.createClass({displayName:"Controls",mixins:[e("mixins/TutorialMixin")],popoverTitle:"Camera Controls",popoverText:"Use these controls to pan, rotate, and zoom the camera.",popoverTemplate:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div><button class="btn btn-info tutorial-next"><i class="icon-check"></i></button></div>',panLeft:function(){n.Console.executeCommand("G.incrementCameraPan(-0.01, 0)")},panRight:function(){n.Console.executeCommand("G.incrementCameraPan(0.01, 0)")},panUp:function(){n.Console.executeCommand("G.incrementCameraPan(0, -0.01)")},panDown:function(){n.Console.executeCommand("G.incrementCameraPan(0, 0.01)")},rotateUp:function(){n.Console.executeCommand("G.incrementCameraRotate(-0.01, 0, 0)")},rotateDown:function(){n.Console.executeCommand("G.incrementCameraRotate(0, 0, 0.01)")},rotateLeft:function(){n.Console.executeCommand("G.incrementCameraRotate(0.01, 0, 0)")},rotateRight:function(){n.Console.executeCommand("G.incrementCameraRotate(0, 0, -0.01)")},cameraHome:function(){n.Console.executeCommand("G.resetCamera()")},zoomIn:function(){n.Console.executeCommand("G.incrementCameraZoom(-0.01)")},zoomOut:function(){n.Console.executeCommand("G.incrementCameraZoom(+0.01)")},componentDidMount:function(){n.on("start:tutorial",function(){n.once("tutorial:cameracontrols",function(){n.tutorialEnabled&&this.showPopover}.bind(this)),$(".tutorial-next").click(function(){this.destroyPopover,n.trigger("tutorial:console")}.bind(this))}.bind(this))},render:function(){return t.DOM.div({className:"position-toolbar"},t.DOM.button({className:"btn squareB icon-chevron-left pan-left",onClick:this.panLeft}),t.DOM.button({className:"btn squareB icon-chevron-up pan-top",onClick:this.panUp}),t.DOM.button({className:"btn squareB icon-chevron-right pan-right",onClick:this.panRight}),t.DOM.button({className:"btn squareB icon-chevron-down pan-bottom",onClick:this.panDown}),t.DOM.button({className:"btn squareB icon-home pan-home",onClick:this.cameraHome}),t.DOM.button({className:"btn squareB icon-undo rotate-left",onClick:this.rotateLeft}),t.DOM.button({className:"btn squareB icon-repeat rotate90 rotate-top",onClick:this.rotateUp}),t.DOM.button({className:"btn squareB icon-repeat rotate-right",onClick:this.rotateRight}),t.DOM.button({className:"btn squareB icon-undo rotate90 rotate-bottom",onClick:this.rotateDown}),t.DOM.button({className:"btn squareB icon-home rotate-home",onClick:this.cameraHome}),t.DOM.button({className:"btn squareB icon-zoom-in zoom-in",onClick:this.zoomIn}),t.DOM.button({className:"btn squareB icon-zoom-out zoom-out",onClick:this.zoomOut}))}});t.renderComponent(r({},""),document.getElementById("camera-controls"))}),define("components/app",["require","jquery","geppetto","react","jsx!./simulationcontrols/LoadingSpinner","jsx!./tutorial/IntroModal","./utils","jsx!./simulationcontrols/SimulationControls","jsx!./cameracontrols/CameraControls","jsx!./tutorial/IntroModal"],function(e){var t=e("jquery"),n=e("geppetto"),r=e("react"),i=e("jsx!./simulationcontrols/LoadingSpinner"),s=e("jsx!./tutorial/IntroModal"),o=e("./utils");e("jsx!./simulationcontrols/SimulationControls"),e("jsx!./cameracontrols/CameraControls"),e("jsx!./tutorial/IntroModal"),n.on("simulation:show_spinner",function(){r.renderComponent(i({show:!0,keyboard:!1}),t("#modal-region").get(0))});var u=o.getQueryStringParameter("sim"),a=n.webGLAvailable();a&&(u?n.Console.executeCommand('Simulation.load("'+u+'")'):t.cookie("geppetto_hideWelcomeMessage")||r.renderComponent(s({show:!0}),document.getElementById("modal-region")))}),require.config({paths:{jquery:"vendor/jquery-1.9.1.min",three:"vendor/three.min",codemirror:"vendor/codemirror.min",underscore:"vendor/underscore.min",backbone:"vendor/backbone.min","backbone-store":"vendor/backbone-localStorage.min","backbone-associations":"vendor/backbone-associations-min",geppetto:"GEPPETTO",react:"vendor/react",jsx:"vendor/jsx",JSXTransformer:"vendor/JSXTransformer",text:"vendor/text"},shim:{"vendor/jquery-ui-1.10.3.custom.min":["jquery"],"vendor/TrackballControls":["three"],"vendor/THREEx.KeyboardState":["three"],"vendor/ColladaLoader":["three"],"vendor/OBJLoader":["three"],"vendor/ColorConverter":["three"],"vendor/bootstrap.min":["jquery"],"vendor/codemirror-formats.min":["codemirror"],"vendor/backbone-localStorage.min":["backbone"],"backbone-associations":["backbone"],"vendor/dat.gui.min":["jquery"],"vendor/stats.min":["jquery"],"vendor/Detector":["jquery"],"vendor/jquery.cookie":["jquery"],"vendor/rAF":["jquery"],JSXTransformer:{exports:"JSXTransformer"}}});var jqueryLib=["jquery","geppetto","three","vendor/THREEx.KeyboardState","vendor/ColladaLoader","vendor/OBJLoader","vendor/jquery-ui-1.10.3.custom.min","vendor/TrackballControls","vendor/ColorConverter","vendor/bootstrap.min","codemirror","vendor/codemirror-formats.min","vendor/dat.gui.min","vendor/stats.min","vendor/Detector","vendor/jquery.cookie","vendor/rAF"];require(jqueryLib,function(e,t){require(["components/app"],function(){}),e(function(){window.GEPPETTO=require("geppetto"),window.Simulation=GEPPETTO.Simulation,window.G=GEPPETTO.G,window.Widgets=GEPPETTO.Widgets,window.help=GEPPETTO.Utility.help})}),define("main",function(){});